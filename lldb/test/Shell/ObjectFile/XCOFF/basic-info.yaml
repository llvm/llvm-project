# RUN: yaml2obj %s -o %t
# RUN: lldb-test object-file %t | FileCheck %s

# CHECK: Plugin name: xcoff
# CHECK: Architecture: powerpc64-ibm-aix
# CHECK: Executable: true
# CHECK: Stripped: false
# CHECK: Type: executable
# CHECK: Strata: unknown
# CHECK: Name: .text
# CHECK-NEXT: Type: code
# CHECK-NEXT: Permissions: r-x
# CHECK: Name: .data
# CHECK-NEXT: Type: data
# CHECK-NEXT: Permissions: rw-
# CHECK: Name: .bss
# CHECK-NEXT: Type: zero-fill
# CHECK-NEXT: Permissions: rw-
# CHECK: Name: .loader
# CHECK-NEXT: Type: regular
# CHECK-NEXT: Permissions: r--
# CHECK: Name: .dwline
# CHECK-NEXT: Type: dwarf-line
# CHECK-NEXT: Permissions: r--
# CHECK: Name: .dwinfo
# CHECK-NEXT: Type: dwarf-info
# CHECK-NEXT: Permissions: r--
# CHECK: Name: .dwabrev
# CHECK-NEXT: Type: dwarf-abbrev
# CHECK-NEXT: Permissions: r--

# RUN: %lldb %t -o "image dump symtab" -o exit | FileCheck %s --check-prefix=CHECK-SYMBOL
# CHECK-SYMBOL:Index   UserID DSX Type            File Address/Value Load Address       Size               Flags      Name
# CHECK-SYMBOL:[    0] 4294967295     Invalid         0xffffffffffffffff                    0x0000000000000000 0x00000000 errno
# CHECK-SYMBOL:[    1] 4294967295     Code            0x0000000100000500                    0x0000000000000398 0x00000000 __threads_init
# CHECK-SYMBOL:[    2] 4294967295     Data            0x0000000110000a70                    0x0000000000000060 0x00000000 __threads_init
# CHECK-SYMBOL:[    3] 4294967295     Invalid         0x0000000110000ad0                    0x00000000000000b0 0x00000000 TOC
# CHECK-SYMBOL:[    4] 4294967295     Invalid         0x0000000100000898                    0x00000000100001d8 0x00000000 text
# CHECK-SYMBOL:[    5] 4294967295     Code            0x0000000100000898                    0x00000000100001d8 0x00000000 main

--- !XCOFF
FileHeader:
  MagicNumber:     0x1F7
  NumberOfSections: 7 
  CreationTime:    000000000
  Flags:           0x0002
Sections:
  - Name:            .text
    Address:         0x100000438
    Size:            0x38
    FileOffsetToData: 0x0
    FileOffsetToLineNumbers: 0x0
    NumberOfLineNumbers: 0x0
    Flags:           [ STYP_TEXT ]
    SectionData:     E8C20000
  - Name:            .data
    Address:         0x1100008D2
    Size:            0x2AE
    FileOffsetToData: 0x8D2
    FileOffsetToRelocations: 0x132E
    FileOffsetToLineNumbers: 0x0
    NumberOfRelocations: 0x22
    NumberOfLineNumbers: 0x0
    Flags:           [ STYP_DATA ]
    SectionData:     '' 
  - Name:            .bss
    Address:         0x110000B80
    Size:            0x28
    FileOffsetToData: 0x0
    FileOffsetToRelocations: 0x0
    FileOffsetToLineNumbers: 0x0
    NumberOfRelocations: 0x0
    NumberOfLineNumbers: 0x0
    Flags:           [ STYP_BSS ]
    SectionData:     ''
  - Name:            .loader
    Address:         0x0
    Size:            0x413
    FileOffsetToData: 0xB80
    FileOffsetToRelocations: 0x0
    FileOffsetToLineNumbers: 0x0
    NumberOfRelocations: 0x0
    NumberOfLineNumbers: 0x0
    Flags:           [ STYP_LOADER ]
    SectionData:     00000001
  - Name:            .dwline
    Address:         0x0
    Size:            0x9C
    FileOffsetToData: 0xF94
    FileOffsetToRelocations: 0x150A
    FileOffsetToLineNumbers: 0x0
    NumberOfRelocations: 0x5
    NumberOfLineNumbers: 0x0
    Flags:           [ STYP_DWARF ]
    SectionData:     FFFFFFFF
  - Name:            .dwinfo
    Address:         0x0
    Size:            0xDD
    FileOffsetToData: 0x1030
    FileOffsetToRelocations: 0x1550
    FileOffsetToLineNumbers: 0x0
    NumberOfRelocations: 0x6
    NumberOfLineNumbers: 0x0
    Flags:           [ STYP_DWARF ]
    SectionData:     FFFFFFFF
  - Name:            .dwabrev
    Address:         0x0
    Size:            0x43
    FileOffsetToData: 0x110E
    FileOffsetToRelocations: 0x0
    FileOffsetToLineNumbers: 0x0
    NumberOfRelocations: 0x0
    NumberOfLineNumbers: 0x0
    Flags:           [ STYP_DWARF ]
    SectionData:     01110125
Symbols:
  - Name:            errno
    Value:           0x0
    Section:         N_UNDEF
    Type:            0x0
    StorageClass:    C_EXT
    NumberOfAuxEntries: 1
    AuxEntries:
      - Type:            AUX_CSECT
        ParameterHashIndex: 0
        TypeChkSectNum:  0
        SymbolAlignmentAndType: 0
        StorageMappingClass: XMC_RW
        SectionOrLengthLo: 0
        SectionOrLengthHi: 0
  - Name:            .__threads_init
    Value:           0x100000500
    Section:         .text
    Type:            0x20
    StorageClass:    C_EXT
    NumberOfAuxEntries: 1
    AuxEntries:
      - Type:            AUX_CSECT
        ParameterHashIndex: 0
        TypeChkSectNum:  0
        SymbolAlignmentAndType: 2
        StorageMappingClass: XMC_PR
        SectionOrLengthLo: 80
        SectionOrLengthHi: 0
  - Name:            __threads_init
    Value:           0x110000A70
    Section:         .data
    Type:            0x0
    StorageClass:    C_EXT
    NumberOfAuxEntries: 1
    AuxEntries:
      - Type:            AUX_CSECT
        ParameterHashIndex: 0
        TypeChkSectNum:  0
        SymbolAlignmentAndType: 25
        StorageMappingClass: XMC_DS
        SectionOrLengthLo: 24
        SectionOrLengthHi: 0
  - Name:            TOC
    Value:           0x110000AD0
    Section:         .data
    Type:            0x0
    StorageClass:    C_HIDEXT
    NumberOfAuxEntries: 1
    AuxEntries:
      - Type:            AUX_CSECT
        ParameterHashIndex: 0
        TypeChkSectNum:  0
        SymbolAlignmentAndType: 25
        StorageMappingClass: XMC_TC0
        SectionOrLengthLo: 0
        SectionOrLengthHi: 0
  - Name:            .text
    Value:           0x100000898
    Section:         .text
    Type:            0x0
    StorageClass:    C_HIDEXT
    NumberOfAuxEntries: 1
    AuxEntries:
      - Type:            AUX_CSECT
        ParameterHashIndex: 0
        TypeChkSectNum:  0
        SymbolAlignmentAndType: 17
        StorageMappingClass: XMC_PR
        SectionOrLengthLo: 58
        SectionOrLengthHi: 0
  - Name:            .main
    Value:           0x100000898
    Section:         .text
    Type:            0x0
    StorageClass:    C_EXT
    NumberOfAuxEntries: 1
    AuxEntries:
      - Type:            AUX_CSECT
        ParameterHashIndex: 0
        TypeChkSectNum:  0
        SymbolAlignmentAndType: 2
        StorageMappingClass: XMC_PR
        SectionOrLengthLo: 135
        SectionOrLengthHi: 0
StringTable:     {}
...
