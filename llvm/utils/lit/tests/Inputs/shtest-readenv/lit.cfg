import os

import lit.formats
import lit.util

config.name = "shtest-readenv"
config.suffixes = [".txt"]
lit_shell_env = os.environ.get("LIT_USE_INTERNAL_SHELL")
use_lit_shell = lit.util.pythonize_bool(lit_shell_env)
config.test_format = lit.formats.ShTest(execute_external=not use_lit_shell)
config.test_source_root = None
config.test_exec_root = None

# The internal env command cannot invoke the internal echo command.
# Pass along the external echo to test that we handle "env" correctly.
import shutil
echo = shutil.which("echo")
if echo:
    config.substitutions.append(("%{external-echo}", echo))
