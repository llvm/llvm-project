; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: opt -S -atomic-expand -mtriple=powerpc64le-unknown-unknown \
; RUN:   -opaque-pointers < %s 2>&1 | FileCheck %s
; RUN: opt -S -atomic-expand -mtriple=powerpc64-unknown-unknown \
; RUN:   -opaque-pointers < %s 2>&1 | FileCheck %s

define double @foo(double* %dp) {
; CHECK-LABEL: @foo(
; CHECK-NEXT:  entry:
; CHECK-NEXT:    [[TMP0:%.*]] = load atomic i64, ptr [[DP:%.*]] monotonic, align 8
; CHECK-NEXT:    [[TMP1:%.*]] = bitcast i64 [[TMP0]] to double
; CHECK-NEXT:    call void @llvm.ppc.cfence.f64(double [[TMP1]])
; CHECK-NEXT:    ret double [[TMP1]]
;
entry:
  %0 = load atomic double, double* %dp acquire, align 8
  ret double %0
}
