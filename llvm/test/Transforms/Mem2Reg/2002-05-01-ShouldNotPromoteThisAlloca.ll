; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; This input caused the mem2reg pass to die because it was trying to promote
; the %r alloca, even though it is invalid to do so in this case!
;
; RUN: opt < %s -passes=mem2reg -S | FileCheck %s

define void @test() {
; CHECK-LABEL: @test(
; CHECK-NEXT:    [[R:%.*]] = alloca i32, align 4
; CHECK-NEXT:    store i32 4, i32* [[R]], align 4
; CHECK-NEXT:    store i32* [[R]], i32** null, align 8
; CHECK-NEXT:    ret void
;
  %r = alloca i32		; <i32*> [#uses=2]
  store i32 4, i32* %r
  store i32* %r, i32** null
  ret void
}

