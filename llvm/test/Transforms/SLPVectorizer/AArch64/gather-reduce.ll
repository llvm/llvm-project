; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: opt -S -passes=slp-vectorizer,dce,instcombine < %s | FileCheck %s --check-prefix=GENERIC
; RUN: opt -S -mcpu=kryo -passes=slp-vectorizer,dce,instcombine < %s | FileCheck %s --check-prefix=KRYO

target datalayout = "e-m:e-i64:64-i128:128-n32:64-S128"
target triple = "aarch64--linux-gnu"

; These tests check that we vectorize the index calculations in the
; gather-reduce pattern shown below. We check cases having i32 and i64
; subtraction.
;
; int gather_reduce_8x16(short *a, short *b, short *g, int n) {
;   int sum = 0;
;   for (int i = 0; i < n ; ++i) {
;     sum += g[*a++ - b[0]]; sum += g[*a++ - b[1]];
;     sum += g[*a++ - b[2]]; sum += g[*a++ - b[3]];
;     sum += g[*a++ - b[4]]; sum += g[*a++ - b[5]];
;     sum += g[*a++ - b[6]]; sum += g[*a++ - b[7]];
;   }
;   return sum;
; }

define i32 @gather_reduce_8x16_i32(ptr nocapture readonly %a, ptr nocapture readonly %b, ptr nocapture readonly %g, i32 %n) {
; GENERIC-LABEL: @gather_reduce_8x16_i32(
; GENERIC-NEXT:  entry:
; GENERIC-NEXT:    [[CMP_99:%.*]] = icmp sgt i32 [[N:%.*]], 0
; GENERIC-NEXT:    br i1 [[CMP_99]], label [[FOR_BODY_PREHEADER:%.*]], label [[FOR_COND_CLEANUP:%.*]]
; GENERIC:       for.body.preheader:
; GENERIC-NEXT:    br label [[FOR_BODY:%.*]]
; GENERIC:       for.cond.cleanup.loopexit:
; GENERIC-NEXT:    br label [[FOR_COND_CLEANUP]]
; GENERIC:       for.cond.cleanup:
; GENERIC-NEXT:    [[SUM_0_LCSSA:%.*]] = phi i32 [ 0, [[ENTRY:%.*]] ], [ [[ADD66:%.*]], [[FOR_COND_CLEANUP_LOOPEXIT:%.*]] ]
; GENERIC-NEXT:    ret i32 [[SUM_0_LCSSA]]
; GENERIC:       for.body:
; GENERIC-NEXT:    [[I_0103:%.*]] = phi i32 [ [[INC:%.*]], [[FOR_BODY]] ], [ 0, [[FOR_BODY_PREHEADER]] ]
; GENERIC-NEXT:    [[SUM_0102:%.*]] = phi i32 [ [[ADD66]], [[FOR_BODY]] ], [ 0, [[FOR_BODY_PREHEADER]] ]
; GENERIC-NEXT:    [[A_ADDR_0101:%.*]] = phi ptr [ [[INCDEC_PTR58:%.*]], [[FOR_BODY]] ], [ [[A:%.*]], [[FOR_BODY_PREHEADER]] ]
; GENERIC-NEXT:    [[INCDEC_PTR:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 1
; GENERIC-NEXT:    [[TMP0:%.*]] = load i16, ptr [[A_ADDR_0101]], align 2
; GENERIC-NEXT:    [[CONV:%.*]] = zext i16 [[TMP0]] to i64
; GENERIC-NEXT:    [[INCDEC_PTR1:%.*]] = getelementptr inbounds i16, ptr [[B:%.*]], i64 1
; GENERIC-NEXT:    [[TMP1:%.*]] = load i16, ptr [[B]], align 2
; GENERIC-NEXT:    [[CONV2:%.*]] = zext i16 [[TMP1]] to i64
; GENERIC-NEXT:    [[SUB:%.*]] = sub nsw i64 [[CONV]], [[CONV2]]
; GENERIC-NEXT:    [[ARRAYIDX:%.*]] = getelementptr inbounds i16, ptr [[G:%.*]], i64 [[SUB]]
; GENERIC-NEXT:    [[TMP2:%.*]] = load i16, ptr [[ARRAYIDX]], align 2
; GENERIC-NEXT:    [[CONV3:%.*]] = zext i16 [[TMP2]] to i32
; GENERIC-NEXT:    [[ADD:%.*]] = add nsw i32 [[SUM_0102]], [[CONV3]]
; GENERIC-NEXT:    [[INCDEC_PTR4:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 2
; GENERIC-NEXT:    [[TMP3:%.*]] = load i16, ptr [[INCDEC_PTR]], align 2
; GENERIC-NEXT:    [[CONV5:%.*]] = zext i16 [[TMP3]] to i64
; GENERIC-NEXT:    [[INCDEC_PTR6:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 2
; GENERIC-NEXT:    [[TMP4:%.*]] = load i16, ptr [[INCDEC_PTR1]], align 2
; GENERIC-NEXT:    [[CONV7:%.*]] = zext i16 [[TMP4]] to i64
; GENERIC-NEXT:    [[SUB8:%.*]] = sub nsw i64 [[CONV5]], [[CONV7]]
; GENERIC-NEXT:    [[ARRAYIDX10:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB8]]
; GENERIC-NEXT:    [[TMP5:%.*]] = load i16, ptr [[ARRAYIDX10]], align 2
; GENERIC-NEXT:    [[CONV11:%.*]] = zext i16 [[TMP5]] to i32
; GENERIC-NEXT:    [[ADD12:%.*]] = add nsw i32 [[ADD]], [[CONV11]]
; GENERIC-NEXT:    [[INCDEC_PTR13:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 3
; GENERIC-NEXT:    [[TMP6:%.*]] = load i16, ptr [[INCDEC_PTR4]], align 2
; GENERIC-NEXT:    [[CONV14:%.*]] = zext i16 [[TMP6]] to i64
; GENERIC-NEXT:    [[INCDEC_PTR15:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 3
; GENERIC-NEXT:    [[TMP7:%.*]] = load i16, ptr [[INCDEC_PTR6]], align 2
; GENERIC-NEXT:    [[CONV16:%.*]] = zext i16 [[TMP7]] to i64
; GENERIC-NEXT:    [[SUB17:%.*]] = sub nsw i64 [[CONV14]], [[CONV16]]
; GENERIC-NEXT:    [[ARRAYIDX19:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB17]]
; GENERIC-NEXT:    [[TMP8:%.*]] = load i16, ptr [[ARRAYIDX19]], align 2
; GENERIC-NEXT:    [[CONV20:%.*]] = zext i16 [[TMP8]] to i32
; GENERIC-NEXT:    [[ADD21:%.*]] = add nsw i32 [[ADD12]], [[CONV20]]
; GENERIC-NEXT:    [[INCDEC_PTR22:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 4
; GENERIC-NEXT:    [[TMP9:%.*]] = load i16, ptr [[INCDEC_PTR13]], align 2
; GENERIC-NEXT:    [[CONV23:%.*]] = zext i16 [[TMP9]] to i64
; GENERIC-NEXT:    [[INCDEC_PTR24:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 4
; GENERIC-NEXT:    [[TMP10:%.*]] = load i16, ptr [[INCDEC_PTR15]], align 2
; GENERIC-NEXT:    [[CONV25:%.*]] = zext i16 [[TMP10]] to i64
; GENERIC-NEXT:    [[SUB26:%.*]] = sub nsw i64 [[CONV23]], [[CONV25]]
; GENERIC-NEXT:    [[ARRAYIDX28:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB26]]
; GENERIC-NEXT:    [[TMP11:%.*]] = load i16, ptr [[ARRAYIDX28]], align 2
; GENERIC-NEXT:    [[CONV29:%.*]] = zext i16 [[TMP11]] to i32
; GENERIC-NEXT:    [[ADD30:%.*]] = add nsw i32 [[ADD21]], [[CONV29]]
; GENERIC-NEXT:    [[INCDEC_PTR31:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 5
; GENERIC-NEXT:    [[TMP12:%.*]] = load i16, ptr [[INCDEC_PTR22]], align 2
; GENERIC-NEXT:    [[CONV32:%.*]] = zext i16 [[TMP12]] to i64
; GENERIC-NEXT:    [[INCDEC_PTR33:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 5
; GENERIC-NEXT:    [[TMP13:%.*]] = load i16, ptr [[INCDEC_PTR24]], align 2
; GENERIC-NEXT:    [[CONV34:%.*]] = zext i16 [[TMP13]] to i64
; GENERIC-NEXT:    [[SUB35:%.*]] = sub nsw i64 [[CONV32]], [[CONV34]]
; GENERIC-NEXT:    [[ARRAYIDX37:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB35]]
; GENERIC-NEXT:    [[TMP14:%.*]] = load i16, ptr [[ARRAYIDX37]], align 2
; GENERIC-NEXT:    [[CONV38:%.*]] = zext i16 [[TMP14]] to i32
; GENERIC-NEXT:    [[ADD39:%.*]] = add nsw i32 [[ADD30]], [[CONV38]]
; GENERIC-NEXT:    [[INCDEC_PTR40:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 6
; GENERIC-NEXT:    [[TMP15:%.*]] = load i16, ptr [[INCDEC_PTR31]], align 2
; GENERIC-NEXT:    [[CONV41:%.*]] = zext i16 [[TMP15]] to i64
; GENERIC-NEXT:    [[INCDEC_PTR42:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 6
; GENERIC-NEXT:    [[TMP16:%.*]] = load i16, ptr [[INCDEC_PTR33]], align 2
; GENERIC-NEXT:    [[CONV43:%.*]] = zext i16 [[TMP16]] to i64
; GENERIC-NEXT:    [[SUB44:%.*]] = sub nsw i64 [[CONV41]], [[CONV43]]
; GENERIC-NEXT:    [[ARRAYIDX46:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB44]]
; GENERIC-NEXT:    [[TMP17:%.*]] = load i16, ptr [[ARRAYIDX46]], align 2
; GENERIC-NEXT:    [[CONV47:%.*]] = zext i16 [[TMP17]] to i32
; GENERIC-NEXT:    [[ADD48:%.*]] = add nsw i32 [[ADD39]], [[CONV47]]
; GENERIC-NEXT:    [[INCDEC_PTR49:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 7
; GENERIC-NEXT:    [[TMP18:%.*]] = load i16, ptr [[INCDEC_PTR40]], align 2
; GENERIC-NEXT:    [[CONV50:%.*]] = zext i16 [[TMP18]] to i64
; GENERIC-NEXT:    [[INCDEC_PTR51:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 7
; GENERIC-NEXT:    [[TMP19:%.*]] = load i16, ptr [[INCDEC_PTR42]], align 2
; GENERIC-NEXT:    [[CONV52:%.*]] = zext i16 [[TMP19]] to i64
; GENERIC-NEXT:    [[SUB53:%.*]] = sub nsw i64 [[CONV50]], [[CONV52]]
; GENERIC-NEXT:    [[ARRAYIDX55:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB53]]
; GENERIC-NEXT:    [[TMP20:%.*]] = load i16, ptr [[ARRAYIDX55]], align 2
; GENERIC-NEXT:    [[CONV56:%.*]] = zext i16 [[TMP20]] to i32
; GENERIC-NEXT:    [[ADD57:%.*]] = add nsw i32 [[ADD48]], [[CONV56]]
; GENERIC-NEXT:    [[INCDEC_PTR58]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 8
; GENERIC-NEXT:    [[TMP21:%.*]] = load i16, ptr [[INCDEC_PTR49]], align 2
; GENERIC-NEXT:    [[CONV59:%.*]] = zext i16 [[TMP21]] to i64
; GENERIC-NEXT:    [[TMP22:%.*]] = load i16, ptr [[INCDEC_PTR51]], align 2
; GENERIC-NEXT:    [[CONV61:%.*]] = zext i16 [[TMP22]] to i64
; GENERIC-NEXT:    [[SUB62:%.*]] = sub nsw i64 [[CONV59]], [[CONV61]]
; GENERIC-NEXT:    [[ARRAYIDX64:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB62]]
; GENERIC-NEXT:    [[TMP23:%.*]] = load i16, ptr [[ARRAYIDX64]], align 2
; GENERIC-NEXT:    [[CONV65:%.*]] = zext i16 [[TMP23]] to i32
; GENERIC-NEXT:    [[ADD66]] = add nsw i32 [[ADD57]], [[CONV65]]
; GENERIC-NEXT:    [[INC]] = add nuw nsw i32 [[I_0103]], 1
; GENERIC-NEXT:    [[EXITCOND:%.*]] = icmp eq i32 [[INC]], [[N]]
; GENERIC-NEXT:    br i1 [[EXITCOND]], label [[FOR_COND_CLEANUP_LOOPEXIT]], label [[FOR_BODY]]
;
; KRYO-LABEL: @gather_reduce_8x16_i32(
; KRYO-NEXT:  entry:
; KRYO-NEXT:    [[CMP_99:%.*]] = icmp sgt i32 [[N:%.*]], 0
; KRYO-NEXT:    br i1 [[CMP_99]], label [[FOR_BODY_PREHEADER:%.*]], label [[FOR_COND_CLEANUP:%.*]]
; KRYO:       for.body.preheader:
; KRYO-NEXT:    br label [[FOR_BODY:%.*]]
; KRYO:       for.cond.cleanup.loopexit:
; KRYO-NEXT:    br label [[FOR_COND_CLEANUP]]
; KRYO:       for.cond.cleanup:
; KRYO-NEXT:    [[SUM_0_LCSSA:%.*]] = phi i32 [ 0, [[ENTRY:%.*]] ], [ [[ADD66:%.*]], [[FOR_COND_CLEANUP_LOOPEXIT:%.*]] ]
; KRYO-NEXT:    ret i32 [[SUM_0_LCSSA]]
; KRYO:       for.body:
; KRYO-NEXT:    [[I_0103:%.*]] = phi i32 [ [[INC:%.*]], [[FOR_BODY]] ], [ 0, [[FOR_BODY_PREHEADER]] ]
; KRYO-NEXT:    [[SUM_0102:%.*]] = phi i32 [ [[ADD66]], [[FOR_BODY]] ], [ 0, [[FOR_BODY_PREHEADER]] ]
; KRYO-NEXT:    [[A_ADDR_0101:%.*]] = phi ptr [ [[INCDEC_PTR58:%.*]], [[FOR_BODY]] ], [ [[A:%.*]], [[FOR_BODY_PREHEADER]] ]
; KRYO-NEXT:    [[INCDEC_PTR:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 1
; KRYO-NEXT:    [[TMP0:%.*]] = load i16, ptr [[A_ADDR_0101]], align 2
; KRYO-NEXT:    [[CONV:%.*]] = zext i16 [[TMP0]] to i64
; KRYO-NEXT:    [[INCDEC_PTR1:%.*]] = getelementptr inbounds i16, ptr [[B:%.*]], i64 1
; KRYO-NEXT:    [[TMP1:%.*]] = load i16, ptr [[B]], align 2
; KRYO-NEXT:    [[CONV2:%.*]] = zext i16 [[TMP1]] to i64
; KRYO-NEXT:    [[SUB:%.*]] = sub nsw i64 [[CONV]], [[CONV2]]
; KRYO-NEXT:    [[ARRAYIDX:%.*]] = getelementptr inbounds i16, ptr [[G:%.*]], i64 [[SUB]]
; KRYO-NEXT:    [[TMP2:%.*]] = load i16, ptr [[ARRAYIDX]], align 2
; KRYO-NEXT:    [[CONV3:%.*]] = zext i16 [[TMP2]] to i32
; KRYO-NEXT:    [[ADD:%.*]] = add nsw i32 [[SUM_0102]], [[CONV3]]
; KRYO-NEXT:    [[INCDEC_PTR4:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 2
; KRYO-NEXT:    [[TMP3:%.*]] = load i16, ptr [[INCDEC_PTR]], align 2
; KRYO-NEXT:    [[CONV5:%.*]] = zext i16 [[TMP3]] to i64
; KRYO-NEXT:    [[INCDEC_PTR6:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 2
; KRYO-NEXT:    [[TMP4:%.*]] = load i16, ptr [[INCDEC_PTR1]], align 2
; KRYO-NEXT:    [[CONV7:%.*]] = zext i16 [[TMP4]] to i64
; KRYO-NEXT:    [[SUB8:%.*]] = sub nsw i64 [[CONV5]], [[CONV7]]
; KRYO-NEXT:    [[ARRAYIDX10:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB8]]
; KRYO-NEXT:    [[TMP5:%.*]] = load i16, ptr [[ARRAYIDX10]], align 2
; KRYO-NEXT:    [[CONV11:%.*]] = zext i16 [[TMP5]] to i32
; KRYO-NEXT:    [[ADD12:%.*]] = add nsw i32 [[ADD]], [[CONV11]]
; KRYO-NEXT:    [[INCDEC_PTR13:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 3
; KRYO-NEXT:    [[TMP6:%.*]] = load i16, ptr [[INCDEC_PTR4]], align 2
; KRYO-NEXT:    [[CONV14:%.*]] = zext i16 [[TMP6]] to i64
; KRYO-NEXT:    [[INCDEC_PTR15:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 3
; KRYO-NEXT:    [[TMP7:%.*]] = load i16, ptr [[INCDEC_PTR6]], align 2
; KRYO-NEXT:    [[CONV16:%.*]] = zext i16 [[TMP7]] to i64
; KRYO-NEXT:    [[SUB17:%.*]] = sub nsw i64 [[CONV14]], [[CONV16]]
; KRYO-NEXT:    [[ARRAYIDX19:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB17]]
; KRYO-NEXT:    [[TMP8:%.*]] = load i16, ptr [[ARRAYIDX19]], align 2
; KRYO-NEXT:    [[CONV20:%.*]] = zext i16 [[TMP8]] to i32
; KRYO-NEXT:    [[ADD21:%.*]] = add nsw i32 [[ADD12]], [[CONV20]]
; KRYO-NEXT:    [[INCDEC_PTR22:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 4
; KRYO-NEXT:    [[TMP9:%.*]] = load i16, ptr [[INCDEC_PTR13]], align 2
; KRYO-NEXT:    [[CONV23:%.*]] = zext i16 [[TMP9]] to i64
; KRYO-NEXT:    [[INCDEC_PTR24:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 4
; KRYO-NEXT:    [[TMP10:%.*]] = load i16, ptr [[INCDEC_PTR15]], align 2
; KRYO-NEXT:    [[CONV25:%.*]] = zext i16 [[TMP10]] to i64
; KRYO-NEXT:    [[SUB26:%.*]] = sub nsw i64 [[CONV23]], [[CONV25]]
; KRYO-NEXT:    [[ARRAYIDX28:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB26]]
; KRYO-NEXT:    [[TMP11:%.*]] = load i16, ptr [[ARRAYIDX28]], align 2
; KRYO-NEXT:    [[CONV29:%.*]] = zext i16 [[TMP11]] to i32
; KRYO-NEXT:    [[ADD30:%.*]] = add nsw i32 [[ADD21]], [[CONV29]]
; KRYO-NEXT:    [[INCDEC_PTR31:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 5
; KRYO-NEXT:    [[TMP12:%.*]] = load i16, ptr [[INCDEC_PTR22]], align 2
; KRYO-NEXT:    [[CONV32:%.*]] = zext i16 [[TMP12]] to i64
; KRYO-NEXT:    [[INCDEC_PTR33:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 5
; KRYO-NEXT:    [[TMP13:%.*]] = load i16, ptr [[INCDEC_PTR24]], align 2
; KRYO-NEXT:    [[CONV34:%.*]] = zext i16 [[TMP13]] to i64
; KRYO-NEXT:    [[SUB35:%.*]] = sub nsw i64 [[CONV32]], [[CONV34]]
; KRYO-NEXT:    [[ARRAYIDX37:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB35]]
; KRYO-NEXT:    [[TMP14:%.*]] = load i16, ptr [[ARRAYIDX37]], align 2
; KRYO-NEXT:    [[CONV38:%.*]] = zext i16 [[TMP14]] to i32
; KRYO-NEXT:    [[ADD39:%.*]] = add nsw i32 [[ADD30]], [[CONV38]]
; KRYO-NEXT:    [[INCDEC_PTR40:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 6
; KRYO-NEXT:    [[TMP15:%.*]] = load i16, ptr [[INCDEC_PTR31]], align 2
; KRYO-NEXT:    [[CONV41:%.*]] = zext i16 [[TMP15]] to i64
; KRYO-NEXT:    [[INCDEC_PTR42:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 6
; KRYO-NEXT:    [[TMP16:%.*]] = load i16, ptr [[INCDEC_PTR33]], align 2
; KRYO-NEXT:    [[CONV43:%.*]] = zext i16 [[TMP16]] to i64
; KRYO-NEXT:    [[SUB44:%.*]] = sub nsw i64 [[CONV41]], [[CONV43]]
; KRYO-NEXT:    [[ARRAYIDX46:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB44]]
; KRYO-NEXT:    [[TMP17:%.*]] = load i16, ptr [[ARRAYIDX46]], align 2
; KRYO-NEXT:    [[CONV47:%.*]] = zext i16 [[TMP17]] to i32
; KRYO-NEXT:    [[ADD48:%.*]] = add nsw i32 [[ADD39]], [[CONV47]]
; KRYO-NEXT:    [[INCDEC_PTR49:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 7
; KRYO-NEXT:    [[TMP18:%.*]] = load i16, ptr [[INCDEC_PTR40]], align 2
; KRYO-NEXT:    [[CONV50:%.*]] = zext i16 [[TMP18]] to i64
; KRYO-NEXT:    [[INCDEC_PTR51:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 7
; KRYO-NEXT:    [[TMP19:%.*]] = load i16, ptr [[INCDEC_PTR42]], align 2
; KRYO-NEXT:    [[CONV52:%.*]] = zext i16 [[TMP19]] to i64
; KRYO-NEXT:    [[SUB53:%.*]] = sub nsw i64 [[CONV50]], [[CONV52]]
; KRYO-NEXT:    [[ARRAYIDX55:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB53]]
; KRYO-NEXT:    [[TMP20:%.*]] = load i16, ptr [[ARRAYIDX55]], align 2
; KRYO-NEXT:    [[CONV56:%.*]] = zext i16 [[TMP20]] to i32
; KRYO-NEXT:    [[ADD57:%.*]] = add nsw i32 [[ADD48]], [[CONV56]]
; KRYO-NEXT:    [[INCDEC_PTR58]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 8
; KRYO-NEXT:    [[TMP21:%.*]] = load i16, ptr [[INCDEC_PTR49]], align 2
; KRYO-NEXT:    [[CONV59:%.*]] = zext i16 [[TMP21]] to i64
; KRYO-NEXT:    [[TMP22:%.*]] = load i16, ptr [[INCDEC_PTR51]], align 2
; KRYO-NEXT:    [[CONV61:%.*]] = zext i16 [[TMP22]] to i64
; KRYO-NEXT:    [[SUB62:%.*]] = sub nsw i64 [[CONV59]], [[CONV61]]
; KRYO-NEXT:    [[ARRAYIDX64:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB62]]
; KRYO-NEXT:    [[TMP23:%.*]] = load i16, ptr [[ARRAYIDX64]], align 2
; KRYO-NEXT:    [[CONV65:%.*]] = zext i16 [[TMP23]] to i32
; KRYO-NEXT:    [[ADD66]] = add nsw i32 [[ADD57]], [[CONV65]]
; KRYO-NEXT:    [[INC]] = add nuw nsw i32 [[I_0103]], 1
; KRYO-NEXT:    [[EXITCOND:%.*]] = icmp eq i32 [[INC]], [[N]]
; KRYO-NEXT:    br i1 [[EXITCOND]], label [[FOR_COND_CLEANUP_LOOPEXIT]], label [[FOR_BODY]]
;
entry:
  %cmp.99 = icmp sgt i32 %n, 0
  br i1 %cmp.99, label %for.body.preheader, label %for.cond.cleanup

for.body.preheader:
  br label %for.body

for.cond.cleanup.loopexit:
  br label %for.cond.cleanup

for.cond.cleanup:
  %sum.0.lcssa = phi i32 [ 0, %entry ], [ %add66, %for.cond.cleanup.loopexit ]
  ret i32 %sum.0.lcssa

for.body:
  %i.0103 = phi i32 [ %inc, %for.body ], [ 0, %for.body.preheader ]
  %sum.0102 = phi i32 [ %add66, %for.body ], [ 0, %for.body.preheader ]
  %a.addr.0101 = phi ptr [ %incdec.ptr58, %for.body ], [ %a, %for.body.preheader ]
  %incdec.ptr = getelementptr inbounds i16, ptr %a.addr.0101, i64 1
  %0 = load i16, ptr %a.addr.0101, align 2
  %conv = zext i16 %0 to i32
  %incdec.ptr1 = getelementptr inbounds i16, ptr %b, i64 1
  %1 = load i16, ptr %b, align 2
  %conv2 = zext i16 %1 to i32
  %sub = sub nsw i32 %conv, %conv2
  %arrayidx = getelementptr inbounds i16, ptr %g, i32 %sub
  %2 = load i16, ptr %arrayidx, align 2
  %conv3 = zext i16 %2 to i32
  %add = add nsw i32 %conv3, %sum.0102
  %incdec.ptr4 = getelementptr inbounds i16, ptr %a.addr.0101, i64 2
  %3 = load i16, ptr %incdec.ptr, align 2
  %conv5 = zext i16 %3 to i32
  %incdec.ptr6 = getelementptr inbounds i16, ptr %b, i64 2
  %4 = load i16, ptr %incdec.ptr1, align 2
  %conv7 = zext i16 %4 to i32
  %sub8 = sub nsw i32 %conv5, %conv7
  %arrayidx10 = getelementptr inbounds i16, ptr %g, i32 %sub8
  %5 = load i16, ptr %arrayidx10, align 2
  %conv11 = zext i16 %5 to i32
  %add12 = add nsw i32 %add, %conv11
  %incdec.ptr13 = getelementptr inbounds i16, ptr %a.addr.0101, i64 3
  %6 = load i16, ptr %incdec.ptr4, align 2
  %conv14 = zext i16 %6 to i32
  %incdec.ptr15 = getelementptr inbounds i16, ptr %b, i64 3
  %7 = load i16, ptr %incdec.ptr6, align 2
  %conv16 = zext i16 %7 to i32
  %sub17 = sub nsw i32 %conv14, %conv16
  %arrayidx19 = getelementptr inbounds i16, ptr %g, i32 %sub17
  %8 = load i16, ptr %arrayidx19, align 2
  %conv20 = zext i16 %8 to i32
  %add21 = add nsw i32 %add12, %conv20
  %incdec.ptr22 = getelementptr inbounds i16, ptr %a.addr.0101, i64 4
  %9 = load i16, ptr %incdec.ptr13, align 2
  %conv23 = zext i16 %9 to i32
  %incdec.ptr24 = getelementptr inbounds i16, ptr %b, i64 4
  %10 = load i16, ptr %incdec.ptr15, align 2
  %conv25 = zext i16 %10 to i32
  %sub26 = sub nsw i32 %conv23, %conv25
  %arrayidx28 = getelementptr inbounds i16, ptr %g, i32 %sub26
  %11 = load i16, ptr %arrayidx28, align 2
  %conv29 = zext i16 %11 to i32
  %add30 = add nsw i32 %add21, %conv29
  %incdec.ptr31 = getelementptr inbounds i16, ptr %a.addr.0101, i64 5
  %12 = load i16, ptr %incdec.ptr22, align 2
  %conv32 = zext i16 %12 to i32
  %incdec.ptr33 = getelementptr inbounds i16, ptr %b, i64 5
  %13 = load i16, ptr %incdec.ptr24, align 2
  %conv34 = zext i16 %13 to i32
  %sub35 = sub nsw i32 %conv32, %conv34
  %arrayidx37 = getelementptr inbounds i16, ptr %g, i32 %sub35
  %14 = load i16, ptr %arrayidx37, align 2
  %conv38 = zext i16 %14 to i32
  %add39 = add nsw i32 %add30, %conv38
  %incdec.ptr40 = getelementptr inbounds i16, ptr %a.addr.0101, i64 6
  %15 = load i16, ptr %incdec.ptr31, align 2
  %conv41 = zext i16 %15 to i32
  %incdec.ptr42 = getelementptr inbounds i16, ptr %b, i64 6
  %16 = load i16, ptr %incdec.ptr33, align 2
  %conv43 = zext i16 %16 to i32
  %sub44 = sub nsw i32 %conv41, %conv43
  %arrayidx46 = getelementptr inbounds i16, ptr %g, i32 %sub44
  %17 = load i16, ptr %arrayidx46, align 2
  %conv47 = zext i16 %17 to i32
  %add48 = add nsw i32 %add39, %conv47
  %incdec.ptr49 = getelementptr inbounds i16, ptr %a.addr.0101, i64 7
  %18 = load i16, ptr %incdec.ptr40, align 2
  %conv50 = zext i16 %18 to i32
  %incdec.ptr51 = getelementptr inbounds i16, ptr %b, i64 7
  %19 = load i16, ptr %incdec.ptr42, align 2
  %conv52 = zext i16 %19 to i32
  %sub53 = sub nsw i32 %conv50, %conv52
  %arrayidx55 = getelementptr inbounds i16, ptr %g, i32 %sub53
  %20 = load i16, ptr %arrayidx55, align 2
  %conv56 = zext i16 %20 to i32
  %add57 = add nsw i32 %add48, %conv56
  %incdec.ptr58 = getelementptr inbounds i16, ptr %a.addr.0101, i64 8
  %21 = load i16, ptr %incdec.ptr49, align 2
  %conv59 = zext i16 %21 to i32
  %22 = load i16, ptr %incdec.ptr51, align 2
  %conv61 = zext i16 %22 to i32
  %sub62 = sub nsw i32 %conv59, %conv61
  %arrayidx64 = getelementptr inbounds i16, ptr %g, i32 %sub62
  %23 = load i16, ptr %arrayidx64, align 2
  %conv65 = zext i16 %23 to i32
  %add66 = add nsw i32 %add57, %conv65
  %inc = add nuw nsw i32 %i.0103, 1
  %exitcond = icmp eq i32 %inc, %n
  br i1 %exitcond, label %for.cond.cleanup.loopexit, label %for.body
}

define i32 @gather_reduce_8x16_i64(ptr nocapture readonly %a, ptr nocapture readonly %b, ptr nocapture readonly %g, i32 %n) {
; GENERIC-LABEL: @gather_reduce_8x16_i64(
; GENERIC-NEXT:  entry:
; GENERIC-NEXT:    [[CMP_99:%.*]] = icmp sgt i32 [[N:%.*]], 0
; GENERIC-NEXT:    br i1 [[CMP_99]], label [[FOR_BODY_PREHEADER:%.*]], label [[FOR_COND_CLEANUP:%.*]]
; GENERIC:       for.body.preheader:
; GENERIC-NEXT:    br label [[FOR_BODY:%.*]]
; GENERIC:       for.cond.cleanup.loopexit:
; GENERIC-NEXT:    br label [[FOR_COND_CLEANUP]]
; GENERIC:       for.cond.cleanup:
; GENERIC-NEXT:    [[SUM_0_LCSSA:%.*]] = phi i32 [ 0, [[ENTRY:%.*]] ], [ [[ADD66:%.*]], [[FOR_COND_CLEANUP_LOOPEXIT:%.*]] ]
; GENERIC-NEXT:    ret i32 [[SUM_0_LCSSA]]
; GENERIC:       for.body:
; GENERIC-NEXT:    [[I_0103:%.*]] = phi i32 [ [[INC:%.*]], [[FOR_BODY]] ], [ 0, [[FOR_BODY_PREHEADER]] ]
; GENERIC-NEXT:    [[SUM_0102:%.*]] = phi i32 [ [[ADD66]], [[FOR_BODY]] ], [ 0, [[FOR_BODY_PREHEADER]] ]
; GENERIC-NEXT:    [[A_ADDR_0101:%.*]] = phi ptr [ [[INCDEC_PTR58:%.*]], [[FOR_BODY]] ], [ [[A:%.*]], [[FOR_BODY_PREHEADER]] ]
; GENERIC-NEXT:    [[INCDEC_PTR:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 1
; GENERIC-NEXT:    [[TMP0:%.*]] = load i16, ptr [[A_ADDR_0101]], align 2
; GENERIC-NEXT:    [[CONV:%.*]] = zext i16 [[TMP0]] to i64
; GENERIC-NEXT:    [[INCDEC_PTR1:%.*]] = getelementptr inbounds i16, ptr [[B:%.*]], i64 1
; GENERIC-NEXT:    [[TMP1:%.*]] = load i16, ptr [[B]], align 2
; GENERIC-NEXT:    [[CONV2:%.*]] = zext i16 [[TMP1]] to i64
; GENERIC-NEXT:    [[SUB:%.*]] = sub nsw i64 [[CONV]], [[CONV2]]
; GENERIC-NEXT:    [[ARRAYIDX:%.*]] = getelementptr inbounds i16, ptr [[G:%.*]], i64 [[SUB]]
; GENERIC-NEXT:    [[TMP2:%.*]] = load i16, ptr [[ARRAYIDX]], align 2
; GENERIC-NEXT:    [[CONV3:%.*]] = zext i16 [[TMP2]] to i32
; GENERIC-NEXT:    [[ADD:%.*]] = add nsw i32 [[SUM_0102]], [[CONV3]]
; GENERIC-NEXT:    [[INCDEC_PTR4:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 2
; GENERIC-NEXT:    [[TMP3:%.*]] = load i16, ptr [[INCDEC_PTR]], align 2
; GENERIC-NEXT:    [[CONV5:%.*]] = zext i16 [[TMP3]] to i64
; GENERIC-NEXT:    [[INCDEC_PTR6:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 2
; GENERIC-NEXT:    [[TMP4:%.*]] = load i16, ptr [[INCDEC_PTR1]], align 2
; GENERIC-NEXT:    [[CONV7:%.*]] = zext i16 [[TMP4]] to i64
; GENERIC-NEXT:    [[SUB8:%.*]] = sub nsw i64 [[CONV5]], [[CONV7]]
; GENERIC-NEXT:    [[ARRAYIDX10:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB8]]
; GENERIC-NEXT:    [[TMP5:%.*]] = load i16, ptr [[ARRAYIDX10]], align 2
; GENERIC-NEXT:    [[CONV11:%.*]] = zext i16 [[TMP5]] to i32
; GENERIC-NEXT:    [[ADD12:%.*]] = add nsw i32 [[ADD]], [[CONV11]]
; GENERIC-NEXT:    [[INCDEC_PTR13:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 3
; GENERIC-NEXT:    [[TMP6:%.*]] = load i16, ptr [[INCDEC_PTR4]], align 2
; GENERIC-NEXT:    [[CONV14:%.*]] = zext i16 [[TMP6]] to i64
; GENERIC-NEXT:    [[INCDEC_PTR15:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 3
; GENERIC-NEXT:    [[TMP7:%.*]] = load i16, ptr [[INCDEC_PTR6]], align 2
; GENERIC-NEXT:    [[CONV16:%.*]] = zext i16 [[TMP7]] to i64
; GENERIC-NEXT:    [[SUB17:%.*]] = sub nsw i64 [[CONV14]], [[CONV16]]
; GENERIC-NEXT:    [[ARRAYIDX19:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB17]]
; GENERIC-NEXT:    [[TMP8:%.*]] = load i16, ptr [[ARRAYIDX19]], align 2
; GENERIC-NEXT:    [[CONV20:%.*]] = zext i16 [[TMP8]] to i32
; GENERIC-NEXT:    [[ADD21:%.*]] = add nsw i32 [[ADD12]], [[CONV20]]
; GENERIC-NEXT:    [[INCDEC_PTR22:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 4
; GENERIC-NEXT:    [[TMP9:%.*]] = load i16, ptr [[INCDEC_PTR13]], align 2
; GENERIC-NEXT:    [[CONV23:%.*]] = zext i16 [[TMP9]] to i64
; GENERIC-NEXT:    [[INCDEC_PTR24:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 4
; GENERIC-NEXT:    [[TMP10:%.*]] = load i16, ptr [[INCDEC_PTR15]], align 2
; GENERIC-NEXT:    [[CONV25:%.*]] = zext i16 [[TMP10]] to i64
; GENERIC-NEXT:    [[SUB26:%.*]] = sub nsw i64 [[CONV23]], [[CONV25]]
; GENERIC-NEXT:    [[ARRAYIDX28:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB26]]
; GENERIC-NEXT:    [[TMP11:%.*]] = load i16, ptr [[ARRAYIDX28]], align 2
; GENERIC-NEXT:    [[CONV29:%.*]] = zext i16 [[TMP11]] to i32
; GENERIC-NEXT:    [[ADD30:%.*]] = add nsw i32 [[ADD21]], [[CONV29]]
; GENERIC-NEXT:    [[INCDEC_PTR31:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 5
; GENERIC-NEXT:    [[TMP12:%.*]] = load i16, ptr [[INCDEC_PTR22]], align 2
; GENERIC-NEXT:    [[CONV32:%.*]] = zext i16 [[TMP12]] to i64
; GENERIC-NEXT:    [[INCDEC_PTR33:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 5
; GENERIC-NEXT:    [[TMP13:%.*]] = load i16, ptr [[INCDEC_PTR24]], align 2
; GENERIC-NEXT:    [[CONV34:%.*]] = zext i16 [[TMP13]] to i64
; GENERIC-NEXT:    [[SUB35:%.*]] = sub nsw i64 [[CONV32]], [[CONV34]]
; GENERIC-NEXT:    [[ARRAYIDX37:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB35]]
; GENERIC-NEXT:    [[TMP14:%.*]] = load i16, ptr [[ARRAYIDX37]], align 2
; GENERIC-NEXT:    [[CONV38:%.*]] = zext i16 [[TMP14]] to i32
; GENERIC-NEXT:    [[ADD39:%.*]] = add nsw i32 [[ADD30]], [[CONV38]]
; GENERIC-NEXT:    [[INCDEC_PTR40:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 6
; GENERIC-NEXT:    [[TMP15:%.*]] = load i16, ptr [[INCDEC_PTR31]], align 2
; GENERIC-NEXT:    [[CONV41:%.*]] = zext i16 [[TMP15]] to i64
; GENERIC-NEXT:    [[INCDEC_PTR42:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 6
; GENERIC-NEXT:    [[TMP16:%.*]] = load i16, ptr [[INCDEC_PTR33]], align 2
; GENERIC-NEXT:    [[CONV43:%.*]] = zext i16 [[TMP16]] to i64
; GENERIC-NEXT:    [[SUB44:%.*]] = sub nsw i64 [[CONV41]], [[CONV43]]
; GENERIC-NEXT:    [[ARRAYIDX46:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB44]]
; GENERIC-NEXT:    [[TMP17:%.*]] = load i16, ptr [[ARRAYIDX46]], align 2
; GENERIC-NEXT:    [[CONV47:%.*]] = zext i16 [[TMP17]] to i32
; GENERIC-NEXT:    [[ADD48:%.*]] = add nsw i32 [[ADD39]], [[CONV47]]
; GENERIC-NEXT:    [[INCDEC_PTR49:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 7
; GENERIC-NEXT:    [[TMP18:%.*]] = load i16, ptr [[INCDEC_PTR40]], align 2
; GENERIC-NEXT:    [[CONV50:%.*]] = zext i16 [[TMP18]] to i64
; GENERIC-NEXT:    [[INCDEC_PTR51:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 7
; GENERIC-NEXT:    [[TMP19:%.*]] = load i16, ptr [[INCDEC_PTR42]], align 2
; GENERIC-NEXT:    [[CONV52:%.*]] = zext i16 [[TMP19]] to i64
; GENERIC-NEXT:    [[SUB53:%.*]] = sub nsw i64 [[CONV50]], [[CONV52]]
; GENERIC-NEXT:    [[ARRAYIDX55:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB53]]
; GENERIC-NEXT:    [[TMP20:%.*]] = load i16, ptr [[ARRAYIDX55]], align 2
; GENERIC-NEXT:    [[CONV56:%.*]] = zext i16 [[TMP20]] to i32
; GENERIC-NEXT:    [[ADD57:%.*]] = add nsw i32 [[ADD48]], [[CONV56]]
; GENERIC-NEXT:    [[INCDEC_PTR58]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 8
; GENERIC-NEXT:    [[TMP21:%.*]] = load i16, ptr [[INCDEC_PTR49]], align 2
; GENERIC-NEXT:    [[CONV59:%.*]] = zext i16 [[TMP21]] to i64
; GENERIC-NEXT:    [[TMP22:%.*]] = load i16, ptr [[INCDEC_PTR51]], align 2
; GENERIC-NEXT:    [[CONV61:%.*]] = zext i16 [[TMP22]] to i64
; GENERIC-NEXT:    [[SUB62:%.*]] = sub nsw i64 [[CONV59]], [[CONV61]]
; GENERIC-NEXT:    [[ARRAYIDX64:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB62]]
; GENERIC-NEXT:    [[TMP23:%.*]] = load i16, ptr [[ARRAYIDX64]], align 2
; GENERIC-NEXT:    [[CONV65:%.*]] = zext i16 [[TMP23]] to i32
; GENERIC-NEXT:    [[ADD66]] = add nsw i32 [[ADD57]], [[CONV65]]
; GENERIC-NEXT:    [[INC]] = add nuw nsw i32 [[I_0103]], 1
; GENERIC-NEXT:    [[EXITCOND:%.*]] = icmp eq i32 [[INC]], [[N]]
; GENERIC-NEXT:    br i1 [[EXITCOND]], label [[FOR_COND_CLEANUP_LOOPEXIT]], label [[FOR_BODY]]
;
; KRYO-LABEL: @gather_reduce_8x16_i64(
; KRYO-NEXT:  entry:
; KRYO-NEXT:    [[CMP_99:%.*]] = icmp sgt i32 [[N:%.*]], 0
; KRYO-NEXT:    br i1 [[CMP_99]], label [[FOR_BODY_PREHEADER:%.*]], label [[FOR_COND_CLEANUP:%.*]]
; KRYO:       for.body.preheader:
; KRYO-NEXT:    br label [[FOR_BODY:%.*]]
; KRYO:       for.cond.cleanup.loopexit:
; KRYO-NEXT:    br label [[FOR_COND_CLEANUP]]
; KRYO:       for.cond.cleanup:
; KRYO-NEXT:    [[SUM_0_LCSSA:%.*]] = phi i32 [ 0, [[ENTRY:%.*]] ], [ [[ADD66:%.*]], [[FOR_COND_CLEANUP_LOOPEXIT:%.*]] ]
; KRYO-NEXT:    ret i32 [[SUM_0_LCSSA]]
; KRYO:       for.body:
; KRYO-NEXT:    [[I_0103:%.*]] = phi i32 [ [[INC:%.*]], [[FOR_BODY]] ], [ 0, [[FOR_BODY_PREHEADER]] ]
; KRYO-NEXT:    [[SUM_0102:%.*]] = phi i32 [ [[ADD66]], [[FOR_BODY]] ], [ 0, [[FOR_BODY_PREHEADER]] ]
; KRYO-NEXT:    [[A_ADDR_0101:%.*]] = phi ptr [ [[INCDEC_PTR58:%.*]], [[FOR_BODY]] ], [ [[A:%.*]], [[FOR_BODY_PREHEADER]] ]
; KRYO-NEXT:    [[INCDEC_PTR:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 1
; KRYO-NEXT:    [[TMP0:%.*]] = load i16, ptr [[A_ADDR_0101]], align 2
; KRYO-NEXT:    [[CONV:%.*]] = zext i16 [[TMP0]] to i64
; KRYO-NEXT:    [[INCDEC_PTR1:%.*]] = getelementptr inbounds i16, ptr [[B:%.*]], i64 1
; KRYO-NEXT:    [[TMP1:%.*]] = load i16, ptr [[B]], align 2
; KRYO-NEXT:    [[CONV2:%.*]] = zext i16 [[TMP1]] to i64
; KRYO-NEXT:    [[SUB:%.*]] = sub nsw i64 [[CONV]], [[CONV2]]
; KRYO-NEXT:    [[ARRAYIDX:%.*]] = getelementptr inbounds i16, ptr [[G:%.*]], i64 [[SUB]]
; KRYO-NEXT:    [[TMP2:%.*]] = load i16, ptr [[ARRAYIDX]], align 2
; KRYO-NEXT:    [[CONV3:%.*]] = zext i16 [[TMP2]] to i32
; KRYO-NEXT:    [[ADD:%.*]] = add nsw i32 [[SUM_0102]], [[CONV3]]
; KRYO-NEXT:    [[INCDEC_PTR4:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 2
; KRYO-NEXT:    [[TMP3:%.*]] = load i16, ptr [[INCDEC_PTR]], align 2
; KRYO-NEXT:    [[CONV5:%.*]] = zext i16 [[TMP3]] to i64
; KRYO-NEXT:    [[INCDEC_PTR6:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 2
; KRYO-NEXT:    [[TMP4:%.*]] = load i16, ptr [[INCDEC_PTR1]], align 2
; KRYO-NEXT:    [[CONV7:%.*]] = zext i16 [[TMP4]] to i64
; KRYO-NEXT:    [[SUB8:%.*]] = sub nsw i64 [[CONV5]], [[CONV7]]
; KRYO-NEXT:    [[ARRAYIDX10:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB8]]
; KRYO-NEXT:    [[TMP5:%.*]] = load i16, ptr [[ARRAYIDX10]], align 2
; KRYO-NEXT:    [[CONV11:%.*]] = zext i16 [[TMP5]] to i32
; KRYO-NEXT:    [[ADD12:%.*]] = add nsw i32 [[ADD]], [[CONV11]]
; KRYO-NEXT:    [[INCDEC_PTR13:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 3
; KRYO-NEXT:    [[TMP6:%.*]] = load i16, ptr [[INCDEC_PTR4]], align 2
; KRYO-NEXT:    [[CONV14:%.*]] = zext i16 [[TMP6]] to i64
; KRYO-NEXT:    [[INCDEC_PTR15:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 3
; KRYO-NEXT:    [[TMP7:%.*]] = load i16, ptr [[INCDEC_PTR6]], align 2
; KRYO-NEXT:    [[CONV16:%.*]] = zext i16 [[TMP7]] to i64
; KRYO-NEXT:    [[SUB17:%.*]] = sub nsw i64 [[CONV14]], [[CONV16]]
; KRYO-NEXT:    [[ARRAYIDX19:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB17]]
; KRYO-NEXT:    [[TMP8:%.*]] = load i16, ptr [[ARRAYIDX19]], align 2
; KRYO-NEXT:    [[CONV20:%.*]] = zext i16 [[TMP8]] to i32
; KRYO-NEXT:    [[ADD21:%.*]] = add nsw i32 [[ADD12]], [[CONV20]]
; KRYO-NEXT:    [[INCDEC_PTR22:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 4
; KRYO-NEXT:    [[TMP9:%.*]] = load i16, ptr [[INCDEC_PTR13]], align 2
; KRYO-NEXT:    [[CONV23:%.*]] = zext i16 [[TMP9]] to i64
; KRYO-NEXT:    [[INCDEC_PTR24:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 4
; KRYO-NEXT:    [[TMP10:%.*]] = load i16, ptr [[INCDEC_PTR15]], align 2
; KRYO-NEXT:    [[CONV25:%.*]] = zext i16 [[TMP10]] to i64
; KRYO-NEXT:    [[SUB26:%.*]] = sub nsw i64 [[CONV23]], [[CONV25]]
; KRYO-NEXT:    [[ARRAYIDX28:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB26]]
; KRYO-NEXT:    [[TMP11:%.*]] = load i16, ptr [[ARRAYIDX28]], align 2
; KRYO-NEXT:    [[CONV29:%.*]] = zext i16 [[TMP11]] to i32
; KRYO-NEXT:    [[ADD30:%.*]] = add nsw i32 [[ADD21]], [[CONV29]]
; KRYO-NEXT:    [[INCDEC_PTR31:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 5
; KRYO-NEXT:    [[TMP12:%.*]] = load i16, ptr [[INCDEC_PTR22]], align 2
; KRYO-NEXT:    [[CONV32:%.*]] = zext i16 [[TMP12]] to i64
; KRYO-NEXT:    [[INCDEC_PTR33:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 5
; KRYO-NEXT:    [[TMP13:%.*]] = load i16, ptr [[INCDEC_PTR24]], align 2
; KRYO-NEXT:    [[CONV34:%.*]] = zext i16 [[TMP13]] to i64
; KRYO-NEXT:    [[SUB35:%.*]] = sub nsw i64 [[CONV32]], [[CONV34]]
; KRYO-NEXT:    [[ARRAYIDX37:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB35]]
; KRYO-NEXT:    [[TMP14:%.*]] = load i16, ptr [[ARRAYIDX37]], align 2
; KRYO-NEXT:    [[CONV38:%.*]] = zext i16 [[TMP14]] to i32
; KRYO-NEXT:    [[ADD39:%.*]] = add nsw i32 [[ADD30]], [[CONV38]]
; KRYO-NEXT:    [[INCDEC_PTR40:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 6
; KRYO-NEXT:    [[TMP15:%.*]] = load i16, ptr [[INCDEC_PTR31]], align 2
; KRYO-NEXT:    [[CONV41:%.*]] = zext i16 [[TMP15]] to i64
; KRYO-NEXT:    [[INCDEC_PTR42:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 6
; KRYO-NEXT:    [[TMP16:%.*]] = load i16, ptr [[INCDEC_PTR33]], align 2
; KRYO-NEXT:    [[CONV43:%.*]] = zext i16 [[TMP16]] to i64
; KRYO-NEXT:    [[SUB44:%.*]] = sub nsw i64 [[CONV41]], [[CONV43]]
; KRYO-NEXT:    [[ARRAYIDX46:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB44]]
; KRYO-NEXT:    [[TMP17:%.*]] = load i16, ptr [[ARRAYIDX46]], align 2
; KRYO-NEXT:    [[CONV47:%.*]] = zext i16 [[TMP17]] to i32
; KRYO-NEXT:    [[ADD48:%.*]] = add nsw i32 [[ADD39]], [[CONV47]]
; KRYO-NEXT:    [[INCDEC_PTR49:%.*]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 7
; KRYO-NEXT:    [[TMP18:%.*]] = load i16, ptr [[INCDEC_PTR40]], align 2
; KRYO-NEXT:    [[CONV50:%.*]] = zext i16 [[TMP18]] to i64
; KRYO-NEXT:    [[INCDEC_PTR51:%.*]] = getelementptr inbounds i16, ptr [[B]], i64 7
; KRYO-NEXT:    [[TMP19:%.*]] = load i16, ptr [[INCDEC_PTR42]], align 2
; KRYO-NEXT:    [[CONV52:%.*]] = zext i16 [[TMP19]] to i64
; KRYO-NEXT:    [[SUB53:%.*]] = sub nsw i64 [[CONV50]], [[CONV52]]
; KRYO-NEXT:    [[ARRAYIDX55:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB53]]
; KRYO-NEXT:    [[TMP20:%.*]] = load i16, ptr [[ARRAYIDX55]], align 2
; KRYO-NEXT:    [[CONV56:%.*]] = zext i16 [[TMP20]] to i32
; KRYO-NEXT:    [[ADD57:%.*]] = add nsw i32 [[ADD48]], [[CONV56]]
; KRYO-NEXT:    [[INCDEC_PTR58]] = getelementptr inbounds i16, ptr [[A_ADDR_0101]], i64 8
; KRYO-NEXT:    [[TMP21:%.*]] = load i16, ptr [[INCDEC_PTR49]], align 2
; KRYO-NEXT:    [[CONV59:%.*]] = zext i16 [[TMP21]] to i64
; KRYO-NEXT:    [[TMP22:%.*]] = load i16, ptr [[INCDEC_PTR51]], align 2
; KRYO-NEXT:    [[CONV61:%.*]] = zext i16 [[TMP22]] to i64
; KRYO-NEXT:    [[SUB62:%.*]] = sub nsw i64 [[CONV59]], [[CONV61]]
; KRYO-NEXT:    [[ARRAYIDX64:%.*]] = getelementptr inbounds i16, ptr [[G]], i64 [[SUB62]]
; KRYO-NEXT:    [[TMP23:%.*]] = load i16, ptr [[ARRAYIDX64]], align 2
; KRYO-NEXT:    [[CONV65:%.*]] = zext i16 [[TMP23]] to i32
; KRYO-NEXT:    [[ADD66]] = add nsw i32 [[ADD57]], [[CONV65]]
; KRYO-NEXT:    [[INC]] = add nuw nsw i32 [[I_0103]], 1
; KRYO-NEXT:    [[EXITCOND:%.*]] = icmp eq i32 [[INC]], [[N]]
; KRYO-NEXT:    br i1 [[EXITCOND]], label [[FOR_COND_CLEANUP_LOOPEXIT]], label [[FOR_BODY]]
;
entry:
  %cmp.99 = icmp sgt i32 %n, 0
  br i1 %cmp.99, label %for.body.preheader, label %for.cond.cleanup

for.body.preheader:
  br label %for.body

for.cond.cleanup.loopexit:
  br label %for.cond.cleanup

for.cond.cleanup:
  %sum.0.lcssa = phi i32 [ 0, %entry ], [ %add66, %for.cond.cleanup.loopexit ]
  ret i32 %sum.0.lcssa

for.body:
  %i.0103 = phi i32 [ %inc, %for.body ], [ 0, %for.body.preheader ]
  %sum.0102 = phi i32 [ %add66, %for.body ], [ 0, %for.body.preheader ]
  %a.addr.0101 = phi ptr [ %incdec.ptr58, %for.body ], [ %a, %for.body.preheader ]
  %incdec.ptr = getelementptr inbounds i16, ptr %a.addr.0101, i64 1
  %0 = load i16, ptr %a.addr.0101, align 2
  %conv = zext i16 %0 to i64
  %incdec.ptr1 = getelementptr inbounds i16, ptr %b, i64 1
  %1 = load i16, ptr %b, align 2
  %conv2 = zext i16 %1 to i64
  %sub = sub nsw i64 %conv, %conv2
  %arrayidx = getelementptr inbounds i16, ptr %g, i64 %sub
  %2 = load i16, ptr %arrayidx, align 2
  %conv3 = zext i16 %2 to i32
  %add = add nsw i32 %conv3, %sum.0102
  %incdec.ptr4 = getelementptr inbounds i16, ptr %a.addr.0101, i64 2
  %3 = load i16, ptr %incdec.ptr, align 2
  %conv5 = zext i16 %3 to i64
  %incdec.ptr6 = getelementptr inbounds i16, ptr %b, i64 2
  %4 = load i16, ptr %incdec.ptr1, align 2
  %conv7 = zext i16 %4 to i64
  %sub8 = sub nsw i64 %conv5, %conv7
  %arrayidx10 = getelementptr inbounds i16, ptr %g, i64 %sub8
  %5 = load i16, ptr %arrayidx10, align 2
  %conv11 = zext i16 %5 to i32
  %add12 = add nsw i32 %add, %conv11
  %incdec.ptr13 = getelementptr inbounds i16, ptr %a.addr.0101, i64 3
  %6 = load i16, ptr %incdec.ptr4, align 2
  %conv14 = zext i16 %6 to i64
  %incdec.ptr15 = getelementptr inbounds i16, ptr %b, i64 3
  %7 = load i16, ptr %incdec.ptr6, align 2
  %conv16 = zext i16 %7 to i64
  %sub17 = sub nsw i64 %conv14, %conv16
  %arrayidx19 = getelementptr inbounds i16, ptr %g, i64 %sub17
  %8 = load i16, ptr %arrayidx19, align 2
  %conv20 = zext i16 %8 to i32
  %add21 = add nsw i32 %add12, %conv20
  %incdec.ptr22 = getelementptr inbounds i16, ptr %a.addr.0101, i64 4
  %9 = load i16, ptr %incdec.ptr13, align 2
  %conv23 = zext i16 %9 to i64
  %incdec.ptr24 = getelementptr inbounds i16, ptr %b, i64 4
  %10 = load i16, ptr %incdec.ptr15, align 2
  %conv25 = zext i16 %10 to i64
  %sub26 = sub nsw i64 %conv23, %conv25
  %arrayidx28 = getelementptr inbounds i16, ptr %g, i64 %sub26
  %11 = load i16, ptr %arrayidx28, align 2
  %conv29 = zext i16 %11 to i32
  %add30 = add nsw i32 %add21, %conv29
  %incdec.ptr31 = getelementptr inbounds i16, ptr %a.addr.0101, i64 5
  %12 = load i16, ptr %incdec.ptr22, align 2
  %conv32 = zext i16 %12 to i64
  %incdec.ptr33 = getelementptr inbounds i16, ptr %b, i64 5
  %13 = load i16, ptr %incdec.ptr24, align 2
  %conv34 = zext i16 %13 to i64
  %sub35 = sub nsw i64 %conv32, %conv34
  %arrayidx37 = getelementptr inbounds i16, ptr %g, i64 %sub35
  %14 = load i16, ptr %arrayidx37, align 2
  %conv38 = zext i16 %14 to i32
  %add39 = add nsw i32 %add30, %conv38
  %incdec.ptr40 = getelementptr inbounds i16, ptr %a.addr.0101, i64 6
  %15 = load i16, ptr %incdec.ptr31, align 2
  %conv41 = zext i16 %15 to i64
  %incdec.ptr42 = getelementptr inbounds i16, ptr %b, i64 6
  %16 = load i16, ptr %incdec.ptr33, align 2
  %conv43 = zext i16 %16 to i64
  %sub44 = sub nsw i64 %conv41, %conv43
  %arrayidx46 = getelementptr inbounds i16, ptr %g, i64 %sub44
  %17 = load i16, ptr %arrayidx46, align 2
  %conv47 = zext i16 %17 to i32
  %add48 = add nsw i32 %add39, %conv47
  %incdec.ptr49 = getelementptr inbounds i16, ptr %a.addr.0101, i64 7
  %18 = load i16, ptr %incdec.ptr40, align 2
  %conv50 = zext i16 %18 to i64
  %incdec.ptr51 = getelementptr inbounds i16, ptr %b, i64 7
  %19 = load i16, ptr %incdec.ptr42, align 2
  %conv52 = zext i16 %19 to i64
  %sub53 = sub nsw i64 %conv50, %conv52
  %arrayidx55 = getelementptr inbounds i16, ptr %g, i64 %sub53
  %20 = load i16, ptr %arrayidx55, align 2
  %conv56 = zext i16 %20 to i32
  %add57 = add nsw i32 %add48, %conv56
  %incdec.ptr58 = getelementptr inbounds i16, ptr %a.addr.0101, i64 8
  %21 = load i16, ptr %incdec.ptr49, align 2
  %conv59 = zext i16 %21 to i64
  %22 = load i16, ptr %incdec.ptr51, align 2
  %conv61 = zext i16 %22 to i64
  %sub62 = sub nsw i64 %conv59, %conv61
  %arrayidx64 = getelementptr inbounds i16, ptr %g, i64 %sub62
  %23 = load i16, ptr %arrayidx64, align 2
  %conv65 = zext i16 %23 to i32
  %add66 = add nsw i32 %add57, %conv65
  %inc = add nuw nsw i32 %i.0103, 1
  %exitcond = icmp eq i32 %inc, %n
  br i1 %exitcond, label %for.cond.cleanup.loopexit, label %for.body
}
