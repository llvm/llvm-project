; NOTE: Assertions have been autogenerated by utils/update_test_checks.py UTC_ARGS: --version 6
; RUN: opt -passes=slp-vectorizer -S < %s | FileCheck %s



define <4 x i32> @test(<4 x i32> %A){
; CHECK-LABEL: define <4 x i32> @test(
; CHECK-SAME: <4 x i32> [[A:%.*]]) {
; CHECK-NEXT:  [[ENTRY:.*:]]
; CHECK-NEXT:    [[TMP0:%.*]] = shufflevector <4 x i32> [[A]], <4 x i32> poison, <4 x i32> <i32 0, i32 poison, i32 poison, i32 2>
; CHECK-NEXT:    [[TMP3:%.*]] = shufflevector <4 x i32> [[A]], <4 x i32> poison, <4 x i32> <i32 0, i32 1, i32 1, i32 3>
; CHECK-NEXT:    [[TMP2:%.*]] = sdiv <4 x i32> [[TMP0]], [[TMP3]]
; CHECK-NEXT:    [[TMP1:%.*]] = shufflevector <4 x i32> [[TMP2]], <4 x i32> poison, <4 x i32> <i32 0, i32 1, i32 3, i32 2>
; CHECK-NEXT:    ret <4 x i32> [[TMP1]]
;
entry:
  %e0 = extractelement <4 x i32> %A, i64 0
  %e1 = extractelement <4 x i32> %A, i64 1
  %e2 = extractelement <4 x i32> %A, i64 2
  %e3 = extractelement <4 x i32> %A, i64 3
  %oob = extractelement <4 x i32> %A, i64 4
  %d0 = sdiv i32 %e0, %e0
  %d1 = sdiv i32 %oob, %e1
  %d2 = sdiv i32 %e2, %e3
  %d3 = sdiv i32 %oob, %e1
  %v0 = insertelement <4 x i32> poison, i32 %d0, i64 0
  %v1 = insertelement <4 x i32> %v0, i32 %d1, i64 1
  %v2 = insertelement <4 x i32> %v1, i32 %d2, i64 2
  %v3 = insertelement <4 x i32> %v2, i32 %d3, i64 3
  ret <4 x i32> %v3

}
