; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: opt -mtriple=x86_64-- -passes=slp-vectorizer,instcombine -S < %s | FileCheck %s

; These conversions should be vectorized by reviews.llvm.org/D57059

define dso_local <4 x float> @foo(<4 x i32> %0) {
; CHECK-LABEL: @foo(
; CHECK-NEXT:    [[TMP2:%.*]] = sitofp <4 x i32> [[TMP0:%.*]] to <4 x float>
; CHECK-NEXT:    [[TMP3:%.*]] = shufflevector <4 x float> [[TMP2]], <4 x float> poison, <4 x i32> <i32 1, i32 1, i32 2, i32 3>
; CHECK-NEXT:    ret <4 x float> [[TMP3]]
;
  %2 = extractelement <4 x i32> %0, i32 1
  %3 = sitofp i32 %2 to float
  %4 = insertelement <4 x float> undef, float %3, i32 0
  %5 = insertelement <4 x float> %4, float %3, i32 1
  %6 = extractelement <4 x i32> %0, i32 2
  %7 = sitofp i32 %6 to float
  %8 = insertelement <4 x float> %5, float %7, i32 2
  %9 = extractelement <4 x i32> %0, i32 3
  %10 = sitofp i32 %9 to float
  %11 = insertelement <4 x float> %8, float %10, i32 3
  ret <4 x float> %11
}

