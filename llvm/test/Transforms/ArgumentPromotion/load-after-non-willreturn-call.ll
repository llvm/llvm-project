; NOTE: Assertions have been autogenerated by utils/update_test_checks.py UTC_ARGS: --function-signature --scrub-attributes
; RUN: opt -S -argpromotion < %s | FileCheck %s

declare void @may_not_return()

define internal i32 @callee(i32* %p) {
; CHECK-LABEL: define {{[^@]+}}@callee
; CHECK-SAME: (i32 [[P_VAL:%.*]]) {
; CHECK-NEXT:    call void @may_not_return()
; CHECK-NEXT:    ret i32 [[P_VAL]]
;
  call void @may_not_return() readnone
  %x = load i32, i32* %p
  ret i32 %x
}

define void @caller(i32* %p) {
; CHECK-LABEL: define {{[^@]+}}@caller
; CHECK-SAME: (i32* [[P:%.*]]) {
; CHECK-NEXT:    [[P_VAL:%.*]] = load i32, i32* [[P]], align 4
; CHECK-NEXT:    [[TMP1:%.*]] = call i32 @callee(i32 [[P_VAL]])
; CHECK-NEXT:    ret void
;
  call i32 @callee(i32* %p)
  ret void
}
