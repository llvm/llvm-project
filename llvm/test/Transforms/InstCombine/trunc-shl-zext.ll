; NOTE: Assertions have been autogenerated by utils/update_test_checks.py UTC_ARGS: --version 2
; RUN: opt < %s -passes=instcombine -S | FileCheck %s

define i32 @trunc_shl_zext_32(i32 %a) {
; CHECK-LABEL: define i32 @trunc_shl_zext_32
; CHECK-SAME: (i32 [[A:%.*]]) {
; CHECK-NEXT:    [[TRUNC:%.*]] = trunc i32 [[A]] to i16
; CHECK-NEXT:    [[SHL:%.*]] = shl i16 [[TRUNC]], 4
; CHECK-NEXT:    [[EXT:%.*]] = zext i16 [[SHL]] to i32
; CHECK-NEXT:    ret i32 [[EXT]]
;
  %trunc = trunc i32 %a to i16
  %shl = shl i16 %trunc, 4
  %ext = zext i16 %shl to i32
  ret i32 %ext
}

define i64 @trunc_shl_zext_64(i64 %a) {
; CHECK-LABEL: define i64 @trunc_shl_zext_64
; CHECK-SAME: (i64 [[A:%.*]]) {
; CHECK-NEXT:    [[TRUNC:%.*]] = trunc i64 [[A]] to i8
; CHECK-NEXT:    [[SHL:%.*]] = shl i8 [[TRUNC]], 7
; CHECK-NEXT:    [[EXT:%.*]] = zext i8 [[SHL]] to i64
; CHECK-NEXT:    ret i64 [[EXT]]
;
  %trunc = trunc i64 %a to i8
  %shl = shl i8 %trunc, 7
  %ext = zext i8 %shl to i64
  ret i64 %ext
}
