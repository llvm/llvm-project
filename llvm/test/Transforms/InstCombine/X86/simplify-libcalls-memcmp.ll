; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: opt -S < %s -passes=instcombine | FileCheck %s

; This test requires a target with 'bcmp' in its library.
; It used to crash/assert because the function signature does
; not match the expected libcall signature for memcmp -
; the last arg should have type size_t -> i64 for this target.

target triple = "x86_64-unknown-linux-gnu"

@str = private unnamed_addr constant [6 x i8] c"abcde\00", align 1

declare i32 @memcmp(ptr, ptr, i32)

define void @PR50850() {
; CHECK-LABEL: @PR50850(
; CHECK-NEXT:    [[CALL:%.*]] = call i32 @memcmp(ptr nonnull @PR50850, ptr nonnull @str, i32 6)
; CHECK-NEXT:    ret void
;
  %call = call i32 @memcmp(ptr @PR50850, ptr @str, i32 6)
  ret void
}
