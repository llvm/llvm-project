; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: opt -S -passes=instcombine %s | FileCheck %s

@a = common global i8 0, align 1
@b = external global i32

define void @tinkywinky() {
; CHECK-LABEL: @tinkywinky(
; CHECK-NEXT:    [[PATATINO:%.*]] = load i8, ptr @a, align 1
; CHECK-NEXT:    [[TOBOOL_NOT:%.*]] = icmp eq i8 [[PATATINO]], 0
; CHECK-NEXT:    [[LNOT_EXT:%.*]] = zext i1 [[TOBOOL_NOT]] to i32
; CHECK-NEXT:    [[ZEXT:%.*]] = zext i1 icmp ne (ptr @a, ptr @b) to i32
; CHECK-NEXT:    [[XOR1:%.*]] = or i32 [[ZEXT]], [[LNOT_EXT]]
; CHECK-NEXT:    [[OR:%.*]] = or disjoint i32 [[XOR1]], 2
; CHECK-NEXT:    store i32 [[OR]], ptr @b, align 4
; CHECK-NEXT:    ret void
;
  %patatino = load i8, ptr @a
  %tobool = icmp ne i8 %patatino, 0
  %lnot = xor i1 %tobool, true
  %lnot.ext = zext i1 %lnot to i32
  %zext = zext i1 icmp ne (ptr @a, ptr @b) to i32
  %xor = xor i32 %zext, 2
  %or = or i32 %xor, %lnot.ext
  store i32 %or, ptr @b, align 4
  ret void
}
