; NOTE: Assertions have been autogenerated by utils/update_test_checks.py UTC_ARGS: --version 2
; RUN: opt -opaque-pointers=0 < %s -passes=instcombine -S | FileCheck %s

target datalayout = "e-p:32:32"
target triple = "i686-pc-linux-gnu"

declare void @takes_i32(i32)
declare void @takes_i32_inalloca(i32* inalloca(i32))

define void @f() {
; CHECK-LABEL: define void @f() {
; CHECK-NEXT:    [[ARGS:%.*]] = alloca inalloca i32, align 4
; CHECK-NEXT:    call void bitcast (void (i32)* @takes_i32 to void (i32*)*)(i32* nonnull inalloca(i32) [[ARGS]])
; CHECK-NEXT:    ret void
;
  %args = alloca inalloca i32
  call void bitcast (void (i32)* @takes_i32 to void (i32*)*)(i32* inalloca(i32) %args)
  ret void
}

define void @g() {
; CHECK-LABEL: define void @g() {
; CHECK-NEXT:    call void bitcast (void (i32*)* @takes_i32_inalloca to void (i32)*)(i32 0)
; CHECK-NEXT:    ret void
;
  call void bitcast (void (i32*)* @takes_i32_inalloca to void (i32)*)(i32 0)
  ret void
}
