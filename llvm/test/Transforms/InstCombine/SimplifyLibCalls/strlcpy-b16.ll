; NOTE: Assertions have been autogenerated by utils/update_test_checks.py UTC_ARGS: --version 5
; RUN: opt -p instcombine -S %s | FileCheck %s

target datalayout = "b:16-p:32:32"

declare i32 @strlcpy(ptr, ptr, i32)

; strlcpy(dst, src, 1) -> *dst = 0, strlen(src)
define i32 @test_1(ptr %dst, ptr %src) {
; CHECK-LABEL: define i32 @test_1(
; CHECK-SAME: ptr [[DST:%.*]], ptr [[SRC:%.*]]) {
; CHECK-NEXT:    store i16 0, ptr [[DST]], align 1
; CHECK-NEXT:    [[STRLEN:%.*]] = call i32 @strlen(ptr noundef nonnull dereferenceable(1) [[SRC]])
; CHECK-NEXT:    ret i32 [[STRLEN]]
;
  %call = call i32 @strlcpy(ptr %dst, ptr %src, i32 1)
  ret i32 %call
}
