; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: opt -passes=reg2mem -S < %s | FileCheck %s

declare target("opaque") @ret_opaque()
declare void @pass_opaque(target("opaque"))

define void @test() {
; CHECK-LABEL: @test(
; CHECK-NEXT:    %"reg2mem alloca point" = bitcast i32 0 to i32
; CHECK-NEXT:    [[X:%.*]] = call target("opaque") @ret_opaque()
; CHECK-NEXT:    br label [[NEXT:%.*]]
; CHECK:       next:
; CHECK-NEXT:    call void @pass_opaque(target("opaque") [[X]])
; CHECK-NEXT:    ret void
;
  %x = call target("opaque") @ret_opaque()
  br label %next

next:
  call void @pass_opaque(target("opaque") %x)
  ret void
}
