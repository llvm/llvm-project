; NOTE: Assertions have been autogenerated by utils/update_test_checks.py UTC_ARGS: --version 5
; RUN: opt -S -passes=globalopt < %s | FileCheck %s

; Don't evaluate call with return value type mismatch.

@llvm.global_ctors = appending global [1 x { i32, ptr, ptr }] [{ i32, ptr, ptr } { i32 65535, ptr @__cxx_global_var_init, ptr null }]

define void @__cxa_guard_acquire() {
; CHECK-LABEL: define void @__cxa_guard_acquire() local_unnamed_addr {
; CHECK-NEXT:  [[ENTRY:.*:]]
; CHECK-NEXT:    ret void
;
entry:
  ret void
}

define void @__cxx_global_var_init() {
; CHECK-LABEL: define void @__cxx_global_var_init() {
; CHECK-NEXT:    [[RES:%.*]] = call i32 @__cxa_guard_acquire()
; CHECK-NEXT:    [[TOBOOL_NOT:%.*]] = icmp eq i32 [[RES]], 0
; CHECK-NEXT:    ret void
;
  %res = call i32 @__cxa_guard_acquire()
  %tobool.not = icmp eq i32 %res, 0
  ret void
}
