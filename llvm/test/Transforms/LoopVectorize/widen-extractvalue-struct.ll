; NOTE: Assertions have been autogenerated by utils/update_test_checks.py UTC_ARGS: --filter "(:|sincos|extract|broadcast)" --version 5
; RUN: opt -passes=loop-vectorize -force-vector-interleave=1 -force-vector-width=2 < %s -S -o - | FileCheck %s

define float @sincos_invariant_arg(float %x) {
; CHECK-LABEL: define float @sincos_invariant_arg(
; CHECK-SAME: float [[X:%.*]]) {
; CHECK:  [[ENTRY:.*:]]
; CHECK:  [[VECTOR_PH:.*:]]
; CHECK:    [[BROADCAST_SPLATINSERT:%.*]] = insertelement <2 x float> poison, float [[X]], i64 0
; CHECK:    [[BROADCAST_SPLAT:%.*]] = shufflevector <2 x float> [[BROADCAST_SPLATINSERT]], <2 x float> poison, <2 x i32> zeroinitializer
; CHECK:    [[TMP0:%.*]] = call { <2 x float>, <2 x float> } @llvm.sincos.v2f32(<2 x float> [[BROADCAST_SPLAT]])
; CHECK:    [[TMP1:%.*]] = extractvalue { <2 x float>, <2 x float> } [[TMP0]], 0
; CHECK:  [[VECTOR_BODY:.*:]]
; CHECK:  [[MIDDLE_BLOCK:.*:]]
; CHECK:  [[EXIT:.*:]]
;
entry:
  br label %loop

loop:
  %iv = phi i64 [ 0, %entry ], [ %iv.next, %loop ]
  %acc = phi float [ 0.0, %entry ], [ %sum, %loop ]
  %call = tail call { float, float } @llvm.sincos.f32(float %x)
  %sin_val = extractvalue { float, float } %call, 0
  %sum = fadd float %acc, %sin_val
  %iv.next = add i64 %iv, 1
  %done = icmp eq i64 %iv, 1
  br i1 %done, label %exit, label %loop

exit:
  ret float %sum
}
