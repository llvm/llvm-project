; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: not --crash opt -disable-output -passes=rewrite-statepoints-for-gc %s 2>&1 | FileCheck %s

; CHECK: LLVM ERROR: unsupported GC: unsupported-gc

declare void @g()
declare i32 @h()

define ptr addrspace(1) @f0(ptr addrspace(1) %arg) gc "unsupported-gc" {
  call void @g() [ "deopt"(i32 100) ]
  ret ptr addrspace(1) %arg
}
