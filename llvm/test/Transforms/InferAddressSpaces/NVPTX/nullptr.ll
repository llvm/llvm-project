; NOTE: Assertions have been autogenerated by utils/update_test_checks.py UTC_ARGS: --version 5
; RUN: opt -S -passes=infer-address-spaces %s | FileCheck %s

target triple = "nvptx64--"

define ptr @pr171890(i1 %c) {
; CHECK-LABEL: define ptr @pr171890(
; CHECK-SAME: i1 [[C:%.*]]) {
; CHECK-NEXT:  [[ENTRY:.*:]]
; CHECK-NEXT:    [[STACK:%.*]] = alloca i16, align 2
; CHECK-NEXT:    [[TMP0:%.*]] = addrspacecast ptr [[STACK]] to ptr addrspace(5)
; CHECK-NEXT:    [[TMP1:%.*]] = addrspacecast ptr addrspace(5) [[TMP0]] to ptr
; CHECK-NEXT:    [[CONST:%.*]] = getelementptr i8, ptr null, i64 1
; CHECK-NEXT:    [[SEL:%.*]] = select i1 [[C]], ptr [[TMP1]], ptr [[CONST]]
; CHECK-NEXT:    ret ptr [[SEL]]
;
entry:
  %stack = alloca i16, align 2
  %const = getelementptr i8, ptr null, i64 1
  %sel = select i1 %c, ptr %stack, ptr %const
  ret ptr %sel
}
