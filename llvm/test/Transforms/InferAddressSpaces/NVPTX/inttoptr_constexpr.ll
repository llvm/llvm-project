; NOTE: Assertions have been autogenerated by utils/update_test_checks.py UTC_ARGS: --version 6
; RUN: opt -S -mtriple=nvptx64-nvidia-cuda -passes=infer-address-spaces %s | FileCheck %s

@g = addrspace(1) global i32 0, align 4

define void @test() {
; CHECK-LABEL: define void @test() {
; CHECK-NEXT:    store i32 0, ptr inttoptr (i64 xor (i64 ptrtoint (ptr addrspacecast (ptr addrspace(1) @g to ptr) to i64), i64 7) to ptr), align 4
; CHECK-NEXT:    ret void
;
  store i32 0, ptr inttoptr (i64
    xor (i64
      ptrtoint (ptr
        addrspacecast (ptr addrspace(1) @g to ptr)
      to i64),
    i64 7)
  to ptr)

  ret void
}

define void @test1() {
; CHECK-LABEL: define void @test1() {
; CHECK-NEXT:    store i32 0, ptr addrspace(1) @g, align 4
; CHECK-NEXT:    ret void
;
  store i32 0, ptr inttoptr (i64
    ptrtoint (ptr
      addrspacecast (ptr addrspace(1) @g to ptr)
      to i64)
    to ptr)

  ret void
}
