; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; RUN: opt < %s -passes=instsimplify

; instsimplify pass should explicitly require DominatorTreeAnalysis
; This test will segfault if DominatorTree is not available

target triple = "x86_64-grtev4-linux-gnu"

; Function Attrs: nounwind uwtable
define void @foo(ptr) #1 align 2 {
  br i1 undef, label %exit, label %2

; <label>:2:
  %3 = tail call ptr @_Znwm(i64 56) #10
  %p = load ptr, ptr undef, align 8
  %4 = icmp eq ptr %p, %3
  br i1 %4, label %exit, label %5

; <label>:6:
  %6 = icmp eq ptr %p, null
  br i1 %6, label %exit, label %7

; <label>:8:
  br label %exit

exit:
  ret void
}

; Function Attrs: nobuiltin
declare ptr @_Znwm(i64)
