; NOTE: Assertions have been autogenerated by utils/update_test_checks.py UTC_ARGS: --check-globals all --version 5
; RUN: opt -S -passes=elim-avail-extern -avail-extern-gv-in-addrspace-to-local=3 %s -o - | FileCheck %s

@shared = internal addrspace(3) global i32 undef, align 4
@shared.imported = available_externally hidden unnamed_addr addrspace(3) global i32 undef, align 4

;.
; CHECK: @shared = internal addrspace(3) global i32 undef, align 4
; CHECK: @shared.imported.__uniq.[[UUID:.*]] = internal unnamed_addr addrspace(3) global i32 undef, align 4
;.
define void @foo(i32 %v) {
; CHECK-LABEL: define void @foo(
; CHECK-SAME: i32 [[V:%.*]]) {
; CHECK-NEXT:    store i32 [[V]], ptr addrspace(3) @shared, align 4
; CHECK-NEXT:    store i32 [[V]], ptr addrspace(3) @shared.imported.__uniq.[[UUID]], align 4
; CHECK-NEXT:    ret void
;
  store i32 %v, ptr addrspace(3) @shared, align 4
  store i32 %v, ptr addrspace(3) @shared.imported, align 4
  ret void
}
