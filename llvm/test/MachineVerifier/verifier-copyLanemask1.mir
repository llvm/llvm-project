# RUN: not --crash llc -o - -mtriple=amdgcn-amd-amdhsa -run-pass=none -verify-machineinstrs %s 2>&1 | FileCheck %s
# REQUIRES: amdgpu-registered-target

# CHECK: *** Bad machine code: Copy with lanemask Instruction uses virtual register ***
# CHECK-NEXT: - function:    test_copy_lanemask_instruction_1
# CHECK-NEXT: - basic block: %bb.0 
# CHECK-NEXT: - instruction: $vgpr2 = COPY_LANEMASK %0:vgpr_32, lanemask(0x0000000000000018)
# CHECK-NEXT: - operand 1:   %0:vgpr_32

# CHECK: *** Bad machine code: Copy with lanemask Instruction uses virtual register ***
# CHECK-NEXT: - function:    test_copy_lanemask_instruction_1
# CHECK-NEXT: - basic block: %bb.0 
# CHECK-NEXT: - instruction: %1:vgpr_32 = COPY_LANEMASK $vgpr1, lanemask(0x00000000000000FF)
# CHECK-NEXT: - operand 0:   %1:vgpr_32

---
name: test_copy_lanemask_instruction_1
tracksRegLiveness: true
body:             |
  bb.0:
    liveins: $vgpr0, $vgpr1

    %0:vgpr_32 = COPY $vgpr0
    $vgpr2 = COPY_LANEMASK %0, lanemask(24)
    %1:vgpr_32 = COPY_LANEMASK $vgpr1, lanemask(0x000000000000FF)
    S_ENDPGM 0
...

