# RUN: not --crash llc -mtriple=amdgcn -run-pass=none -filetype=null %s 2>&1 | FileCheck -implicit-check-not="Bad machine code" %s

---
name:            test_valid_copies
tracksRegLiveness: true
body:             |
  bb.0:
    liveins: $vgpr0, $vcc
    %0:_(s32) = COPY $vgpr0
    %1:_(s16) = COPY $vgpr0
    %2:_(s64) = COPY $vcc
    %3:_(s1) = COPY $vcc
    $vgpr0 = COPY %0
    $vgpr0 = COPY %0
    $vcc = COPY %2
    $vcc = COPY %3
...

---
name:            test_invalid_copies
tracksRegLiveness: true
body:             |
  bb.0:
  liveins: $vgpr0_vgpr1, $vgpr2, $vcc

  ; CHECK: *** Bad machine code: Copy Instruction is illegal with mismatching sizes ***
  ; CHECK: - instruction: %0:_(s32) = COPY $vgpr0_vgpr1
  %0:_(s32) = COPY $vgpr0_vgpr1

  ; CHECK: *** Bad machine code: Copy Instruction is illegal with mismatching sizes ***
  ; CHECK: - instruction: %1:_(s64) = COPY $vgpr2
  %1:_(s64) = COPY $vgpr2

  ; CHECK: *** Bad machine code: Copy Instruction is illegal with mismatching sizes ***
  ; CHECK: - instruction: %2:_(s32) = COPY $vcc
  %2:_(s32) = COPY $vcc

  ; CHECK: *** Bad machine code: Copy Instruction is illegal with mismatching sizes ***
  ; CHECK: - instruction: %3:_(s8) = COPY $vgpr2
  %3:_(s8) = COPY $vgpr2

  ; CHECK: *** Bad machine code: Copy Instruction is illegal with mismatching sizes ***
  ; CHECK: - instruction: $vgpr0_vgpr1 = COPY %0:_(s32)
  $vgpr0_vgpr1 = COPY %0

  ; CHECK: *** Bad machine code: Copy Instruction is illegal with mismatching sizes ***
  ; CHECK: - instruction: $vgpr2 = COPY %1:_(s64)
  $vgpr2 = COPY %1

  ; CHECK: *** Bad machine code: Copy Instruction is illegal with mismatching sizes ***
  ; CHECK: - instruction: $vcc = COPY %2:_(s32)
  $vcc = COPY %2

  ; CHECK: *** Bad machine code: Copy Instruction is illegal with mismatching sizes ***
  ; CHECK: - instruction: $vgpr2 = COPY %3:_(s8)
  $vgpr2 = COPY %3

...
