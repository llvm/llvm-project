; NOTE: Assertions have been autogenerated by utils/update_analyze_test_checks.py UTC_ARGS: --filter "switch" --filter "swtich" --version 6
; RUN: opt < %s -passes="print<cost-model>" -cost-kind=throughput 2>&1 -disable-output -mtriple=x86_64-unknown-linux-gnu | FileCheck %s -check-prefixes=CHECK,THROUGHPUT
; RUN: opt < %s -passes="print<cost-model>" -cost-kind=latency 2>&1 -disable-output -mtriple=x86_64-unknown-linux-gnu | FileCheck %s -check-prefixes=CHECK,LATENCY
; RUN: opt < %s -passes="print<cost-model>" -cost-kind=code-size 2>&1 -disable-output -mtriple=x86_64-unknown-linux-gnu | FileCheck %s -check-prefixes=CHECK,CODESIZE

target datalayout = "e-p:64:64:64-i1:8:8-i8:8:8-i16:16:16-i32:32:32-i64:64:64-f32:32:32-f64:64:64-v64:64:64-v128:128:128-a0:0:64-s0:64:64-f80:128:128-n8:16:32:64-S128"

define i32 @single_succ_switch(i32 %x) {
; CHECK-LABEL: 'single_succ_switch'
; CHECK:  Cost Model: Found an estimated cost of 1 for instruction: switch i32 %x, label %default [
;
entry:
  switch i32 %x, label %default [
  ]
default:
  ret i32 1
}

define i32 @dense_switch(i32 %x) {
; THROUGHPUT-LABEL: 'dense_switch'
; THROUGHPUT:  Cost Model: Found an estimated cost of 1 for instruction: switch i32 %x, label %default [
;
; LATENCY-LABEL: 'dense_switch'
; LATENCY:  Cost Model: Found an estimated cost of 1 for instruction: switch i32 %x, label %default [
;
; CODESIZE-LABEL: 'dense_switch'
; CODESIZE:  Cost Model: Found an estimated cost of 2 for instruction: switch i32 %x, label %default [
;
entry:
  switch i32 %x, label %default [
    i32 0, label %bb0
    i32 1, label %bb1
    i32 2, label %bb2
    i32 3, label %bb3
    i32 4, label %bb4
  ]
bb0:
  ret i32 0
bb1:
  ret i32 1
bb2:
  ret i32 2
bb3:
  ret i32 3
bb4:
  ret i32 4
default:
  unreachable
}

define i32 @dense_switch_reachable_default(i32 %x) {
; THROUGHPUT-LABEL: 'dense_switch_reachable_default'
; THROUGHPUT:  Cost Model: Found an estimated cost of 1 for instruction: switch i32 %x, label %default [
;
; LATENCY-LABEL: 'dense_switch_reachable_default'
; LATENCY:  Cost Model: Found an estimated cost of 1 for instruction: switch i32 %x, label %default [
;
; CODESIZE-LABEL: 'dense_switch_reachable_default'
; CODESIZE:  Cost Model: Found an estimated cost of 4 for instruction: switch i32 %x, label %default [
;
entry:
  switch i32 %x, label %default [
    i32 0, label %bb0
    i32 1, label %bb1
    i32 2, label %bb2
    i32 3, label %bb3
    i32 4, label %bb4
  ]
bb0:
  ret i32 0
bb1:
  ret i32 1
bb2:
  ret i32 2
bb3:
  ret i32 3
bb4:
  ret i32 4
default:
  ret i32 5
}

define i32 @sparse_switch(i32 %x) {
; THROUGHPUT-LABEL: 'sparse_switch'
; THROUGHPUT:  Cost Model: Found an estimated cost of 1 for instruction: switch i32 %x, label %default [
;
; LATENCY-LABEL: 'sparse_switch'
; LATENCY:  Cost Model: Found an estimated cost of 1 for instruction: switch i32 %x, label %default [
;
; CODESIZE-LABEL: 'sparse_switch'
; CODESIZE:  Cost Model: Found an estimated cost of 6 for instruction: switch i32 %x, label %default [
;
entry:
  switch i32 %x, label %default [
    i32 0, label %bb0
    i32 100, label %bb1
    i32 200, label %bb2
    i32 300, label %bb3
    i32 400, label %bb4
  ]
bb0:
  ret i32 0
bb1:
  ret i32 1
bb2:
  ret i32 2
bb3:
  ret i32 3
bb4:
  ret i32 4
default:
  unreachable
}

define i32 @sparse_switch_reachable_default(i32 %x) {
; THROUGHPUT-LABEL: 'sparse_switch_reachable_default'
; THROUGHPUT:  Cost Model: Found an estimated cost of 1 for instruction: switch i32 %x, label %default [
;
; LATENCY-LABEL: 'sparse_switch_reachable_default'
; LATENCY:  Cost Model: Found an estimated cost of 1 for instruction: switch i32 %x, label %default [
;
; CODESIZE-LABEL: 'sparse_switch_reachable_default'
; CODESIZE:  Cost Model: Found an estimated cost of 6 for instruction: switch i32 %x, label %default [
;
entry:
  switch i32 %x, label %default [
    i32 0, label %bb0
    i32 100, label %bb1
    i32 200, label %bb2
    i32 300, label %bb3
    i32 400, label %bb4
  ]
bb0:
  ret i32 0
bb1:
  ret i32 1
bb2:
  ret i32 2
bb3:
  ret i32 3
bb4:
  ret i32 4
default:
  ret i32 5
}

define i32 @dense_big_switch(i32 %x) {
; THROUGHPUT-LABEL: 'dense_big_switch'
; THROUGHPUT:  Cost Model: Found an estimated cost of 1 for instruction: switch i32 %x, label %default [
;
; LATENCY-LABEL: 'dense_big_switch'
; LATENCY:  Cost Model: Found an estimated cost of 1 for instruction: switch i32 %x, label %default [
;
; CODESIZE-LABEL: 'dense_big_switch'
; CODESIZE:  Cost Model: Found an estimated cost of 2 for instruction: switch i32 %x, label %default [
;
entry:
  switch i32 %x, label %default [
    i32 0, label %bb0
    i32 1, label %bb1
    i32 2, label %bb2
    i32 3, label %bb3
    i32 4, label %bb4
    i32 5, label %bb5
    i32 6, label %bb6
    i32 7, label %bb7
    i32 8, label %bb8
    i32 9, label %bb9
    i32 10, label %bb10
  ]
bb0:
  ret i32 0
bb1:
  ret i32 1
bb2:
  ret i32 2
bb3:
  ret i32 3
bb4:
  ret i32 4
bb5:
  ret i32 5
bb6:
  ret i32 6
bb7:
  ret i32 7
bb8:
  ret i32 8
bb9:
  ret i32 9
bb10:
  ret i32 10
default:
  unreachable
}

define i32 @sparse_big_switch(i32 %x) {
; THROUGHPUT-LABEL: 'sparse_big_switch'
; THROUGHPUT:  Cost Model: Found an estimated cost of 1 for instruction: switch i32 %x, label %default [
;
; LATENCY-LABEL: 'sparse_big_switch'
; LATENCY:  Cost Model: Found an estimated cost of 1 for instruction: switch i32 %x, label %default [
;
; CODESIZE-LABEL: 'sparse_big_switch'
; CODESIZE:  Cost Model: Found an estimated cost of 8 for instruction: switch i32 %x, label %default [
;
entry:
  switch i32 %x, label %default [
    i32 0, label %bb0
    i32 100, label %bb1
    i32 200, label %bb2
    i32 300, label %bb3
    i32 400, label %bb4
    i32 500, label %bb5
    i32 600, label %bb6
    i32 700, label %bb7
    i32 800, label %bb8
    i32 900, label %bb9
    i32 1000, label %bb10
  ]
bb0:
  ret i32 0
bb1:
  ret i32 1
bb2:
  ret i32 2
bb3:
  ret i32 3
bb4:
  ret i32 4
bb5:
  ret i32 5
bb6:
  ret i32 6
bb7:
  ret i32 7
bb8:
  ret i32 8
bb9:
  ret i32 9
bb10:
  ret i32 10
default:
  unreachable
}
