; NOTE: Assertions have been autogenerated by utils/update_analyze_test_checks.py UTC_ARGS: --version 6
; RUN: opt < %s -disable-output "-passes=print<da>" -aa-pipeline=basic-aa 2>&1 | FileCheck %s

; Test for function isKnownLessThan that calculates a back-edge taken count,
; which can return a CouldNotCompute SCEV.

define void @test(i64 %conv, ptr %a) {
; CHECK-LABEL: 'test'
; CHECK-NEXT:  Src: %ld = load i32, ptr %arrayidx12, align 4 --> Dst: %ld = load i32, ptr %arrayidx12, align 4
; CHECK-NEXT:    da analyze - consistent input [0]!
; CHECK-NEXT:    Runtime Assumptions:
; CHECK-NEXT:    Compare predicate: {0,+,1}<nuw><nsw><%loop> slt) %conv
; CHECK-NEXT:    Equal predicate: (sext i64 (4 * %conv) to i128) == (4 * (sext i64 %conv to i128))<nsw>
; CHECK-NEXT:    Equal predicate: (sext i64 {0,+,(4 * %conv)}<%loop> to i128) == {0,+,(sext i64 (4 * %conv) to i128)}<%loop>
; CHECK-NEXT:    Equal predicate: (sext i64 {(4 * %conv),+,(4 * %conv)}<%loop> to i128) == ((sext i64 (4 * %conv) to i128) + (sext i64 {0,+,(4 * %conv)}<%loop> to i128))
; CHECK-NEXT:    Equal predicate: (sext i64 {(-1 + (4 * %conv)),+,(4 * %conv)}<%loop> to i128) == (-1 + (sext i64 {(4 * %conv),+,(4 * %conv)}<%loop> to i128))<nsw>
;
entry:
  %sub = add i64 %conv, 1
  br label %loop

loop:
  %i = phi i64 [ %add26, %loop ], [ 0, %entry ]
  %arrayidx12 = getelementptr i32, ptr %a, i64 %i
  %ld = load i32, ptr %arrayidx12, align 4
  %add26 = add nsw i64 %sub, %i
  br label %loop
}
