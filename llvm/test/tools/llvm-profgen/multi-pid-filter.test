; Test that the --pid argument works, including when passing multiple PIDs

; RUN: llvm-profgen --format=text --perfscript=%S/Inputs/multi-process-nocs-noprobe.perfscript --binary=%S/Inputs/multi-process-nocs-noprobe.perfbin --output=%t --profile-summary-cold-count=0 --multi-process-profile --pid=149754
; RUN: FileCheck %s --input-file %t --check-prefix=CHECK-FIRST-ONLY

CHECK-FIRST-ONLY-NOT: loop2

CHECK-FIRST-ONLY: loop1:1302:0
CHECK-FIRST-ONLY-NEXT: 0: 0
CHECK-FIRST-ONLY-NEXT: 1: 31
CHECK-FIRST-ONLY-NEXT: 2: 0

CHECK-FIRST-ONLY-NOT: loop2

; RUN: llvm-profgen --format=text --perfscript=%S/Inputs/multi-process-nocs-noprobe.perfscript --binary=%S/Inputs/multi-process-nocs-noprobe.perfbin --output=%t --profile-summary-cold-count=0 --multi-process-profile --pid=149755
; RUN: FileCheck %s --input-file %t --check-prefix=CHECK-SECOND-ONLY

CHECK-SECOND-ONLY-NOT: loop1

CHECK-SECOND-ONLY:loop2:655:0
CHECK-SECOND-ONLY-NEXT: 0: 0
CHECK-SECOND-ONLY-NEXT: 1: 16
CHECK-SECOND-ONLY-NEXT: 2: 0

CHECK-SECOND-ONLY-NOT: loop1

; RUN: llvm-profgen --format=text --perfscript=%S/Inputs/multi-process-nocs-noprobe.perfscript --binary=%S/Inputs/multi-process-nocs-noprobe.perfbin --output=%t --profile-summary-cold-count=0 --multi-process-profile --pid=149754,149755
; RUN: FileCheck %s --input-file %t --check-prefix=CHECK-BOTH

CHECK-BOTH: loop1:1302:0
CHECK-BOTH-NEXT: 0: 0
CHECK-BOTH-NEXT: 1: 31
CHECK-BOTH-NEXT: 2: 0
CHECK-BOTH-NEXT:loop2:655:0
CHECK-BOTH-NEXT: 0: 0
CHECK-BOTH-NEXT: 1: 16
CHECK-BOTH-NEXT: 2: 0

; original code can be found in multi-process-nocs-noprobe.test
