# RUN: yaml2obj %s -o %t
# RUN: llvm-objdump -d %t --mattr=help 2>&1 | FileCheck %s
# RUN: llvm-objdump -d %t --mcpu=help 2>&1 | FileCheck %s
# REQUIRES: x86-registered-target

# CHECK: Available CPUs for this target:
# CHECK: Available features for this target:
## To check we still disassemble the file:
# CHECK: file format elf64-x86-64

--- !ELF
FileHeader:
  Class:           ELFCLASS64
  Data:            ELFDATA2LSB
  Type:            ET_EXEC
  Machine:         EM_X86_64

# RUN: cp %t a.out
# RUN: llvm-objdump -d --mcpu=help 2>&1 \
# RUN:   | FileCheck %s --check-prefix=CHECK-DEFAULT-FILE
# RUN: rm a.out

# CHECK-DEFAULT-FILE: Available CPUs for this target:
# CHECK-DEFAULT-FILE: Available features for this target:

# RUN: llvm-objdump --triple=arm --mcpu=help %t 2>&1 \
# RUN:   | FileCheck %s --check-prefix=CHECK-TRIPLE-PRIORITY

# CHECK-TRIPLE-PRIORITY: Available CPUs for this target:
# CHECK-TRIPLE-PRIORITY: Available features for this target:
# CHECK-TRIPLE-PRIORITY: arm

# RUN: not llvm-objdump --triple=x86_64 --mcpu=help 2>&1 \
# RUN:   | FileCheck %s --check-prefix=CHECK-WITHOUT-FILE

# CHECK-WITHOUT-FILE: Available CPUs for this target:
# CHECK-WITHOUT-FILE: Available features for this target:

# RUN: llvm-objdump --mcpu=help %t 2>&1 \
# RUN:   | FileCheck %s --check-prefix=CHECK-WITHOUT-DISASSEMBLING

# CHECK-WITHOUT-DISASSEMBLING: Available CPUs for this target:
# CHECK-WITHOUT-DISASSEMBLING: Available features for this target:
