# RUN: yaml2obj --docnum=1 %s -o %t.o

# RUN: llvm-readobj --headers %t.o 2>&1 | FileCheck %s -DFILE=%t.o --check-prefix=CASE-INVALID

# CASE-INVALID: SectionHeaderOffset: 0x0
# CASE-INVALID: ProgramHeaderEntrySize: 56
# CASE-INVALID-NEXT: warning: '[[FILE]]': invalid section index: 0
# CHECK-INVALID-NEXT:  ProgramHeaderCount: <?>
# CHECK-INVALID-NEXT:  SectionHeaderEntrySize: 64
# CHECK-INVALID-NEXT:  SectionHeaderCount: <?>
# CHECK-INVALID-NEXT:  StringTableSectionIndex: <?>

--- !ELF
FileHeader:
  Class:   ELFCLASS64
  Data:    ELFDATA2LSB
  Type:    ET_EXEC
  Machine: EM_X86_64
  EPhNum:  65535
  EShOff:  0
ProgramHeaders:
  - Type: PT_LOAD

# RUN: yaml2obj --docnum=2 %s -o %t2.o

# RUN: llvm-readobj --headers %t2.o 2>&1 | FileCheck %s --check-prefix=CASE-VALID

# CASE-VALID: SectionHeaderOffset: 0
# CASE-VALID: ProgramHeaderCount: 65535 (65536)
# CASE-VALID: unable to dump program headers: program headers are longer than binary of size 336: e_phoff = 0x40, e_phnum = 65536, e_phentsize = 56

--- !ELF
FileHeader:
  Class:   ELFCLASS64
  Data:    ELFDATA2LSB
  Type:    ET_EXEC
  Machine: EM_X86_64
  EPhNum:  65535
Sections:
  - Type: SHT_NULL
    Info: 65536
ProgramHeaders:
  - Type: PT_LOAD
