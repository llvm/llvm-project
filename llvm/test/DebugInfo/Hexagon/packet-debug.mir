# RUN: llc -mtriple=hexagon -run-pass hexagon-packetizer %s -o - | FileCheck %s

# CHECK-LABEL: name: factorial

# The first bundle in bb.0 should have debug-location !19 (line 9),
# not !18 (line 0) from the DBG_VALUE instructions.
# CHECK: bb.0:
# CHECK: BUNDLE {{.*}}line: 9

--- |
  define void @factorial() { ret void }

  !llvm.dbg.cu = !{!2}
  !llvm.module.flags = !{!6, !7}

  !2 = distinct !DICompileUnit(language: DW_LANG_C11, file: !3, producer: "test", isOptimized: true, runtimeVersion: 0, emissionKind: FullDebug)
  !3 = !DIFile(filename: "fact.c", directory: "/test")
  !5 = !DIBasicType(name: "int", size: 32, encoding: DW_ATE_signed)
  !6 = !{i32 2, !"Debug Info Version", i32 3}
  !7 = !{i32 1, !"wchar_size", i32 4}
  !12 = distinct !DISubprogram(name: "factorial", scope: !3, file: !3, line: 6, type: !13, scopeLine: 7, flags: DIFlagPrototyped, spFlags: DISPFlagDefinition | DISPFlagOptimized, unit: !2)
  !13 = !DISubroutineType(types: !14)
  !14 = !{!5, !5}
  !16 = !DILocalVariable(name: "i", arg: 1, scope: !12, file: !3, line: 6, type: !5)
  !18 = !DILocation(line: 0, scope: !12)
  !19 = !DILocation(line: 9, column: 9, scope: !12)
  !21 = !DILocation(line: 9, column: 7, scope: !12)

...
---
name:            factorial
alignment:       16
tracksRegLiveness: true
body:             |
  bb.0:
    liveins: $r0

    DBG_VALUE $r0, $noreg, !16, !DIExpression(), debug-location !18
    $r2 = A2_tfr $r0
    DBG_VALUE $r2, $noreg, !16, !DIExpression(), debug-location !18
    renamable $p0 = C2_cmpeqi killed $r0, 1, debug-location !19
    renamable $r0 = A2_tfrsi 1
    J2_jumpt killed $p0, %bb.1, implicit-def $pc, debug-location !21

  bb.1:
    PS_jmpret $r31, implicit-def dead $pc

...
