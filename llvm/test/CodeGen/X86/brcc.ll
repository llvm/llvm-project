; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --version 2
; RUN: llc < %s -mtriple=x86_64-unknown | FileCheck %s

define i64 @foo(i1 %0) {
; CHECK-LABEL: foo:
; CHECK:       # %bb.0:
; CHECK-NEXT:    movl $1, %eax
; CHECK-NEXT:    testb $1, %dil
; CHECK-NEXT:    je .LBB0_2
; CHECK-NEXT:  # %bb.1:
; CHECK-NEXT:    xorl %eax, %eax
; CHECK-NEXT:  .LBB0_2:
; CHECK-NEXT:    retq
  br label %2

2:
  %3 = select i1 %0, i1 %0, i1 false
  %4 = freeze i1 %3
  br i1 %4, label %5, label %6

5:
  br label %6

6:
  %7 = phi i64 [ 0, %5 ], [ 1, %2 ]
  ret i64 %7
}
