; NOTE: Assertions have been autogenerated by utils/update_test_checks.py
; Check if "RtLibUseGOT" works correctly when lib calls are simplified.
; RUN: opt < %s -passes=instcombine -S | FileCheck %s

@percent_s = constant [4 x i8] c"%s\0A\00"
@hello_world = constant [13 x i8] c"hello world\0A\00"
declare i32 @printf(ptr, ...)
define void @printf_call() {
; CHECK-LABEL: @printf_call(
; CHECK-NEXT:    [[PUTS:%.*]] = call i32 @puts(ptr nonnull dereferenceable(1) @hello_world)
; CHECK-NEXT:    ret void
;
  call i32 (ptr, ...) @printf(ptr @percent_s, ptr @hello_world)
  ret void
}

; CHECK: Function Attrs: nofree nounwind nonlazybind
; CHECK-NEXT: declare noundef i32 @puts(ptr nocapture noundef readonly)

!llvm.module.flags = !{!0}
!0 = !{i32 7, !"RtLibUseGOT", i32 1}
