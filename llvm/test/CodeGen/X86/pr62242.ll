; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py
; RUN: llc < %s -mtriple=x86_64-unknown-unknown -mattr=+avx2 | FileCheck %s --check-prefixes=AVX2

define <4 x i32> @unpck_permute_canonicalized_mask(<4 x i32> %a, <4 x i32> %b) {
; AVX2-LABEL: unpck_permute_canonicalized_mask:
; AVX2:       # %bb.0:
; AVX2-NEXT:    vunpckhps {{.*#+}} xmm0 = xmm0[2],xmm1[2],xmm0[3],xmm1[3]
; AVX2-NEXT:    vshufps {{.*#+}} xmm0 = xmm0[0,3,2,1]
; AVX2-NEXT:    retq
  ; This mask will get canonicalized to vector_shuffle<6, 3, -1, 2> %b, %a.
  ; Make sure the generated permute masks are still correct.
  %shuffle = shufflevector <4 x i32> %a, <4 x i32> %b, <4 x i32> <i32 2, i32 7, i32 undef, i32 6>
  ret <4 x i32> %shuffle
}
