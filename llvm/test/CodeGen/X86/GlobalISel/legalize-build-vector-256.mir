# NOTE: Assertions have been autogenerated by utils/update_mir_test_checks.py UTC_ARGS: --version 6
# RUN: llc -mtriple=x86_64-linux-gnu -mattr=avx     -run-pass=legalizer -global-isel-abort=1 -pass-remarks-missed='gisel*' %s -o -  | FileCheck %s --check-prefixes=AVX
# RUN: llc -mtriple=x86_64-linux-gnu -mattr=avx512f -run-pass=legalizer -global-isel-abort=1 -pass-remarks-missed='gisel*' %s -o -  | FileCheck %s --check-prefixes=AVX512F

---
name: test_basic_v8i32
body: |
  bb.0:
    liveins: $edi, $esi, $edx, $ecx
    ; AVX-LABEL: name: test_basic_v8i32
    ; AVX: liveins: $edi, $esi, $edx, $ecx
    ; AVX-NEXT: {{  $}}
    ; AVX-NEXT: [[COPY:%[0-9]+]]:_(s32) = COPY $edi
    ; AVX-NEXT: [[COPY1:%[0-9]+]]:_(s32) = COPY $esi
    ; AVX-NEXT: [[COPY2:%[0-9]+]]:_(s32) = COPY $edx
    ; AVX-NEXT: [[COPY3:%[0-9]+]]:_(s32) = COPY $ecx
    ; AVX-NEXT: [[COPY4:%[0-9]+]]:_(s32) = COPY $edx
    ; AVX-NEXT: [[COPY5:%[0-9]+]]:_(s32) = COPY $edi
    ; AVX-NEXT: [[COPY6:%[0-9]+]]:_(s32) = COPY $esi
    ; AVX-NEXT: [[COPY7:%[0-9]+]]:_(s32) = COPY $ecx
    ; AVX-NEXT: [[DEF:%[0-9]+]]:vr128(<4 x s32>) = G_IMPLICIT_DEF
    ; AVX-NEXT: [[PINSRDrri:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[DEF]](<4 x s32>), [[COPY]](s32), 0
    ; AVX-NEXT: [[PINSRDrri1:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri]](<4 x s32>), [[COPY1]](s32), 1
    ; AVX-NEXT: [[PINSRDrri2:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri1]](<4 x s32>), [[COPY2]](s32), 2
    ; AVX-NEXT: [[PINSRDrri3:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri2]](<4 x s32>), [[COPY3]](s32), 3
    ; AVX-NEXT: [[DEF1:%[0-9]+]]:vr128(<4 x s32>) = G_IMPLICIT_DEF
    ; AVX-NEXT: [[PINSRDrri4:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[DEF1]](<4 x s32>), [[COPY4]](s32), 0
    ; AVX-NEXT: [[PINSRDrri5:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri4]](<4 x s32>), [[COPY5]](s32), 1
    ; AVX-NEXT: [[PINSRDrri6:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri5]](<4 x s32>), [[COPY6]](s32), 2
    ; AVX-NEXT: [[PINSRDrri7:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri6]](<4 x s32>), [[COPY7]](s32), 3
    ; AVX-NEXT: [[DEF2:%[0-9]+]]:vr256(<8 x s32>) = G_IMPLICIT_DEF
    ; AVX-NEXT: [[VINSERTF128rri:%[0-9]+]]:vr256(<8 x s32>) = VINSERTF128rri [[DEF2]](<8 x s32>), [[PINSRDrri3]](<4 x s32>), 0
    ; AVX-NEXT: [[VINSERTF128rri1:%[0-9]+]]:_(<8 x s32>) = VINSERTF128rri [[VINSERTF128rri]](<8 x s32>), [[PINSRDrri7]](<4 x s32>), 1
    ; AVX-NEXT: RET 0, implicit [[VINSERTF128rri1]](<8 x s32>)
    ;
    ; AVX512F-LABEL: name: test_basic_v8i32
    ; AVX512F: liveins: $edi, $esi, $edx, $ecx
    ; AVX512F-NEXT: {{  $}}
    ; AVX512F-NEXT: [[COPY:%[0-9]+]]:_(s32) = COPY $edi
    ; AVX512F-NEXT: [[COPY1:%[0-9]+]]:_(s32) = COPY $esi
    ; AVX512F-NEXT: [[COPY2:%[0-9]+]]:_(s32) = COPY $edx
    ; AVX512F-NEXT: [[COPY3:%[0-9]+]]:_(s32) = COPY $ecx
    ; AVX512F-NEXT: [[COPY4:%[0-9]+]]:_(s32) = COPY $edx
    ; AVX512F-NEXT: [[COPY5:%[0-9]+]]:_(s32) = COPY $edi
    ; AVX512F-NEXT: [[COPY6:%[0-9]+]]:_(s32) = COPY $esi
    ; AVX512F-NEXT: [[COPY7:%[0-9]+]]:_(s32) = COPY $ecx
    ; AVX512F-NEXT: [[DEF:%[0-9]+]]:vr128(<4 x s32>) = G_IMPLICIT_DEF
    ; AVX512F-NEXT: [[PINSRDrri:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[DEF]](<4 x s32>), [[COPY]](s32), 0
    ; AVX512F-NEXT: [[PINSRDrri1:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri]](<4 x s32>), [[COPY1]](s32), 1
    ; AVX512F-NEXT: [[PINSRDrri2:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri1]](<4 x s32>), [[COPY2]](s32), 2
    ; AVX512F-NEXT: [[PINSRDrri3:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri2]](<4 x s32>), [[COPY3]](s32), 3
    ; AVX512F-NEXT: [[DEF1:%[0-9]+]]:vr128(<4 x s32>) = G_IMPLICIT_DEF
    ; AVX512F-NEXT: [[PINSRDrri4:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[DEF1]](<4 x s32>), [[COPY4]](s32), 0
    ; AVX512F-NEXT: [[PINSRDrri5:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri4]](<4 x s32>), [[COPY5]](s32), 1
    ; AVX512F-NEXT: [[PINSRDrri6:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri5]](<4 x s32>), [[COPY6]](s32), 2
    ; AVX512F-NEXT: [[PINSRDrri7:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri6]](<4 x s32>), [[COPY7]](s32), 3
    ; AVX512F-NEXT: [[DEF2:%[0-9]+]]:vr256(<8 x s32>) = G_IMPLICIT_DEF
    ; AVX512F-NEXT: [[VINSERTF128rri:%[0-9]+]]:vr256(<8 x s32>) = VINSERTF128rri [[DEF2]](<8 x s32>), [[PINSRDrri3]](<4 x s32>), 0
    ; AVX512F-NEXT: [[VINSERTF128rri1:%[0-9]+]]:_(<8 x s32>) = VINSERTF128rri [[VINSERTF128rri]](<8 x s32>), [[PINSRDrri7]](<4 x s32>), 1
    ; AVX512F-NEXT: RET 0, implicit [[VINSERTF128rri1]](<8 x s32>)
    %1:_(s32) = COPY $edi
    %2:_(s32) = COPY $esi
    %3:_(s32) = COPY $edx
    %4:_(s32) = COPY $ecx
    %5:_(s32) = COPY $edx
    %6:_(s32) = COPY $edi
    %7:_(s32) = COPY $esi
    %8:_(s32) = COPY $ecx
    %0:_(<8 x s32>) = G_BUILD_VECTOR %1:_(s32), %2:_(s32), %3:_(s32), %4:_(s32), %5:_(s32), %6:_(s32), %7:_(s32), %8:_(s32)
    RET 0, implicit %0
...
