# NOTE: Assertions have been autogenerated by utils/update_mir_test_checks.py UTC_ARGS: --version 6
# RUN: llc -mtriple=x86_64-linux-gnu -mattr=avx512f -run-pass=legalizer -global-isel-abort=1 -pass-remarks-missed='gisel*' %s -o -  | FileCheck %s --check-prefixes=AVX512F

---
name: test_basic_build_v16i32
body: |
  bb.0:
    liveins: $edi, $esi, $edx, $ecx

    ; SSE2-LABEL: name: test_basic_build_v4i32
    ; SSE2: liveins: $edi, $esi, $edx, $ecx
    ; SSE2-NEXT: {{  $}}
    ; SSE2-NEXT: [[COPY:%[0-9]+]]:_(s32) = COPY $edi
    ; SSE2-NEXT: [[COPY1:%[0-9]+]]:_(s32) = COPY $esi
    ; SSE2-NEXT: [[COPY2:%[0-9]+]]:_(s32) = COPY $edx
    ; SSE2-NEXT: [[COPY3:%[0-9]+]]:_(s32) = COPY $ecx
    ; SSE2-NEXT: [[COPY4:%[0-9]+]]:_(<4 x s32>) = COPY [[COPY]](s32)
    ; SSE2-NEXT: [[COPY4:%[0-9]+]]:_(<4 x s32>) = PINSRDrri [[COPY1]](s32), 1
    ; SSE2-NEXT: [[COPY4:%[0-9]+]]:_(<4 x s32>) = PINSRDrri [[COPY2]](s32), 2
    ; SSE2-NEXT: [[COPY4:%[0-9]+]]:_(<4 x s32>) = PINSRDrri [[COPY3]](s32), 3
    ; SSE2-NEXT: RET 0, implicit [[COPY4]](<4 x s32>)
    ; AVX2-LABEL: name: test_basic_build_v4i32
    ; AVX2: liveins: $edi, $esi, $edx, $ecx
    ; AVX2-NEXT: {{  $}}
    ; AVX2-NEXT: [[COPY:%[0-9]+]]:_(s32) = COPY $edi
    ; AVX2-NEXT: [[COPY1:%[0-9]+]]:_(s32) = COPY $esi
    ; AVX2-NEXT: [[COPY2:%[0-9]+]]:_(s32) = COPY $edx
    ; AVX2-NEXT: [[COPY3:%[0-9]+]]:_(s32) = COPY $ecx
    ; AVX2-NEXT: [[COPY4:%[0-9]+]]:_(<4 x s32>) = COPY [[COPY]](s32)
    ; AVX2-NEXT: [[COPY4:%[0-9]+]]:_(<4 x s32>) = PINSRDrri [[COPY1]](s32), 1
    ; AVX2-NEXT: [[COPY4:%[0-9]+]]:_(<4 x s32>) = PINSRDrri [[COPY2]](s32), 2
    ; AVX2-NEXT: [[COPY4:%[0-9]+]]:_(<4 x s32>) = PINSRDrri [[COPY3]](s32), 3
    ; AVX2-NEXT: RET 0, implicit [[COPY4]](<4 x s32>)
    ; AVX512F-LABEL: name: test_basic_build_v16i32
    ; AVX512F: liveins: $edi, $esi, $edx, $ecx
    ; AVX512F-NEXT: {{  $}}
    ; AVX512F-NEXT: [[COPY:%[0-9]+]]:_(s32) = COPY $edi
    ; AVX512F-NEXT: [[COPY1:%[0-9]+]]:_(s32) = COPY $esi
    ; AVX512F-NEXT: [[COPY2:%[0-9]+]]:_(s32) = COPY $edx
    ; AVX512F-NEXT: [[COPY3:%[0-9]+]]:_(s32) = COPY $ecx
    ; AVX512F-NEXT: [[COPY4:%[0-9]+]]:_(s32) = COPY $esi
    ; AVX512F-NEXT: [[COPY5:%[0-9]+]]:_(s32) = COPY $edx
    ; AVX512F-NEXT: [[COPY6:%[0-9]+]]:_(s32) = COPY $ecx
    ; AVX512F-NEXT: [[COPY7:%[0-9]+]]:_(s32) = COPY $edi
    ; AVX512F-NEXT: [[COPY8:%[0-9]+]]:_(s32) = COPY $edx
    ; AVX512F-NEXT: [[COPY9:%[0-9]+]]:_(s32) = COPY $ecx
    ; AVX512F-NEXT: [[COPY10:%[0-9]+]]:_(s32) = COPY $edi
    ; AVX512F-NEXT: [[COPY11:%[0-9]+]]:_(s32) = COPY $esi
    ; AVX512F-NEXT: [[COPY12:%[0-9]+]]:_(s32) = COPY $ecx
    ; AVX512F-NEXT: [[COPY13:%[0-9]+]]:_(s32) = COPY $edi
    ; AVX512F-NEXT: [[COPY14:%[0-9]+]]:_(s32) = COPY $esi
    ; AVX512F-NEXT: [[COPY15:%[0-9]+]]:_(s32) = COPY $edx
    ; AVX512F-NEXT: [[DEF:%[0-9]+]]:vr128(<4 x s32>) = G_IMPLICIT_DEF
    ; AVX512F-NEXT: [[PINSRDrri:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[DEF]](<4 x s32>), [[COPY]](s32), 0
    ; AVX512F-NEXT: [[PINSRDrri1:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri]](<4 x s32>), [[COPY1]](s32), 1
    ; AVX512F-NEXT: [[PINSRDrri2:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri1]](<4 x s32>), [[COPY2]](s32), 2
    ; AVX512F-NEXT: [[PINSRDrri3:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri2]](<4 x s32>), [[COPY3]](s32), 3
    ; AVX512F-NEXT: [[DEF1:%[0-9]+]]:vr128(<4 x s32>) = G_IMPLICIT_DEF
    ; AVX512F-NEXT: [[PINSRDrri4:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[DEF1]](<4 x s32>), [[COPY4]](s32), 0
    ; AVX512F-NEXT: [[PINSRDrri5:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri4]](<4 x s32>), [[COPY5]](s32), 1
    ; AVX512F-NEXT: [[PINSRDrri6:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri5]](<4 x s32>), [[COPY6]](s32), 2
    ; AVX512F-NEXT: [[PINSRDrri7:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri6]](<4 x s32>), [[COPY7]](s32), 3
    ; AVX512F-NEXT: [[DEF2:%[0-9]+]]:vr256(<8 x s32>) = G_IMPLICIT_DEF
    ; AVX512F-NEXT: [[VINSERTF128rri:%[0-9]+]]:vr256(<8 x s32>) = VINSERTF128rri [[DEF2]](<8 x s32>), [[PINSRDrri3]](<4 x s32>), 0
    ; AVX512F-NEXT: [[VINSERTF128rri1:%[0-9]+]]:vr256(<8 x s32>) = VINSERTF128rri [[VINSERTF128rri]](<8 x s32>), [[PINSRDrri7]](<4 x s32>), 1
    ; AVX512F-NEXT: [[DEF3:%[0-9]+]]:vr128(<4 x s32>) = G_IMPLICIT_DEF
    ; AVX512F-NEXT: [[PINSRDrri8:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[DEF3]](<4 x s32>), [[COPY8]](s32), 0
    ; AVX512F-NEXT: [[PINSRDrri9:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri8]](<4 x s32>), [[COPY9]](s32), 1
    ; AVX512F-NEXT: [[PINSRDrri10:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri9]](<4 x s32>), [[COPY10]](s32), 2
    ; AVX512F-NEXT: [[PINSRDrri11:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri10]](<4 x s32>), [[COPY11]](s32), 3
    ; AVX512F-NEXT: [[DEF4:%[0-9]+]]:vr128(<4 x s32>) = G_IMPLICIT_DEF
    ; AVX512F-NEXT: [[PINSRDrri12:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[DEF4]](<4 x s32>), [[COPY12]](s32), 0
    ; AVX512F-NEXT: [[PINSRDrri13:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri12]](<4 x s32>), [[COPY13]](s32), 1
    ; AVX512F-NEXT: [[PINSRDrri14:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri13]](<4 x s32>), [[COPY14]](s32), 2
    ; AVX512F-NEXT: [[PINSRDrri15:%[0-9]+]]:vr128(<4 x s32>) = PINSRDrri [[PINSRDrri14]](<4 x s32>), [[COPY15]](s32), 3
    ; AVX512F-NEXT: [[DEF5:%[0-9]+]]:vr256(<8 x s32>) = G_IMPLICIT_DEF
    ; AVX512F-NEXT: [[VINSERTF128rri2:%[0-9]+]]:vr256(<8 x s32>) = VINSERTF128rri [[DEF5]](<8 x s32>), [[PINSRDrri11]](<4 x s32>), 0
    ; AVX512F-NEXT: [[VINSERTF128rri3:%[0-9]+]]:vr256(<8 x s32>) = VINSERTF128rri [[VINSERTF128rri2]](<8 x s32>), [[PINSRDrri15]](<4 x s32>), 1
    ; AVX512F-NEXT: [[DEF6:%[0-9]+]]:vr512(<16 x s32>) = G_IMPLICIT_DEF
    ; AVX512F-NEXT: [[VINSERTF64X4Zrri:%[0-9]+]]:vr512(<16 x s32>) = VINSERTF64X4Zrri [[DEF6]](<16 x s32>), [[VINSERTF128rri1]](<8 x s32>), 0
    ; AVX512F-NEXT: [[VINSERTF64X4Zrri1:%[0-9]+]]:_(<16 x s32>) = VINSERTF64X4Zrri [[VINSERTF64X4Zrri]](<16 x s32>), [[VINSERTF128rri3]](<8 x s32>), 1
    ; AVX512F-NEXT: RET 0, implicit [[VINSERTF64X4Zrri1]](<16 x s32>)
    %1:_(s32) = COPY $edi
    %2:_(s32) = COPY $esi
    %3:_(s32) = COPY $edx
    %4:_(s32) = COPY $ecx
    %5:_(s32) = COPY $esi
    %6:_(s32) = COPY $edx
    %7:_(s32) = COPY $ecx
    %8:_(s32) = COPY $edi
    %9:_(s32) = COPY $edx
    %10:_(s32) = COPY $ecx
    %11:_(s32) = COPY $edi
    %12:_(s32) = COPY $esi
    %13:_(s32) = COPY $ecx
    %14:_(s32) = COPY $edi
    %15:_(s32) = COPY $esi
    %16:_(s32) = COPY $edx
    %0:_(<16 x s32>) = G_BUILD_VECTOR %1:_(s32), %2:_(s32), %3:_(s32), %4:_(s32), %5:_(s32), %6:_(s32), %7:_(s32), %8:_(s32), %9:_(s32), %10:_(s32), %11:_(s32), %12:_(s32), %13:_(s32), %14:_(s32), %15:_(s32), %16:_(s32)
    RET 0, implicit %0
...
