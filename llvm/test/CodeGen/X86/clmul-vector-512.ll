; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py
; RUN: llc < %s -mtriple=x86_64-- -mattr=+avx512f,+vpclmulqdq | FileCheck %s --check-prefixes=AVX512,AVX512F
; RUN: llc < %s -mtriple=x86_64-- -mattr=+avx512vl,+vpclmulqdq | FileCheck %s --check-prefixes=AVX512,AVX512VL

define <64 x i8> @clmul_v64i8(<64 x i8> %a, <64 x i8> %b) nounwind {
; AVX512-LABEL: clmul_v64i8:
; AVX512:       # %bb.0:
; AVX512-NEXT:    vextracti64x4 $1, %zmm0, %ymm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm5
; AVX512-NEXT:    vpmullw %ymm5, %ymm2, %ymm3
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm6
; AVX512-NEXT:    vinserti64x4 $1, %ymm3, %zmm6, %zmm6
; AVX512-NEXT:    vpbroadcastd {{.*#+}} zmm3 = [255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0]
; AVX512-NEXT:    vpandn %ymm4, %ymm3, %ymm4
; AVX512-NEXT:    vpmaddubsw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vpsllw $8, %ymm4, %ymm4
; AVX512-NEXT:    vpandn %ymm5, %ymm3, %ymm5
; AVX512-NEXT:    vpmaddubsw %ymm5, %ymm2, %ymm5
; AVX512-NEXT:    vpsllw $8, %ymm5, %ymm5
; AVX512-NEXT:    vinserti64x4 $1, %ymm5, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 | (zmm6 & zmm3)
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm5
; AVX512-NEXT:    vextracti64x4 $1, %zmm5, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm7
; AVX512-NEXT:    vpmullw %ymm5, %ymm0, %ymm8
; AVX512-NEXT:    vinserti64x4 $1, %ymm7, %zmm8, %zmm7
; AVX512-NEXT:    vpandq %zmm3, %zmm7, %zmm7
; AVX512-NEXT:    vpandn %ymm5, %ymm3, %ymm5
; AVX512-NEXT:    vpmaddubsw %ymm5, %ymm0, %ymm5
; AVX512-NEXT:    vpsllw $8, %ymm5, %ymm5
; AVX512-NEXT:    vpandn %ymm6, %ymm3, %ymm6
; AVX512-NEXT:    vpmaddubsw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpsllw $8, %ymm6, %ymm6
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm4 ^ (zmm5 | zmm7)
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm7
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm8
; AVX512-NEXT:    vinserti64x4 $1, %ymm7, %zmm8, %zmm7
; AVX512-NEXT:    vpandq %zmm3, %zmm7, %zmm7
; AVX512-NEXT:    vpandn %ymm4, %ymm3, %ymm4
; AVX512-NEXT:    vpmaddubsw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vpsllw $8, %ymm4, %ymm4
; AVX512-NEXT:    vpandn %ymm6, %ymm3, %ymm6
; AVX512-NEXT:    vpmaddubsw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpsllw $8, %ymm6, %ymm6
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm5 ^ (zmm4 | zmm7)
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm5
; AVX512-NEXT:    vextracti64x4 $1, %zmm5, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm7
; AVX512-NEXT:    vpmullw %ymm5, %ymm0, %ymm8
; AVX512-NEXT:    vinserti64x4 $1, %ymm7, %zmm8, %zmm7
; AVX512-NEXT:    vpandq %zmm3, %zmm7, %zmm7
; AVX512-NEXT:    vpandn %ymm5, %ymm3, %ymm5
; AVX512-NEXT:    vpmaddubsw %ymm5, %ymm0, %ymm5
; AVX512-NEXT:    vpsllw $8, %ymm5, %ymm5
; AVX512-NEXT:    vpandn %ymm6, %ymm3, %ymm6
; AVX512-NEXT:    vpmaddubsw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpsllw $8, %ymm6, %ymm6
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm4 ^ (zmm5 | zmm7)
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm7
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm8
; AVX512-NEXT:    vinserti64x4 $1, %ymm7, %zmm8, %zmm7
; AVX512-NEXT:    vpandq %zmm3, %zmm7, %zmm7
; AVX512-NEXT:    vpandn %ymm4, %ymm3, %ymm4
; AVX512-NEXT:    vpmaddubsw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vpsllw $8, %ymm4, %ymm4
; AVX512-NEXT:    vpandn %ymm6, %ymm3, %ymm6
; AVX512-NEXT:    vpmaddubsw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpsllw $8, %ymm6, %ymm6
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm5 ^ (zmm4 | zmm7)
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm5
; AVX512-NEXT:    vextracti64x4 $1, %zmm5, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm7
; AVX512-NEXT:    vpmullw %ymm5, %ymm0, %ymm8
; AVX512-NEXT:    vinserti64x4 $1, %ymm7, %zmm8, %zmm7
; AVX512-NEXT:    vpandq %zmm3, %zmm7, %zmm7
; AVX512-NEXT:    vpandn %ymm5, %ymm3, %ymm5
; AVX512-NEXT:    vpmaddubsw %ymm5, %ymm0, %ymm5
; AVX512-NEXT:    vpsllw $8, %ymm5, %ymm5
; AVX512-NEXT:    vpandn %ymm6, %ymm3, %ymm6
; AVX512-NEXT:    vpmaddubsw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpsllw $8, %ymm6, %ymm6
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm4 ^ (zmm5 | zmm7)
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm7
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm8
; AVX512-NEXT:    vinserti64x4 $1, %ymm7, %zmm8, %zmm7
; AVX512-NEXT:    vpandq %zmm3, %zmm7, %zmm7
; AVX512-NEXT:    vpandn %ymm4, %ymm3, %ymm4
; AVX512-NEXT:    vpmaddubsw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vpsllw $8, %ymm4, %ymm4
; AVX512-NEXT:    vpandn %ymm6, %ymm3, %ymm6
; AVX512-NEXT:    vpmaddubsw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpsllw $8, %ymm6, %ymm6
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm5 ^ (zmm4 | zmm7)
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm1
; AVX512-NEXT:    vextracti64x4 $1, %zmm1, %ymm5
; AVX512-NEXT:    vpmullw %ymm5, %ymm2, %ymm6
; AVX512-NEXT:    vpmullw %ymm1, %ymm0, %ymm7
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm7, %zmm6
; AVX512-NEXT:    vpandq %zmm3, %zmm6, %zmm6
; AVX512-NEXT:    vpandn %ymm1, %ymm3, %ymm1
; AVX512-NEXT:    vpmaddubsw %ymm1, %ymm0, %ymm0
; AVX512-NEXT:    vpsllw $8, %ymm0, %ymm0
; AVX512-NEXT:    vpandn %ymm5, %ymm3, %ymm1
; AVX512-NEXT:    vpmaddubsw %ymm1, %ymm2, %ymm1
; AVX512-NEXT:    vpsllw $8, %ymm1, %ymm1
; AVX512-NEXT:    vinserti64x4 $1, %ymm1, %zmm0, %zmm0
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm4 ^ (zmm0 | zmm6)
; AVX512-NEXT:    retq
  %res = call <64 x i8> @llvm.clmul.v64i8(<64 x i8> %a, <64 x i8> %b)
  ret <64 x i8> %res
}

define <32 x i16> @clmul_v32i16(<32 x i16> %a, <32 x i16> %b) nounwind {
; AVX512-LABEL: clmul_v32i16:
; AVX512:       # %bb.0:
; AVX512-NEXT:    vextracti64x4 $1, %zmm0, %ymm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vextracti64x4 $1, %zmm3, %ymm4
; AVX512-NEXT:    vpmullw %ymm4, %ymm2, %ymm4
; AVX512-NEXT:    vpmullw %ymm3, %ymm0, %ymm3
; AVX512-NEXT:    vinserti64x4 $1, %ymm4, %zmm3, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm5
; AVX512-NEXT:    vpmullw %ymm5, %ymm2, %ymm5
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vinserti64x4 $1, %ymm5, %zmm4, %zmm4
; AVX512-NEXT:    vpxorq %zmm3, %zmm4, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm5
; AVX512-NEXT:    vpmullw %ymm5, %ymm2, %ymm5
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vinserti64x4 $1, %ymm5, %zmm4, %zmm4
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm5
; AVX512-NEXT:    vextracti64x4 $1, %zmm5, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpmullw %ymm5, %ymm0, %ymm5
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm3 ^ zmm4
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vextracti64x4 $1, %zmm3, %ymm4
; AVX512-NEXT:    vpmullw %ymm4, %ymm2, %ymm4
; AVX512-NEXT:    vpmullw %ymm3, %ymm0, %ymm3
; AVX512-NEXT:    vinserti64x4 $1, %ymm4, %zmm3, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vextracti64x4 $1, %zmm3, %ymm5
; AVX512-NEXT:    vpmullw %ymm5, %ymm2, %ymm5
; AVX512-NEXT:    vpmullw %ymm3, %ymm0, %ymm3
; AVX512-NEXT:    vinserti64x4 $1, %ymm5, %zmm3, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm5
; AVX512-NEXT:    vextracti64x4 $1, %zmm5, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpmullw %ymm5, %ymm0, %ymm5
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vextracti64x4 $1, %zmm3, %ymm4
; AVX512-NEXT:    vpmullw %ymm4, %ymm2, %ymm4
; AVX512-NEXT:    vpmullw %ymm3, %ymm0, %ymm3
; AVX512-NEXT:    vinserti64x4 $1, %ymm4, %zmm3, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vextracti64x4 $1, %zmm3, %ymm5
; AVX512-NEXT:    vpmullw %ymm5, %ymm2, %ymm5
; AVX512-NEXT:    vpmullw %ymm3, %ymm0, %ymm3
; AVX512-NEXT:    vinserti64x4 $1, %ymm5, %zmm3, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm5
; AVX512-NEXT:    vextracti64x4 $1, %zmm5, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpmullw %ymm5, %ymm0, %ymm5
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vextracti64x4 $1, %zmm3, %ymm4
; AVX512-NEXT:    vpmullw %ymm4, %ymm2, %ymm4
; AVX512-NEXT:    vpmullw %ymm3, %ymm0, %ymm3
; AVX512-NEXT:    vinserti64x4 $1, %ymm4, %zmm3, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vextracti64x4 $1, %zmm3, %ymm5
; AVX512-NEXT:    vpmullw %ymm5, %ymm2, %ymm5
; AVX512-NEXT:    vpmullw %ymm3, %ymm0, %ymm3
; AVX512-NEXT:    vinserti64x4 $1, %ymm5, %zmm3, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm1
; AVX512-NEXT:    vextracti64x4 $1, %zmm1, %ymm5
; AVX512-NEXT:    vpmullw %ymm5, %ymm2, %ymm2
; AVX512-NEXT:    vpmullw %ymm1, %ymm0, %ymm0
; AVX512-NEXT:    vinserti64x4 $1, %ymm2, %zmm0, %zmm0
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm0 ^ zmm4 ^ zmm3
; AVX512-NEXT:    retq
  %res = call <32 x i16> @llvm.clmul.v32i16(<32 x i16> %a, <32 x i16> %b)
  ret <32 x i16> %res
}

define <16 x i32> @clmul_v16i32(<16 x i32> %a, <16 x i32> %b) nounwind {
; AVX512-LABEL: clmul_v16i32:
; AVX512:       # %bb.0:
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpxord %zmm2, %zmm3, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vpmulld %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm4 = zmm4 ^ zmm2 ^ zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm3 = zmm3 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vpmulld %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm4 = zmm4 ^ zmm3 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm3 = zmm3 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vpmulld %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm4 = zmm4 ^ zmm3 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm3 = zmm3 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vpmulld %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm4 = zmm4 ^ zmm3 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm3 = zmm3 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vpmulld %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm4 = zmm4 ^ zmm3 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm3 = zmm3 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vpmulld %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm4 = zmm4 ^ zmm3 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm3 = zmm3 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vpmulld %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm4 = zmm4 ^ zmm3 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm3 = zmm3 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm1
; AVX512-NEXT:    vpmulld %zmm1, %zmm0, %zmm0
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm0 = zmm0 ^ zmm3 ^ zmm2
; AVX512-NEXT:    retq
  %res = call <16 x i32> @llvm.clmul.v16i32(<16 x i32> %a, <16 x i32> %b)
  ret <16 x i32> %res
}

define <8 x i64> @clmul_v8i64(<8 x i64> %a, <8 x i64> %b) nounwind {
; AVX512-LABEL: clmul_v8i64:
; AVX512:       # %bb.0:
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm3
; AVX512-NEXT:    vpsrlq $32, %zmm0, %zmm5
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vporq %zmm2, %zmm3, %zmm2
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm8 = [32,32,32,32,32,32,32,32]
; AVX512-NEXT:    vpandq %zmm8, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm9 = [64,64,64,64,64,64,64,64]
; AVX512-NEXT:    vpandq %zmm9, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm10 = [128,128,128,128,128,128,128,128]
; AVX512-NEXT:    vpandq %zmm10, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm11 = [256,256,256,256,256,256,256,256]
; AVX512-NEXT:    vpandq %zmm11, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm12 = [512,512,512,512,512,512,512,512]
; AVX512-NEXT:    vpandq %zmm12, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm13 = [1024,1024,1024,1024,1024,1024,1024,1024]
; AVX512-NEXT:    vpandq %zmm13, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm14 = [2048,2048,2048,2048,2048,2048,2048,2048]
; AVX512-NEXT:    vpandq %zmm14, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm15 = [4096,4096,4096,4096,4096,4096,4096,4096]
; AVX512-NEXT:    vpandq %zmm15, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm16 = [8192,8192,8192,8192,8192,8192,8192,8192]
; AVX512-NEXT:    vpandq %zmm16, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm17 = [16384,16384,16384,16384,16384,16384,16384,16384]
; AVX512-NEXT:    vpandq %zmm17, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm18 = [32768,32768,32768,32768,32768,32768,32768,32768]
; AVX512-NEXT:    vpandq %zmm18, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm19 = [65536,65536,65536,65536,65536,65536,65536,65536]
; AVX512-NEXT:    vpandq %zmm19, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm20 = [131072,131072,131072,131072,131072,131072,131072,131072]
; AVX512-NEXT:    vpandq %zmm20, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm21 = [262144,262144,262144,262144,262144,262144,262144,262144]
; AVX512-NEXT:    vpandq %zmm21, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm22 = [524288,524288,524288,524288,524288,524288,524288,524288]
; AVX512-NEXT:    vpandq %zmm22, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm23 = [1048576,1048576,1048576,1048576,1048576,1048576,1048576,1048576]
; AVX512-NEXT:    vpandq %zmm23, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm24 = [2097152,2097152,2097152,2097152,2097152,2097152,2097152,2097152]
; AVX512-NEXT:    vpandq %zmm24, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm25 = [4194304,4194304,4194304,4194304,4194304,4194304,4194304,4194304]
; AVX512-NEXT:    vpandq %zmm25, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm26 = [8388608,8388608,8388608,8388608,8388608,8388608,8388608,8388608]
; AVX512-NEXT:    vpandq %zmm26, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm27 = [16777216,16777216,16777216,16777216,16777216,16777216,16777216,16777216]
; AVX512-NEXT:    vpandq %zmm27, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm28 = [33554432,33554432,33554432,33554432,33554432,33554432,33554432,33554432]
; AVX512-NEXT:    vpandq %zmm28, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm29 = [67108864,67108864,67108864,67108864,67108864,67108864,67108864,67108864]
; AVX512-NEXT:    vpandq %zmm29, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm30 = [134217728,134217728,134217728,134217728,134217728,134217728,134217728,134217728]
; AVX512-NEXT:    vpandq %zmm30, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm31 = [268435456,268435456,268435456,268435456,268435456,268435456,268435456,268435456]
; AVX512-NEXT:    vpandq %zmm31, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm7 = [536870912,536870912,536870912,536870912,536870912,536870912,536870912,536870912]
; AVX512-NEXT:    vpandq %zmm7, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm6 = [1073741824,1073741824,1073741824,1073741824,1073741824,1073741824,1073741824,1073741824]
; AVX512-NEXT:    vpandq %zmm6, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm3 = [2147483648,2147483648,2147483648,2147483648,2147483648,2147483648,2147483648,2147483648]
; AVX512-NEXT:    vpandq %zmm3, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm5, %zmm5
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm2 ^ (zmm5 | zmm4)
; AVX512-NEXT:    vpsrlq $32, %zmm1, %zmm1
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm2
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm5
; AVX512-NEXT:    vpmuludq %zmm5, %zmm0, %zmm5
; AVX512-NEXT:    vpsllq $32, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm8, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm2
; AVX512-NEXT:    vpandq %zmm9, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm10, %zmm1, %zmm5
; AVX512-NEXT:    vpmuludq %zmm5, %zmm0, %zmm5
; AVX512-NEXT:    vpsllq $32, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandq %zmm11, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm12, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm2
; AVX512-NEXT:    vpandq %zmm13, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm14, %zmm1, %zmm5
; AVX512-NEXT:    vpmuludq %zmm5, %zmm0, %zmm5
; AVX512-NEXT:    vpsllq $32, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandq %zmm15, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm16, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm2
; AVX512-NEXT:    vpandq %zmm17, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm18, %zmm1, %zmm5
; AVX512-NEXT:    vpmuludq %zmm5, %zmm0, %zmm5
; AVX512-NEXT:    vpsllq $32, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandq %zmm19, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm20, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm2
; AVX512-NEXT:    vpandq %zmm21, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm22, %zmm1, %zmm5
; AVX512-NEXT:    vpmuludq %zmm5, %zmm0, %zmm5
; AVX512-NEXT:    vpsllq $32, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandq %zmm23, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm24, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm2
; AVX512-NEXT:    vpandq %zmm25, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm26, %zmm1, %zmm5
; AVX512-NEXT:    vpmuludq %zmm5, %zmm0, %zmm5
; AVX512-NEXT:    vpsllq $32, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandq %zmm27, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm28, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm2
; AVX512-NEXT:    vpandq %zmm29, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm30, %zmm1, %zmm5
; AVX512-NEXT:    vpmuludq %zmm5, %zmm0, %zmm5
; AVX512-NEXT:    vpsllq $32, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandq %zmm31, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm7, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm2
; AVX512-NEXT:    vpandq %zmm6, %zmm1, %zmm2
; AVX512-NEXT:    vpandq %zmm3, %zmm1, %zmm1
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpmuludq %zmm1, %zmm0, %zmm0
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm1
; AVX512-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm0 ^ zmm4 ^ zmm1
; AVX512-NEXT:    retq
  %res = call <8 x i64> @llvm.clmul.v8i64(<8 x i64> %a, <8 x i64> %b)
  ret <8 x i64> %res
}

;; NOTE: These prefixes are unused and the list is autogenerated. Do not add tests below this line:
; AVX512F: {{.*}}
; AVX512VL: {{.*}}
