; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py
; RUN: llc < %s -mtriple=x86_64-- -mattr=+avx512f,+vpclmulqdq | FileCheck %s --check-prefixes=AVX512,AVX512F
; RUN: llc < %s -mtriple=x86_64-- -mattr=+avx512vl,+vpclmulqdq | FileCheck %s --check-prefixes=AVX512,AVX512VL

define <64 x i8> @clmul_v64i8(<64 x i8> %a, <64 x i8> %b) nounwind {
; AVX512-LABEL: clmul_v64i8:
; AVX512:       # %bb.0:
; AVX512-NEXT:    vextracti64x4 $1, %zmm0, %ymm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm5
; AVX512-NEXT:    vpmullw %ymm5, %ymm2, %ymm3
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm6
; AVX512-NEXT:    vinserti64x4 $1, %ymm3, %zmm6, %zmm6
; AVX512-NEXT:    vpbroadcastd {{.*#+}} zmm3 = [255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0]
; AVX512-NEXT:    vpandn %ymm4, %ymm3, %ymm4
; AVX512-NEXT:    vpmaddubsw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vpsllw $8, %ymm4, %ymm4
; AVX512-NEXT:    vpandn %ymm5, %ymm3, %ymm5
; AVX512-NEXT:    vpmaddubsw %ymm5, %ymm2, %ymm5
; AVX512-NEXT:    vpsllw $8, %ymm5, %ymm5
; AVX512-NEXT:    vinserti64x4 $1, %ymm5, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 | (zmm6 & zmm3)
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm5
; AVX512-NEXT:    vextracti64x4 $1, %zmm5, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm7
; AVX512-NEXT:    vpmullw %ymm5, %ymm0, %ymm8
; AVX512-NEXT:    vinserti64x4 $1, %ymm7, %zmm8, %zmm7
; AVX512-NEXT:    vpandq %zmm3, %zmm7, %zmm7
; AVX512-NEXT:    vpandn %ymm5, %ymm3, %ymm5
; AVX512-NEXT:    vpmaddubsw %ymm5, %ymm0, %ymm5
; AVX512-NEXT:    vpsllw $8, %ymm5, %ymm5
; AVX512-NEXT:    vpandn %ymm6, %ymm3, %ymm6
; AVX512-NEXT:    vpmaddubsw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpsllw $8, %ymm6, %ymm6
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm4 ^ (zmm5 | zmm7)
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm7
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm8
; AVX512-NEXT:    vinserti64x4 $1, %ymm7, %zmm8, %zmm7
; AVX512-NEXT:    vpandq %zmm3, %zmm7, %zmm7
; AVX512-NEXT:    vpandn %ymm4, %ymm3, %ymm4
; AVX512-NEXT:    vpmaddubsw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vpsllw $8, %ymm4, %ymm4
; AVX512-NEXT:    vpandn %ymm6, %ymm3, %ymm6
; AVX512-NEXT:    vpmaddubsw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpsllw $8, %ymm6, %ymm6
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm5 ^ (zmm4 | zmm7)
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm5
; AVX512-NEXT:    vextracti64x4 $1, %zmm5, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm7
; AVX512-NEXT:    vpmullw %ymm5, %ymm0, %ymm8
; AVX512-NEXT:    vinserti64x4 $1, %ymm7, %zmm8, %zmm7
; AVX512-NEXT:    vpandq %zmm3, %zmm7, %zmm7
; AVX512-NEXT:    vpandn %ymm5, %ymm3, %ymm5
; AVX512-NEXT:    vpmaddubsw %ymm5, %ymm0, %ymm5
; AVX512-NEXT:    vpsllw $8, %ymm5, %ymm5
; AVX512-NEXT:    vpandn %ymm6, %ymm3, %ymm6
; AVX512-NEXT:    vpmaddubsw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpsllw $8, %ymm6, %ymm6
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm4 ^ (zmm5 | zmm7)
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm7
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm8
; AVX512-NEXT:    vinserti64x4 $1, %ymm7, %zmm8, %zmm7
; AVX512-NEXT:    vpandq %zmm3, %zmm7, %zmm7
; AVX512-NEXT:    vpandn %ymm4, %ymm3, %ymm4
; AVX512-NEXT:    vpmaddubsw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vpsllw $8, %ymm4, %ymm4
; AVX512-NEXT:    vpandn %ymm6, %ymm3, %ymm6
; AVX512-NEXT:    vpmaddubsw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpsllw $8, %ymm6, %ymm6
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm5 ^ (zmm4 | zmm7)
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm5
; AVX512-NEXT:    vextracti64x4 $1, %zmm5, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm7
; AVX512-NEXT:    vpmullw %ymm5, %ymm0, %ymm8
; AVX512-NEXT:    vinserti64x4 $1, %ymm7, %zmm8, %zmm7
; AVX512-NEXT:    vpandq %zmm3, %zmm7, %zmm7
; AVX512-NEXT:    vpandn %ymm5, %ymm3, %ymm5
; AVX512-NEXT:    vpmaddubsw %ymm5, %ymm0, %ymm5
; AVX512-NEXT:    vpsllw $8, %ymm5, %ymm5
; AVX512-NEXT:    vpandn %ymm6, %ymm3, %ymm6
; AVX512-NEXT:    vpmaddubsw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpsllw $8, %ymm6, %ymm6
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm4 ^ (zmm5 | zmm7)
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm7
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm8
; AVX512-NEXT:    vinserti64x4 $1, %ymm7, %zmm8, %zmm7
; AVX512-NEXT:    vpandq %zmm3, %zmm7, %zmm7
; AVX512-NEXT:    vpandn %ymm4, %ymm3, %ymm4
; AVX512-NEXT:    vpmaddubsw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vpsllw $8, %ymm4, %ymm4
; AVX512-NEXT:    vpandn %ymm6, %ymm3, %ymm6
; AVX512-NEXT:    vpmaddubsw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpsllw $8, %ymm6, %ymm6
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm5 ^ (zmm4 | zmm7)
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm1
; AVX512-NEXT:    vextracti64x4 $1, %zmm1, %ymm5
; AVX512-NEXT:    vpmullw %ymm5, %ymm2, %ymm6
; AVX512-NEXT:    vpmullw %ymm1, %ymm0, %ymm7
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm7, %zmm6
; AVX512-NEXT:    vpandq %zmm3, %zmm6, %zmm6
; AVX512-NEXT:    vpandn %ymm1, %ymm3, %ymm1
; AVX512-NEXT:    vpmaddubsw %ymm1, %ymm0, %ymm0
; AVX512-NEXT:    vpsllw $8, %ymm0, %ymm0
; AVX512-NEXT:    vpandn %ymm5, %ymm3, %ymm1
; AVX512-NEXT:    vpmaddubsw %ymm1, %ymm2, %ymm1
; AVX512-NEXT:    vpsllw $8, %ymm1, %ymm1
; AVX512-NEXT:    vinserti64x4 $1, %ymm1, %zmm0, %zmm0
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm4 ^ (zmm0 | zmm6)
; AVX512-NEXT:    retq
  %res = call <64 x i8> @llvm.clmul.v64i8(<64 x i8> %a, <64 x i8> %b)
  ret <64 x i8> %res
}

define <32 x i16> @clmul_v32i16(<32 x i16> %a, <32 x i16> %b) nounwind {
; AVX512-LABEL: clmul_v32i16:
; AVX512:       # %bb.0:
; AVX512-NEXT:    vextracti64x4 $1, %zmm0, %ymm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vextracti64x4 $1, %zmm3, %ymm4
; AVX512-NEXT:    vpmullw %ymm4, %ymm2, %ymm4
; AVX512-NEXT:    vpmullw %ymm3, %ymm0, %ymm3
; AVX512-NEXT:    vinserti64x4 $1, %ymm4, %zmm3, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm5
; AVX512-NEXT:    vpmullw %ymm5, %ymm2, %ymm5
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vinserti64x4 $1, %ymm5, %zmm4, %zmm4
; AVX512-NEXT:    vpxorq %zmm3, %zmm4, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm5
; AVX512-NEXT:    vpmullw %ymm5, %ymm2, %ymm5
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vinserti64x4 $1, %ymm5, %zmm4, %zmm4
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm5
; AVX512-NEXT:    vextracti64x4 $1, %zmm5, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpmullw %ymm5, %ymm0, %ymm5
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm3 ^ zmm4
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vextracti64x4 $1, %zmm3, %ymm4
; AVX512-NEXT:    vpmullw %ymm4, %ymm2, %ymm4
; AVX512-NEXT:    vpmullw %ymm3, %ymm0, %ymm3
; AVX512-NEXT:    vinserti64x4 $1, %ymm4, %zmm3, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vextracti64x4 $1, %zmm3, %ymm5
; AVX512-NEXT:    vpmullw %ymm5, %ymm2, %ymm5
; AVX512-NEXT:    vpmullw %ymm3, %ymm0, %ymm3
; AVX512-NEXT:    vinserti64x4 $1, %ymm5, %zmm3, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm5
; AVX512-NEXT:    vextracti64x4 $1, %zmm5, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpmullw %ymm5, %ymm0, %ymm5
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vextracti64x4 $1, %zmm3, %ymm4
; AVX512-NEXT:    vpmullw %ymm4, %ymm2, %ymm4
; AVX512-NEXT:    vpmullw %ymm3, %ymm0, %ymm3
; AVX512-NEXT:    vinserti64x4 $1, %ymm4, %zmm3, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vextracti64x4 $1, %zmm3, %ymm5
; AVX512-NEXT:    vpmullw %ymm5, %ymm2, %ymm5
; AVX512-NEXT:    vpmullw %ymm3, %ymm0, %ymm3
; AVX512-NEXT:    vinserti64x4 $1, %ymm5, %zmm3, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm5
; AVX512-NEXT:    vextracti64x4 $1, %zmm5, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpmullw %ymm5, %ymm0, %ymm5
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vextracti64x4 $1, %zmm3, %ymm4
; AVX512-NEXT:    vpmullw %ymm4, %ymm2, %ymm4
; AVX512-NEXT:    vpmullw %ymm3, %ymm0, %ymm3
; AVX512-NEXT:    vinserti64x4 $1, %ymm4, %zmm3, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vextracti64x4 $1, %zmm4, %ymm6
; AVX512-NEXT:    vpmullw %ymm6, %ymm2, %ymm6
; AVX512-NEXT:    vpmullw %ymm4, %ymm0, %ymm4
; AVX512-NEXT:    vinserti64x4 $1, %ymm6, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vextracti64x4 $1, %zmm3, %ymm5
; AVX512-NEXT:    vpmullw %ymm5, %ymm2, %ymm5
; AVX512-NEXT:    vpmullw %ymm3, %ymm0, %ymm3
; AVX512-NEXT:    vinserti64x4 $1, %ymm5, %zmm3, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm1
; AVX512-NEXT:    vextracti64x4 $1, %zmm1, %ymm5
; AVX512-NEXT:    vpmullw %ymm5, %ymm2, %ymm2
; AVX512-NEXT:    vpmullw %ymm1, %ymm0, %ymm0
; AVX512-NEXT:    vinserti64x4 $1, %ymm2, %zmm0, %zmm0
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm0 ^ zmm4 ^ zmm3
; AVX512-NEXT:    retq
  %res = call <32 x i16> @llvm.clmul.v32i16(<32 x i16> %a, <32 x i16> %b)
  ret <32 x i16> %res
}

define <16 x i32> @clmul_v16i32(<16 x i32> %a, <16 x i32> %b) nounwind {
; AVX512-LABEL: clmul_v16i32:
; AVX512:       # %bb.0:
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpxord %zmm2, %zmm3, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vpmulld %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm4 = zmm4 ^ zmm2 ^ zmm3
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm3 = zmm3 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vpmulld %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm4 = zmm4 ^ zmm3 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm3 = zmm3 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vpmulld %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm4 = zmm4 ^ zmm3 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm3 = zmm3 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vpmulld %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm4 = zmm4 ^ zmm3 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm3 = zmm3 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vpmulld %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm4 = zmm4 ^ zmm3 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm3 = zmm3 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vpmulld %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm4 = zmm4 ^ zmm3 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm3 = zmm3 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm4
; AVX512-NEXT:    vpmulld %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm4 = zmm4 ^ zmm3 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm3
; AVX512-NEXT:    vpmulld %zmm3, %zmm0, %zmm3
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm3 = zmm3 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm2
; AVX512-NEXT:    vpmulld %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm1
; AVX512-NEXT:    vpmulld %zmm1, %zmm0, %zmm0
; AVX512-NEXT:    vpternlogd {{.*#+}} zmm0 = zmm0 ^ zmm3 ^ zmm2
; AVX512-NEXT:    retq
  %res = call <16 x i32> @llvm.clmul.v16i32(<16 x i32> %a, <16 x i32> %b)
  ret <16 x i32> %res
}

define <8 x i64> @clmul_v8i64(<8 x i64> %a, <8 x i64> %b) nounwind {
; AVX512-LABEL: clmul_v8i64:
; AVX512:       # %bb.0:
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm3
; AVX512-NEXT:    vpsrlq $32, %zmm0, %zmm5
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vporq %zmm2, %zmm3, %zmm2
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm8 = [32,32,32,32,32,32,32,32]
; AVX512-NEXT:    vpandq %zmm8, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm9 = [64,64,64,64,64,64,64,64]
; AVX512-NEXT:    vpandq %zmm9, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm10 = [128,128,128,128,128,128,128,128]
; AVX512-NEXT:    vpandq %zmm10, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm11 = [256,256,256,256,256,256,256,256]
; AVX512-NEXT:    vpandq %zmm11, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm12 = [512,512,512,512,512,512,512,512]
; AVX512-NEXT:    vpandq %zmm12, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm13 = [1024,1024,1024,1024,1024,1024,1024,1024]
; AVX512-NEXT:    vpandq %zmm13, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm14 = [2048,2048,2048,2048,2048,2048,2048,2048]
; AVX512-NEXT:    vpandq %zmm14, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm15 = [4096,4096,4096,4096,4096,4096,4096,4096]
; AVX512-NEXT:    vpandq %zmm15, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm16 = [8192,8192,8192,8192,8192,8192,8192,8192]
; AVX512-NEXT:    vpandq %zmm16, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm17 = [16384,16384,16384,16384,16384,16384,16384,16384]
; AVX512-NEXT:    vpandq %zmm17, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm18 = [32768,32768,32768,32768,32768,32768,32768,32768]
; AVX512-NEXT:    vpandq %zmm18, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm19 = [65536,65536,65536,65536,65536,65536,65536,65536]
; AVX512-NEXT:    vpandq %zmm19, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm20 = [131072,131072,131072,131072,131072,131072,131072,131072]
; AVX512-NEXT:    vpandq %zmm20, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm21 = [262144,262144,262144,262144,262144,262144,262144,262144]
; AVX512-NEXT:    vpandq %zmm21, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm22 = [524288,524288,524288,524288,524288,524288,524288,524288]
; AVX512-NEXT:    vpandq %zmm22, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm23 = [1048576,1048576,1048576,1048576,1048576,1048576,1048576,1048576]
; AVX512-NEXT:    vpandq %zmm23, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm24 = [2097152,2097152,2097152,2097152,2097152,2097152,2097152,2097152]
; AVX512-NEXT:    vpandq %zmm24, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm25 = [4194304,4194304,4194304,4194304,4194304,4194304,4194304,4194304]
; AVX512-NEXT:    vpandq %zmm25, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm26 = [8388608,8388608,8388608,8388608,8388608,8388608,8388608,8388608]
; AVX512-NEXT:    vpandq %zmm26, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm27 = [16777216,16777216,16777216,16777216,16777216,16777216,16777216,16777216]
; AVX512-NEXT:    vpandq %zmm27, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm28 = [33554432,33554432,33554432,33554432,33554432,33554432,33554432,33554432]
; AVX512-NEXT:    vpandq %zmm28, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm29 = [67108864,67108864,67108864,67108864,67108864,67108864,67108864,67108864]
; AVX512-NEXT:    vpandq %zmm29, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm30 = [134217728,134217728,134217728,134217728,134217728,134217728,134217728,134217728]
; AVX512-NEXT:    vpandq %zmm30, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm31 = [268435456,268435456,268435456,268435456,268435456,268435456,268435456,268435456]
; AVX512-NEXT:    vpandq %zmm31, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm7 = [536870912,536870912,536870912,536870912,536870912,536870912,536870912,536870912]
; AVX512-NEXT:    vpandq %zmm7, %zmm1, %zmm3
; AVX512-NEXT:    vpmuludq %zmm3, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm2 ^ (zmm3 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm6 = [1073741824,1073741824,1073741824,1073741824,1073741824,1073741824,1073741824,1073741824]
; AVX512-NEXT:    vpandq %zmm6, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm4
; AVX512-NEXT:    vpmuludq %zmm2, %zmm5, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm2 = zmm3 ^ (zmm2 | zmm4)
; AVX512-NEXT:    vpbroadcastq {{.*#+}} zmm3 = [2147483648,2147483648,2147483648,2147483648,2147483648,2147483648,2147483648,2147483648]
; AVX512-NEXT:    vpandq %zmm3, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm5, %zmm5
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm2 ^ (zmm5 | zmm4)
; AVX512-NEXT:    vpsrlq $32, %zmm1, %zmm1
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm2
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm5
; AVX512-NEXT:    vpmuludq %zmm5, %zmm0, %zmm5
; AVX512-NEXT:    vpsllq $32, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm8, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm2
; AVX512-NEXT:    vpandq %zmm9, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm10, %zmm1, %zmm5
; AVX512-NEXT:    vpmuludq %zmm5, %zmm0, %zmm5
; AVX512-NEXT:    vpsllq $32, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandq %zmm11, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm12, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm2
; AVX512-NEXT:    vpandq %zmm13, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm14, %zmm1, %zmm5
; AVX512-NEXT:    vpmuludq %zmm5, %zmm0, %zmm5
; AVX512-NEXT:    vpsllq $32, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandq %zmm15, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm16, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm2
; AVX512-NEXT:    vpandq %zmm17, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm18, %zmm1, %zmm5
; AVX512-NEXT:    vpmuludq %zmm5, %zmm0, %zmm5
; AVX512-NEXT:    vpsllq $32, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandq %zmm19, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm20, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm2
; AVX512-NEXT:    vpandq %zmm21, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm22, %zmm1, %zmm5
; AVX512-NEXT:    vpmuludq %zmm5, %zmm0, %zmm5
; AVX512-NEXT:    vpsllq $32, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandq %zmm23, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm24, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm2
; AVX512-NEXT:    vpandq %zmm25, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm26, %zmm1, %zmm5
; AVX512-NEXT:    vpmuludq %zmm5, %zmm0, %zmm5
; AVX512-NEXT:    vpsllq $32, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandq %zmm27, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm28, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm2
; AVX512-NEXT:    vpandq %zmm29, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm30, %zmm1, %zmm5
; AVX512-NEXT:    vpmuludq %zmm5, %zmm0, %zmm5
; AVX512-NEXT:    vpsllq $32, %zmm5, %zmm5
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm5 = zmm5 ^ zmm4 ^ zmm2
; AVX512-NEXT:    vpandq %zmm31, %zmm1, %zmm2
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm2
; AVX512-NEXT:    vpandq %zmm7, %zmm1, %zmm4
; AVX512-NEXT:    vpmuludq %zmm4, %zmm0, %zmm4
; AVX512-NEXT:    vpsllq $32, %zmm4, %zmm4
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm4 = zmm4 ^ zmm5 ^ zmm2
; AVX512-NEXT:    vpandq %zmm6, %zmm1, %zmm2
; AVX512-NEXT:    vpandq %zmm3, %zmm1, %zmm1
; AVX512-NEXT:    vpmuludq %zmm2, %zmm0, %zmm2
; AVX512-NEXT:    vpmuludq %zmm1, %zmm0, %zmm0
; AVX512-NEXT:    vpsllq $32, %zmm2, %zmm1
; AVX512-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm0 ^ zmm4 ^ zmm1
; AVX512-NEXT:    retq
  %res = call <8 x i64> @llvm.clmul.v8i64(<8 x i64> %a, <8 x i64> %b)
  ret <8 x i64> %res
}

define <64 x i8> @clmulr_v64i8(<64 x i8> %a, <64 x i8> %b) nounwind {
; AVX512F-LABEL: clmulr_v64i8:
; AVX512F:       # %bb.0:
; AVX512F-NEXT:    vextracti64x4 $1, %zmm0, %ymm3
; AVX512F-NEXT:    vpbroadcastb {{.*#+}} ymm2 = [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]
; AVX512F-NEXT:    vpand %ymm2, %ymm3, %ymm5
; AVX512F-NEXT:    vbroadcasti128 {{.*#+}} ymm4 = [0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240]
; AVX512F-NEXT:    # ymm4 = mem[0,1,0,1]
; AVX512F-NEXT:    vpshufb %ymm5, %ymm4, %ymm5
; AVX512F-NEXT:    vpsrlw $4, %ymm3, %ymm3
; AVX512F-NEXT:    vpand %ymm2, %ymm3, %ymm6
; AVX512F-NEXT:    vbroadcasti128 {{.*#+}} ymm3 = [0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15,0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15]
; AVX512F-NEXT:    # ymm3 = mem[0,1,0,1]
; AVX512F-NEXT:    vpshufb %ymm6, %ymm3, %ymm6
; AVX512F-NEXT:    vpor %ymm6, %ymm5, %ymm5
; AVX512F-NEXT:    vextracti64x4 $1, %zmm1, %ymm7
; AVX512F-NEXT:    vpsrlw $4, %ymm7, %ymm6
; AVX512F-NEXT:    vpand %ymm2, %ymm6, %ymm6
; AVX512F-NEXT:    vpshufb %ymm6, %ymm3, %ymm6
; AVX512F-NEXT:    vpsrlw $4, %ymm1, %ymm8
; AVX512F-NEXT:    vpand %ymm2, %ymm8, %ymm8
; AVX512F-NEXT:    vpshufb %ymm8, %ymm3, %ymm8
; AVX512F-NEXT:    vinserti64x4 $1, %ymm6, %zmm8, %zmm8
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm8, %zmm9
; AVX512F-NEXT:    vextracti64x4 $1, %zmm9, %ymm10
; AVX512F-NEXT:    vpmullw %ymm5, %ymm10, %ymm6
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm11
; AVX512F-NEXT:    vpshufb %ymm11, %ymm4, %ymm11
; AVX512F-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm0
; AVX512F-NEXT:    vpshufb %ymm0, %ymm3, %ymm0
; AVX512F-NEXT:    vpor %ymm0, %ymm11, %ymm0
; AVX512F-NEXT:    vpmullw %ymm0, %ymm9, %ymm11
; AVX512F-NEXT:    vinserti64x4 $1, %ymm6, %zmm11, %zmm11
; AVX512F-NEXT:    vpbroadcastd {{.*#+}} zmm6 = [255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0]
; AVX512F-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512F-NEXT:    vpmaddubsw %ymm9, %ymm0, %ymm9
; AVX512F-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512F-NEXT:    vpandn %ymm10, %ymm6, %ymm10
; AVX512F-NEXT:    vpmaddubsw %ymm10, %ymm5, %ymm10
; AVX512F-NEXT:    vpsllw $8, %ymm10, %ymm10
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 | (zmm11 & zmm6)
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm8, %zmm10
; AVX512F-NEXT:    vextracti64x4 $1, %zmm10, %ymm11
; AVX512F-NEXT:    vpmullw %ymm5, %ymm11, %ymm12
; AVX512F-NEXT:    vpmullw %ymm0, %ymm10, %ymm13
; AVX512F-NEXT:    vinserti64x4 $1, %ymm12, %zmm13, %zmm12
; AVX512F-NEXT:    vpandq %zmm6, %zmm12, %zmm12
; AVX512F-NEXT:    vpandn %ymm10, %ymm6, %ymm10
; AVX512F-NEXT:    vpmaddubsw %ymm10, %ymm0, %ymm10
; AVX512F-NEXT:    vpsllw $8, %ymm10, %ymm10
; AVX512F-NEXT:    vpandn %ymm11, %ymm6, %ymm11
; AVX512F-NEXT:    vpmaddubsw %ymm11, %ymm5, %ymm11
; AVX512F-NEXT:    vpsllw $8, %ymm11, %ymm11
; AVX512F-NEXT:    vinserti64x4 $1, %ymm11, %zmm10, %zmm10
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm10 = zmm9 ^ (zmm10 | zmm12)
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm8, %zmm9
; AVX512F-NEXT:    vextracti64x4 $1, %zmm9, %ymm11
; AVX512F-NEXT:    vpmullw %ymm5, %ymm11, %ymm12
; AVX512F-NEXT:    vpmullw %ymm0, %ymm9, %ymm13
; AVX512F-NEXT:    vinserti64x4 $1, %ymm12, %zmm13, %zmm12
; AVX512F-NEXT:    vpandq %zmm6, %zmm12, %zmm12
; AVX512F-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512F-NEXT:    vpmaddubsw %ymm9, %ymm0, %ymm9
; AVX512F-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512F-NEXT:    vpandn %ymm11, %ymm6, %ymm11
; AVX512F-NEXT:    vpmaddubsw %ymm11, %ymm5, %ymm11
; AVX512F-NEXT:    vpsllw $8, %ymm11, %ymm11
; AVX512F-NEXT:    vinserti64x4 $1, %ymm11, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm10 ^ (zmm9 | zmm12)
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm8, %zmm8
; AVX512F-NEXT:    vextracti64x4 $1, %zmm8, %ymm10
; AVX512F-NEXT:    vpmullw %ymm5, %ymm10, %ymm11
; AVX512F-NEXT:    vpmullw %ymm0, %ymm8, %ymm12
; AVX512F-NEXT:    vinserti64x4 $1, %ymm11, %zmm12, %zmm11
; AVX512F-NEXT:    vpandq %zmm6, %zmm11, %zmm11
; AVX512F-NEXT:    vpandn %ymm8, %ymm6, %ymm8
; AVX512F-NEXT:    vpmaddubsw %ymm8, %ymm0, %ymm8
; AVX512F-NEXT:    vpsllw $8, %ymm8, %ymm8
; AVX512F-NEXT:    vpandn %ymm10, %ymm6, %ymm10
; AVX512F-NEXT:    vpmaddubsw %ymm10, %ymm5, %ymm10
; AVX512F-NEXT:    vpsllw $8, %ymm10, %ymm10
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm8, %zmm8
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm9 ^ (zmm8 | zmm11)
; AVX512F-NEXT:    vpand %ymm2, %ymm7, %ymm7
; AVX512F-NEXT:    vpshufb %ymm7, %ymm4, %ymm7
; AVX512F-NEXT:    vpand %ymm2, %ymm1, %ymm1
; AVX512F-NEXT:    vpshufb %ymm1, %ymm4, %ymm1
; AVX512F-NEXT:    vinserti64x4 $1, %ymm7, %zmm1, %zmm1
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512F-NEXT:    vpmullw %ymm5, %ymm9, %ymm10
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm11
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm11, %zmm10
; AVX512F-NEXT:    vpandq %zmm6, %zmm10, %zmm10
; AVX512F-NEXT:    vpandn %ymm7, %ymm6, %ymm7
; AVX512F-NEXT:    vpmaddubsw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vpsllw $8, %ymm7, %ymm7
; AVX512F-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512F-NEXT:    vpmaddubsw %ymm9, %ymm5, %ymm9
; AVX512F-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm7 = zmm8 ^ (zmm7 | zmm10)
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vextracti64x4 $1, %zmm8, %ymm9
; AVX512F-NEXT:    vpmullw %ymm5, %ymm9, %ymm10
; AVX512F-NEXT:    vpmullw %ymm0, %ymm8, %ymm11
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm11, %zmm10
; AVX512F-NEXT:    vpandq %zmm6, %zmm10, %zmm10
; AVX512F-NEXT:    vpandn %ymm8, %ymm6, %ymm8
; AVX512F-NEXT:    vpmaddubsw %ymm8, %ymm0, %ymm8
; AVX512F-NEXT:    vpsllw $8, %ymm8, %ymm8
; AVX512F-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512F-NEXT:    vpmaddubsw %ymm9, %ymm5, %ymm9
; AVX512F-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm8, %zmm8
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm7 ^ (zmm8 | zmm10)
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512F-NEXT:    vpmullw %ymm5, %ymm9, %ymm10
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm11
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm11, %zmm10
; AVX512F-NEXT:    vpandq %zmm6, %zmm10, %zmm10
; AVX512F-NEXT:    vpandn %ymm7, %ymm6, %ymm7
; AVX512F-NEXT:    vpmaddubsw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vpsllw $8, %ymm7, %ymm7
; AVX512F-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512F-NEXT:    vpmaddubsw %ymm9, %ymm5, %ymm9
; AVX512F-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm7 = zmm8 ^ (zmm7 | zmm10)
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm1
; AVX512F-NEXT:    vextracti64x4 $1, %zmm1, %ymm8
; AVX512F-NEXT:    vpmullw %ymm5, %ymm8, %ymm9
; AVX512F-NEXT:    vpmullw %ymm1, %ymm0, %ymm10
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm10, %zmm9
; AVX512F-NEXT:    vpandq %zmm6, %zmm9, %zmm9
; AVX512F-NEXT:    vpandn %ymm1, %ymm6, %ymm1
; AVX512F-NEXT:    vpmaddubsw %ymm1, %ymm0, %ymm0
; AVX512F-NEXT:    vpsllw $8, %ymm0, %ymm0
; AVX512F-NEXT:    vpandn %ymm8, %ymm6, %ymm1
; AVX512F-NEXT:    vpmaddubsw %ymm1, %ymm5, %ymm1
; AVX512F-NEXT:    vpsllw $8, %ymm1, %ymm1
; AVX512F-NEXT:    vinserti64x4 $1, %ymm1, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm7 ^ (zmm0 | zmm9)
; AVX512F-NEXT:    vextracti64x4 $1, %zmm0, %ymm1
; AVX512F-NEXT:    vpand %ymm2, %ymm1, %ymm5
; AVX512F-NEXT:    vpshufb %ymm5, %ymm4, %ymm5
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm6
; AVX512F-NEXT:    vpshufb %ymm6, %ymm4, %ymm4
; AVX512F-NEXT:    vinserti64x4 $1, %ymm5, %zmm4, %zmm4
; AVX512F-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512F-NEXT:    vpand %ymm2, %ymm1, %ymm1
; AVX512F-NEXT:    vpshufb %ymm1, %ymm3, %ymm1
; AVX512F-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm0
; AVX512F-NEXT:    vpshufb %ymm0, %ymm3, %ymm0
; AVX512F-NEXT:    vinserti64x4 $1, %ymm1, %zmm0, %zmm0
; AVX512F-NEXT:    vporq %zmm0, %zmm4, %zmm0
; AVX512F-NEXT:    retq
;
; AVX512VL-LABEL: clmulr_v64i8:
; AVX512VL:       # %bb.0:
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm0, %ymm3
; AVX512VL-NEXT:    vpbroadcastd {{.*#+}} ymm2 = [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]
; AVX512VL-NEXT:    vpand %ymm2, %ymm3, %ymm5
; AVX512VL-NEXT:    vbroadcasti128 {{.*#+}} ymm4 = [0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240]
; AVX512VL-NEXT:    # ymm4 = mem[0,1,0,1]
; AVX512VL-NEXT:    vpshufb %ymm5, %ymm4, %ymm5
; AVX512VL-NEXT:    vpsrlw $4, %ymm3, %ymm3
; AVX512VL-NEXT:    vpand %ymm2, %ymm3, %ymm6
; AVX512VL-NEXT:    vbroadcasti128 {{.*#+}} ymm3 = [0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15,0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15]
; AVX512VL-NEXT:    # ymm3 = mem[0,1,0,1]
; AVX512VL-NEXT:    vpshufb %ymm6, %ymm3, %ymm6
; AVX512VL-NEXT:    vpor %ymm6, %ymm5, %ymm5
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm1, %ymm7
; AVX512VL-NEXT:    vpsrlw $4, %ymm7, %ymm6
; AVX512VL-NEXT:    vpand %ymm2, %ymm6, %ymm6
; AVX512VL-NEXT:    vpshufb %ymm6, %ymm3, %ymm6
; AVX512VL-NEXT:    vpsrlw $4, %ymm1, %ymm8
; AVX512VL-NEXT:    vpand %ymm2, %ymm8, %ymm8
; AVX512VL-NEXT:    vpshufb %ymm8, %ymm3, %ymm8
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm6, %zmm8, %zmm8
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm8, %zmm9
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm9, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm10, %ymm6
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm11
; AVX512VL-NEXT:    vpshufb %ymm11, %ymm4, %ymm11
; AVX512VL-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm0, %ymm3, %ymm0
; AVX512VL-NEXT:    vpor %ymm0, %ymm11, %ymm0
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm9, %ymm11
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm6, %zmm11, %zmm11
; AVX512VL-NEXT:    vpbroadcastd {{.*#+}} zmm6 = [255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0]
; AVX512VL-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512VL-NEXT:    vpmaddubsw %ymm9, %ymm0, %ymm9
; AVX512VL-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512VL-NEXT:    vpandn %ymm10, %ymm6, %ymm10
; AVX512VL-NEXT:    vpmaddubsw %ymm10, %ymm5, %ymm10
; AVX512VL-NEXT:    vpsllw $8, %ymm10, %ymm10
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 | (zmm11 & zmm6)
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm8, %zmm10
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm10, %ymm11
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm11, %ymm12
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm10, %ymm13
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm12, %zmm13, %zmm12
; AVX512VL-NEXT:    vpandq %zmm6, %zmm12, %zmm12
; AVX512VL-NEXT:    vpandn %ymm10, %ymm6, %ymm10
; AVX512VL-NEXT:    vpmaddubsw %ymm10, %ymm0, %ymm10
; AVX512VL-NEXT:    vpsllw $8, %ymm10, %ymm10
; AVX512VL-NEXT:    vpandn %ymm11, %ymm6, %ymm11
; AVX512VL-NEXT:    vpmaddubsw %ymm11, %ymm5, %ymm11
; AVX512VL-NEXT:    vpsllw $8, %ymm11, %ymm11
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm11, %zmm10, %zmm10
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm10 = zmm9 ^ (zmm10 | zmm12)
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm8, %zmm9
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm9, %ymm11
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm11, %ymm12
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm9, %ymm13
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm12, %zmm13, %zmm12
; AVX512VL-NEXT:    vpandq %zmm6, %zmm12, %zmm12
; AVX512VL-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512VL-NEXT:    vpmaddubsw %ymm9, %ymm0, %ymm9
; AVX512VL-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512VL-NEXT:    vpandn %ymm11, %ymm6, %ymm11
; AVX512VL-NEXT:    vpmaddubsw %ymm11, %ymm5, %ymm11
; AVX512VL-NEXT:    vpsllw $8, %ymm11, %ymm11
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm11, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm10 ^ (zmm9 | zmm12)
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm8, %zmm8
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm8, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm10, %ymm11
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm8, %ymm12
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm11, %zmm12, %zmm11
; AVX512VL-NEXT:    vpandq %zmm6, %zmm11, %zmm11
; AVX512VL-NEXT:    vpandn %ymm8, %ymm6, %ymm8
; AVX512VL-NEXT:    vpmaddubsw %ymm8, %ymm0, %ymm8
; AVX512VL-NEXT:    vpsllw $8, %ymm8, %ymm8
; AVX512VL-NEXT:    vpandn %ymm10, %ymm6, %ymm10
; AVX512VL-NEXT:    vpmaddubsw %ymm10, %ymm5, %ymm10
; AVX512VL-NEXT:    vpsllw $8, %ymm10, %ymm10
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm8, %zmm8
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm9 ^ (zmm8 | zmm11)
; AVX512VL-NEXT:    vpand %ymm2, %ymm7, %ymm7
; AVX512VL-NEXT:    vpshufb %ymm7, %ymm4, %ymm7
; AVX512VL-NEXT:    vpand %ymm2, %ymm1, %ymm1
; AVX512VL-NEXT:    vpshufb %ymm1, %ymm4, %ymm1
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm7, %zmm1, %zmm1
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm9, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm11
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm11, %zmm10
; AVX512VL-NEXT:    vpandq %zmm6, %zmm10, %zmm10
; AVX512VL-NEXT:    vpandn %ymm7, %ymm6, %ymm7
; AVX512VL-NEXT:    vpmaddubsw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vpsllw $8, %ymm7, %ymm7
; AVX512VL-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512VL-NEXT:    vpmaddubsw %ymm9, %ymm5, %ymm9
; AVX512VL-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm7 = zmm8 ^ (zmm7 | zmm10)
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm8, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm9, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm8, %ymm11
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm11, %zmm10
; AVX512VL-NEXT:    vpandq %zmm6, %zmm10, %zmm10
; AVX512VL-NEXT:    vpandn %ymm8, %ymm6, %ymm8
; AVX512VL-NEXT:    vpmaddubsw %ymm8, %ymm0, %ymm8
; AVX512VL-NEXT:    vpsllw $8, %ymm8, %ymm8
; AVX512VL-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512VL-NEXT:    vpmaddubsw %ymm9, %ymm5, %ymm9
; AVX512VL-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm8, %zmm8
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm7 ^ (zmm8 | zmm10)
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm9, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm11
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm11, %zmm10
; AVX512VL-NEXT:    vpandq %zmm6, %zmm10, %zmm10
; AVX512VL-NEXT:    vpandn %ymm7, %ymm6, %ymm7
; AVX512VL-NEXT:    vpmaddubsw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vpsllw $8, %ymm7, %ymm7
; AVX512VL-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512VL-NEXT:    vpmaddubsw %ymm9, %ymm5, %ymm9
; AVX512VL-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm7 = zmm8 ^ (zmm7 | zmm10)
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm1
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm1, %ymm8
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm8, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm1, %ymm0, %ymm10
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm10, %zmm9
; AVX512VL-NEXT:    vpandq %zmm6, %zmm9, %zmm9
; AVX512VL-NEXT:    vpandn %ymm1, %ymm6, %ymm1
; AVX512VL-NEXT:    vpmaddubsw %ymm1, %ymm0, %ymm0
; AVX512VL-NEXT:    vpsllw $8, %ymm0, %ymm0
; AVX512VL-NEXT:    vpandn %ymm8, %ymm6, %ymm1
; AVX512VL-NEXT:    vpmaddubsw %ymm1, %ymm5, %ymm1
; AVX512VL-NEXT:    vpsllw $8, %ymm1, %ymm1
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm1, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm7 ^ (zmm0 | zmm9)
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm0, %ymm1
; AVX512VL-NEXT:    vpand %ymm2, %ymm1, %ymm5
; AVX512VL-NEXT:    vpshufb %ymm5, %ymm4, %ymm5
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm6
; AVX512VL-NEXT:    vpshufb %ymm6, %ymm4, %ymm4
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm5, %zmm4, %zmm4
; AVX512VL-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512VL-NEXT:    vpand %ymm2, %ymm1, %ymm1
; AVX512VL-NEXT:    vpshufb %ymm1, %ymm3, %ymm1
; AVX512VL-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm0, %ymm3, %ymm0
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm1, %zmm0, %zmm0
; AVX512VL-NEXT:    vporq %zmm0, %zmm4, %zmm0
; AVX512VL-NEXT:    retq
  %a.ext = zext <64 x i8> %a to <64 x i16>
  %b.ext = zext <64 x i8> %b to <64 x i16>
  %clmul = call <64 x i16> @llvm.clmul.v64i16(<64 x i16> %a.ext, <64 x i16> %b.ext)
  %res.ext = lshr <64 x i16> %clmul, splat (i16 7)
  %res = trunc <64 x i16> %res.ext to <64 x i8>
  ret <64 x i8> %res
}

define <32 x i16> @clmulr_v32i16(<32 x i16> %a, <32 x i16> %b) nounwind {
; AVX512F-LABEL: clmulr_v32i16:
; AVX512F:       # %bb.0:
; AVX512F-NEXT:    vextracti64x4 $1, %zmm1, %ymm2
; AVX512F-NEXT:    vmovdqa {{.*#+}} ymm3 = [1,0,3,2,5,4,7,6,9,8,11,10,13,12,15,14,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30]
; AVX512F-NEXT:    vpshufb %ymm3, %ymm2, %ymm5
; AVX512F-NEXT:    vpbroadcastb {{.*#+}} ymm2 = [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]
; AVX512F-NEXT:    vpand %ymm2, %ymm5, %ymm6
; AVX512F-NEXT:    vbroadcasti128 {{.*#+}} ymm4 = [0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240]
; AVX512F-NEXT:    # ymm4 = mem[0,1,0,1]
; AVX512F-NEXT:    vpshufb %ymm6, %ymm4, %ymm6
; AVX512F-NEXT:    vpshufb %ymm3, %ymm1, %ymm7
; AVX512F-NEXT:    vpand %ymm2, %ymm7, %ymm1
; AVX512F-NEXT:    vpshufb %ymm1, %ymm4, %ymm1
; AVX512F-NEXT:    vinserti64x4 $1, %ymm6, %zmm1, %zmm6
; AVX512F-NEXT:    vpsrlw $4, %ymm5, %ymm1
; AVX512F-NEXT:    vpand %ymm2, %ymm1, %ymm5
; AVX512F-NEXT:    vbroadcasti128 {{.*#+}} ymm1 = [0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15,0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15]
; AVX512F-NEXT:    # ymm1 = mem[0,1,0,1]
; AVX512F-NEXT:    vpshufb %ymm5, %ymm1, %ymm5
; AVX512F-NEXT:    vpsrlw $4, %ymm7, %ymm7
; AVX512F-NEXT:    vpand %ymm2, %ymm7, %ymm7
; AVX512F-NEXT:    vpshufb %ymm7, %ymm1, %ymm7
; AVX512F-NEXT:    vinserti64x4 $1, %ymm5, %zmm7, %zmm5
; AVX512F-NEXT:    vporq %zmm5, %zmm6, %zmm5
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm8
; AVX512F-NEXT:    vextracti64x4 $1, %zmm0, %ymm6
; AVX512F-NEXT:    vpshufb %ymm3, %ymm6, %ymm6
; AVX512F-NEXT:    vpand %ymm2, %ymm6, %ymm9
; AVX512F-NEXT:    vpshufb %ymm9, %ymm4, %ymm9
; AVX512F-NEXT:    vpsrlw $4, %ymm6, %ymm6
; AVX512F-NEXT:    vpand %ymm2, %ymm6, %ymm6
; AVX512F-NEXT:    vpshufb %ymm6, %ymm1, %ymm6
; AVX512F-NEXT:    vpor %ymm6, %ymm9, %ymm6
; AVX512F-NEXT:    vpmullw %ymm6, %ymm8, %ymm8
; AVX512F-NEXT:    vpshufb %ymm3, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm9
; AVX512F-NEXT:    vpshufb %ymm9, %ymm4, %ymm9
; AVX512F-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm0
; AVX512F-NEXT:    vpshufb %ymm0, %ymm1, %ymm0
; AVX512F-NEXT:    vpor %ymm0, %ymm9, %ymm0
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vinserti64x4 $1, %ymm8, %zmm7, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512F-NEXT:    vextracti64x4 $1, %zmm8, %ymm9
; AVX512F-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512F-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm8, %zmm8
; AVX512F-NEXT:    vpxorq %zmm7, %zmm8, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512F-NEXT:    vextracti64x4 $1, %zmm8, %ymm9
; AVX512F-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512F-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm8, %zmm8
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm9
; AVX512F-NEXT:    vextracti64x4 $1, %zmm9, %ymm10
; AVX512F-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512F-NEXT:    vpmullw %ymm0, %ymm9, %ymm9
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm7 ^ zmm8
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm8
; AVX512F-NEXT:    vpmullw %ymm6, %ymm8, %ymm8
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vinserti64x4 $1, %ymm8, %zmm7, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512F-NEXT:    vextracti64x4 $1, %zmm8, %ymm10
; AVX512F-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512F-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm8, %zmm8
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512F-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm9
; AVX512F-NEXT:    vextracti64x4 $1, %zmm9, %ymm10
; AVX512F-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512F-NEXT:    vpmullw %ymm0, %ymm9, %ymm9
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm8
; AVX512F-NEXT:    vpmullw %ymm6, %ymm8, %ymm8
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vinserti64x4 $1, %ymm8, %zmm7, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512F-NEXT:    vextracti64x4 $1, %zmm8, %ymm10
; AVX512F-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512F-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm8, %zmm8
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512F-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm9
; AVX512F-NEXT:    vextracti64x4 $1, %zmm9, %ymm10
; AVX512F-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512F-NEXT:    vpmullw %ymm0, %ymm9, %ymm9
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm8
; AVX512F-NEXT:    vpmullw %ymm6, %ymm8, %ymm8
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vinserti64x4 $1, %ymm8, %zmm7, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512F-NEXT:    vextracti64x4 $1, %zmm8, %ymm10
; AVX512F-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512F-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm8, %zmm8
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512F-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm5
; AVX512F-NEXT:    vextracti64x4 $1, %zmm5, %ymm9
; AVX512F-NEXT:    vpmullw %ymm6, %ymm9, %ymm6
; AVX512F-NEXT:    vpmullw %ymm5, %ymm0, %ymm0
; AVX512F-NEXT:    vinserti64x4 $1, %ymm6, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm0 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm0, %ymm5
; AVX512F-NEXT:    vpshufb %ymm3, %ymm5, %ymm5
; AVX512F-NEXT:    vpand %ymm2, %ymm5, %ymm6
; AVX512F-NEXT:    vpshufb %ymm6, %ymm4, %ymm6
; AVX512F-NEXT:    vpshufb %ymm3, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm3
; AVX512F-NEXT:    vpshufb %ymm3, %ymm4, %ymm3
; AVX512F-NEXT:    vinserti64x4 $1, %ymm6, %zmm3, %zmm3
; AVX512F-NEXT:    vpsrlw $4, %ymm5, %ymm4
; AVX512F-NEXT:    vpand %ymm2, %ymm4, %ymm4
; AVX512F-NEXT:    vpshufb %ymm4, %ymm1, %ymm4
; AVX512F-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm0
; AVX512F-NEXT:    vpshufb %ymm0, %ymm1, %ymm0
; AVX512F-NEXT:    vinserti64x4 $1, %ymm4, %zmm0, %zmm0
; AVX512F-NEXT:    vporq %zmm0, %zmm3, %zmm0
; AVX512F-NEXT:    retq
;
; AVX512VL-LABEL: clmulr_v32i16:
; AVX512VL:       # %bb.0:
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm1, %ymm2
; AVX512VL-NEXT:    vmovdqa {{.*#+}} ymm3 = [1,0,3,2,5,4,7,6,9,8,11,10,13,12,15,14,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30]
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm2, %ymm5
; AVX512VL-NEXT:    vpbroadcastd {{.*#+}} ymm2 = [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]
; AVX512VL-NEXT:    vpand %ymm2, %ymm5, %ymm6
; AVX512VL-NEXT:    vbroadcasti128 {{.*#+}} ymm4 = [0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240]
; AVX512VL-NEXT:    # ymm4 = mem[0,1,0,1]
; AVX512VL-NEXT:    vpshufb %ymm6, %ymm4, %ymm6
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm1, %ymm7
; AVX512VL-NEXT:    vpand %ymm2, %ymm7, %ymm1
; AVX512VL-NEXT:    vpshufb %ymm1, %ymm4, %ymm1
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm6, %zmm1, %zmm6
; AVX512VL-NEXT:    vpsrlw $4, %ymm5, %ymm1
; AVX512VL-NEXT:    vpand %ymm2, %ymm1, %ymm5
; AVX512VL-NEXT:    vbroadcasti128 {{.*#+}} ymm1 = [0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15,0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15]
; AVX512VL-NEXT:    # ymm1 = mem[0,1,0,1]
; AVX512VL-NEXT:    vpshufb %ymm5, %ymm1, %ymm5
; AVX512VL-NEXT:    vpsrlw $4, %ymm7, %ymm7
; AVX512VL-NEXT:    vpand %ymm2, %ymm7, %ymm7
; AVX512VL-NEXT:    vpshufb %ymm7, %ymm1, %ymm7
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm5, %zmm7, %zmm5
; AVX512VL-NEXT:    vporq %zmm5, %zmm6, %zmm5
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm8
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm0, %ymm6
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm6, %ymm6
; AVX512VL-NEXT:    vpand %ymm2, %ymm6, %ymm9
; AVX512VL-NEXT:    vpshufb %ymm9, %ymm4, %ymm9
; AVX512VL-NEXT:    vpsrlw $4, %ymm6, %ymm6
; AVX512VL-NEXT:    vpand %ymm2, %ymm6, %ymm6
; AVX512VL-NEXT:    vpshufb %ymm6, %ymm1, %ymm6
; AVX512VL-NEXT:    vpor %ymm6, %ymm9, %ymm6
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm8, %ymm8
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm9
; AVX512VL-NEXT:    vpshufb %ymm9, %ymm4, %ymm9
; AVX512VL-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm0, %ymm1, %ymm0
; AVX512VL-NEXT:    vpor %ymm0, %ymm9, %ymm0
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm8, %zmm7, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm8, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm8, %zmm8
; AVX512VL-NEXT:    vpxorq %zmm7, %zmm8, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm8, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm8, %zmm8
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm9
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm9, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm9, %ymm9
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm7 ^ zmm8
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm8
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm8, %ymm8
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm8, %zmm7, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm8, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm8, %zmm8
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm9
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm9, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm9, %ymm9
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm8
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm8, %ymm8
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm8, %zmm7, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm8, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm8, %zmm8
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm9
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm9, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm9, %ymm9
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm8
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm8, %ymm8
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm8, %zmm7, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm8, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm8, %zmm8
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm5
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm5, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm9, %ymm6
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm0, %ymm0
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm6, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm0 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm0, %ymm5
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm5, %ymm5
; AVX512VL-NEXT:    vpand %ymm2, %ymm5, %ymm6
; AVX512VL-NEXT:    vpshufb %ymm6, %ymm4, %ymm6
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm3
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm4, %ymm3
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm6, %zmm3, %zmm3
; AVX512VL-NEXT:    vpsrlw $4, %ymm5, %ymm4
; AVX512VL-NEXT:    vpand %ymm2, %ymm4, %ymm4
; AVX512VL-NEXT:    vpshufb %ymm4, %ymm1, %ymm4
; AVX512VL-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm0, %ymm1, %ymm0
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm4, %zmm0, %zmm0
; AVX512VL-NEXT:    vporq %zmm0, %zmm3, %zmm0
; AVX512VL-NEXT:    retq
  %a.ext = zext <32 x i16> %a to <32 x i32>
  %b.ext = zext <32 x i16> %b to <32 x i32>
  %clmul = call <32 x i32> @llvm.clmul.v32i32(<32 x i32> %a.ext, <32 x i32> %b.ext)
  %res.ext = lshr <32 x i32> %clmul, splat (i32 15)
  %res = trunc <32 x i32> %res.ext to <32 x i16>
  ret <32 x i16> %res
}

define <16 x i32> @clmulr_v16i32(<16 x i32> %a, <16 x i32> %b) nounwind {
; AVX512F-LABEL: clmulr_v16i32:
; AVX512F:       # %bb.0:
; AVX512F-NEXT:    vextracti64x4 $1, %zmm0, %ymm2
; AVX512F-NEXT:    vmovdqa {{.*#+}} ymm3 = [3,128,1,128,7,128,5,128,11,128,9,128,15,128,13,128,19,128,17,128,23,128,21,128,27,128,25,128,31,128,29,128]
; AVX512F-NEXT:    vpshufb %ymm3, %ymm2, %ymm5
; AVX512F-NEXT:    vpbroadcastd {{.*#+}} ymm4 = [16711935,16711935,16711935,16711935,16711935,16711935,16711935,16711935]
; AVX512F-NEXT:    vpand %ymm4, %ymm2, %ymm2
; AVX512F-NEXT:    vprord $8, %zmm2, %zmm2
; AVX512F-NEXT:    vpor %ymm5, %ymm2, %ymm6
; AVX512F-NEXT:    vpbroadcastb {{.*#+}} ymm2 = [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]
; AVX512F-NEXT:    vpand %ymm2, %ymm6, %ymm7
; AVX512F-NEXT:    vbroadcasti128 {{.*#+}} ymm5 = [0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240]
; AVX512F-NEXT:    # ymm5 = mem[0,1,0,1]
; AVX512F-NEXT:    vpshufb %ymm7, %ymm5, %ymm7
; AVX512F-NEXT:    vpshufb %ymm3, %ymm0, %ymm8
; AVX512F-NEXT:    vpand %ymm4, %ymm0, %ymm0
; AVX512F-NEXT:    vprord $8, %zmm0, %zmm0
; AVX512F-NEXT:    vpor %ymm0, %ymm8, %ymm8
; AVX512F-NEXT:    vpand %ymm2, %ymm8, %ymm0
; AVX512F-NEXT:    vpshufb %ymm0, %ymm5, %ymm0
; AVX512F-NEXT:    vinserti64x4 $1, %ymm7, %zmm0, %zmm7
; AVX512F-NEXT:    vpsrlw $4, %ymm6, %ymm0
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm6
; AVX512F-NEXT:    vbroadcasti128 {{.*#+}} ymm0 = [0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15,0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15]
; AVX512F-NEXT:    # ymm0 = mem[0,1,0,1]
; AVX512F-NEXT:    vpshufb %ymm6, %ymm0, %ymm6
; AVX512F-NEXT:    vpsrlw $4, %ymm8, %ymm8
; AVX512F-NEXT:    vpand %ymm2, %ymm8, %ymm8
; AVX512F-NEXT:    vpshufb %ymm8, %ymm0, %ymm8
; AVX512F-NEXT:    vinserti64x4 $1, %ymm6, %zmm8, %zmm6
; AVX512F-NEXT:    vporq %zmm6, %zmm7, %zmm6
; AVX512F-NEXT:    vextracti64x4 $1, %zmm1, %ymm7
; AVX512F-NEXT:    vpshufb %ymm3, %ymm7, %ymm8
; AVX512F-NEXT:    vpand %ymm4, %ymm7, %ymm7
; AVX512F-NEXT:    vprord $8, %zmm7, %zmm7
; AVX512F-NEXT:    vpor %ymm7, %ymm8, %ymm7
; AVX512F-NEXT:    vpand %ymm2, %ymm7, %ymm8
; AVX512F-NEXT:    vpshufb %ymm8, %ymm5, %ymm8
; AVX512F-NEXT:    vpshufb %ymm3, %ymm1, %ymm9
; AVX512F-NEXT:    vpand %ymm4, %ymm1, %ymm1
; AVX512F-NEXT:    vprord $8, %zmm1, %zmm1
; AVX512F-NEXT:    vpor %ymm1, %ymm9, %ymm1
; AVX512F-NEXT:    vpand %ymm2, %ymm1, %ymm9
; AVX512F-NEXT:    vpshufb %ymm9, %ymm5, %ymm9
; AVX512F-NEXT:    vinserti64x4 $1, %ymm8, %zmm9, %zmm8
; AVX512F-NEXT:    vpsrlw $4, %ymm7, %ymm7
; AVX512F-NEXT:    vpand %ymm2, %ymm7, %ymm7
; AVX512F-NEXT:    vpshufb %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512F-NEXT:    vpand %ymm2, %ymm1, %ymm1
; AVX512F-NEXT:    vpshufb %ymm1, %ymm0, %ymm1
; AVX512F-NEXT:    vinserti64x4 $1, %ymm7, %zmm1, %zmm1
; AVX512F-NEXT:    vporq %zmm1, %zmm8, %zmm1
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpxord %zmm7, %zmm8, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm7 ^ zmm8
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm1
; AVX512F-NEXT:    vpmulld %zmm1, %zmm6, %zmm1
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm1 = zmm1 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm1, %ymm6
; AVX512F-NEXT:    vpshufb %ymm3, %ymm6, %ymm7
; AVX512F-NEXT:    vpand %ymm4, %ymm6, %ymm6
; AVX512F-NEXT:    vprord $8, %zmm6, %zmm6
; AVX512F-NEXT:    vpor %ymm7, %ymm6, %ymm6
; AVX512F-NEXT:    vpand %ymm2, %ymm6, %ymm7
; AVX512F-NEXT:    vpshufb %ymm7, %ymm5, %ymm7
; AVX512F-NEXT:    vpshufb %ymm3, %ymm1, %ymm3
; AVX512F-NEXT:    vpand %ymm4, %ymm1, %ymm1
; AVX512F-NEXT:    vprord $8, %zmm1, %zmm1
; AVX512F-NEXT:    vpor %ymm3, %ymm1, %ymm1
; AVX512F-NEXT:    vpand %ymm2, %ymm1, %ymm3
; AVX512F-NEXT:    vpshufb %ymm3, %ymm5, %ymm3
; AVX512F-NEXT:    vinserti64x4 $1, %ymm7, %zmm3, %zmm3
; AVX512F-NEXT:    vpsrlw $4, %ymm6, %ymm4
; AVX512F-NEXT:    vpand %ymm2, %ymm4, %ymm4
; AVX512F-NEXT:    vpshufb %ymm4, %ymm0, %ymm4
; AVX512F-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512F-NEXT:    vpand %ymm2, %ymm1, %ymm1
; AVX512F-NEXT:    vpshufb %ymm1, %ymm0, %ymm0
; AVX512F-NEXT:    vinserti64x4 $1, %ymm4, %zmm0, %zmm0
; AVX512F-NEXT:    vporq %zmm0, %zmm3, %zmm0
; AVX512F-NEXT:    retq
;
; AVX512VL-LABEL: clmulr_v16i32:
; AVX512VL:       # %bb.0:
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm0, %ymm2
; AVX512VL-NEXT:    vmovdqa {{.*#+}} ymm3 = [3,128,1,128,7,128,5,128,11,128,9,128,15,128,13,128,19,128,17,128,23,128,21,128,27,128,25,128,31,128,29,128]
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm2, %ymm5
; AVX512VL-NEXT:    vpbroadcastd {{.*#+}} ymm4 = [16711935,16711935,16711935,16711935,16711935,16711935,16711935,16711935]
; AVX512VL-NEXT:    vpand %ymm4, %ymm2, %ymm2
; AVX512VL-NEXT:    vprord $8, %ymm2, %ymm2
; AVX512VL-NEXT:    vpor %ymm5, %ymm2, %ymm6
; AVX512VL-NEXT:    vpbroadcastd {{.*#+}} ymm2 = [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]
; AVX512VL-NEXT:    vpand %ymm2, %ymm6, %ymm7
; AVX512VL-NEXT:    vbroadcasti128 {{.*#+}} ymm5 = [0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240]
; AVX512VL-NEXT:    # ymm5 = mem[0,1,0,1]
; AVX512VL-NEXT:    vpshufb %ymm7, %ymm5, %ymm7
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm0, %ymm8
; AVX512VL-NEXT:    vpand %ymm4, %ymm0, %ymm0
; AVX512VL-NEXT:    vprord $8, %ymm0, %ymm0
; AVX512VL-NEXT:    vpor %ymm0, %ymm8, %ymm8
; AVX512VL-NEXT:    vpand %ymm2, %ymm8, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm0, %ymm5, %ymm0
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm7, %zmm0, %zmm7
; AVX512VL-NEXT:    vpsrlw $4, %ymm6, %ymm0
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm6
; AVX512VL-NEXT:    vbroadcasti128 {{.*#+}} ymm0 = [0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15,0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15]
; AVX512VL-NEXT:    # ymm0 = mem[0,1,0,1]
; AVX512VL-NEXT:    vpshufb %ymm6, %ymm0, %ymm6
; AVX512VL-NEXT:    vpsrlw $4, %ymm8, %ymm8
; AVX512VL-NEXT:    vpand %ymm2, %ymm8, %ymm8
; AVX512VL-NEXT:    vpshufb %ymm8, %ymm0, %ymm8
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm6, %zmm8, %zmm6
; AVX512VL-NEXT:    vporq %zmm6, %zmm7, %zmm6
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm1, %ymm7
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm7, %ymm8
; AVX512VL-NEXT:    vpand %ymm4, %ymm7, %ymm7
; AVX512VL-NEXT:    vprord $8, %ymm7, %ymm7
; AVX512VL-NEXT:    vpor %ymm7, %ymm8, %ymm7
; AVX512VL-NEXT:    vpand %ymm2, %ymm7, %ymm8
; AVX512VL-NEXT:    vpshufb %ymm8, %ymm5, %ymm8
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm1, %ymm9
; AVX512VL-NEXT:    vpand %ymm4, %ymm1, %ymm1
; AVX512VL-NEXT:    vprord $8, %ymm1, %ymm1
; AVX512VL-NEXT:    vpor %ymm1, %ymm9, %ymm1
; AVX512VL-NEXT:    vpand %ymm2, %ymm1, %ymm9
; AVX512VL-NEXT:    vpshufb %ymm9, %ymm5, %ymm9
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm8, %zmm9, %zmm8
; AVX512VL-NEXT:    vpsrlw $4, %ymm7, %ymm7
; AVX512VL-NEXT:    vpand %ymm2, %ymm7, %ymm7
; AVX512VL-NEXT:    vpshufb %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512VL-NEXT:    vpand %ymm2, %ymm1, %ymm1
; AVX512VL-NEXT:    vpshufb %ymm1, %ymm0, %ymm1
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm7, %zmm1, %zmm1
; AVX512VL-NEXT:    vporq %zmm1, %zmm8, %zmm1
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpxord %zmm7, %zmm8, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm7 ^ zmm8
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm1
; AVX512VL-NEXT:    vpmulld %zmm1, %zmm6, %zmm1
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm1 = zmm1 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm1, %ymm6
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm6, %ymm7
; AVX512VL-NEXT:    vpand %ymm4, %ymm6, %ymm6
; AVX512VL-NEXT:    vprord $8, %ymm6, %ymm6
; AVX512VL-NEXT:    vpor %ymm7, %ymm6, %ymm6
; AVX512VL-NEXT:    vpand %ymm2, %ymm6, %ymm7
; AVX512VL-NEXT:    vpshufb %ymm7, %ymm5, %ymm7
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm1, %ymm3
; AVX512VL-NEXT:    vpand %ymm4, %ymm1, %ymm1
; AVX512VL-NEXT:    vprord $8, %ymm1, %ymm1
; AVX512VL-NEXT:    vpor %ymm3, %ymm1, %ymm1
; AVX512VL-NEXT:    vpand %ymm2, %ymm1, %ymm3
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm5, %ymm3
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm7, %zmm3, %zmm3
; AVX512VL-NEXT:    vpsrlw $4, %ymm6, %ymm4
; AVX512VL-NEXT:    vpand %ymm2, %ymm4, %ymm4
; AVX512VL-NEXT:    vpshufb %ymm4, %ymm0, %ymm4
; AVX512VL-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512VL-NEXT:    vpand %ymm2, %ymm1, %ymm1
; AVX512VL-NEXT:    vpshufb %ymm1, %ymm0, %ymm0
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm4, %zmm0, %zmm0
; AVX512VL-NEXT:    vporq %zmm0, %zmm3, %zmm0
; AVX512VL-NEXT:    retq
  %a.ext = zext <16 x i32> %a to <16 x i64>
  %b.ext = zext <16 x i32> %b to <16 x i64>
  %clmul = call <16 x i64> @llvm.clmul.v16i64(<16 x i64> %a.ext, <16 x i64> %b.ext)
  %res.ext = lshr <16 x i64> %clmul, splat (i64 31)
  %res = trunc <16 x i64> %res.ext to <16 x i32>
  ret <16 x i32> %res
}

define <8 x i64> @clmulr_v8i64(<8 x i64> %a, <8 x i64> %b) nounwind {
; AVX512F-LABEL: clmulr_v8i64:
; AVX512F:       # %bb.0:
; AVX512F-NEXT:    vextracti64x4 $1, %zmm0, %ymm2
; AVX512F-NEXT:    vmovdqa {{.*#+}} ymm15 = [7,6,5,4,3,2,1,0,15,14,13,12,11,10,9,8,23,22,21,20,19,18,17,16,31,30,29,28,27,26,25,24]
; AVX512F-NEXT:    vpshufb %ymm15, %ymm2, %ymm3
; AVX512F-NEXT:    vpbroadcastb {{.*#+}} ymm6 = [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]
; AVX512F-NEXT:    vpand %ymm6, %ymm3, %ymm4
; AVX512F-NEXT:    vbroadcasti128 {{.*#+}} ymm14 = [0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240]
; AVX512F-NEXT:    # ymm14 = mem[0,1,0,1]
; AVX512F-NEXT:    vpshufb %ymm4, %ymm14, %ymm4
; AVX512F-NEXT:    vpshufb %ymm15, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm6, %ymm0, %ymm5
; AVX512F-NEXT:    vpshufb %ymm5, %ymm14, %ymm5
; AVX512F-NEXT:    vinserti64x4 $1, %ymm4, %zmm5, %zmm4
; AVX512F-NEXT:    vpsrlw $4, %ymm3, %ymm3
; AVX512F-NEXT:    vpand %ymm6, %ymm3, %ymm3
; AVX512F-NEXT:    vbroadcasti128 {{.*#+}} ymm13 = [0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15,0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15]
; AVX512F-NEXT:    # ymm13 = mem[0,1,0,1]
; AVX512F-NEXT:    vpshufb %ymm3, %ymm13, %ymm3
; AVX512F-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm6, %ymm0, %ymm0
; AVX512F-NEXT:    vpshufb %ymm0, %ymm13, %ymm0
; AVX512F-NEXT:    vinserti64x4 $1, %ymm3, %zmm0, %zmm0
; AVX512F-NEXT:    vporq %zmm0, %zmm4, %zmm5
; AVX512F-NEXT:    vextracti64x4 $1, %zmm1, %ymm0
; AVX512F-NEXT:    vpshufb %ymm15, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm6, %ymm0, %ymm3
; AVX512F-NEXT:    vpshufb %ymm3, %ymm14, %ymm3
; AVX512F-NEXT:    vpshufb %ymm15, %ymm1, %ymm1
; AVX512F-NEXT:    vpand %ymm6, %ymm1, %ymm4
; AVX512F-NEXT:    vpshufb %ymm4, %ymm14, %ymm4
; AVX512F-NEXT:    vinserti64x4 $1, %ymm3, %zmm4, %zmm3
; AVX512F-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm6, %ymm0, %ymm0
; AVX512F-NEXT:    vpshufb %ymm0, %ymm13, %ymm0
; AVX512F-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512F-NEXT:    vpand %ymm6, %ymm1, %ymm1
; AVX512F-NEXT:    vpshufb %ymm1, %ymm13, %ymm1
; AVX512F-NEXT:    vinserti64x4 $1, %ymm0, %zmm1, %zmm0
; AVX512F-NEXT:    vporq %zmm0, %zmm3, %zmm1
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm3
; AVX512F-NEXT:    vpsrlq $32, %zmm5, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vporq %zmm0, %zmm3, %zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm16 = [512,512,512,512,512,512,512,512]
; AVX512F-NEXT:    vpandq %zmm16, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm17 = [1024,1024,1024,1024,1024,1024,1024,1024]
; AVX512F-NEXT:    vpandq %zmm17, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm18 = [2048,2048,2048,2048,2048,2048,2048,2048]
; AVX512F-NEXT:    vpandq %zmm18, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm19 = [4096,4096,4096,4096,4096,4096,4096,4096]
; AVX512F-NEXT:    vpandq %zmm19, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm20 = [8192,8192,8192,8192,8192,8192,8192,8192]
; AVX512F-NEXT:    vpandq %zmm20, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm21 = [16384,16384,16384,16384,16384,16384,16384,16384]
; AVX512F-NEXT:    vpandq %zmm21, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm22 = [32768,32768,32768,32768,32768,32768,32768,32768]
; AVX512F-NEXT:    vpandq %zmm22, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm23 = [65536,65536,65536,65536,65536,65536,65536,65536]
; AVX512F-NEXT:    vpandq %zmm23, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm24 = [131072,131072,131072,131072,131072,131072,131072,131072]
; AVX512F-NEXT:    vpandq %zmm24, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm25 = [262144,262144,262144,262144,262144,262144,262144,262144]
; AVX512F-NEXT:    vpandq %zmm25, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm26 = [524288,524288,524288,524288,524288,524288,524288,524288]
; AVX512F-NEXT:    vpandq %zmm26, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm27 = [1048576,1048576,1048576,1048576,1048576,1048576,1048576,1048576]
; AVX512F-NEXT:    vpandq %zmm27, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm28 = [2097152,2097152,2097152,2097152,2097152,2097152,2097152,2097152]
; AVX512F-NEXT:    vpandq %zmm28, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm29 = [4194304,4194304,4194304,4194304,4194304,4194304,4194304,4194304]
; AVX512F-NEXT:    vpandq %zmm29, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm30 = [8388608,8388608,8388608,8388608,8388608,8388608,8388608,8388608]
; AVX512F-NEXT:    vpandq %zmm30, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm31 = [16777216,16777216,16777216,16777216,16777216,16777216,16777216,16777216]
; AVX512F-NEXT:    vpandq %zmm31, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm12 = [33554432,33554432,33554432,33554432,33554432,33554432,33554432,33554432]
; AVX512F-NEXT:    vpandq %zmm12, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm11 = [67108864,67108864,67108864,67108864,67108864,67108864,67108864,67108864]
; AVX512F-NEXT:    vpandq %zmm11, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm10 = [134217728,134217728,134217728,134217728,134217728,134217728,134217728,134217728]
; AVX512F-NEXT:    vpandq %zmm10, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm8 = [268435456,268435456,268435456,268435456,268435456,268435456,268435456,268435456]
; AVX512F-NEXT:    vpandq %zmm8, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm7 = [536870912,536870912,536870912,536870912,536870912,536870912,536870912,536870912]
; AVX512F-NEXT:    vpandq %zmm7, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm2
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm2)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm4 = [1073741824,1073741824,1073741824,1073741824,1073741824,1073741824,1073741824,1073741824]
; AVX512F-NEXT:    vpandq %zmm4, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm2
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm2)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm2 = [2147483648,2147483648,2147483648,2147483648,2147483648,2147483648,2147483648,2147483648]
; AVX512F-NEXT:    vpandq %zmm2, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm0 ^ (zmm9 | zmm3)
; AVX512F-NEXT:    vpsrlq $32, %zmm1, %zmm1
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512F-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512F-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm16, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm17, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm18, %zmm1, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512F-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm19, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm20, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm21, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm22, %zmm1, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512F-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm23, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm24, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm25, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm26, %zmm1, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512F-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm27, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm28, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm29, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm30, %zmm1, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512F-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm31, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm12, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm11, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm10, %zmm1, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512F-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm8, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm7, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm4, %zmm1, %zmm0
; AVX512F-NEXT:    vpandq %zmm2, %zmm1, %zmm1
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm1, %zmm5, %zmm1
; AVX512F-NEXT:    vpsllq $32, %zmm1, %zmm1
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm1 = zmm1 ^ zmm3 ^ zmm0
; AVX512F-NEXT:    vextracti64x4 $1, %zmm1, %ymm0
; AVX512F-NEXT:    vpshufb {{.*#+}} ymm2 = ymm0[u,u,u,u,3],zero,zero,zero,ymm0[u,u,u,u,11],zero,zero,zero,ymm0[u,u,u,u,19],zero,zero,zero,ymm0[u,u,u,u,27],zero,zero,zero
; AVX512F-NEXT:    vpshufb {{.*#+}} ymm3 = ymm0[u,u,u,u],zero,ymm0[2],zero,zero,ymm0[u,u,u,u],zero,ymm0[10],zero,zero,ymm0[u,u,u,u],zero,ymm0[18],zero,zero,ymm0[u,u,u,u],zero,ymm0[26],zero,zero
; AVX512F-NEXT:    vpor %ymm2, %ymm3, %ymm2
; AVX512F-NEXT:    vpshufb {{.*#+}} ymm3 = ymm0[u,u,u,u],zero,zero,ymm0[1,0,u,u,u,u],zero,zero,ymm0[9,8,u,u,u,u],zero,zero,ymm0[17,16,u,u,u,u],zero,zero,ymm0[25,24]
; AVX512F-NEXT:    vpor %ymm2, %ymm3, %ymm2
; AVX512F-NEXT:    vpshufb {{.*#+}} ymm0 = ymm0[7,6,5,4,u,u,u,u,15,14,13,12,u,u,u,u,23,22,21,20,u,u,u,u,31,30,29,28,u,u,u,u]
; AVX512F-NEXT:    vpblendd {{.*#+}} ymm0 = ymm0[0],ymm2[1],ymm0[2],ymm2[3],ymm0[4],ymm2[5],ymm0[6],ymm2[7]
; AVX512F-NEXT:    vpand %ymm6, %ymm0, %ymm2
; AVX512F-NEXT:    vpshufb %ymm2, %ymm14, %ymm2
; AVX512F-NEXT:    vpshufb %ymm15, %ymm1, %ymm1
; AVX512F-NEXT:    vpand %ymm6, %ymm1, %ymm3
; AVX512F-NEXT:    vpshufb %ymm3, %ymm14, %ymm3
; AVX512F-NEXT:    vinserti64x4 $1, %ymm2, %zmm3, %zmm2
; AVX512F-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm6, %ymm0, %ymm0
; AVX512F-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512F-NEXT:    vpand %ymm6, %ymm1, %ymm1
; AVX512F-NEXT:    vpshufb %ymm0, %ymm13, %ymm0
; AVX512F-NEXT:    vpshufb %ymm1, %ymm13, %ymm1
; AVX512F-NEXT:    vinserti64x4 $1, %ymm0, %zmm1, %zmm0
; AVX512F-NEXT:    vporq %zmm0, %zmm2, %zmm0
; AVX512F-NEXT:    retq
;
; AVX512VL-LABEL: clmulr_v8i64:
; AVX512VL:       # %bb.0:
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm0, %ymm2
; AVX512VL-NEXT:    vmovdqa {{.*#+}} ymm15 = [7,6,5,4,3,2,1,0,15,14,13,12,11,10,9,8,23,22,21,20,19,18,17,16,31,30,29,28,27,26,25,24]
; AVX512VL-NEXT:    vpshufb %ymm15, %ymm2, %ymm3
; AVX512VL-NEXT:    vpbroadcastd {{.*#+}} ymm6 = [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]
; AVX512VL-NEXT:    vpand %ymm6, %ymm3, %ymm4
; AVX512VL-NEXT:    vbroadcasti128 {{.*#+}} ymm14 = [0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240]
; AVX512VL-NEXT:    # ymm14 = mem[0,1,0,1]
; AVX512VL-NEXT:    vpshufb %ymm4, %ymm14, %ymm4
; AVX512VL-NEXT:    vpshufb %ymm15, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm6, %ymm0, %ymm5
; AVX512VL-NEXT:    vpshufb %ymm5, %ymm14, %ymm5
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm4, %zmm5, %zmm4
; AVX512VL-NEXT:    vpsrlw $4, %ymm3, %ymm3
; AVX512VL-NEXT:    vpand %ymm6, %ymm3, %ymm3
; AVX512VL-NEXT:    vbroadcasti128 {{.*#+}} ymm13 = [0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15,0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15]
; AVX512VL-NEXT:    # ymm13 = mem[0,1,0,1]
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm13, %ymm3
; AVX512VL-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm6, %ymm0, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm0, %ymm13, %ymm0
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm3, %zmm0, %zmm0
; AVX512VL-NEXT:    vporq %zmm0, %zmm4, %zmm5
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm1, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm15, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm6, %ymm0, %ymm3
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm14, %ymm3
; AVX512VL-NEXT:    vpshufb %ymm15, %ymm1, %ymm1
; AVX512VL-NEXT:    vpand %ymm6, %ymm1, %ymm4
; AVX512VL-NEXT:    vpshufb %ymm4, %ymm14, %ymm4
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm3, %zmm4, %zmm3
; AVX512VL-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm6, %ymm0, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm0, %ymm13, %ymm0
; AVX512VL-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512VL-NEXT:    vpand %ymm6, %ymm1, %ymm1
; AVX512VL-NEXT:    vpshufb %ymm1, %ymm13, %ymm1
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm0, %zmm1, %zmm0
; AVX512VL-NEXT:    vporq %zmm0, %zmm3, %zmm1
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsrlq $32, %zmm5, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vporq %zmm0, %zmm3, %zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm16 = [512,512,512,512,512,512,512,512]
; AVX512VL-NEXT:    vpandq %zmm16, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm17 = [1024,1024,1024,1024,1024,1024,1024,1024]
; AVX512VL-NEXT:    vpandq %zmm17, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm18 = [2048,2048,2048,2048,2048,2048,2048,2048]
; AVX512VL-NEXT:    vpandq %zmm18, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm19 = [4096,4096,4096,4096,4096,4096,4096,4096]
; AVX512VL-NEXT:    vpandq %zmm19, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm20 = [8192,8192,8192,8192,8192,8192,8192,8192]
; AVX512VL-NEXT:    vpandq %zmm20, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm21 = [16384,16384,16384,16384,16384,16384,16384,16384]
; AVX512VL-NEXT:    vpandq %zmm21, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm22 = [32768,32768,32768,32768,32768,32768,32768,32768]
; AVX512VL-NEXT:    vpandq %zmm22, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm23 = [65536,65536,65536,65536,65536,65536,65536,65536]
; AVX512VL-NEXT:    vpandq %zmm23, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm24 = [131072,131072,131072,131072,131072,131072,131072,131072]
; AVX512VL-NEXT:    vpandq %zmm24, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm25 = [262144,262144,262144,262144,262144,262144,262144,262144]
; AVX512VL-NEXT:    vpandq %zmm25, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm26 = [524288,524288,524288,524288,524288,524288,524288,524288]
; AVX512VL-NEXT:    vpandq %zmm26, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm27 = [1048576,1048576,1048576,1048576,1048576,1048576,1048576,1048576]
; AVX512VL-NEXT:    vpandq %zmm27, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm28 = [2097152,2097152,2097152,2097152,2097152,2097152,2097152,2097152]
; AVX512VL-NEXT:    vpandq %zmm28, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm29 = [4194304,4194304,4194304,4194304,4194304,4194304,4194304,4194304]
; AVX512VL-NEXT:    vpandq %zmm29, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm30 = [8388608,8388608,8388608,8388608,8388608,8388608,8388608,8388608]
; AVX512VL-NEXT:    vpandq %zmm30, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm31 = [16777216,16777216,16777216,16777216,16777216,16777216,16777216,16777216]
; AVX512VL-NEXT:    vpandq %zmm31, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm12 = [33554432,33554432,33554432,33554432,33554432,33554432,33554432,33554432]
; AVX512VL-NEXT:    vpandq %zmm12, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm11 = [67108864,67108864,67108864,67108864,67108864,67108864,67108864,67108864]
; AVX512VL-NEXT:    vpandq %zmm11, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm10 = [134217728,134217728,134217728,134217728,134217728,134217728,134217728,134217728]
; AVX512VL-NEXT:    vpandq %zmm10, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm8 = [268435456,268435456,268435456,268435456,268435456,268435456,268435456,268435456]
; AVX512VL-NEXT:    vpandq %zmm8, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm7 = [536870912,536870912,536870912,536870912,536870912,536870912,536870912,536870912]
; AVX512VL-NEXT:    vpandq %zmm7, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm2
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm2)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm4 = [1073741824,1073741824,1073741824,1073741824,1073741824,1073741824,1073741824,1073741824]
; AVX512VL-NEXT:    vpandq %zmm4, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm2
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm2)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm2 = [2147483648,2147483648,2147483648,2147483648,2147483648,2147483648,2147483648,2147483648]
; AVX512VL-NEXT:    vpandq %zmm2, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm0 ^ (zmm9 | zmm3)
; AVX512VL-NEXT:    vpsrlq $32, %zmm1, %zmm1
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512VL-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512VL-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm16, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm17, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm18, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512VL-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm19, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm20, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm21, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm22, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512VL-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm23, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm24, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm25, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm26, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512VL-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm27, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm28, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm29, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm30, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512VL-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm31, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm12, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm11, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm10, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512VL-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm8, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm7, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm4, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm2, %zmm1, %zmm1
; AVX512VL-NEXT:    vpmuludq %zmm1, %zmm5, %zmm1
; AVX512VL-NEXT:    vpsllq $32, %zmm1, %zmm1
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm1 = zmm1 ^ zmm3 ^ zmm0
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm1, %ymm0
; AVX512VL-NEXT:    vpshufb {{.*#+}} ymm2 = ymm0[u,u,u,u,3],zero,zero,zero,ymm0[u,u,u,u,11],zero,zero,zero,ymm0[u,u,u,u,19],zero,zero,zero,ymm0[u,u,u,u,27],zero,zero,zero
; AVX512VL-NEXT:    vpshufb {{.*#+}} ymm3 = ymm0[u,u,u,u],zero,ymm0[2],zero,zero,ymm0[u,u,u,u],zero,ymm0[10],zero,zero,ymm0[u,u,u,u],zero,ymm0[18],zero,zero,ymm0[u,u,u,u],zero,ymm0[26],zero,zero
; AVX512VL-NEXT:    vpshufb {{.*#+}} ymm4 = ymm0[u,u,u,u],zero,zero,ymm0[1,0,u,u,u,u],zero,zero,ymm0[9,8,u,u,u,u],zero,zero,ymm0[17,16,u,u,u,u],zero,zero,ymm0[25,24]
; AVX512VL-NEXT:    vpternlogq {{.*#+}} ymm4 = ymm4 | ymm3 | ymm2
; AVX512VL-NEXT:    vpshufb {{.*#+}} ymm0 = ymm0[7,6,5,4,u,u,u,u,15,14,13,12,u,u,u,u,23,22,21,20,u,u,u,u,31,30,29,28,u,u,u,u]
; AVX512VL-NEXT:    vpblendd {{.*#+}} ymm0 = ymm0[0],ymm4[1],ymm0[2],ymm4[3],ymm0[4],ymm4[5],ymm0[6],ymm4[7]
; AVX512VL-NEXT:    vpand %ymm6, %ymm0, %ymm2
; AVX512VL-NEXT:    vpshufb %ymm2, %ymm14, %ymm2
; AVX512VL-NEXT:    vpshufb %ymm15, %ymm1, %ymm1
; AVX512VL-NEXT:    vpand %ymm6, %ymm1, %ymm3
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm14, %ymm3
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm2, %zmm3, %zmm2
; AVX512VL-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm6, %ymm0, %ymm0
; AVX512VL-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512VL-NEXT:    vpand %ymm6, %ymm1, %ymm1
; AVX512VL-NEXT:    vpshufb %ymm0, %ymm13, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm1, %ymm13, %ymm1
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm0, %zmm1, %zmm0
; AVX512VL-NEXT:    vporq %zmm0, %zmm2, %zmm0
; AVX512VL-NEXT:    retq
  %a.ext = zext <8 x i64> %a to <8 x i128>
  %b.ext = zext <8 x i64> %b to <8 x i128>
  %clmul = call <8 x i128> @llvm.clmul.v8i128(<8 x i128> %a.ext, <8 x i128> %b.ext)
  %res.ext = lshr <8 x i128> %clmul, splat (i128 63)
  %res = trunc <8 x i128> %res.ext to <8 x i64>
  ret <8 x i64> %res
}

define <64 x i8> @clmulh_v64i8(<64 x i8> %a, <64 x i8> %b) nounwind {
; AVX512F-LABEL: clmulh_v64i8:
; AVX512F:       # %bb.0:
; AVX512F-NEXT:    vextracti64x4 $1, %zmm0, %ymm4
; AVX512F-NEXT:    vpbroadcastb {{.*#+}} ymm2 = [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]
; AVX512F-NEXT:    vpand %ymm2, %ymm4, %ymm5
; AVX512F-NEXT:    vbroadcasti128 {{.*#+}} ymm3 = [0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240]
; AVX512F-NEXT:    # ymm3 = mem[0,1,0,1]
; AVX512F-NEXT:    vpshufb %ymm5, %ymm3, %ymm5
; AVX512F-NEXT:    vpsrlw $4, %ymm4, %ymm4
; AVX512F-NEXT:    vpand %ymm2, %ymm4, %ymm6
; AVX512F-NEXT:    vbroadcasti128 {{.*#+}} ymm4 = [0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15,0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15]
; AVX512F-NEXT:    # ymm4 = mem[0,1,0,1]
; AVX512F-NEXT:    vpshufb %ymm6, %ymm4, %ymm6
; AVX512F-NEXT:    vpor %ymm6, %ymm5, %ymm5
; AVX512F-NEXT:    vextracti64x4 $1, %zmm1, %ymm7
; AVX512F-NEXT:    vpsrlw $4, %ymm7, %ymm6
; AVX512F-NEXT:    vpand %ymm2, %ymm6, %ymm6
; AVX512F-NEXT:    vpshufb %ymm6, %ymm4, %ymm6
; AVX512F-NEXT:    vpsrlw $4, %ymm1, %ymm8
; AVX512F-NEXT:    vpand %ymm2, %ymm8, %ymm8
; AVX512F-NEXT:    vpshufb %ymm8, %ymm4, %ymm8
; AVX512F-NEXT:    vinserti64x4 $1, %ymm6, %zmm8, %zmm8
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm8, %zmm9
; AVX512F-NEXT:    vextracti64x4 $1, %zmm9, %ymm10
; AVX512F-NEXT:    vpmullw %ymm5, %ymm10, %ymm6
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm11
; AVX512F-NEXT:    vpshufb %ymm11, %ymm3, %ymm11
; AVX512F-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm0
; AVX512F-NEXT:    vpshufb %ymm0, %ymm4, %ymm0
; AVX512F-NEXT:    vpor %ymm0, %ymm11, %ymm0
; AVX512F-NEXT:    vpmullw %ymm0, %ymm9, %ymm11
; AVX512F-NEXT:    vinserti64x4 $1, %ymm6, %zmm11, %zmm11
; AVX512F-NEXT:    vpbroadcastd {{.*#+}} zmm6 = [255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0]
; AVX512F-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512F-NEXT:    vpmaddubsw %ymm9, %ymm0, %ymm9
; AVX512F-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512F-NEXT:    vpandn %ymm10, %ymm6, %ymm10
; AVX512F-NEXT:    vpmaddubsw %ymm10, %ymm5, %ymm10
; AVX512F-NEXT:    vpsllw $8, %ymm10, %ymm10
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 | (zmm11 & zmm6)
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm8, %zmm10
; AVX512F-NEXT:    vextracti64x4 $1, %zmm10, %ymm11
; AVX512F-NEXT:    vpmullw %ymm5, %ymm11, %ymm12
; AVX512F-NEXT:    vpmullw %ymm0, %ymm10, %ymm13
; AVX512F-NEXT:    vinserti64x4 $1, %ymm12, %zmm13, %zmm12
; AVX512F-NEXT:    vpandq %zmm6, %zmm12, %zmm12
; AVX512F-NEXT:    vpandn %ymm10, %ymm6, %ymm10
; AVX512F-NEXT:    vpmaddubsw %ymm10, %ymm0, %ymm10
; AVX512F-NEXT:    vpsllw $8, %ymm10, %ymm10
; AVX512F-NEXT:    vpandn %ymm11, %ymm6, %ymm11
; AVX512F-NEXT:    vpmaddubsw %ymm11, %ymm5, %ymm11
; AVX512F-NEXT:    vpsllw $8, %ymm11, %ymm11
; AVX512F-NEXT:    vinserti64x4 $1, %ymm11, %zmm10, %zmm10
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm10 = zmm9 ^ (zmm10 | zmm12)
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm8, %zmm9
; AVX512F-NEXT:    vextracti64x4 $1, %zmm9, %ymm11
; AVX512F-NEXT:    vpmullw %ymm5, %ymm11, %ymm12
; AVX512F-NEXT:    vpmullw %ymm0, %ymm9, %ymm13
; AVX512F-NEXT:    vinserti64x4 $1, %ymm12, %zmm13, %zmm12
; AVX512F-NEXT:    vpandq %zmm6, %zmm12, %zmm12
; AVX512F-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512F-NEXT:    vpmaddubsw %ymm9, %ymm0, %ymm9
; AVX512F-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512F-NEXT:    vpandn %ymm11, %ymm6, %ymm11
; AVX512F-NEXT:    vpmaddubsw %ymm11, %ymm5, %ymm11
; AVX512F-NEXT:    vpsllw $8, %ymm11, %ymm11
; AVX512F-NEXT:    vinserti64x4 $1, %ymm11, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm10 ^ (zmm9 | zmm12)
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm8, %zmm8
; AVX512F-NEXT:    vextracti64x4 $1, %zmm8, %ymm10
; AVX512F-NEXT:    vpmullw %ymm5, %ymm10, %ymm11
; AVX512F-NEXT:    vpmullw %ymm0, %ymm8, %ymm12
; AVX512F-NEXT:    vinserti64x4 $1, %ymm11, %zmm12, %zmm11
; AVX512F-NEXT:    vpandq %zmm6, %zmm11, %zmm11
; AVX512F-NEXT:    vpandn %ymm8, %ymm6, %ymm8
; AVX512F-NEXT:    vpmaddubsw %ymm8, %ymm0, %ymm8
; AVX512F-NEXT:    vpsllw $8, %ymm8, %ymm8
; AVX512F-NEXT:    vpandn %ymm10, %ymm6, %ymm10
; AVX512F-NEXT:    vpmaddubsw %ymm10, %ymm5, %ymm10
; AVX512F-NEXT:    vpsllw $8, %ymm10, %ymm10
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm8, %zmm8
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm9 ^ (zmm8 | zmm11)
; AVX512F-NEXT:    vpand %ymm2, %ymm7, %ymm7
; AVX512F-NEXT:    vpshufb %ymm7, %ymm3, %ymm7
; AVX512F-NEXT:    vpand %ymm2, %ymm1, %ymm1
; AVX512F-NEXT:    vpshufb %ymm1, %ymm3, %ymm1
; AVX512F-NEXT:    vinserti64x4 $1, %ymm7, %zmm1, %zmm1
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512F-NEXT:    vpmullw %ymm5, %ymm9, %ymm10
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm11
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm11, %zmm10
; AVX512F-NEXT:    vpandq %zmm6, %zmm10, %zmm10
; AVX512F-NEXT:    vpandn %ymm7, %ymm6, %ymm7
; AVX512F-NEXT:    vpmaddubsw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vpsllw $8, %ymm7, %ymm7
; AVX512F-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512F-NEXT:    vpmaddubsw %ymm9, %ymm5, %ymm9
; AVX512F-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm7 = zmm8 ^ (zmm7 | zmm10)
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vextracti64x4 $1, %zmm8, %ymm9
; AVX512F-NEXT:    vpmullw %ymm5, %ymm9, %ymm10
; AVX512F-NEXT:    vpmullw %ymm0, %ymm8, %ymm11
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm11, %zmm10
; AVX512F-NEXT:    vpandq %zmm6, %zmm10, %zmm10
; AVX512F-NEXT:    vpandn %ymm8, %ymm6, %ymm8
; AVX512F-NEXT:    vpmaddubsw %ymm8, %ymm0, %ymm8
; AVX512F-NEXT:    vpsllw $8, %ymm8, %ymm8
; AVX512F-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512F-NEXT:    vpmaddubsw %ymm9, %ymm5, %ymm9
; AVX512F-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm8, %zmm8
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm7 ^ (zmm8 | zmm10)
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512F-NEXT:    vpmullw %ymm5, %ymm9, %ymm10
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm11
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm11, %zmm10
; AVX512F-NEXT:    vpandq %zmm6, %zmm10, %zmm10
; AVX512F-NEXT:    vpandn %ymm7, %ymm6, %ymm7
; AVX512F-NEXT:    vpmaddubsw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vpsllw $8, %ymm7, %ymm7
; AVX512F-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512F-NEXT:    vpmaddubsw %ymm9, %ymm5, %ymm9
; AVX512F-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm7 = zmm8 ^ (zmm7 | zmm10)
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm1
; AVX512F-NEXT:    vextracti64x4 $1, %zmm1, %ymm8
; AVX512F-NEXT:    vpmullw %ymm5, %ymm8, %ymm9
; AVX512F-NEXT:    vpmullw %ymm1, %ymm0, %ymm10
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm10, %zmm9
; AVX512F-NEXT:    vpandq %zmm6, %zmm9, %zmm9
; AVX512F-NEXT:    vpandn %ymm1, %ymm6, %ymm1
; AVX512F-NEXT:    vpmaddubsw %ymm1, %ymm0, %ymm0
; AVX512F-NEXT:    vpsllw $8, %ymm0, %ymm0
; AVX512F-NEXT:    vpandn %ymm8, %ymm6, %ymm1
; AVX512F-NEXT:    vpmaddubsw %ymm1, %ymm5, %ymm1
; AVX512F-NEXT:    vpsllw $8, %ymm1, %ymm1
; AVX512F-NEXT:    vinserti64x4 $1, %ymm1, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm7 ^ (zmm0 | zmm9)
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm1
; AVX512F-NEXT:    vpshufb %ymm1, %ymm3, %ymm1
; AVX512F-NEXT:    vpsrlw $4, %ymm0, %ymm5
; AVX512F-NEXT:    vpand %ymm2, %ymm5, %ymm5
; AVX512F-NEXT:    vpshufb %ymm5, %ymm4, %ymm5
; AVX512F-NEXT:    vpor %ymm5, %ymm1, %ymm1
; AVX512F-NEXT:    vpsrlw $1, %ymm1, %ymm1
; AVX512F-NEXT:    vextracti64x4 $1, %zmm0, %ymm0
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm5
; AVX512F-NEXT:    vpshufb %ymm5, %ymm3, %ymm3
; AVX512F-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm0
; AVX512F-NEXT:    vpshufb %ymm0, %ymm4, %ymm0
; AVX512F-NEXT:    vpor %ymm0, %ymm3, %ymm0
; AVX512F-NEXT:    vpsrlw $1, %ymm0, %ymm0
; AVX512F-NEXT:    vinserti64x4 $1, %ymm0, %zmm1, %zmm0
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm0, %zmm0
; AVX512F-NEXT:    retq
;
; AVX512VL-LABEL: clmulh_v64i8:
; AVX512VL:       # %bb.0:
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm0, %ymm4
; AVX512VL-NEXT:    vpbroadcastd {{.*#+}} ymm2 = [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]
; AVX512VL-NEXT:    vpand %ymm2, %ymm4, %ymm5
; AVX512VL-NEXT:    vbroadcasti128 {{.*#+}} ymm3 = [0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240]
; AVX512VL-NEXT:    # ymm3 = mem[0,1,0,1]
; AVX512VL-NEXT:    vpshufb %ymm5, %ymm3, %ymm5
; AVX512VL-NEXT:    vpsrlw $4, %ymm4, %ymm4
; AVX512VL-NEXT:    vpand %ymm2, %ymm4, %ymm6
; AVX512VL-NEXT:    vbroadcasti128 {{.*#+}} ymm4 = [0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15,0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15]
; AVX512VL-NEXT:    # ymm4 = mem[0,1,0,1]
; AVX512VL-NEXT:    vpshufb %ymm6, %ymm4, %ymm6
; AVX512VL-NEXT:    vpor %ymm6, %ymm5, %ymm5
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm1, %ymm7
; AVX512VL-NEXT:    vpsrlw $4, %ymm7, %ymm6
; AVX512VL-NEXT:    vpand %ymm2, %ymm6, %ymm6
; AVX512VL-NEXT:    vpshufb %ymm6, %ymm4, %ymm6
; AVX512VL-NEXT:    vpsrlw $4, %ymm1, %ymm8
; AVX512VL-NEXT:    vpand %ymm2, %ymm8, %ymm8
; AVX512VL-NEXT:    vpshufb %ymm8, %ymm4, %ymm8
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm6, %zmm8, %zmm8
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm8, %zmm9
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm9, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm10, %ymm6
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm11
; AVX512VL-NEXT:    vpshufb %ymm11, %ymm3, %ymm11
; AVX512VL-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm0, %ymm4, %ymm0
; AVX512VL-NEXT:    vpor %ymm0, %ymm11, %ymm0
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm9, %ymm11
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm6, %zmm11, %zmm11
; AVX512VL-NEXT:    vpbroadcastd {{.*#+}} zmm6 = [255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0,255,0]
; AVX512VL-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512VL-NEXT:    vpmaddubsw %ymm9, %ymm0, %ymm9
; AVX512VL-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512VL-NEXT:    vpandn %ymm10, %ymm6, %ymm10
; AVX512VL-NEXT:    vpmaddubsw %ymm10, %ymm5, %ymm10
; AVX512VL-NEXT:    vpsllw $8, %ymm10, %ymm10
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 | (zmm11 & zmm6)
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm8, %zmm10
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm10, %ymm11
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm11, %ymm12
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm10, %ymm13
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm12, %zmm13, %zmm12
; AVX512VL-NEXT:    vpandq %zmm6, %zmm12, %zmm12
; AVX512VL-NEXT:    vpandn %ymm10, %ymm6, %ymm10
; AVX512VL-NEXT:    vpmaddubsw %ymm10, %ymm0, %ymm10
; AVX512VL-NEXT:    vpsllw $8, %ymm10, %ymm10
; AVX512VL-NEXT:    vpandn %ymm11, %ymm6, %ymm11
; AVX512VL-NEXT:    vpmaddubsw %ymm11, %ymm5, %ymm11
; AVX512VL-NEXT:    vpsllw $8, %ymm11, %ymm11
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm11, %zmm10, %zmm10
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm10 = zmm9 ^ (zmm10 | zmm12)
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm8, %zmm9
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm9, %ymm11
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm11, %ymm12
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm9, %ymm13
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm12, %zmm13, %zmm12
; AVX512VL-NEXT:    vpandq %zmm6, %zmm12, %zmm12
; AVX512VL-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512VL-NEXT:    vpmaddubsw %ymm9, %ymm0, %ymm9
; AVX512VL-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512VL-NEXT:    vpandn %ymm11, %ymm6, %ymm11
; AVX512VL-NEXT:    vpmaddubsw %ymm11, %ymm5, %ymm11
; AVX512VL-NEXT:    vpsllw $8, %ymm11, %ymm11
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm11, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm10 ^ (zmm9 | zmm12)
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm8, %zmm8
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm8, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm10, %ymm11
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm8, %ymm12
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm11, %zmm12, %zmm11
; AVX512VL-NEXT:    vpandq %zmm6, %zmm11, %zmm11
; AVX512VL-NEXT:    vpandn %ymm8, %ymm6, %ymm8
; AVX512VL-NEXT:    vpmaddubsw %ymm8, %ymm0, %ymm8
; AVX512VL-NEXT:    vpsllw $8, %ymm8, %ymm8
; AVX512VL-NEXT:    vpandn %ymm10, %ymm6, %ymm10
; AVX512VL-NEXT:    vpmaddubsw %ymm10, %ymm5, %ymm10
; AVX512VL-NEXT:    vpsllw $8, %ymm10, %ymm10
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm8, %zmm8
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm9 ^ (zmm8 | zmm11)
; AVX512VL-NEXT:    vpand %ymm2, %ymm7, %ymm7
; AVX512VL-NEXT:    vpshufb %ymm7, %ymm3, %ymm7
; AVX512VL-NEXT:    vpand %ymm2, %ymm1, %ymm1
; AVX512VL-NEXT:    vpshufb %ymm1, %ymm3, %ymm1
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm7, %zmm1, %zmm1
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm9, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm11
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm11, %zmm10
; AVX512VL-NEXT:    vpandq %zmm6, %zmm10, %zmm10
; AVX512VL-NEXT:    vpandn %ymm7, %ymm6, %ymm7
; AVX512VL-NEXT:    vpmaddubsw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vpsllw $8, %ymm7, %ymm7
; AVX512VL-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512VL-NEXT:    vpmaddubsw %ymm9, %ymm5, %ymm9
; AVX512VL-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm7 = zmm8 ^ (zmm7 | zmm10)
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm8, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm9, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm8, %ymm11
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm11, %zmm10
; AVX512VL-NEXT:    vpandq %zmm6, %zmm10, %zmm10
; AVX512VL-NEXT:    vpandn %ymm8, %ymm6, %ymm8
; AVX512VL-NEXT:    vpmaddubsw %ymm8, %ymm0, %ymm8
; AVX512VL-NEXT:    vpsllw $8, %ymm8, %ymm8
; AVX512VL-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512VL-NEXT:    vpmaddubsw %ymm9, %ymm5, %ymm9
; AVX512VL-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm8, %zmm8
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm7 ^ (zmm8 | zmm10)
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm9, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm11
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm11, %zmm10
; AVX512VL-NEXT:    vpandq %zmm6, %zmm10, %zmm10
; AVX512VL-NEXT:    vpandn %ymm7, %ymm6, %ymm7
; AVX512VL-NEXT:    vpmaddubsw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vpsllw $8, %ymm7, %ymm7
; AVX512VL-NEXT:    vpandn %ymm9, %ymm6, %ymm9
; AVX512VL-NEXT:    vpmaddubsw %ymm9, %ymm5, %ymm9
; AVX512VL-NEXT:    vpsllw $8, %ymm9, %ymm9
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm7 = zmm8 ^ (zmm7 | zmm10)
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm1
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm1, %ymm8
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm8, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm1, %ymm0, %ymm10
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm10, %zmm9
; AVX512VL-NEXT:    vpandq %zmm6, %zmm9, %zmm9
; AVX512VL-NEXT:    vpandn %ymm1, %ymm6, %ymm1
; AVX512VL-NEXT:    vpmaddubsw %ymm1, %ymm0, %ymm0
; AVX512VL-NEXT:    vpsllw $8, %ymm0, %ymm0
; AVX512VL-NEXT:    vpandn %ymm8, %ymm6, %ymm1
; AVX512VL-NEXT:    vpmaddubsw %ymm1, %ymm5, %ymm1
; AVX512VL-NEXT:    vpsllw $8, %ymm1, %ymm1
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm1, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm7 ^ (zmm0 | zmm9)
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm1
; AVX512VL-NEXT:    vpshufb %ymm1, %ymm3, %ymm1
; AVX512VL-NEXT:    vpsrlw $4, %ymm0, %ymm5
; AVX512VL-NEXT:    vpand %ymm2, %ymm5, %ymm5
; AVX512VL-NEXT:    vpshufb %ymm5, %ymm4, %ymm5
; AVX512VL-NEXT:    vpor %ymm5, %ymm1, %ymm1
; AVX512VL-NEXT:    vpsrlw $1, %ymm1, %ymm1
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm5
; AVX512VL-NEXT:    vpshufb %ymm5, %ymm3, %ymm3
; AVX512VL-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm0, %ymm4, %ymm0
; AVX512VL-NEXT:    vpor %ymm0, %ymm3, %ymm0
; AVX512VL-NEXT:    vpsrlw $1, %ymm0, %ymm0
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm0, %zmm1, %zmm0
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm0, %zmm0
; AVX512VL-NEXT:    retq
  %a.ext = zext <64 x i8> %a to <64 x i16>
  %b.ext = zext <64 x i8> %b to <64 x i16>
  %clmul = call <64 x i16> @llvm.clmul.v64i16(<64 x i16> %a.ext, <64 x i16> %b.ext)
  %res.ext = lshr <64 x i16> %clmul, splat (i16 8)
  %res = trunc <64 x i16> %res.ext to <64 x i8>
  ret <64 x i8> %res
}

define <32 x i16> @clmulh_v32i16(<32 x i16> %a, <32 x i16> %b) nounwind {
; AVX512F-LABEL: clmulh_v32i16:
; AVX512F:       # %bb.0:
; AVX512F-NEXT:    vextracti64x4 $1, %zmm1, %ymm2
; AVX512F-NEXT:    vmovdqa {{.*#+}} ymm3 = [1,0,3,2,5,4,7,6,9,8,11,10,13,12,15,14,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30]
; AVX512F-NEXT:    vpshufb %ymm3, %ymm2, %ymm5
; AVX512F-NEXT:    vpbroadcastb {{.*#+}} ymm2 = [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]
; AVX512F-NEXT:    vpand %ymm2, %ymm5, %ymm6
; AVX512F-NEXT:    vbroadcasti128 {{.*#+}} ymm4 = [0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240]
; AVX512F-NEXT:    # ymm4 = mem[0,1,0,1]
; AVX512F-NEXT:    vpshufb %ymm6, %ymm4, %ymm6
; AVX512F-NEXT:    vpshufb %ymm3, %ymm1, %ymm7
; AVX512F-NEXT:    vpand %ymm2, %ymm7, %ymm1
; AVX512F-NEXT:    vpshufb %ymm1, %ymm4, %ymm1
; AVX512F-NEXT:    vinserti64x4 $1, %ymm6, %zmm1, %zmm6
; AVX512F-NEXT:    vpsrlw $4, %ymm5, %ymm1
; AVX512F-NEXT:    vpand %ymm2, %ymm1, %ymm5
; AVX512F-NEXT:    vbroadcasti128 {{.*#+}} ymm1 = [0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15,0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15]
; AVX512F-NEXT:    # ymm1 = mem[0,1,0,1]
; AVX512F-NEXT:    vpshufb %ymm5, %ymm1, %ymm5
; AVX512F-NEXT:    vpsrlw $4, %ymm7, %ymm7
; AVX512F-NEXT:    vpand %ymm2, %ymm7, %ymm7
; AVX512F-NEXT:    vpshufb %ymm7, %ymm1, %ymm7
; AVX512F-NEXT:    vinserti64x4 $1, %ymm5, %zmm7, %zmm5
; AVX512F-NEXT:    vporq %zmm5, %zmm6, %zmm5
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm8
; AVX512F-NEXT:    vextracti64x4 $1, %zmm0, %ymm6
; AVX512F-NEXT:    vpshufb %ymm3, %ymm6, %ymm6
; AVX512F-NEXT:    vpand %ymm2, %ymm6, %ymm9
; AVX512F-NEXT:    vpshufb %ymm9, %ymm4, %ymm9
; AVX512F-NEXT:    vpsrlw $4, %ymm6, %ymm6
; AVX512F-NEXT:    vpand %ymm2, %ymm6, %ymm6
; AVX512F-NEXT:    vpshufb %ymm6, %ymm1, %ymm6
; AVX512F-NEXT:    vpor %ymm6, %ymm9, %ymm6
; AVX512F-NEXT:    vpmullw %ymm6, %ymm8, %ymm8
; AVX512F-NEXT:    vpshufb %ymm3, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm9
; AVX512F-NEXT:    vpshufb %ymm9, %ymm4, %ymm9
; AVX512F-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm0
; AVX512F-NEXT:    vpshufb %ymm0, %ymm1, %ymm0
; AVX512F-NEXT:    vpor %ymm0, %ymm9, %ymm0
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vinserti64x4 $1, %ymm8, %zmm7, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512F-NEXT:    vextracti64x4 $1, %zmm8, %ymm9
; AVX512F-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512F-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm8, %zmm8
; AVX512F-NEXT:    vpxorq %zmm7, %zmm8, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512F-NEXT:    vextracti64x4 $1, %zmm8, %ymm9
; AVX512F-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512F-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm8, %zmm8
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm9
; AVX512F-NEXT:    vextracti64x4 $1, %zmm9, %ymm10
; AVX512F-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512F-NEXT:    vpmullw %ymm0, %ymm9, %ymm9
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm7 ^ zmm8
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm8
; AVX512F-NEXT:    vpmullw %ymm6, %ymm8, %ymm8
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vinserti64x4 $1, %ymm8, %zmm7, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512F-NEXT:    vextracti64x4 $1, %zmm8, %ymm10
; AVX512F-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512F-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm8, %zmm8
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512F-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm9
; AVX512F-NEXT:    vextracti64x4 $1, %zmm9, %ymm10
; AVX512F-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512F-NEXT:    vpmullw %ymm0, %ymm9, %ymm9
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm8
; AVX512F-NEXT:    vpmullw %ymm6, %ymm8, %ymm8
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vinserti64x4 $1, %ymm8, %zmm7, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512F-NEXT:    vextracti64x4 $1, %zmm8, %ymm10
; AVX512F-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512F-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm8, %zmm8
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512F-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm9
; AVX512F-NEXT:    vextracti64x4 $1, %zmm9, %ymm10
; AVX512F-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512F-NEXT:    vpmullw %ymm0, %ymm9, %ymm9
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm8
; AVX512F-NEXT:    vpmullw %ymm6, %ymm8, %ymm8
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vinserti64x4 $1, %ymm8, %zmm7, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512F-NEXT:    vextracti64x4 $1, %zmm8, %ymm10
; AVX512F-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512F-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512F-NEXT:    vinserti64x4 $1, %ymm10, %zmm8, %zmm8
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512F-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512F-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm5
; AVX512F-NEXT:    vextracti64x4 $1, %zmm5, %ymm9
; AVX512F-NEXT:    vpmullw %ymm6, %ymm9, %ymm6
; AVX512F-NEXT:    vpmullw %ymm5, %ymm0, %ymm0
; AVX512F-NEXT:    vinserti64x4 $1, %ymm6, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm0 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vpshufb %ymm3, %ymm0, %ymm5
; AVX512F-NEXT:    vpand %ymm2, %ymm5, %ymm6
; AVX512F-NEXT:    vpshufb %ymm6, %ymm4, %ymm6
; AVX512F-NEXT:    vpsrlw $4, %ymm5, %ymm5
; AVX512F-NEXT:    vpand %ymm2, %ymm5, %ymm5
; AVX512F-NEXT:    vpshufb %ymm5, %ymm1, %ymm5
; AVX512F-NEXT:    vpor %ymm5, %ymm6, %ymm5
; AVX512F-NEXT:    vpsrlw $1, %ymm5, %ymm5
; AVX512F-NEXT:    vextracti64x4 $1, %zmm0, %ymm0
; AVX512F-NEXT:    vpshufb %ymm3, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm3
; AVX512F-NEXT:    vpshufb %ymm3, %ymm4, %ymm3
; AVX512F-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm0
; AVX512F-NEXT:    vpshufb %ymm0, %ymm1, %ymm0
; AVX512F-NEXT:    vpor %ymm0, %ymm3, %ymm0
; AVX512F-NEXT:    vpsrlw $1, %ymm0, %ymm0
; AVX512F-NEXT:    vinserti64x4 $1, %ymm0, %zmm5, %zmm0
; AVX512F-NEXT:    retq
;
; AVX512VL-LABEL: clmulh_v32i16:
; AVX512VL:       # %bb.0:
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm1, %ymm2
; AVX512VL-NEXT:    vmovdqa {{.*#+}} ymm3 = [1,0,3,2,5,4,7,6,9,8,11,10,13,12,15,14,17,16,19,18,21,20,23,22,25,24,27,26,29,28,31,30]
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm2, %ymm5
; AVX512VL-NEXT:    vpbroadcastd {{.*#+}} ymm2 = [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]
; AVX512VL-NEXT:    vpand %ymm2, %ymm5, %ymm6
; AVX512VL-NEXT:    vbroadcasti128 {{.*#+}} ymm4 = [0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240]
; AVX512VL-NEXT:    # ymm4 = mem[0,1,0,1]
; AVX512VL-NEXT:    vpshufb %ymm6, %ymm4, %ymm6
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm1, %ymm7
; AVX512VL-NEXT:    vpand %ymm2, %ymm7, %ymm1
; AVX512VL-NEXT:    vpshufb %ymm1, %ymm4, %ymm1
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm6, %zmm1, %zmm6
; AVX512VL-NEXT:    vpsrlw $4, %ymm5, %ymm1
; AVX512VL-NEXT:    vpand %ymm2, %ymm1, %ymm5
; AVX512VL-NEXT:    vbroadcasti128 {{.*#+}} ymm1 = [0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15,0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15]
; AVX512VL-NEXT:    # ymm1 = mem[0,1,0,1]
; AVX512VL-NEXT:    vpshufb %ymm5, %ymm1, %ymm5
; AVX512VL-NEXT:    vpsrlw $4, %ymm7, %ymm7
; AVX512VL-NEXT:    vpand %ymm2, %ymm7, %ymm7
; AVX512VL-NEXT:    vpshufb %ymm7, %ymm1, %ymm7
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm5, %zmm7, %zmm5
; AVX512VL-NEXT:    vporq %zmm5, %zmm6, %zmm5
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm8
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm0, %ymm6
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm6, %ymm6
; AVX512VL-NEXT:    vpand %ymm2, %ymm6, %ymm9
; AVX512VL-NEXT:    vpshufb %ymm9, %ymm4, %ymm9
; AVX512VL-NEXT:    vpsrlw $4, %ymm6, %ymm6
; AVX512VL-NEXT:    vpand %ymm2, %ymm6, %ymm6
; AVX512VL-NEXT:    vpshufb %ymm6, %ymm1, %ymm6
; AVX512VL-NEXT:    vpor %ymm6, %ymm9, %ymm6
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm8, %ymm8
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm9
; AVX512VL-NEXT:    vpshufb %ymm9, %ymm4, %ymm9
; AVX512VL-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm0, %ymm1, %ymm0
; AVX512VL-NEXT:    vpor %ymm0, %ymm9, %ymm0
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm8, %zmm7, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm8, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm8, %zmm8
; AVX512VL-NEXT:    vpxorq %zmm7, %zmm8, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm8, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm8, %zmm8
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm9
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm9, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm9, %ymm9
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm7 ^ zmm8
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm8
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm8, %ymm8
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm8, %zmm7, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm8, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm8, %zmm8
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm9
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm9, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm9, %ymm9
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm8
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm8, %ymm8
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm8, %zmm7, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm8, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm8, %zmm8
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm9
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm9, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm9, %ymm9
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm8
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm8, %ymm8
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm8, %zmm7, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm8
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm8, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm10, %ymm10
; AVX512VL-NEXT:    vpmullw %ymm0, %ymm8, %ymm8
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm10, %zmm8, %zmm8
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm7, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm9, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm9, %zmm7, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm5, %zmm5
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm5, %ymm9
; AVX512VL-NEXT:    vpmullw %ymm6, %ymm9, %ymm6
; AVX512VL-NEXT:    vpmullw %ymm5, %ymm0, %ymm0
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm6, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm0 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm0, %ymm5
; AVX512VL-NEXT:    vpand %ymm2, %ymm5, %ymm6
; AVX512VL-NEXT:    vpshufb %ymm6, %ymm4, %ymm6
; AVX512VL-NEXT:    vpsrlw $4, %ymm5, %ymm5
; AVX512VL-NEXT:    vpand %ymm2, %ymm5, %ymm5
; AVX512VL-NEXT:    vpshufb %ymm5, %ymm1, %ymm5
; AVX512VL-NEXT:    vpor %ymm5, %ymm6, %ymm5
; AVX512VL-NEXT:    vpsrlw $1, %ymm5, %ymm5
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm0, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm3
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm4, %ymm3
; AVX512VL-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm0, %ymm1, %ymm0
; AVX512VL-NEXT:    vpor %ymm0, %ymm3, %ymm0
; AVX512VL-NEXT:    vpsrlw $1, %ymm0, %ymm0
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm0, %zmm5, %zmm0
; AVX512VL-NEXT:    retq
  %a.ext = zext <32 x i16> %a to <32 x i32>
  %b.ext = zext <32 x i16> %b to <32 x i32>
  %clmul = call <32 x i32> @llvm.clmul.v32i32(<32 x i32> %a.ext, <32 x i32> %b.ext)
  %res.ext = lshr <32 x i32> %clmul, splat (i32 16)
  %res = trunc <32 x i32> %res.ext to <32 x i16>
  ret <32 x i16> %res
}

define <16 x i32> @clmulh_v16i32(<16 x i32> %a, <16 x i32> %b) nounwind {
; AVX512F-LABEL: clmulh_v16i32:
; AVX512F:       # %bb.0:
; AVX512F-NEXT:    vextracti64x4 $1, %zmm0, %ymm2
; AVX512F-NEXT:    vmovdqa {{.*#+}} ymm3 = [3,128,1,128,7,128,5,128,11,128,9,128,15,128,13,128,19,128,17,128,23,128,21,128,27,128,25,128,31,128,29,128]
; AVX512F-NEXT:    vpshufb %ymm3, %ymm2, %ymm5
; AVX512F-NEXT:    vpbroadcastd {{.*#+}} ymm4 = [16711935,16711935,16711935,16711935,16711935,16711935,16711935,16711935]
; AVX512F-NEXT:    vpand %ymm4, %ymm2, %ymm2
; AVX512F-NEXT:    vprord $8, %zmm2, %zmm2
; AVX512F-NEXT:    vpor %ymm5, %ymm2, %ymm6
; AVX512F-NEXT:    vpbroadcastb {{.*#+}} ymm2 = [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]
; AVX512F-NEXT:    vpand %ymm2, %ymm6, %ymm7
; AVX512F-NEXT:    vbroadcasti128 {{.*#+}} ymm5 = [0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240]
; AVX512F-NEXT:    # ymm5 = mem[0,1,0,1]
; AVX512F-NEXT:    vpshufb %ymm7, %ymm5, %ymm7
; AVX512F-NEXT:    vpshufb %ymm3, %ymm0, %ymm8
; AVX512F-NEXT:    vpand %ymm4, %ymm0, %ymm0
; AVX512F-NEXT:    vprord $8, %zmm0, %zmm0
; AVX512F-NEXT:    vpor %ymm0, %ymm8, %ymm8
; AVX512F-NEXT:    vpand %ymm2, %ymm8, %ymm0
; AVX512F-NEXT:    vpshufb %ymm0, %ymm5, %ymm0
; AVX512F-NEXT:    vinserti64x4 $1, %ymm7, %zmm0, %zmm7
; AVX512F-NEXT:    vpsrlw $4, %ymm6, %ymm0
; AVX512F-NEXT:    vpand %ymm2, %ymm0, %ymm6
; AVX512F-NEXT:    vbroadcasti128 {{.*#+}} ymm0 = [0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15,0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15]
; AVX512F-NEXT:    # ymm0 = mem[0,1,0,1]
; AVX512F-NEXT:    vpshufb %ymm6, %ymm0, %ymm6
; AVX512F-NEXT:    vpsrlw $4, %ymm8, %ymm8
; AVX512F-NEXT:    vpand %ymm2, %ymm8, %ymm8
; AVX512F-NEXT:    vpshufb %ymm8, %ymm0, %ymm8
; AVX512F-NEXT:    vinserti64x4 $1, %ymm6, %zmm8, %zmm6
; AVX512F-NEXT:    vporq %zmm6, %zmm7, %zmm6
; AVX512F-NEXT:    vextracti64x4 $1, %zmm1, %ymm7
; AVX512F-NEXT:    vpshufb %ymm3, %ymm7, %ymm8
; AVX512F-NEXT:    vpand %ymm4, %ymm7, %ymm7
; AVX512F-NEXT:    vprord $8, %zmm7, %zmm7
; AVX512F-NEXT:    vpor %ymm7, %ymm8, %ymm7
; AVX512F-NEXT:    vpand %ymm2, %ymm7, %ymm8
; AVX512F-NEXT:    vpshufb %ymm8, %ymm5, %ymm8
; AVX512F-NEXT:    vpshufb %ymm3, %ymm1, %ymm9
; AVX512F-NEXT:    vpand %ymm4, %ymm1, %ymm1
; AVX512F-NEXT:    vprord $8, %zmm1, %zmm1
; AVX512F-NEXT:    vpor %ymm1, %ymm9, %ymm1
; AVX512F-NEXT:    vpand %ymm2, %ymm1, %ymm9
; AVX512F-NEXT:    vpshufb %ymm9, %ymm5, %ymm9
; AVX512F-NEXT:    vinserti64x4 $1, %ymm8, %zmm9, %zmm8
; AVX512F-NEXT:    vpsrlw $4, %ymm7, %ymm7
; AVX512F-NEXT:    vpand %ymm2, %ymm7, %ymm7
; AVX512F-NEXT:    vpshufb %ymm7, %ymm0, %ymm7
; AVX512F-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512F-NEXT:    vpand %ymm2, %ymm1, %ymm1
; AVX512F-NEXT:    vpshufb %ymm1, %ymm0, %ymm1
; AVX512F-NEXT:    vinserti64x4 $1, %ymm7, %zmm1, %zmm1
; AVX512F-NEXT:    vporq %zmm1, %zmm8, %zmm1
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpxord %zmm7, %zmm8, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm7 ^ zmm8
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512F-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512F-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512F-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm1
; AVX512F-NEXT:    vpmulld %zmm1, %zmm6, %zmm1
; AVX512F-NEXT:    vpternlogd {{.*#+}} zmm1 = zmm1 ^ zmm8 ^ zmm7
; AVX512F-NEXT:    vextracti64x4 $1, %zmm1, %ymm6
; AVX512F-NEXT:    vpshufb %ymm3, %ymm6, %ymm7
; AVX512F-NEXT:    vpand %ymm4, %ymm6, %ymm6
; AVX512F-NEXT:    vprord $8, %zmm6, %zmm6
; AVX512F-NEXT:    vpor %ymm7, %ymm6, %ymm6
; AVX512F-NEXT:    vpand %ymm2, %ymm6, %ymm7
; AVX512F-NEXT:    vpshufb %ymm7, %ymm5, %ymm7
; AVX512F-NEXT:    vpshufb %ymm3, %ymm1, %ymm3
; AVX512F-NEXT:    vpand %ymm4, %ymm1, %ymm1
; AVX512F-NEXT:    vprord $8, %zmm1, %zmm1
; AVX512F-NEXT:    vpor %ymm3, %ymm1, %ymm1
; AVX512F-NEXT:    vpand %ymm2, %ymm1, %ymm3
; AVX512F-NEXT:    vpshufb %ymm3, %ymm5, %ymm3
; AVX512F-NEXT:    vinserti64x4 $1, %ymm7, %zmm3, %zmm3
; AVX512F-NEXT:    vpsrlw $4, %ymm6, %ymm4
; AVX512F-NEXT:    vpand %ymm2, %ymm4, %ymm4
; AVX512F-NEXT:    vpshufb %ymm4, %ymm0, %ymm4
; AVX512F-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512F-NEXT:    vpand %ymm2, %ymm1, %ymm1
; AVX512F-NEXT:    vpshufb %ymm1, %ymm0, %ymm0
; AVX512F-NEXT:    vinserti64x4 $1, %ymm4, %zmm0, %zmm0
; AVX512F-NEXT:    vporq %zmm0, %zmm3, %zmm0
; AVX512F-NEXT:    vpsrld $1, %zmm0, %zmm0
; AVX512F-NEXT:    retq
;
; AVX512VL-LABEL: clmulh_v16i32:
; AVX512VL:       # %bb.0:
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm0, %ymm2
; AVX512VL-NEXT:    vmovdqa {{.*#+}} ymm3 = [3,128,1,128,7,128,5,128,11,128,9,128,15,128,13,128,19,128,17,128,23,128,21,128,27,128,25,128,31,128,29,128]
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm2, %ymm5
; AVX512VL-NEXT:    vpbroadcastd {{.*#+}} ymm4 = [16711935,16711935,16711935,16711935,16711935,16711935,16711935,16711935]
; AVX512VL-NEXT:    vpand %ymm4, %ymm2, %ymm2
; AVX512VL-NEXT:    vprord $8, %ymm2, %ymm2
; AVX512VL-NEXT:    vpor %ymm5, %ymm2, %ymm6
; AVX512VL-NEXT:    vpbroadcastd {{.*#+}} ymm2 = [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]
; AVX512VL-NEXT:    vpand %ymm2, %ymm6, %ymm7
; AVX512VL-NEXT:    vbroadcasti128 {{.*#+}} ymm5 = [0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240]
; AVX512VL-NEXT:    # ymm5 = mem[0,1,0,1]
; AVX512VL-NEXT:    vpshufb %ymm7, %ymm5, %ymm7
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm0, %ymm8
; AVX512VL-NEXT:    vpand %ymm4, %ymm0, %ymm0
; AVX512VL-NEXT:    vprord $8, %ymm0, %ymm0
; AVX512VL-NEXT:    vpor %ymm0, %ymm8, %ymm8
; AVX512VL-NEXT:    vpand %ymm2, %ymm8, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm0, %ymm5, %ymm0
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm7, %zmm0, %zmm7
; AVX512VL-NEXT:    vpsrlw $4, %ymm6, %ymm0
; AVX512VL-NEXT:    vpand %ymm2, %ymm0, %ymm6
; AVX512VL-NEXT:    vbroadcasti128 {{.*#+}} ymm0 = [0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15,0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15]
; AVX512VL-NEXT:    # ymm0 = mem[0,1,0,1]
; AVX512VL-NEXT:    vpshufb %ymm6, %ymm0, %ymm6
; AVX512VL-NEXT:    vpsrlw $4, %ymm8, %ymm8
; AVX512VL-NEXT:    vpand %ymm2, %ymm8, %ymm8
; AVX512VL-NEXT:    vpshufb %ymm8, %ymm0, %ymm8
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm6, %zmm8, %zmm6
; AVX512VL-NEXT:    vporq %zmm6, %zmm7, %zmm6
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm1, %ymm7
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm7, %ymm8
; AVX512VL-NEXT:    vpand %ymm4, %ymm7, %ymm7
; AVX512VL-NEXT:    vprord $8, %ymm7, %ymm7
; AVX512VL-NEXT:    vpor %ymm7, %ymm8, %ymm7
; AVX512VL-NEXT:    vpand %ymm2, %ymm7, %ymm8
; AVX512VL-NEXT:    vpshufb %ymm8, %ymm5, %ymm8
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm1, %ymm9
; AVX512VL-NEXT:    vpand %ymm4, %ymm1, %ymm1
; AVX512VL-NEXT:    vprord $8, %ymm1, %ymm1
; AVX512VL-NEXT:    vpor %ymm1, %ymm9, %ymm1
; AVX512VL-NEXT:    vpand %ymm2, %ymm1, %ymm9
; AVX512VL-NEXT:    vpshufb %ymm9, %ymm5, %ymm9
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm8, %zmm9, %zmm8
; AVX512VL-NEXT:    vpsrlw $4, %ymm7, %ymm7
; AVX512VL-NEXT:    vpand %ymm2, %ymm7, %ymm7
; AVX512VL-NEXT:    vpshufb %ymm7, %ymm0, %ymm7
; AVX512VL-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512VL-NEXT:    vpand %ymm2, %ymm1, %ymm1
; AVX512VL-NEXT:    vpshufb %ymm1, %ymm0, %ymm1
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm7, %zmm1, %zmm1
; AVX512VL-NEXT:    vporq %zmm1, %zmm8, %zmm1
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpxord %zmm7, %zmm8, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm7 ^ zmm8
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmulld %zmm9, %zmm6, %zmm9
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm9 = zmm9 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm8
; AVX512VL-NEXT:    vpmulld %zmm8, %zmm6, %zmm8
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm8 = zmm8 ^ zmm9 ^ zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm7
; AVX512VL-NEXT:    vpmulld %zmm7, %zmm6, %zmm7
; AVX512VL-NEXT:    vpandd {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to16}, %zmm1, %zmm1
; AVX512VL-NEXT:    vpmulld %zmm1, %zmm6, %zmm1
; AVX512VL-NEXT:    vpternlogd {{.*#+}} zmm1 = zmm1 ^ zmm8 ^ zmm7
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm1, %ymm6
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm6, %ymm7
; AVX512VL-NEXT:    vpand %ymm4, %ymm6, %ymm6
; AVX512VL-NEXT:    vprord $8, %ymm6, %ymm6
; AVX512VL-NEXT:    vpor %ymm7, %ymm6, %ymm6
; AVX512VL-NEXT:    vpand %ymm2, %ymm6, %ymm7
; AVX512VL-NEXT:    vpshufb %ymm7, %ymm5, %ymm7
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm1, %ymm3
; AVX512VL-NEXT:    vpand %ymm4, %ymm1, %ymm1
; AVX512VL-NEXT:    vprord $8, %ymm1, %ymm1
; AVX512VL-NEXT:    vpor %ymm3, %ymm1, %ymm1
; AVX512VL-NEXT:    vpand %ymm2, %ymm1, %ymm3
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm5, %ymm3
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm7, %zmm3, %zmm3
; AVX512VL-NEXT:    vpsrlw $4, %ymm6, %ymm4
; AVX512VL-NEXT:    vpand %ymm2, %ymm4, %ymm4
; AVX512VL-NEXT:    vpshufb %ymm4, %ymm0, %ymm4
; AVX512VL-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512VL-NEXT:    vpand %ymm2, %ymm1, %ymm1
; AVX512VL-NEXT:    vpshufb %ymm1, %ymm0, %ymm0
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm4, %zmm0, %zmm0
; AVX512VL-NEXT:    vporq %zmm0, %zmm3, %zmm0
; AVX512VL-NEXT:    vpsrld $1, %zmm0, %zmm0
; AVX512VL-NEXT:    retq
  %a.ext = zext <16 x i32> %a to <16 x i64>
  %b.ext = zext <16 x i32> %b to <16 x i64>
  %clmul = call <16 x i64> @llvm.clmul.v16i64(<16 x i64> %a.ext, <16 x i64> %b.ext)
  %res.ext = lshr <16 x i64> %clmul, splat (i64 32)
  %res = trunc <16 x i64> %res.ext to <16 x i32>
  ret <16 x i32> %res
}

define <8 x i64> @clmulh_v8i64(<8 x i64> %a, <8 x i64> %b) nounwind {
; AVX512F-LABEL: clmulh_v8i64:
; AVX512F:       # %bb.0:
; AVX512F-NEXT:    vextracti64x4 $1, %zmm0, %ymm2
; AVX512F-NEXT:    vmovdqa {{.*#+}} ymm15 = [7,6,5,4,3,2,1,0,15,14,13,12,11,10,9,8,23,22,21,20,19,18,17,16,31,30,29,28,27,26,25,24]
; AVX512F-NEXT:    vpshufb %ymm15, %ymm2, %ymm3
; AVX512F-NEXT:    vpbroadcastb {{.*#+}} ymm6 = [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]
; AVX512F-NEXT:    vpand %ymm6, %ymm3, %ymm4
; AVX512F-NEXT:    vbroadcasti128 {{.*#+}} ymm14 = [0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240]
; AVX512F-NEXT:    # ymm14 = mem[0,1,0,1]
; AVX512F-NEXT:    vpshufb %ymm4, %ymm14, %ymm4
; AVX512F-NEXT:    vpshufb %ymm15, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm6, %ymm0, %ymm5
; AVX512F-NEXT:    vpshufb %ymm5, %ymm14, %ymm5
; AVX512F-NEXT:    vinserti64x4 $1, %ymm4, %zmm5, %zmm4
; AVX512F-NEXT:    vpsrlw $4, %ymm3, %ymm3
; AVX512F-NEXT:    vpand %ymm6, %ymm3, %ymm3
; AVX512F-NEXT:    vbroadcasti128 {{.*#+}} ymm13 = [0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15,0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15]
; AVX512F-NEXT:    # ymm13 = mem[0,1,0,1]
; AVX512F-NEXT:    vpshufb %ymm3, %ymm13, %ymm3
; AVX512F-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm6, %ymm0, %ymm0
; AVX512F-NEXT:    vpshufb %ymm0, %ymm13, %ymm0
; AVX512F-NEXT:    vinserti64x4 $1, %ymm3, %zmm0, %zmm0
; AVX512F-NEXT:    vporq %zmm0, %zmm4, %zmm5
; AVX512F-NEXT:    vextracti64x4 $1, %zmm1, %ymm0
; AVX512F-NEXT:    vpshufb %ymm15, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm6, %ymm0, %ymm3
; AVX512F-NEXT:    vpshufb %ymm3, %ymm14, %ymm3
; AVX512F-NEXT:    vpshufb %ymm15, %ymm1, %ymm1
; AVX512F-NEXT:    vpand %ymm6, %ymm1, %ymm4
; AVX512F-NEXT:    vpshufb %ymm4, %ymm14, %ymm4
; AVX512F-NEXT:    vinserti64x4 $1, %ymm3, %zmm4, %zmm3
; AVX512F-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm6, %ymm0, %ymm0
; AVX512F-NEXT:    vpshufb %ymm0, %ymm13, %ymm0
; AVX512F-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512F-NEXT:    vpand %ymm6, %ymm1, %ymm1
; AVX512F-NEXT:    vpshufb %ymm1, %ymm13, %ymm1
; AVX512F-NEXT:    vinserti64x4 $1, %ymm0, %zmm1, %zmm0
; AVX512F-NEXT:    vporq %zmm0, %zmm3, %zmm1
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm3
; AVX512F-NEXT:    vpsrlq $32, %zmm5, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vporq %zmm0, %zmm3, %zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm16 = [512,512,512,512,512,512,512,512]
; AVX512F-NEXT:    vpandq %zmm16, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm17 = [1024,1024,1024,1024,1024,1024,1024,1024]
; AVX512F-NEXT:    vpandq %zmm17, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm18 = [2048,2048,2048,2048,2048,2048,2048,2048]
; AVX512F-NEXT:    vpandq %zmm18, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm19 = [4096,4096,4096,4096,4096,4096,4096,4096]
; AVX512F-NEXT:    vpandq %zmm19, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm20 = [8192,8192,8192,8192,8192,8192,8192,8192]
; AVX512F-NEXT:    vpandq %zmm20, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm21 = [16384,16384,16384,16384,16384,16384,16384,16384]
; AVX512F-NEXT:    vpandq %zmm21, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm22 = [32768,32768,32768,32768,32768,32768,32768,32768]
; AVX512F-NEXT:    vpandq %zmm22, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm23 = [65536,65536,65536,65536,65536,65536,65536,65536]
; AVX512F-NEXT:    vpandq %zmm23, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm24 = [131072,131072,131072,131072,131072,131072,131072,131072]
; AVX512F-NEXT:    vpandq %zmm24, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm25 = [262144,262144,262144,262144,262144,262144,262144,262144]
; AVX512F-NEXT:    vpandq %zmm25, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm26 = [524288,524288,524288,524288,524288,524288,524288,524288]
; AVX512F-NEXT:    vpandq %zmm26, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm27 = [1048576,1048576,1048576,1048576,1048576,1048576,1048576,1048576]
; AVX512F-NEXT:    vpandq %zmm27, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm28 = [2097152,2097152,2097152,2097152,2097152,2097152,2097152,2097152]
; AVX512F-NEXT:    vpandq %zmm28, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm29 = [4194304,4194304,4194304,4194304,4194304,4194304,4194304,4194304]
; AVX512F-NEXT:    vpandq %zmm29, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm30 = [8388608,8388608,8388608,8388608,8388608,8388608,8388608,8388608]
; AVX512F-NEXT:    vpandq %zmm30, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm31 = [16777216,16777216,16777216,16777216,16777216,16777216,16777216,16777216]
; AVX512F-NEXT:    vpandq %zmm31, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm12 = [33554432,33554432,33554432,33554432,33554432,33554432,33554432,33554432]
; AVX512F-NEXT:    vpandq %zmm12, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm11 = [67108864,67108864,67108864,67108864,67108864,67108864,67108864,67108864]
; AVX512F-NEXT:    vpandq %zmm11, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm10 = [134217728,134217728,134217728,134217728,134217728,134217728,134217728,134217728]
; AVX512F-NEXT:    vpandq %zmm10, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm8 = [268435456,268435456,268435456,268435456,268435456,268435456,268435456,268435456]
; AVX512F-NEXT:    vpandq %zmm8, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm7 = [536870912,536870912,536870912,536870912,536870912,536870912,536870912,536870912]
; AVX512F-NEXT:    vpandq %zmm7, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm2
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm2)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm4 = [1073741824,1073741824,1073741824,1073741824,1073741824,1073741824,1073741824,1073741824]
; AVX512F-NEXT:    vpandq %zmm4, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm2
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm2)
; AVX512F-NEXT:    vpbroadcastq {{.*#+}} zmm2 = [2147483648,2147483648,2147483648,2147483648,2147483648,2147483648,2147483648,2147483648]
; AVX512F-NEXT:    vpandq %zmm2, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm9, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm0 ^ (zmm9 | zmm3)
; AVX512F-NEXT:    vpsrlq $32, %zmm1, %zmm1
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512F-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512F-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512F-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm16, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm17, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm18, %zmm1, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512F-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm19, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm20, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm21, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm22, %zmm1, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512F-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm23, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm24, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm25, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm26, %zmm1, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512F-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm27, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm28, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm29, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm30, %zmm1, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512F-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm31, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm12, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm11, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm10, %zmm1, %zmm9
; AVX512F-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512F-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm8, %zmm1, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpandq %zmm7, %zmm1, %zmm3
; AVX512F-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512F-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512F-NEXT:    vpandq %zmm4, %zmm1, %zmm0
; AVX512F-NEXT:    vpandq %zmm2, %zmm1, %zmm1
; AVX512F-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512F-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512F-NEXT:    vpmuludq %zmm1, %zmm5, %zmm1
; AVX512F-NEXT:    vpsllq $32, %zmm1, %zmm1
; AVX512F-NEXT:    vpternlogq {{.*#+}} zmm1 = zmm1 ^ zmm3 ^ zmm0
; AVX512F-NEXT:    vextracti64x4 $1, %zmm1, %ymm0
; AVX512F-NEXT:    vpshufb {{.*#+}} ymm2 = ymm0[u,u,u,u,3],zero,zero,zero,ymm0[u,u,u,u,11],zero,zero,zero,ymm0[u,u,u,u,19],zero,zero,zero,ymm0[u,u,u,u,27],zero,zero,zero
; AVX512F-NEXT:    vpshufb {{.*#+}} ymm3 = ymm0[u,u,u,u],zero,ymm0[2],zero,zero,ymm0[u,u,u,u],zero,ymm0[10],zero,zero,ymm0[u,u,u,u],zero,ymm0[18],zero,zero,ymm0[u,u,u,u],zero,ymm0[26],zero,zero
; AVX512F-NEXT:    vpor %ymm2, %ymm3, %ymm2
; AVX512F-NEXT:    vpshufb {{.*#+}} ymm3 = ymm0[u,u,u,u],zero,zero,ymm0[1,0,u,u,u,u],zero,zero,ymm0[9,8,u,u,u,u],zero,zero,ymm0[17,16,u,u,u,u],zero,zero,ymm0[25,24]
; AVX512F-NEXT:    vpor %ymm2, %ymm3, %ymm2
; AVX512F-NEXT:    vpshufb {{.*#+}} ymm0 = ymm0[7,6,5,4,u,u,u,u,15,14,13,12,u,u,u,u,23,22,21,20,u,u,u,u,31,30,29,28,u,u,u,u]
; AVX512F-NEXT:    vpblendd {{.*#+}} ymm0 = ymm0[0],ymm2[1],ymm0[2],ymm2[3],ymm0[4],ymm2[5],ymm0[6],ymm2[7]
; AVX512F-NEXT:    vpand %ymm6, %ymm0, %ymm2
; AVX512F-NEXT:    vpshufb %ymm2, %ymm14, %ymm2
; AVX512F-NEXT:    vpshufb %ymm15, %ymm1, %ymm1
; AVX512F-NEXT:    vpand %ymm6, %ymm1, %ymm3
; AVX512F-NEXT:    vpshufb %ymm3, %ymm14, %ymm3
; AVX512F-NEXT:    vinserti64x4 $1, %ymm2, %zmm3, %zmm2
; AVX512F-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512F-NEXT:    vpand %ymm6, %ymm0, %ymm0
; AVX512F-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512F-NEXT:    vpand %ymm6, %ymm1, %ymm1
; AVX512F-NEXT:    vpshufb %ymm0, %ymm13, %ymm0
; AVX512F-NEXT:    vpshufb %ymm1, %ymm13, %ymm1
; AVX512F-NEXT:    vinserti64x4 $1, %ymm0, %zmm1, %zmm0
; AVX512F-NEXT:    vporq %zmm0, %zmm2, %zmm0
; AVX512F-NEXT:    vpsrlq $1, %zmm0, %zmm0
; AVX512F-NEXT:    retq
;
; AVX512VL-LABEL: clmulh_v8i64:
; AVX512VL:       # %bb.0:
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm0, %ymm2
; AVX512VL-NEXT:    vmovdqa {{.*#+}} ymm15 = [7,6,5,4,3,2,1,0,15,14,13,12,11,10,9,8,23,22,21,20,19,18,17,16,31,30,29,28,27,26,25,24]
; AVX512VL-NEXT:    vpshufb %ymm15, %ymm2, %ymm3
; AVX512VL-NEXT:    vpbroadcastd {{.*#+}} ymm6 = [15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15]
; AVX512VL-NEXT:    vpand %ymm6, %ymm3, %ymm4
; AVX512VL-NEXT:    vbroadcasti128 {{.*#+}} ymm14 = [0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240]
; AVX512VL-NEXT:    # ymm14 = mem[0,1,0,1]
; AVX512VL-NEXT:    vpshufb %ymm4, %ymm14, %ymm4
; AVX512VL-NEXT:    vpshufb %ymm15, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm6, %ymm0, %ymm5
; AVX512VL-NEXT:    vpshufb %ymm5, %ymm14, %ymm5
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm4, %zmm5, %zmm4
; AVX512VL-NEXT:    vpsrlw $4, %ymm3, %ymm3
; AVX512VL-NEXT:    vpand %ymm6, %ymm3, %ymm3
; AVX512VL-NEXT:    vbroadcasti128 {{.*#+}} ymm13 = [0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15,0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15]
; AVX512VL-NEXT:    # ymm13 = mem[0,1,0,1]
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm13, %ymm3
; AVX512VL-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm6, %ymm0, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm0, %ymm13, %ymm0
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm3, %zmm0, %zmm0
; AVX512VL-NEXT:    vporq %zmm0, %zmm4, %zmm5
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm1, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm15, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm6, %ymm0, %ymm3
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm14, %ymm3
; AVX512VL-NEXT:    vpshufb %ymm15, %ymm1, %ymm1
; AVX512VL-NEXT:    vpand %ymm6, %ymm1, %ymm4
; AVX512VL-NEXT:    vpshufb %ymm4, %ymm14, %ymm4
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm3, %zmm4, %zmm3
; AVX512VL-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm6, %ymm0, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm0, %ymm13, %ymm0
; AVX512VL-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512VL-NEXT:    vpand %ymm6, %ymm1, %ymm1
; AVX512VL-NEXT:    vpshufb %ymm1, %ymm13, %ymm1
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm0, %zmm1, %zmm0
; AVX512VL-NEXT:    vporq %zmm0, %zmm3, %zmm1
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsrlq $32, %zmm5, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vporq %zmm0, %zmm3, %zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm16 = [512,512,512,512,512,512,512,512]
; AVX512VL-NEXT:    vpandq %zmm16, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm17 = [1024,1024,1024,1024,1024,1024,1024,1024]
; AVX512VL-NEXT:    vpandq %zmm17, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm18 = [2048,2048,2048,2048,2048,2048,2048,2048]
; AVX512VL-NEXT:    vpandq %zmm18, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm19 = [4096,4096,4096,4096,4096,4096,4096,4096]
; AVX512VL-NEXT:    vpandq %zmm19, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm20 = [8192,8192,8192,8192,8192,8192,8192,8192]
; AVX512VL-NEXT:    vpandq %zmm20, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm21 = [16384,16384,16384,16384,16384,16384,16384,16384]
; AVX512VL-NEXT:    vpandq %zmm21, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm22 = [32768,32768,32768,32768,32768,32768,32768,32768]
; AVX512VL-NEXT:    vpandq %zmm22, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm23 = [65536,65536,65536,65536,65536,65536,65536,65536]
; AVX512VL-NEXT:    vpandq %zmm23, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm24 = [131072,131072,131072,131072,131072,131072,131072,131072]
; AVX512VL-NEXT:    vpandq %zmm24, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm25 = [262144,262144,262144,262144,262144,262144,262144,262144]
; AVX512VL-NEXT:    vpandq %zmm25, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm26 = [524288,524288,524288,524288,524288,524288,524288,524288]
; AVX512VL-NEXT:    vpandq %zmm26, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm27 = [1048576,1048576,1048576,1048576,1048576,1048576,1048576,1048576]
; AVX512VL-NEXT:    vpandq %zmm27, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm28 = [2097152,2097152,2097152,2097152,2097152,2097152,2097152,2097152]
; AVX512VL-NEXT:    vpandq %zmm28, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm29 = [4194304,4194304,4194304,4194304,4194304,4194304,4194304,4194304]
; AVX512VL-NEXT:    vpandq %zmm29, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm30 = [8388608,8388608,8388608,8388608,8388608,8388608,8388608,8388608]
; AVX512VL-NEXT:    vpandq %zmm30, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm31 = [16777216,16777216,16777216,16777216,16777216,16777216,16777216,16777216]
; AVX512VL-NEXT:    vpandq %zmm31, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm12 = [33554432,33554432,33554432,33554432,33554432,33554432,33554432,33554432]
; AVX512VL-NEXT:    vpandq %zmm12, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm11 = [67108864,67108864,67108864,67108864,67108864,67108864,67108864,67108864]
; AVX512VL-NEXT:    vpandq %zmm11, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm10 = [134217728,134217728,134217728,134217728,134217728,134217728,134217728,134217728]
; AVX512VL-NEXT:    vpandq %zmm10, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm8 = [268435456,268435456,268435456,268435456,268435456,268435456,268435456,268435456]
; AVX512VL-NEXT:    vpandq %zmm8, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm4
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm4)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm7 = [536870912,536870912,536870912,536870912,536870912,536870912,536870912,536870912]
; AVX512VL-NEXT:    vpandq %zmm7, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm2
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm0 ^ (zmm3 | zmm2)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm4 = [1073741824,1073741824,1073741824,1073741824,1073741824,1073741824,1073741824,1073741824]
; AVX512VL-NEXT:    vpandq %zmm4, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm2
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm9, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm0 = zmm3 ^ (zmm0 | zmm2)
; AVX512VL-NEXT:    vpbroadcastq {{.*#+}} zmm2 = [2147483648,2147483648,2147483648,2147483648,2147483648,2147483648,2147483648,2147483648]
; AVX512VL-NEXT:    vpandq %zmm2, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm9, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm0 ^ (zmm9 | zmm3)
; AVX512VL-NEXT:    vpsrlq $32, %zmm1, %zmm1
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512VL-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512VL-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512VL-NEXT:    vpandq {{\.?LCPI[0-9]+_[0-9]+}}(%rip){1to8}, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm16, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm17, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm18, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512VL-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm19, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm20, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm21, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm22, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512VL-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm23, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm24, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm25, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm26, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512VL-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm27, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm28, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm29, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm30, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512VL-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm31, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm12, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm11, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm10, %zmm1, %zmm9
; AVX512VL-NEXT:    vpmuludq %zmm9, %zmm5, %zmm9
; AVX512VL-NEXT:    vpsllq $32, %zmm9, %zmm9
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm9 = zmm9 ^ zmm3 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm8, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm7, %zmm1, %zmm3
; AVX512VL-NEXT:    vpmuludq %zmm3, %zmm5, %zmm3
; AVX512VL-NEXT:    vpsllq $32, %zmm3, %zmm3
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm3 = zmm3 ^ zmm9 ^ zmm0
; AVX512VL-NEXT:    vpandq %zmm4, %zmm1, %zmm0
; AVX512VL-NEXT:    vpmuludq %zmm0, %zmm5, %zmm0
; AVX512VL-NEXT:    vpsllq $32, %zmm0, %zmm0
; AVX512VL-NEXT:    vpandq %zmm2, %zmm1, %zmm1
; AVX512VL-NEXT:    vpmuludq %zmm1, %zmm5, %zmm1
; AVX512VL-NEXT:    vpsllq $32, %zmm1, %zmm1
; AVX512VL-NEXT:    vpternlogq {{.*#+}} zmm1 = zmm1 ^ zmm3 ^ zmm0
; AVX512VL-NEXT:    vextracti64x4 $1, %zmm1, %ymm0
; AVX512VL-NEXT:    vpshufb {{.*#+}} ymm2 = ymm0[u,u,u,u,3],zero,zero,zero,ymm0[u,u,u,u,11],zero,zero,zero,ymm0[u,u,u,u,19],zero,zero,zero,ymm0[u,u,u,u,27],zero,zero,zero
; AVX512VL-NEXT:    vpshufb {{.*#+}} ymm3 = ymm0[u,u,u,u],zero,ymm0[2],zero,zero,ymm0[u,u,u,u],zero,ymm0[10],zero,zero,ymm0[u,u,u,u],zero,ymm0[18],zero,zero,ymm0[u,u,u,u],zero,ymm0[26],zero,zero
; AVX512VL-NEXT:    vpshufb {{.*#+}} ymm4 = ymm0[u,u,u,u],zero,zero,ymm0[1,0,u,u,u,u],zero,zero,ymm0[9,8,u,u,u,u],zero,zero,ymm0[17,16,u,u,u,u],zero,zero,ymm0[25,24]
; AVX512VL-NEXT:    vpternlogq {{.*#+}} ymm4 = ymm4 | ymm3 | ymm2
; AVX512VL-NEXT:    vpshufb {{.*#+}} ymm0 = ymm0[7,6,5,4,u,u,u,u,15,14,13,12,u,u,u,u,23,22,21,20,u,u,u,u,31,30,29,28,u,u,u,u]
; AVX512VL-NEXT:    vpblendd {{.*#+}} ymm0 = ymm0[0],ymm4[1],ymm0[2],ymm4[3],ymm0[4],ymm4[5],ymm0[6],ymm4[7]
; AVX512VL-NEXT:    vpand %ymm6, %ymm0, %ymm2
; AVX512VL-NEXT:    vpshufb %ymm2, %ymm14, %ymm2
; AVX512VL-NEXT:    vpshufb %ymm15, %ymm1, %ymm1
; AVX512VL-NEXT:    vpand %ymm6, %ymm1, %ymm3
; AVX512VL-NEXT:    vpshufb %ymm3, %ymm14, %ymm3
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm2, %zmm3, %zmm2
; AVX512VL-NEXT:    vpsrlw $4, %ymm0, %ymm0
; AVX512VL-NEXT:    vpand %ymm6, %ymm0, %ymm0
; AVX512VL-NEXT:    vpsrlw $4, %ymm1, %ymm1
; AVX512VL-NEXT:    vpand %ymm6, %ymm1, %ymm1
; AVX512VL-NEXT:    vpshufb %ymm0, %ymm13, %ymm0
; AVX512VL-NEXT:    vpshufb %ymm1, %ymm13, %ymm1
; AVX512VL-NEXT:    vinserti64x4 $1, %ymm0, %zmm1, %zmm0
; AVX512VL-NEXT:    vporq %zmm0, %zmm2, %zmm0
; AVX512VL-NEXT:    vpsrlq $1, %zmm0, %zmm0
; AVX512VL-NEXT:    retq
  %a.ext = zext <8 x i64> %a to <8 x i128>
  %b.ext = zext <8 x i64> %b to <8 x i128>
  %clmul = call <8 x i128> @llvm.clmul.v8i128(<8 x i128> %a.ext, <8 x i128> %b.ext)
  %res.ext = lshr <8 x i128> %clmul, splat (i128 64)
  %res = trunc <8 x i128> %res.ext to <8 x i64>
  ret <8 x i64> %res
}
