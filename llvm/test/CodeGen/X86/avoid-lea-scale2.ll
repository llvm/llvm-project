; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --version 5
; RUN: llc < %s -mtriple=x86_64-linux | FileCheck %s --check-prefix=LINUX
; RUN: llc < %s -mtriple=x86_64-win32 | FileCheck %s --check-prefix=DARWIN

define i32 @foo(i32 %x) nounwind readnone {
; LINUX-LABEL: foo:
; LINUX:       # %bb.0:
; LINUX-NEXT:    # kill: def $edi killed $edi def $rdi
; LINUX-NEXT:    leal -2(,%rdi,2), %eax
; LINUX-NEXT:    retq
;
; DARWIN-LABEL: foo:
; DARWIN:       # %bb.0:
; DARWIN-NEXT:    # kill: def $ecx killed $ecx def $rcx
; DARWIN-NEXT:    leal -2(,%rcx,2), %eax
; DARWIN-NEXT:    retq
  %t0 = shl i32 %x, 1
  %t1 = add i32 %t0, -2
  ret i32 %t1
}

