; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py
; RUN: llc -mtriple=aarch64 -verify-machineinstrs %s -o - | FileCheck %s --check-prefixes=CHECK,CHECK-SD
; RUN: llc -mtriple=aarch64 -global-isel=0 < %s | FileCheck %s --check-prefixes=CHECK,CHECK-GI
; RUN: llc -mtriple=armv6m-none-eabi -global-isel=0 < %s | FileCheck %s --check-prefixes=CHECK-SOFTFLOAT


define i1 @isfinite_h(half %x) {
; CHECK-LABEL: isfinite_h:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    // kill: def $h0 killed $h0 def $s0
; CHECK-NEXT:    fmov w8, s0
; CHECK-NEXT:    ubfx w8, w8, #10, #5
; CHECK-NEXT:    cmp w8, #31
; CHECK-NEXT:    cset w0, lo
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: isfinite_h:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r0, r0, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #27
; CHECK-SOFTFLOAT-NEXT:    cmp r0, #31
; CHECK-SOFTFLOAT-NEXT:    blo .LBB0_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    movs r0, #0
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:  .LBB0_2:
; CHECK-SOFTFLOAT-NEXT:    movs r0, #1
; CHECK-SOFTFLOAT-NEXT:    bx lr
entry:
  %0 = tail call i1 @llvm.is.fpclass.f16(half %x, i32 504)  ; 0x1f8 = "finite"
  ret i1 %0
}

define i1 @not_isfinite_h(half %x) {
; CHECK-LABEL: not_isfinite_h:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    // kill: def $h0 killed $h0 def $s0
; CHECK-NEXT:    fmov w8, s0
; CHECK-NEXT:    ubfx w8, w8, #10, #5
; CHECK-NEXT:    cmp w8, #30
; CHECK-NEXT:    cset w0, hi
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: not_isfinite_h:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r0, r0, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #27
; CHECK-SOFTFLOAT-NEXT:    cmp r0, #30
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB1_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    movs r0, #0
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:  .LBB1_2:
; CHECK-SOFTFLOAT-NEXT:    movs r0, #1
; CHECK-SOFTFLOAT-NEXT:    bx lr
entry:
  %0 = tail call i1 @llvm.is.fpclass.f16(half %x, i32 519)  ; ~0x1f8 = "~finite"
  ret i1 %0
}

define i1 @isfinite_f(float %x) {
; CHECK-LABEL: isfinite_f:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    fmov w8, s0
; CHECK-NEXT:    ubfx w8, w8, #23, #8
; CHECK-NEXT:    cmp w8, #255
; CHECK-NEXT:    cset w0, lo
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: isfinite_f:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r0, r0, #1
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #24
; CHECK-SOFTFLOAT-NEXT:    cmp r0, #255
; CHECK-SOFTFLOAT-NEXT:    blo .LBB2_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    movs r0, #0
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:  .LBB2_2:
; CHECK-SOFTFLOAT-NEXT:    movs r0, #1
; CHECK-SOFTFLOAT-NEXT:    bx lr
entry:
  %0 = tail call i1 @llvm.is.fpclass.f32(float %x, i32 504)  ; 0x1f8 = "finite"
  ret i1 %0
}

define i1 @not_isfinite_f(float %x) {
; CHECK-LABEL: not_isfinite_f:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    fmov w8, s0
; CHECK-NEXT:    ubfx w8, w8, #23, #8
; CHECK-NEXT:    cmp w8, #254
; CHECK-NEXT:    cset w0, hi
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: not_isfinite_f:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r0, r0, #1
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #24
; CHECK-SOFTFLOAT-NEXT:    cmp r0, #254
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB3_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    movs r0, #0
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:  .LBB3_2:
; CHECK-SOFTFLOAT-NEXT:    movs r0, #1
; CHECK-SOFTFLOAT-NEXT:    bx lr
entry:
  %0 = tail call i1 @llvm.is.fpclass.f32(float %x, i32 519)  ; ~0x1f8 = "~finite"
  ret i1 %0
}


define i1 @isfinite_f_strictfp(float %x) strictfp {
; CHECK-LABEL: isfinite_f_strictfp:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    fmov w8, s0
; CHECK-NEXT:    ubfx w8, w8, #23, #8
; CHECK-NEXT:    cmp w8, #255
; CHECK-NEXT:    cset w0, lo
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: isfinite_f_strictfp:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r0, r0, #1
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #24
; CHECK-SOFTFLOAT-NEXT:    cmp r0, #255
; CHECK-SOFTFLOAT-NEXT:    blo .LBB4_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    movs r0, #0
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:  .LBB4_2:
; CHECK-SOFTFLOAT-NEXT:    movs r0, #1
; CHECK-SOFTFLOAT-NEXT:    bx lr
entry:
  %0 = tail call i1 @llvm.is.fpclass.f32(float %x, i32 504) strictfp ; 0x1f8 = "finite"
  ret i1 %0
}

define i1 @not_isfinite_f_strictfp(float %x) strictfp {
; CHECK-LABEL: not_isfinite_f_strictfp:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    fmov w8, s0
; CHECK-NEXT:    ubfx w8, w8, #23, #8
; CHECK-NEXT:    cmp w8, #254
; CHECK-NEXT:    cset w0, hi
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: not_isfinite_f_strictfp:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r0, r0, #1
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #24
; CHECK-SOFTFLOAT-NEXT:    cmp r0, #254
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB5_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    movs r0, #0
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:  .LBB5_2:
; CHECK-SOFTFLOAT-NEXT:    movs r0, #1
; CHECK-SOFTFLOAT-NEXT:    bx lr
entry:
  %0 = tail call i1 @llvm.is.fpclass.f32(float %x, i32 519) strictfp ; ~0x1f8 = ~"finite"
  ret i1 %0
}


define i1 @isfinite_d(double %x) {
; CHECK-LABEL: isfinite_d:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    fmov x8, d0
; CHECK-NEXT:    ubfx x8, x8, #52, #11
; CHECK-NEXT:    cmp x8, #2047
; CHECK-NEXT:    cset w0, lo
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: isfinite_d:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #31
; CHECK-SOFTFLOAT-NEXT:    lsls r1, r1, #1
; CHECK-SOFTFLOAT-NEXT:    adds r0, r1, r0
; CHECK-SOFTFLOAT-NEXT:    ldr r1, .LCPI6_0
; CHECK-SOFTFLOAT-NEXT:    cmp r0, r1
; CHECK-SOFTFLOAT-NEXT:    blo .LBB6_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    movs r0, #0
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:  .LBB6_2:
; CHECK-SOFTFLOAT-NEXT:    movs r0, #1
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:    .p2align 2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.3:
; CHECK-SOFTFLOAT-NEXT:  .LCPI6_0:
; CHECK-SOFTFLOAT-NEXT:    .long 4292870144 @ 0xffe00000
entry:
  %0 = tail call i1 @llvm.is.fpclass.f64(double %x, i32 504)  ; 0x1f8 = "finite"
  ret i1 %0
}

define i1 @not_isfinite_d(double %x) {
; CHECK-LABEL: not_isfinite_d:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    fmov x8, d0
; CHECK-NEXT:    ubfx x8, x8, #52, #11
; CHECK-NEXT:    cmp x8, #2046
; CHECK-NEXT:    cset w0, hi
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: not_isfinite_d:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #31
; CHECK-SOFTFLOAT-NEXT:    lsls r1, r1, #1
; CHECK-SOFTFLOAT-NEXT:    adds r0, r1, r0
; CHECK-SOFTFLOAT-NEXT:    ldr r1, .LCPI7_0
; CHECK-SOFTFLOAT-NEXT:    cmp r0, r1
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB7_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    movs r0, #0
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:  .LBB7_2:
; CHECK-SOFTFLOAT-NEXT:    movs r0, #1
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:    .p2align 2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.3:
; CHECK-SOFTFLOAT-NEXT:  .LCPI7_0:
; CHECK-SOFTFLOAT-NEXT:    .long 4292870143 @ 0xffdfffff
entry:
  %0 = tail call i1 @llvm.is.fpclass.f64(double %x, i32 519)  ; ~0x1f8 = "~finite"
  ret i1 %0
}

define i1 @isfinite_d_strictfp(double %x) {
; CHECK-LABEL: isfinite_d_strictfp:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    fmov x8, d0
; CHECK-NEXT:    ubfx x8, x8, #52, #11
; CHECK-NEXT:    cmp x8, #2047
; CHECK-NEXT:    cset w0, lo
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: isfinite_d_strictfp:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #31
; CHECK-SOFTFLOAT-NEXT:    lsls r1, r1, #1
; CHECK-SOFTFLOAT-NEXT:    adds r0, r1, r0
; CHECK-SOFTFLOAT-NEXT:    ldr r1, .LCPI8_0
; CHECK-SOFTFLOAT-NEXT:    cmp r0, r1
; CHECK-SOFTFLOAT-NEXT:    blo .LBB8_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    movs r0, #0
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:  .LBB8_2:
; CHECK-SOFTFLOAT-NEXT:    movs r0, #1
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:    .p2align 2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.3:
; CHECK-SOFTFLOAT-NEXT:  .LCPI8_0:
; CHECK-SOFTFLOAT-NEXT:    .long 4292870144 @ 0xffe00000
entry:
  %0 = tail call i1 @llvm.is.fpclass.f64(double %x, i32 504) strictfp  ; 0x1f8 = "finite"
  ret i1 %0
}

define i1 @not_isfinite_d_strictfp(double %x) {
; CHECK-LABEL: not_isfinite_d_strictfp:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    fmov x8, d0
; CHECK-NEXT:    ubfx x8, x8, #52, #11
; CHECK-NEXT:    cmp x8, #2046
; CHECK-NEXT:    cset w0, hi
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: not_isfinite_d_strictfp:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #31
; CHECK-SOFTFLOAT-NEXT:    lsls r1, r1, #1
; CHECK-SOFTFLOAT-NEXT:    adds r0, r1, r0
; CHECK-SOFTFLOAT-NEXT:    ldr r1, .LCPI9_0
; CHECK-SOFTFLOAT-NEXT:    cmp r0, r1
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB9_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    movs r0, #0
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:  .LBB9_2:
; CHECK-SOFTFLOAT-NEXT:    movs r0, #1
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:    .p2align 2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.3:
; CHECK-SOFTFLOAT-NEXT:  .LCPI9_0:
; CHECK-SOFTFLOAT-NEXT:    .long 4292870143 @ 0xffdfffff
entry:
  %0 = tail call i1 @llvm.is.fpclass.f64(double %x, i32 519) strictfp  ; ~0x1f8 = "~finite"
  ret i1 %0
}

define i1 @isfinite_bf16(bfloat %x) {
; CHECK-LABEL: isfinite_bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    // kill: def $h0 killed $h0 def $s0
; CHECK-NEXT:    fmov w8, s0
; CHECK-NEXT:    ubfx w8, w8, #7, #8
; CHECK-NEXT:    cmp w8, #255
; CHECK-NEXT:    cset w0, lo
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: isfinite_bf16:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #7
; CHECK-SOFTFLOAT-NEXT:    uxtb r0, r0
; CHECK-SOFTFLOAT-NEXT:    cmp r0, #255
; CHECK-SOFTFLOAT-NEXT:    blo .LBB10_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    movs r0, #0
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:  .LBB10_2:
; CHECK-SOFTFLOAT-NEXT:    movs r0, #1
; CHECK-SOFTFLOAT-NEXT:    bx lr
entry:
  %0 = tail call i1 @llvm.is.fpclass.bf16(bfloat %x, i32 504)  ; 0x1f8 = "finite"
  ret i1 %0
}

define i1 @not_isfinite_bf16(bfloat %x) {
; CHECK-LABEL: not_isfinite_bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    // kill: def $h0 killed $h0 def $s0
; CHECK-NEXT:    fmov w8, s0
; CHECK-NEXT:    ubfx w8, w8, #7, #8
; CHECK-NEXT:    cmp w8, #254
; CHECK-NEXT:    cset w0, hi
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: not_isfinite_bf16:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #7
; CHECK-SOFTFLOAT-NEXT:    uxtb r0, r0
; CHECK-SOFTFLOAT-NEXT:    cmp r0, #254
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB11_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    movs r0, #0
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:  .LBB11_2:
; CHECK-SOFTFLOAT-NEXT:    movs r0, #1
; CHECK-SOFTFLOAT-NEXT:    bx lr
entry:
  %0 = tail call i1 @llvm.is.fpclass.bf16(bfloat %x, i32 519)  ; ~0x1f8 = "~finite"
  ret i1 %0
}

define i1 @isfinite_f128(fp128 %x) {
; CHECK-LABEL: isfinite_f128:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    str q0, [sp, #-16]!
; CHECK-NEXT:    .cfi_def_cfa_offset 16
; CHECK-NEXT:    ldp x8, x9, [sp], #16
; CHECK-NEXT:    extr x8, x9, x8, #63
; CHECK-NEXT:    mov x9, #-562949953421312 // =0xfffe000000000000
; CHECK-NEXT:    cmp x8, x9
; CHECK-NEXT:    cset w0, lo
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: isfinite_f128:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r2, #31
; CHECK-SOFTFLOAT-NEXT:    lsls r1, r3, #1
; CHECK-SOFTFLOAT-NEXT:    adds r0, r1, r0
; CHECK-SOFTFLOAT-NEXT:    ldr r1, .LCPI12_0
; CHECK-SOFTFLOAT-NEXT:    cmp r0, r1
; CHECK-SOFTFLOAT-NEXT:    blo .LBB12_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    movs r0, #0
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:  .LBB12_2:
; CHECK-SOFTFLOAT-NEXT:    movs r0, #1
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:    .p2align 2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.3:
; CHECK-SOFTFLOAT-NEXT:  .LCPI12_0:
; CHECK-SOFTFLOAT-NEXT:    .long 4294836224 @ 0xfffe0000
entry:
  %0 = tail call i1 @llvm.is.fpclass.f128(fp128 %x, i32 504)  ; 0x1f8 = "finite"
  ret i1 %0
}

define i1 @not_isfinite_f128(fp128 %x) {
; CHECK-LABEL: not_isfinite_f128:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    str q0, [sp, #-16]!
; CHECK-NEXT:    .cfi_def_cfa_offset 16
; CHECK-NEXT:    ldp x8, x9, [sp], #16
; CHECK-NEXT:    extr x8, x9, x8, #63
; CHECK-NEXT:    mov x9, #-562949953421313 // =0xfffdffffffffffff
; CHECK-NEXT:    cmp x8, x9
; CHECK-NEXT:    cset w0, hi
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: not_isfinite_f128:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r2, #31
; CHECK-SOFTFLOAT-NEXT:    lsls r1, r3, #1
; CHECK-SOFTFLOAT-NEXT:    adds r0, r1, r0
; CHECK-SOFTFLOAT-NEXT:    ldr r1, .LCPI13_0
; CHECK-SOFTFLOAT-NEXT:    cmp r0, r1
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB13_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    movs r0, #0
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:  .LBB13_2:
; CHECK-SOFTFLOAT-NEXT:    movs r0, #1
; CHECK-SOFTFLOAT-NEXT:    bx lr
; CHECK-SOFTFLOAT-NEXT:    .p2align 2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.3:
; CHECK-SOFTFLOAT-NEXT:  .LCPI13_0:
; CHECK-SOFTFLOAT-NEXT:    .long 4294836223 @ 0xfffdffff
entry:
  %0 = tail call i1 @llvm.is.fpclass.f128(fp128 %x, i32 519)  ; ~0x1f8 = "~finite"
  ret i1 %0
}

define <4 x i1> @isfinite_v4h(<4 x half> %x) {
; CHECK-LABEL: isfinite_v4h:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    movi v1.4h, #248, lsl #8
; CHECK-NEXT:    add v0.4h, v0.4h, v0.4h
; CHECK-NEXT:    cmhi v0.4h, v1.4h, v0.4h
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: isfinite_v4h:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    .save {r4, r5, r7, lr}
; CHECK-SOFTFLOAT-NEXT:    push {r4, r5, r7, lr}
; CHECK-SOFTFLOAT-NEXT:    mov r4, r3
; CHECK-SOFTFLOAT-NEXT:    lsls r0, r0, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #27
; CHECK-SOFTFLOAT-NEXT:    movs r3, #1
; CHECK-SOFTFLOAT-NEXT:    movs r5, #0
; CHECK-SOFTFLOAT-NEXT:    cmp r0, #31
; CHECK-SOFTFLOAT-NEXT:    mov r0, r3
; CHECK-SOFTFLOAT-NEXT:    blo .LBB14_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r0, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB14_2: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r1, r1, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r1, r1, #27
; CHECK-SOFTFLOAT-NEXT:    cmp r1, #31
; CHECK-SOFTFLOAT-NEXT:    mov r1, r3
; CHECK-SOFTFLOAT-NEXT:    blo .LBB14_4
; CHECK-SOFTFLOAT-NEXT:  @ %bb.3: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r1, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB14_4: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r2, r2, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r2, r2, #27
; CHECK-SOFTFLOAT-NEXT:    cmp r2, #31
; CHECK-SOFTFLOAT-NEXT:    mov r2, r3
; CHECK-SOFTFLOAT-NEXT:    blo .LBB14_6
; CHECK-SOFTFLOAT-NEXT:  @ %bb.5: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r2, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB14_6: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r4, r4, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r4, r4, #27
; CHECK-SOFTFLOAT-NEXT:    cmp r4, #31
; CHECK-SOFTFLOAT-NEXT:    blo .LBB14_8
; CHECK-SOFTFLOAT-NEXT:  @ %bb.7: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r3, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB14_8: @ %entry
; CHECK-SOFTFLOAT-NEXT:    pop {r4, r5, r7, pc}
entry:
  %0 = tail call <4 x i1> @llvm.is.fpclass.v4f16(<4 x half> %x, i32 504)  ; 0x1f8 = "finite"
  ret <4 x i1> %0
}

define <4 x i1> @not_isfinite_v4h(<4 x half> %x) {
; CHECK-LABEL: not_isfinite_v4h:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    movi v1.4h, #248, lsl #8
; CHECK-NEXT:    add v0.4h, v0.4h, v0.4h
; CHECK-NEXT:    cmhs v0.4h, v0.4h, v1.4h
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: not_isfinite_v4h:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    .save {r4, r5, r7, lr}
; CHECK-SOFTFLOAT-NEXT:    push {r4, r5, r7, lr}
; CHECK-SOFTFLOAT-NEXT:    mov r4, r3
; CHECK-SOFTFLOAT-NEXT:    lsls r0, r0, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #27
; CHECK-SOFTFLOAT-NEXT:    movs r3, #1
; CHECK-SOFTFLOAT-NEXT:    movs r5, #0
; CHECK-SOFTFLOAT-NEXT:    cmp r0, #30
; CHECK-SOFTFLOAT-NEXT:    mov r0, r3
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB15_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r0, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB15_2: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r1, r1, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r1, r1, #27
; CHECK-SOFTFLOAT-NEXT:    cmp r1, #30
; CHECK-SOFTFLOAT-NEXT:    mov r1, r3
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB15_4
; CHECK-SOFTFLOAT-NEXT:  @ %bb.3: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r1, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB15_4: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r2, r2, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r2, r2, #27
; CHECK-SOFTFLOAT-NEXT:    cmp r2, #30
; CHECK-SOFTFLOAT-NEXT:    mov r2, r3
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB15_6
; CHECK-SOFTFLOAT-NEXT:  @ %bb.5: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r2, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB15_6: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r4, r4, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r4, r4, #27
; CHECK-SOFTFLOAT-NEXT:    cmp r4, #30
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB15_8
; CHECK-SOFTFLOAT-NEXT:  @ %bb.7: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r3, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB15_8: @ %entry
; CHECK-SOFTFLOAT-NEXT:    pop {r4, r5, r7, pc}
entry:
  %0 = tail call <4 x i1> @llvm.is.fpclass.v4f16(<4 x half> %x, i32 519)  ; ~0x1f8 = "~finite"
  ret <4 x i1> %0
}

define <4 x i1> @isfinite_v4f(<4 x float> %x) {
; CHECK-LABEL: isfinite_v4f:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    mvni v1.4s, #127, msl #16
; CHECK-NEXT:    fabs v0.4s, v0.4s
; CHECK-NEXT:    fneg v1.4s, v1.4s
; CHECK-NEXT:    fcmgt v2.4s, v0.4s, v1.4s
; CHECK-NEXT:    fcmgt v0.4s, v1.4s, v0.4s
; CHECK-NEXT:    orr v0.16b, v0.16b, v2.16b
; CHECK-NEXT:    xtn v0.4h, v0.4s
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: isfinite_v4f:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    .save {r4, r5, r7, lr}
; CHECK-SOFTFLOAT-NEXT:    push {r4, r5, r7, lr}
; CHECK-SOFTFLOAT-NEXT:    mov r4, r3
; CHECK-SOFTFLOAT-NEXT:    lsls r0, r0, #1
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #24
; CHECK-SOFTFLOAT-NEXT:    movs r3, #1
; CHECK-SOFTFLOAT-NEXT:    movs r5, #0
; CHECK-SOFTFLOAT-NEXT:    cmp r0, #255
; CHECK-SOFTFLOAT-NEXT:    mov r0, r3
; CHECK-SOFTFLOAT-NEXT:    blo .LBB16_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r0, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB16_2: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r1, r1, #1
; CHECK-SOFTFLOAT-NEXT:    lsrs r1, r1, #24
; CHECK-SOFTFLOAT-NEXT:    cmp r1, #255
; CHECK-SOFTFLOAT-NEXT:    mov r1, r3
; CHECK-SOFTFLOAT-NEXT:    blo .LBB16_4
; CHECK-SOFTFLOAT-NEXT:  @ %bb.3: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r1, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB16_4: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r2, r2, #1
; CHECK-SOFTFLOAT-NEXT:    lsrs r2, r2, #24
; CHECK-SOFTFLOAT-NEXT:    cmp r2, #255
; CHECK-SOFTFLOAT-NEXT:    mov r2, r3
; CHECK-SOFTFLOAT-NEXT:    blo .LBB16_6
; CHECK-SOFTFLOAT-NEXT:  @ %bb.5: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r2, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB16_6: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r4, r4, #1
; CHECK-SOFTFLOAT-NEXT:    lsrs r4, r4, #24
; CHECK-SOFTFLOAT-NEXT:    cmp r4, #255
; CHECK-SOFTFLOAT-NEXT:    blo .LBB16_8
; CHECK-SOFTFLOAT-NEXT:  @ %bb.7: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r3, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB16_8: @ %entry
; CHECK-SOFTFLOAT-NEXT:    pop {r4, r5, r7, pc}
entry:
  %0 = tail call <4 x i1> @llvm.is.fpclass.v4f32(<4 x float> %x, i32 504)  ; 0x1f8 = "finite"
  ret <4 x i1> %0
}

define <4 x i1> @not_isfinite_v4f(<4 x float> %x) {
; CHECK-LABEL: not_isfinite_v4f:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    movi v1.2d, #0xff000000ff000000
; CHECK-NEXT:    add v0.4s, v0.4s, v0.4s
; CHECK-NEXT:    cmhs v0.4s, v0.4s, v1.4s
; CHECK-NEXT:    xtn v0.4h, v0.4s
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: not_isfinite_v4f:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    .save {r4, r5, r7, lr}
; CHECK-SOFTFLOAT-NEXT:    push {r4, r5, r7, lr}
; CHECK-SOFTFLOAT-NEXT:    mov r4, r3
; CHECK-SOFTFLOAT-NEXT:    lsls r0, r0, #1
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #24
; CHECK-SOFTFLOAT-NEXT:    movs r3, #1
; CHECK-SOFTFLOAT-NEXT:    movs r5, #0
; CHECK-SOFTFLOAT-NEXT:    cmp r0, #254
; CHECK-SOFTFLOAT-NEXT:    mov r0, r3
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB17_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r0, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB17_2: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r1, r1, #1
; CHECK-SOFTFLOAT-NEXT:    lsrs r1, r1, #24
; CHECK-SOFTFLOAT-NEXT:    cmp r1, #254
; CHECK-SOFTFLOAT-NEXT:    mov r1, r3
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB17_4
; CHECK-SOFTFLOAT-NEXT:  @ %bb.3: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r1, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB17_4: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r2, r2, #1
; CHECK-SOFTFLOAT-NEXT:    lsrs r2, r2, #24
; CHECK-SOFTFLOAT-NEXT:    cmp r2, #254
; CHECK-SOFTFLOAT-NEXT:    mov r2, r3
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB17_6
; CHECK-SOFTFLOAT-NEXT:  @ %bb.5: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r2, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB17_6: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r4, r4, #1
; CHECK-SOFTFLOAT-NEXT:    lsrs r4, r4, #24
; CHECK-SOFTFLOAT-NEXT:    cmp r4, #254
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB17_8
; CHECK-SOFTFLOAT-NEXT:  @ %bb.7: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r3, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB17_8: @ %entry
; CHECK-SOFTFLOAT-NEXT:    pop {r4, r5, r7, pc}
entry:
  %0 = tail call <4 x i1> @llvm.is.fpclass.v4f32(<4 x float> %x, i32 519)  ; ~0x1f8 = "~finite"
  ret <4 x i1> %0
}

define <2 x i1> @isfinite_v2d(<2 x double> %x) {
; CHECK-LABEL: isfinite_v2d:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    mov x8, #9218868437227405312 // =0x7ff0000000000000
; CHECK-NEXT:    fabs v0.2d, v0.2d
; CHECK-NEXT:    dup v1.2d, x8
; CHECK-NEXT:    fcmgt v2.2d, v0.2d, v1.2d
; CHECK-NEXT:    fcmgt v0.2d, v1.2d, v0.2d
; CHECK-NEXT:    orr v0.16b, v0.16b, v2.16b
; CHECK-NEXT:    xtn v0.2s, v0.2d
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: isfinite_v2d:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    .save {r4, r5, r7, lr}
; CHECK-SOFTFLOAT-NEXT:    push {r4, r5, r7, lr}
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #31
; CHECK-SOFTFLOAT-NEXT:    lsls r1, r1, #1
; CHECK-SOFTFLOAT-NEXT:    adds r0, r1, r0
; CHECK-SOFTFLOAT-NEXT:    movs r1, #1
; CHECK-SOFTFLOAT-NEXT:    movs r4, #0
; CHECK-SOFTFLOAT-NEXT:    ldr r5, .LCPI18_0
; CHECK-SOFTFLOAT-NEXT:    cmp r0, r5
; CHECK-SOFTFLOAT-NEXT:    mov r0, r1
; CHECK-SOFTFLOAT-NEXT:    blo .LBB18_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r0, r4
; CHECK-SOFTFLOAT-NEXT:  .LBB18_2: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsrs r2, r2, #31
; CHECK-SOFTFLOAT-NEXT:    lsls r3, r3, #1
; CHECK-SOFTFLOAT-NEXT:    adds r2, r3, r2
; CHECK-SOFTFLOAT-NEXT:    cmp r2, r5
; CHECK-SOFTFLOAT-NEXT:    blo .LBB18_4
; CHECK-SOFTFLOAT-NEXT:  @ %bb.3: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r1, r4
; CHECK-SOFTFLOAT-NEXT:  .LBB18_4: @ %entry
; CHECK-SOFTFLOAT-NEXT:    pop {r4, r5, r7, pc}
; CHECK-SOFTFLOAT-NEXT:    .p2align 2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.5:
; CHECK-SOFTFLOAT-NEXT:  .LCPI18_0:
; CHECK-SOFTFLOAT-NEXT:    .long 4292870144 @ 0xffe00000
entry:
  %0 = tail call <2 x i1> @llvm.is.fpclass.v2f64(<2 x double> %x, i32 504)  ; 0x1f8 = "finite"
  ret <2 x i1> %0
}

define <2 x i1> @not_isfinite_v2d(<2 x double> %x) {
; CHECK-LABEL: not_isfinite_v2d:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    mov x8, #-9007199254740992 // =0xffe0000000000000
; CHECK-NEXT:    add v0.2d, v0.2d, v0.2d
; CHECK-NEXT:    dup v1.2d, x8
; CHECK-NEXT:    cmhs v0.2d, v0.2d, v1.2d
; CHECK-NEXT:    xtn v0.2s, v0.2d
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: not_isfinite_v2d:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    .save {r4, r5, r7, lr}
; CHECK-SOFTFLOAT-NEXT:    push {r4, r5, r7, lr}
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #31
; CHECK-SOFTFLOAT-NEXT:    lsls r1, r1, #1
; CHECK-SOFTFLOAT-NEXT:    adds r0, r1, r0
; CHECK-SOFTFLOAT-NEXT:    movs r1, #1
; CHECK-SOFTFLOAT-NEXT:    movs r4, #0
; CHECK-SOFTFLOAT-NEXT:    ldr r5, .LCPI19_0
; CHECK-SOFTFLOAT-NEXT:    cmp r0, r5
; CHECK-SOFTFLOAT-NEXT:    mov r0, r1
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB19_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r0, r4
; CHECK-SOFTFLOAT-NEXT:  .LBB19_2: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsrs r2, r2, #31
; CHECK-SOFTFLOAT-NEXT:    lsls r3, r3, #1
; CHECK-SOFTFLOAT-NEXT:    adds r2, r3, r2
; CHECK-SOFTFLOAT-NEXT:    cmp r2, r5
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB19_4
; CHECK-SOFTFLOAT-NEXT:  @ %bb.3: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r1, r4
; CHECK-SOFTFLOAT-NEXT:  .LBB19_4: @ %entry
; CHECK-SOFTFLOAT-NEXT:    pop {r4, r5, r7, pc}
; CHECK-SOFTFLOAT-NEXT:    .p2align 2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.5:
; CHECK-SOFTFLOAT-NEXT:  .LCPI19_0:
; CHECK-SOFTFLOAT-NEXT:    .long 4292870143 @ 0xffdfffff
entry:
  %0 = tail call <2 x i1> @llvm.is.fpclass.v2f64(<2 x double> %x, i32 519)  ; ~0x1f8 = "~finite"
  ret <2 x i1> %0
}

define <4 x i1> @isfinite_v4bf16(<4 x bfloat> %x) {
; CHECK-LABEL: isfinite_v4bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    movi d1, #0xff00ff00ff00ff00
; CHECK-NEXT:    add v0.4h, v0.4h, v0.4h
; CHECK-NEXT:    cmhi v0.4h, v1.4h, v0.4h
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: isfinite_v4bf16:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    .save {r4, r5, r7, lr}
; CHECK-SOFTFLOAT-NEXT:    push {r4, r5, r7, lr}
; CHECK-SOFTFLOAT-NEXT:    mov r4, r3
; CHECK-SOFTFLOAT-NEXT:    lsls r0, r0, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #24
; CHECK-SOFTFLOAT-NEXT:    movs r3, #1
; CHECK-SOFTFLOAT-NEXT:    movs r5, #0
; CHECK-SOFTFLOAT-NEXT:    cmp r0, #255
; CHECK-SOFTFLOAT-NEXT:    mov r0, r3
; CHECK-SOFTFLOAT-NEXT:    blo .LBB20_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r0, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB20_2: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r1, r1, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r1, r1, #24
; CHECK-SOFTFLOAT-NEXT:    cmp r1, #255
; CHECK-SOFTFLOAT-NEXT:    mov r1, r3
; CHECK-SOFTFLOAT-NEXT:    blo .LBB20_4
; CHECK-SOFTFLOAT-NEXT:  @ %bb.3: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r1, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB20_4: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r2, r2, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r2, r2, #24
; CHECK-SOFTFLOAT-NEXT:    cmp r2, #255
; CHECK-SOFTFLOAT-NEXT:    mov r2, r3
; CHECK-SOFTFLOAT-NEXT:    blo .LBB20_6
; CHECK-SOFTFLOAT-NEXT:  @ %bb.5: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r2, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB20_6: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r4, r4, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r4, r4, #24
; CHECK-SOFTFLOAT-NEXT:    cmp r4, #255
; CHECK-SOFTFLOAT-NEXT:    blo .LBB20_8
; CHECK-SOFTFLOAT-NEXT:  @ %bb.7: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r3, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB20_8: @ %entry
; CHECK-SOFTFLOAT-NEXT:    pop {r4, r5, r7, pc}
entry:
  %0 = tail call <4 x i1> @llvm.is.fpclass.v4bf16(<4 x bfloat> %x, i32 504)  ; 0x1f8 = "finite"
  ret <4 x i1> %0
}

define <4 x i1> @not_isfinite_v4bf16(<4 x bfloat> %x) {
; CHECK-LABEL: not_isfinite_v4bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    movi d1, #0xff00ff00ff00ff00
; CHECK-NEXT:    add v0.4h, v0.4h, v0.4h
; CHECK-NEXT:    cmhs v0.4h, v0.4h, v1.4h
; CHECK-NEXT:    ret
;
; CHECK-SOFTFLOAT-LABEL: not_isfinite_v4bf16:
; CHECK-SOFTFLOAT:       @ %bb.0: @ %entry
; CHECK-SOFTFLOAT-NEXT:    .save {r4, r5, r7, lr}
; CHECK-SOFTFLOAT-NEXT:    push {r4, r5, r7, lr}
; CHECK-SOFTFLOAT-NEXT:    mov r4, r3
; CHECK-SOFTFLOAT-NEXT:    lsls r0, r0, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r0, r0, #24
; CHECK-SOFTFLOAT-NEXT:    movs r3, #1
; CHECK-SOFTFLOAT-NEXT:    movs r5, #0
; CHECK-SOFTFLOAT-NEXT:    cmp r0, #254
; CHECK-SOFTFLOAT-NEXT:    mov r0, r3
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB21_2
; CHECK-SOFTFLOAT-NEXT:  @ %bb.1: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r0, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB21_2: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r1, r1, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r1, r1, #24
; CHECK-SOFTFLOAT-NEXT:    cmp r1, #254
; CHECK-SOFTFLOAT-NEXT:    mov r1, r3
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB21_4
; CHECK-SOFTFLOAT-NEXT:  @ %bb.3: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r1, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB21_4: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r2, r2, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r2, r2, #24
; CHECK-SOFTFLOAT-NEXT:    cmp r2, #254
; CHECK-SOFTFLOAT-NEXT:    mov r2, r3
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB21_6
; CHECK-SOFTFLOAT-NEXT:  @ %bb.5: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r2, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB21_6: @ %entry
; CHECK-SOFTFLOAT-NEXT:    lsls r4, r4, #17
; CHECK-SOFTFLOAT-NEXT:    lsrs r4, r4, #24
; CHECK-SOFTFLOAT-NEXT:    cmp r4, #254
; CHECK-SOFTFLOAT-NEXT:    bhi .LBB21_8
; CHECK-SOFTFLOAT-NEXT:  @ %bb.7: @ %entry
; CHECK-SOFTFLOAT-NEXT:    mov r3, r5
; CHECK-SOFTFLOAT-NEXT:  .LBB21_8: @ %entry
; CHECK-SOFTFLOAT-NEXT:    pop {r4, r5, r7, pc}
entry:
  %0 = tail call <4 x i1> @llvm.is.fpclass.v4bf16(<4 x bfloat> %x, i32 519)  ; ~0x1f8 = "~finite"
  ret <4 x i1> %0
}

;; NOTE: These prefixes are unused and the list is autogenerated. Do not add tests below this line:
; CHECK-GI: {{.*}}
; CHECK-SD: {{.*}}
