; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --version 5
; RUN: llc %s -o - -O0 -mtriple=aarch64-unknown -mattr=cmp-bcc-fusion | FileCheck %s
; RUN: llc %s -o - -O0 -mtriple=aarch64-unknown -mcpu=cortex-a77    | FileCheck %s
; RUN: llc %s -o - -O0 -mtriple=aarch64-unknown -mcpu=cortex-a78    | FileCheck %s
; RUN: llc %s -o - -O0 -mtriple=aarch64-unknown -mcpu=cortex-a78ae  | FileCheck %s
; RUN: llc %s -o - -O0 -mtriple=aarch64-unknown -mcpu=cortex-a78c   | FileCheck %s
; RUN: llc %s -o - -O0 -mtriple=aarch64-unknown -mcpu=cortex-a710   | FileCheck %s
; RUN: llc %s -o - -O0 -mtriple=aarch64-unknown -mcpu=cortex-a715   | FileCheck %s
; RUN: llc %s -o - -O0 -mtriple=aarch64-unknown -mcpu=cortex-a720   | FileCheck %s
; RUN: llc %s -o - -O0 -mtriple=aarch64-unknown -mcpu=cortex-a720ae | FileCheck %s
; RUN: llc %s -o - -O0 -mtriple=aarch64-unknown -mcpu=cortex-x1     | FileCheck %s
; RUN: llc %s -o - -O0 -mtriple=aarch64-unknown -mcpu=cortex-x2     | FileCheck %s
; RUN: llc %s -o - -O0 -mtriple=aarch64-unknown -mcpu=neoverse-v2   | FileCheck %s
; RUN: llc %s -o - -O0 -mtriple=aarch64-unknown -mcpu=ampere1       | FileCheck %s
; RUN: llc %s -o - -O0 -mtriple=aarch64-unknown -mcpu=ampere1a      | FileCheck %s
; RUN: llc %s -o - -O0 -mtriple=aarch64-unknown -mcpu=ampere1b      | FileCheck %s


define void @test_cmp_bcc_fusion(i32 %x, i32 %y, i32* %arr) {
; CHECK-LABEL: test_cmp_bcc_fusion:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    str w0, [x2]
; CHECK-NEXT:    cmp w0, w1
; CHECK-NEXT:    b.ne .LBB0_2
; CHECK-NEXT:    b .LBB0_1
; CHECK-NEXT:  .LBB0_1: // %if_true
; CHECK-NEXT:    ret
; CHECK-NEXT:  .LBB0_2: // %if_false
; CHECK-NEXT:    ret
entry:
  %cmp = icmp eq i32 %x, %y
  store i32 %x, i32* %arr, align 4
  br i1 %cmp, label %if_true, label %if_false

if_true:
  ret void

if_false:
  ret void
}
