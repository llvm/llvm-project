; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --version 2
; RUN: llc -mtriple=aarch64 -mattr=+sve  < %s | FileCheck %s


define i32 @build_interpolation(<2 x i32> %0, <2 x i32> %1, <2 x i32> %2) {
; CHECK-LABEL: build_interpolation:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    mul v0.2s, v1.2s, v0.2s
; CHECK-NEXT:    ptrue p0.s, vl2
; CHECK-NEXT:    // kill: def $d2 killed $d2 def $z2
; CHECK-NEXT:    sdiv z0.s, p0/m, z0.s, z2.s
; CHECK-NEXT:    mla v0.2s, v1.2s, v0.s[1]
; CHECK-NEXT:    fmov w0, s0
; CHECK-NEXT:    ret
entry:
  %3 = mul nsw <2 x i32> %1, %0
  %4 = sdiv <2 x i32> %3, %2
  %shift = shufflevector <2 x i32> %4, <2 x i32> poison, <2 x i32> <i32 1, i32 1>
  %5 = mul nsw <2 x i32> %shift, %1
  %6 = add nsw <2 x i32> %5, %4
  %add = extractelement <2 x i32> %6, i64 0
  ret i32 %add
}
