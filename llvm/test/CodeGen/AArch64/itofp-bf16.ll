; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --version 3
; RUN: llc -mtriple=aarch64 -mattr=+bf16 -verify-machineinstrs %s -o - | FileCheck %s --check-prefixes=CHECK,CHECK-SD,CHECK-SD-NOFP16
; RUN: llc -mtriple=aarch64 -mattr=+fullfp16,+bf16 -verify-machineinstrs %s -o - | FileCheck %s --check-prefixes=CHECK,CHECK-SD,CHECK-SD-FP16
; RUN: llc -mtriple=aarch64 -mattr=+bf16 -global-isel -global-isel-abort=2 -verify-machineinstrs %s -o - 2>&1 | FileCheck %s --check-prefixes=CHECK,CHECK-GI,CHECK-GI-NOFP16
; RUN: llc -mtriple=aarch64 -mattr=+fullfp16,+bf16 -global-isel -global-isel-abort=2 -verify-machineinstrs %s -o - 2>&1 | FileCheck %s --check-prefixes=CHECK,CHECK-GI,CHECK-GI-FP16

define bfloat @stofp_i64_bf16(i64 %a) {
; CHECK-SD-LABEL: stofp_i64_bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    cmp x0, #0
; CHECK-SD-NEXT:    cneg x8, x0, mi
; CHECK-SD-NEXT:    lsr x9, x8, #53
; CHECK-SD-NEXT:    and x10, x8, #0xfffffffffffff000
; CHECK-SD-NEXT:    cmp x9, #0
; CHECK-SD-NEXT:    csel x9, x10, x8, ne
; CHECK-SD-NEXT:    and x10, x0, #0x8000000000000000
; CHECK-SD-NEXT:    cset w11, ne
; CHECK-SD-NEXT:    scvtf d0, x9
; CHECK-SD-NEXT:    tst x8, #0xfff
; CHECK-SD-NEXT:    fmov x9, d0
; CHECK-SD-NEXT:    orr x8, x9, x10
; CHECK-SD-NEXT:    csel w9, wzr, w11, eq
; CHECK-SD-NEXT:    orr x8, x8, x9
; CHECK-SD-NEXT:    fmov d0, x8
; CHECK-SD-NEXT:    fcvtxn s0, d0
; CHECK-SD-NEXT:    bfcvt h0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_i64_bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    scvtf s0, x0
; CHECK-GI-NEXT:    bfcvt h0, s0
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp i64 %a to bfloat
  ret bfloat %c
}

define bfloat @utofp_i64_bf16(i64 %a) {
; CHECK-SD-LABEL: utofp_i64_bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    lsr x8, x0, #53
; CHECK-SD-NEXT:    and x9, x0, #0xfffffffffffff000
; CHECK-SD-NEXT:    cmp x8, #0
; CHECK-SD-NEXT:    csel x8, x9, x0, ne
; CHECK-SD-NEXT:    ucvtf d0, x8
; CHECK-SD-NEXT:    cset w8, ne
; CHECK-SD-NEXT:    tst x0, #0xfff
; CHECK-SD-NEXT:    csel w8, wzr, w8, eq
; CHECK-SD-NEXT:    fmov x9, d0
; CHECK-SD-NEXT:    orr x8, x9, x8
; CHECK-SD-NEXT:    fmov d0, x8
; CHECK-SD-NEXT:    fcvtxn s0, d0
; CHECK-SD-NEXT:    bfcvt h0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_i64_bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    ucvtf s0, x0
; CHECK-GI-NEXT:    bfcvt h0, s0
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp i64 %a to bfloat
  ret bfloat %c
}

define bfloat @stofp_i32_bf16(i32 %a) {
; CHECK-SD-LABEL: stofp_i32_bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    scvtf d0, w0
; CHECK-SD-NEXT:    fcvtxn s0, d0
; CHECK-SD-NEXT:    bfcvt h0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_i32_bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    scvtf s0, w0
; CHECK-GI-NEXT:    bfcvt h0, s0
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp i32 %a to bfloat
  ret bfloat %c
}

define bfloat @utofp_i32_bf16(i32 %a) {
; CHECK-SD-LABEL: utofp_i32_bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    ucvtf d0, w0
; CHECK-SD-NEXT:    fcvtxn s0, d0
; CHECK-SD-NEXT:    bfcvt h0, s0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_i32_bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    ucvtf s0, w0
; CHECK-GI-NEXT:    bfcvt h0, s0
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp i32 %a to bfloat
  ret bfloat %c
}

define bfloat @stofp_i16_bf16(i16 %a) {
; CHECK-LABEL: stofp_i16_bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    sxth w8, w0
; CHECK-NEXT:    scvtf s0, w8
; CHECK-NEXT:    bfcvt h0, s0
; CHECK-NEXT:    ret
entry:
  %c = sitofp i16 %a to bfloat
  ret bfloat %c
}

define bfloat @utofp_i16_bf16(i16 %a) {
; CHECK-LABEL: utofp_i16_bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    and w8, w0, #0xffff
; CHECK-NEXT:    ucvtf s0, w8
; CHECK-NEXT:    bfcvt h0, s0
; CHECK-NEXT:    ret
entry:
  %c = uitofp i16 %a to bfloat
  ret bfloat %c
}

define bfloat @stofp_i8_bf16(i8 %a) {
; CHECK-LABEL: stofp_i8_bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    sxtb w8, w0
; CHECK-NEXT:    scvtf s0, w8
; CHECK-NEXT:    bfcvt h0, s0
; CHECK-NEXT:    ret
entry:
  %c = sitofp i8 %a to bfloat
  ret bfloat %c
}

define bfloat @utofp_i8_bf16(i8 %a) {
; CHECK-LABEL: utofp_i8_bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    and w8, w0, #0xff
; CHECK-NEXT:    ucvtf s0, w8
; CHECK-NEXT:    bfcvt h0, s0
; CHECK-NEXT:    ret
entry:
  %c = uitofp i8 %a to bfloat
  ret bfloat %c
}

define <2 x bfloat> @stofp_v2i64_v2bf16(<2 x i64> %a) {
; CHECK-SD-LABEL: stofp_v2i64_v2bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    mov x8, v0.d[1]
; CHECK-SD-NEXT:    cmp x8, #0
; CHECK-SD-NEXT:    cneg x9, x8, mi
; CHECK-SD-NEXT:    and x8, x8, #0x8000000000000000
; CHECK-SD-NEXT:    lsr x10, x9, #53
; CHECK-SD-NEXT:    and x11, x9, #0xfffffffffffff000
; CHECK-SD-NEXT:    cmp x10, #0
; CHECK-SD-NEXT:    csel x10, x11, x9, ne
; CHECK-SD-NEXT:    cset w11, ne
; CHECK-SD-NEXT:    tst x9, #0xfff
; CHECK-SD-NEXT:    fmov x9, d0
; CHECK-SD-NEXT:    csel w11, wzr, w11, eq
; CHECK-SD-NEXT:    scvtf d0, x10
; CHECK-SD-NEXT:    cmp x9, #0
; CHECK-SD-NEXT:    cneg x12, x9, mi
; CHECK-SD-NEXT:    and x9, x9, #0x8000000000000000
; CHECK-SD-NEXT:    lsr x13, x12, #53
; CHECK-SD-NEXT:    cmp x13, #0
; CHECK-SD-NEXT:    and x13, x12, #0xfffffffffffff000
; CHECK-SD-NEXT:    csel x10, x13, x12, ne
; CHECK-SD-NEXT:    cset w13, ne
; CHECK-SD-NEXT:    tst x12, #0xfff
; CHECK-SD-NEXT:    scvtf d1, x10
; CHECK-SD-NEXT:    fmov x10, d0
; CHECK-SD-NEXT:    orr x8, x10, x8
; CHECK-SD-NEXT:    csel w10, wzr, w13, eq
; CHECK-SD-NEXT:    fmov x12, d1
; CHECK-SD-NEXT:    orr x8, x8, x11
; CHECK-SD-NEXT:    fmov d0, x8
; CHECK-SD-NEXT:    orr x9, x12, x9
; CHECK-SD-NEXT:    orr x9, x9, x10
; CHECK-SD-NEXT:    fcvtxn s0, d0
; CHECK-SD-NEXT:    fmov d1, x9
; CHECK-SD-NEXT:    fcvtxn s1, d1
; CHECK-SD-NEXT:    bfcvt h2, s0
; CHECK-SD-NEXT:    bfcvt h0, s1
; CHECK-SD-NEXT:    mov v0.h[1], v2.h[0]
; CHECK-SD-NEXT:    // kill: def $d0 killed $d0 killed $q0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_v2i64_v2bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    mov x8, v0.d[1]
; CHECK-GI-NEXT:    fmov x9, d0
; CHECK-GI-NEXT:    scvtf s0, x9
; CHECK-GI-NEXT:    scvtf s1, x8
; CHECK-GI-NEXT:    mov v0.s[1], v1.s[0]
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp <2 x i64> %a to <2 x bfloat>
  ret <2 x bfloat> %c
}

define <2 x bfloat> @utofp_v2i64_v2bf16(<2 x i64> %a) {
; CHECK-SD-LABEL: utofp_v2i64_v2bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    mov x8, v0.d[1]
; CHECK-SD-NEXT:    fmov x10, d0
; CHECK-SD-NEXT:    lsr x9, x8, #53
; CHECK-SD-NEXT:    and x11, x8, #0xfffffffffffff000
; CHECK-SD-NEXT:    cmp x9, #0
; CHECK-SD-NEXT:    lsr x9, x10, #53
; CHECK-SD-NEXT:    csel x11, x11, x8, ne
; CHECK-SD-NEXT:    cset w12, ne
; CHECK-SD-NEXT:    tst x8, #0xfff
; CHECK-SD-NEXT:    csel w8, wzr, w12, eq
; CHECK-SD-NEXT:    cmp x9, #0
; CHECK-SD-NEXT:    and x9, x10, #0xfffffffffffff000
; CHECK-SD-NEXT:    csel x9, x9, x10, ne
; CHECK-SD-NEXT:    ucvtf d0, x11
; CHECK-SD-NEXT:    ucvtf d1, x9
; CHECK-SD-NEXT:    cset w9, ne
; CHECK-SD-NEXT:    tst x10, #0xfff
; CHECK-SD-NEXT:    csel w9, wzr, w9, eq
; CHECK-SD-NEXT:    fmov x10, d0
; CHECK-SD-NEXT:    fmov x11, d1
; CHECK-SD-NEXT:    orr x8, x10, x8
; CHECK-SD-NEXT:    orr x9, x11, x9
; CHECK-SD-NEXT:    fmov d0, x8
; CHECK-SD-NEXT:    fmov d1, x9
; CHECK-SD-NEXT:    fcvtxn s0, d0
; CHECK-SD-NEXT:    fcvtxn s1, d1
; CHECK-SD-NEXT:    bfcvt h2, s0
; CHECK-SD-NEXT:    bfcvt h0, s1
; CHECK-SD-NEXT:    mov v0.h[1], v2.h[0]
; CHECK-SD-NEXT:    // kill: def $d0 killed $d0 killed $q0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_v2i64_v2bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    mov x8, v0.d[1]
; CHECK-GI-NEXT:    fmov x9, d0
; CHECK-GI-NEXT:    ucvtf s0, x9
; CHECK-GI-NEXT:    ucvtf s1, x8
; CHECK-GI-NEXT:    mov v0.s[1], v1.s[0]
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp <2 x i64> %a to <2 x bfloat>
  ret <2 x bfloat> %c
}

define <3 x bfloat> @stofp_v3i64_v3bf16(<3 x i64> %a) {
; CHECK-SD-LABEL: stofp_v3i64_v3bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    // kill: def $d0 killed $d0 def $q0
; CHECK-SD-NEXT:    fmov x8, d0
; CHECK-SD-NEXT:    movi v3.2d, #0000000000000000
; CHECK-SD-NEXT:    // kill: def $d1 killed $d1 def $q1
; CHECK-SD-NEXT:    // kill: def $d2 killed $d2 def $q2
; CHECK-SD-NEXT:    scvtf s0, x8
; CHECK-SD-NEXT:    fmov x8, d1
; CHECK-SD-NEXT:    scvtf s1, x8
; CHECK-SD-NEXT:    fmov x8, d2
; CHECK-SD-NEXT:    mov v3.s[0], v0.s[0]
; CHECK-SD-NEXT:    scvtf s0, x8
; CHECK-SD-NEXT:    mov v3.s[1], v1.s[0]
; CHECK-SD-NEXT:    mov v3.s[2], v0.s[0]
; CHECK-SD-NEXT:    bfcvtn v0.4h, v3.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_v3i64_v3bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    fmov x8, d0
; CHECK-GI-NEXT:    fmov x9, d1
; CHECK-GI-NEXT:    scvtf s0, x8
; CHECK-GI-NEXT:    scvtf s1, x9
; CHECK-GI-NEXT:    fmov x8, d2
; CHECK-GI-NEXT:    scvtf s2, x8
; CHECK-GI-NEXT:    mov v0.s[1], v1.s[0]
; CHECK-GI-NEXT:    movi d1, #0000000000000000
; CHECK-GI-NEXT:    mov v0.s[2], v2.s[0]
; CHECK-GI-NEXT:    mov v0.s[3], v1.s[0]
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp <3 x i64> %a to <3 x bfloat>
  ret <3 x bfloat> %c
}

define <3 x bfloat> @utofp_v3i64_v3bf16(<3 x i64> %a) {
; CHECK-SD-LABEL: utofp_v3i64_v3bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    // kill: def $d0 killed $d0 def $q0
; CHECK-SD-NEXT:    fmov x8, d0
; CHECK-SD-NEXT:    movi v3.2d, #0000000000000000
; CHECK-SD-NEXT:    // kill: def $d1 killed $d1 def $q1
; CHECK-SD-NEXT:    // kill: def $d2 killed $d2 def $q2
; CHECK-SD-NEXT:    ucvtf s0, x8
; CHECK-SD-NEXT:    fmov x8, d1
; CHECK-SD-NEXT:    ucvtf s1, x8
; CHECK-SD-NEXT:    fmov x8, d2
; CHECK-SD-NEXT:    mov v3.s[0], v0.s[0]
; CHECK-SD-NEXT:    ucvtf s0, x8
; CHECK-SD-NEXT:    mov v3.s[1], v1.s[0]
; CHECK-SD-NEXT:    mov v3.s[2], v0.s[0]
; CHECK-SD-NEXT:    bfcvtn v0.4h, v3.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_v3i64_v3bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    fmov x8, d0
; CHECK-GI-NEXT:    fmov x9, d1
; CHECK-GI-NEXT:    ucvtf s0, x8
; CHECK-GI-NEXT:    ucvtf s1, x9
; CHECK-GI-NEXT:    fmov x8, d2
; CHECK-GI-NEXT:    ucvtf s2, x8
; CHECK-GI-NEXT:    mov v0.s[1], v1.s[0]
; CHECK-GI-NEXT:    movi d1, #0000000000000000
; CHECK-GI-NEXT:    mov v0.s[2], v2.s[0]
; CHECK-GI-NEXT:    mov v0.s[3], v1.s[0]
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp <3 x i64> %a to <3 x bfloat>
  ret <3 x bfloat> %c
}

define <4 x bfloat> @stofp_v4i64_v4bf16(<4 x i64> %a) {
; CHECK-SD-LABEL: stofp_v4i64_v4bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    mov x8, v0.d[1]
; CHECK-SD-NEXT:    fmov x9, d0
; CHECK-SD-NEXT:    scvtf s2, x9
; CHECK-SD-NEXT:    mov x9, v1.d[1]
; CHECK-SD-NEXT:    scvtf s0, x8
; CHECK-SD-NEXT:    fmov x8, d1
; CHECK-SD-NEXT:    mov v2.s[1], v0.s[0]
; CHECK-SD-NEXT:    scvtf s0, x8
; CHECK-SD-NEXT:    mov v2.s[2], v0.s[0]
; CHECK-SD-NEXT:    scvtf s0, x9
; CHECK-SD-NEXT:    mov v2.s[3], v0.s[0]
; CHECK-SD-NEXT:    bfcvtn v0.4h, v2.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_v4i64_v4bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    mov x8, v0.d[1]
; CHECK-GI-NEXT:    fmov x9, d0
; CHECK-GI-NEXT:    scvtf s0, x9
; CHECK-GI-NEXT:    mov x9, v1.d[1]
; CHECK-GI-NEXT:    scvtf s2, x8
; CHECK-GI-NEXT:    fmov x8, d1
; CHECK-GI-NEXT:    scvtf s1, x8
; CHECK-GI-NEXT:    mov v0.s[1], v2.s[0]
; CHECK-GI-NEXT:    scvtf s2, x9
; CHECK-GI-NEXT:    mov v0.s[2], v1.s[0]
; CHECK-GI-NEXT:    mov v0.s[3], v2.s[0]
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp <4 x i64> %a to <4 x bfloat>
  ret <4 x bfloat> %c
}

define <4 x bfloat> @utofp_v4i64_v4bf16(<4 x i64> %a) {
; CHECK-SD-LABEL: utofp_v4i64_v4bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    mov x8, v0.d[1]
; CHECK-SD-NEXT:    fmov x9, d0
; CHECK-SD-NEXT:    ucvtf s2, x9
; CHECK-SD-NEXT:    mov x9, v1.d[1]
; CHECK-SD-NEXT:    ucvtf s0, x8
; CHECK-SD-NEXT:    fmov x8, d1
; CHECK-SD-NEXT:    mov v2.s[1], v0.s[0]
; CHECK-SD-NEXT:    ucvtf s0, x8
; CHECK-SD-NEXT:    mov v2.s[2], v0.s[0]
; CHECK-SD-NEXT:    ucvtf s0, x9
; CHECK-SD-NEXT:    mov v2.s[3], v0.s[0]
; CHECK-SD-NEXT:    bfcvtn v0.4h, v2.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_v4i64_v4bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    mov x8, v0.d[1]
; CHECK-GI-NEXT:    fmov x9, d0
; CHECK-GI-NEXT:    ucvtf s0, x9
; CHECK-GI-NEXT:    mov x9, v1.d[1]
; CHECK-GI-NEXT:    ucvtf s2, x8
; CHECK-GI-NEXT:    fmov x8, d1
; CHECK-GI-NEXT:    ucvtf s1, x8
; CHECK-GI-NEXT:    mov v0.s[1], v2.s[0]
; CHECK-GI-NEXT:    ucvtf s2, x9
; CHECK-GI-NEXT:    mov v0.s[2], v1.s[0]
; CHECK-GI-NEXT:    mov v0.s[3], v2.s[0]
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp <4 x i64> %a to <4 x bfloat>
  ret <4 x bfloat> %c
}

define <8 x bfloat> @stofp_v8i64_v8bf16(<8 x i64> %a) {
; CHECK-SD-LABEL: stofp_v8i64_v8bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    mov x9, v0.d[1]
; CHECK-SD-NEXT:    fmov x10, d0
; CHECK-SD-NEXT:    mov x8, v2.d[1]
; CHECK-SD-NEXT:    scvtf s4, x10
; CHECK-SD-NEXT:    fmov x10, d1
; CHECK-SD-NEXT:    scvtf s0, x9
; CHECK-SD-NEXT:    fmov x9, d2
; CHECK-SD-NEXT:    scvtf s2, x8
; CHECK-SD-NEXT:    mov x8, v1.d[1]
; CHECK-SD-NEXT:    scvtf s1, x9
; CHECK-SD-NEXT:    fmov x9, d3
; CHECK-SD-NEXT:    mov v4.s[1], v0.s[0]
; CHECK-SD-NEXT:    scvtf s0, x10
; CHECK-SD-NEXT:    mov x10, v3.d[1]
; CHECK-SD-NEXT:    scvtf s3, x9
; CHECK-SD-NEXT:    mov v1.s[1], v2.s[0]
; CHECK-SD-NEXT:    scvtf s2, x8
; CHECK-SD-NEXT:    mov v4.s[2], v0.s[0]
; CHECK-SD-NEXT:    scvtf s0, x10
; CHECK-SD-NEXT:    mov v1.s[2], v3.s[0]
; CHECK-SD-NEXT:    mov v4.s[3], v2.s[0]
; CHECK-SD-NEXT:    mov v1.s[3], v0.s[0]
; CHECK-SD-NEXT:    bfcvtn v0.4h, v4.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v1.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_v8i64_v8bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    fmov x9, d0
; CHECK-GI-NEXT:    mov x8, v0.d[1]
; CHECK-GI-NEXT:    mov x10, v1.d[1]
; CHECK-GI-NEXT:    scvtf s0, x9
; CHECK-GI-NEXT:    fmov x9, d1
; CHECK-GI-NEXT:    scvtf s4, x8
; CHECK-GI-NEXT:    mov x8, v2.d[1]
; CHECK-GI-NEXT:    scvtf s1, x9
; CHECK-GI-NEXT:    fmov x9, d2
; CHECK-GI-NEXT:    scvtf s5, x8
; CHECK-GI-NEXT:    mov v0.s[1], v4.s[0]
; CHECK-GI-NEXT:    scvtf s4, x10
; CHECK-GI-NEXT:    scvtf s2, x9
; CHECK-GI-NEXT:    fmov x9, d3
; CHECK-GI-NEXT:    mov x8, v3.d[1]
; CHECK-GI-NEXT:    scvtf s3, x9
; CHECK-GI-NEXT:    mov v0.s[2], v1.s[0]
; CHECK-GI-NEXT:    mov v2.s[1], v5.s[0]
; CHECK-GI-NEXT:    scvtf s1, x8
; CHECK-GI-NEXT:    mov v0.s[3], v4.s[0]
; CHECK-GI-NEXT:    mov v2.s[2], v3.s[0]
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    mov v2.s[3], v1.s[0]
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v2.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp <8 x i64> %a to <8 x bfloat>
  ret <8 x bfloat> %c
}

define <8 x bfloat> @utofp_v8i64_v8bf16(<8 x i64> %a) {
; CHECK-SD-LABEL: utofp_v8i64_v8bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    mov x9, v0.d[1]
; CHECK-SD-NEXT:    fmov x10, d0
; CHECK-SD-NEXT:    mov x8, v2.d[1]
; CHECK-SD-NEXT:    ucvtf s4, x10
; CHECK-SD-NEXT:    fmov x10, d1
; CHECK-SD-NEXT:    ucvtf s0, x9
; CHECK-SD-NEXT:    fmov x9, d2
; CHECK-SD-NEXT:    ucvtf s2, x8
; CHECK-SD-NEXT:    mov x8, v1.d[1]
; CHECK-SD-NEXT:    ucvtf s1, x9
; CHECK-SD-NEXT:    fmov x9, d3
; CHECK-SD-NEXT:    mov v4.s[1], v0.s[0]
; CHECK-SD-NEXT:    ucvtf s0, x10
; CHECK-SD-NEXT:    mov x10, v3.d[1]
; CHECK-SD-NEXT:    ucvtf s3, x9
; CHECK-SD-NEXT:    mov v1.s[1], v2.s[0]
; CHECK-SD-NEXT:    ucvtf s2, x8
; CHECK-SD-NEXT:    mov v4.s[2], v0.s[0]
; CHECK-SD-NEXT:    ucvtf s0, x10
; CHECK-SD-NEXT:    mov v1.s[2], v3.s[0]
; CHECK-SD-NEXT:    mov v4.s[3], v2.s[0]
; CHECK-SD-NEXT:    mov v1.s[3], v0.s[0]
; CHECK-SD-NEXT:    bfcvtn v0.4h, v4.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v1.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_v8i64_v8bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    fmov x9, d0
; CHECK-GI-NEXT:    mov x8, v0.d[1]
; CHECK-GI-NEXT:    mov x10, v1.d[1]
; CHECK-GI-NEXT:    ucvtf s0, x9
; CHECK-GI-NEXT:    fmov x9, d1
; CHECK-GI-NEXT:    ucvtf s4, x8
; CHECK-GI-NEXT:    mov x8, v2.d[1]
; CHECK-GI-NEXT:    ucvtf s1, x9
; CHECK-GI-NEXT:    fmov x9, d2
; CHECK-GI-NEXT:    ucvtf s5, x8
; CHECK-GI-NEXT:    mov v0.s[1], v4.s[0]
; CHECK-GI-NEXT:    ucvtf s4, x10
; CHECK-GI-NEXT:    ucvtf s2, x9
; CHECK-GI-NEXT:    fmov x9, d3
; CHECK-GI-NEXT:    mov x8, v3.d[1]
; CHECK-GI-NEXT:    ucvtf s3, x9
; CHECK-GI-NEXT:    mov v0.s[2], v1.s[0]
; CHECK-GI-NEXT:    mov v2.s[1], v5.s[0]
; CHECK-GI-NEXT:    ucvtf s1, x8
; CHECK-GI-NEXT:    mov v0.s[3], v4.s[0]
; CHECK-GI-NEXT:    mov v2.s[2], v3.s[0]
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    mov v2.s[3], v1.s[0]
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v2.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp <8 x i64> %a to <8 x bfloat>
  ret <8 x bfloat> %c
}

define <16 x bfloat> @stofp_v16i64_v16bf16(<16 x i64> %a) {
; CHECK-SD-LABEL: stofp_v16i64_v16bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    fmov x12, d0
; CHECK-SD-NEXT:    mov x8, v0.d[1]
; CHECK-SD-NEXT:    mov x9, v4.d[1]
; CHECK-SD-NEXT:    mov x10, v2.d[1]
; CHECK-SD-NEXT:    fmov x11, d2
; CHECK-SD-NEXT:    mov x13, v1.d[1]
; CHECK-SD-NEXT:    scvtf s0, x12
; CHECK-SD-NEXT:    fmov x12, d4
; CHECK-SD-NEXT:    scvtf s2, x8
; CHECK-SD-NEXT:    mov x8, v6.d[1]
; CHECK-SD-NEXT:    scvtf s16, x9
; CHECK-SD-NEXT:    fmov x9, d1
; CHECK-SD-NEXT:    scvtf s1, x10
; CHECK-SD-NEXT:    fmov x10, d5
; CHECK-SD-NEXT:    scvtf s4, x12
; CHECK-SD-NEXT:    fmov x12, d6
; CHECK-SD-NEXT:    scvtf s6, x11
; CHECK-SD-NEXT:    mov x11, v5.d[1]
; CHECK-SD-NEXT:    scvtf s5, x9
; CHECK-SD-NEXT:    mov v0.s[1], v2.s[0]
; CHECK-SD-NEXT:    scvtf s2, x10
; CHECK-SD-NEXT:    scvtf s17, x12
; CHECK-SD-NEXT:    fmov x9, d3
; CHECK-SD-NEXT:    fmov x12, d7
; CHECK-SD-NEXT:    mov v4.s[1], v16.s[0]
; CHECK-SD-NEXT:    scvtf s16, x8
; CHECK-SD-NEXT:    mov x8, v3.d[1]
; CHECK-SD-NEXT:    mov x10, v7.d[1]
; CHECK-SD-NEXT:    mov v6.s[1], v1.s[0]
; CHECK-SD-NEXT:    scvtf s7, x11
; CHECK-SD-NEXT:    scvtf s3, x9
; CHECK-SD-NEXT:    scvtf s1, x12
; CHECK-SD-NEXT:    mov v0.s[2], v5.s[0]
; CHECK-SD-NEXT:    scvtf s5, x13
; CHECK-SD-NEXT:    mov v17.s[1], v16.s[0]
; CHECK-SD-NEXT:    mov v4.s[2], v2.s[0]
; CHECK-SD-NEXT:    scvtf s2, x8
; CHECK-SD-NEXT:    mov v6.s[2], v3.s[0]
; CHECK-SD-NEXT:    mov v0.s[3], v5.s[0]
; CHECK-SD-NEXT:    mov v17.s[2], v1.s[0]
; CHECK-SD-NEXT:    scvtf s1, x10
; CHECK-SD-NEXT:    mov v4.s[3], v7.s[0]
; CHECK-SD-NEXT:    mov v6.s[3], v2.s[0]
; CHECK-SD-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-SD-NEXT:    mov v17.s[3], v1.s[0]
; CHECK-SD-NEXT:    bfcvtn v1.4h, v4.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v6.4s
; CHECK-SD-NEXT:    bfcvtn2 v1.8h, v17.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_v16i64_v16bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    fmov x10, d0
; CHECK-GI-NEXT:    mov x8, v0.d[1]
; CHECK-GI-NEXT:    mov x9, v4.d[1]
; CHECK-GI-NEXT:    fmov x11, d1
; CHECK-GI-NEXT:    fmov x13, d2
; CHECK-GI-NEXT:    mov x12, v2.d[1]
; CHECK-GI-NEXT:    scvtf s0, x10
; CHECK-GI-NEXT:    fmov x10, d4
; CHECK-GI-NEXT:    scvtf s16, x8
; CHECK-GI-NEXT:    scvtf s17, x9
; CHECK-GI-NEXT:    mov x8, v6.d[1]
; CHECK-GI-NEXT:    mov x9, v1.d[1]
; CHECK-GI-NEXT:    scvtf s1, x11
; CHECK-GI-NEXT:    scvtf s4, x13
; CHECK-GI-NEXT:    scvtf s2, x10
; CHECK-GI-NEXT:    fmov x11, d5
; CHECK-GI-NEXT:    fmov x13, d6
; CHECK-GI-NEXT:    mov x10, v5.d[1]
; CHECK-GI-NEXT:    scvtf s6, x12
; CHECK-GI-NEXT:    scvtf s19, x8
; CHECK-GI-NEXT:    mov v0.s[1], v16.s[0]
; CHECK-GI-NEXT:    mov x8, v3.d[1]
; CHECK-GI-NEXT:    scvtf s18, x11
; CHECK-GI-NEXT:    scvtf s5, x13
; CHECK-GI-NEXT:    scvtf s16, x9
; CHECK-GI-NEXT:    mov v2.s[1], v17.s[0]
; CHECK-GI-NEXT:    fmov x9, d3
; CHECK-GI-NEXT:    fmov x11, d7
; CHECK-GI-NEXT:    mov v4.s[1], v6.s[0]
; CHECK-GI-NEXT:    mov v0.s[2], v1.s[0]
; CHECK-GI-NEXT:    scvtf s1, x8
; CHECK-GI-NEXT:    scvtf s3, x9
; CHECK-GI-NEXT:    mov x9, v7.d[1]
; CHECK-GI-NEXT:    scvtf s7, x10
; CHECK-GI-NEXT:    scvtf s17, x11
; CHECK-GI-NEXT:    mov v2.s[2], v18.s[0]
; CHECK-GI-NEXT:    mov v5.s[1], v19.s[0]
; CHECK-GI-NEXT:    mov v0.s[3], v16.s[0]
; CHECK-GI-NEXT:    scvtf s6, x9
; CHECK-GI-NEXT:    mov v4.s[2], v3.s[0]
; CHECK-GI-NEXT:    mov v2.s[3], v7.s[0]
; CHECK-GI-NEXT:    mov v5.s[2], v17.s[0]
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    mov v4.s[3], v1.s[0]
; CHECK-GI-NEXT:    mov v5.s[3], v6.s[0]
; CHECK-GI-NEXT:    bfcvtn v1.4h, v2.4s
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v4.4s
; CHECK-GI-NEXT:    bfcvtn2 v1.8h, v5.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp <16 x i64> %a to <16 x bfloat>
  ret <16 x bfloat> %c
}

define <16 x bfloat> @utofp_v16i64_v16bf16(<16 x i64> %a) {
; CHECK-SD-LABEL: utofp_v16i64_v16bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    fmov x12, d0
; CHECK-SD-NEXT:    mov x8, v0.d[1]
; CHECK-SD-NEXT:    mov x9, v4.d[1]
; CHECK-SD-NEXT:    mov x10, v2.d[1]
; CHECK-SD-NEXT:    fmov x11, d2
; CHECK-SD-NEXT:    mov x13, v1.d[1]
; CHECK-SD-NEXT:    ucvtf s0, x12
; CHECK-SD-NEXT:    fmov x12, d4
; CHECK-SD-NEXT:    ucvtf s2, x8
; CHECK-SD-NEXT:    mov x8, v6.d[1]
; CHECK-SD-NEXT:    ucvtf s16, x9
; CHECK-SD-NEXT:    fmov x9, d1
; CHECK-SD-NEXT:    ucvtf s1, x10
; CHECK-SD-NEXT:    fmov x10, d5
; CHECK-SD-NEXT:    ucvtf s4, x12
; CHECK-SD-NEXT:    fmov x12, d6
; CHECK-SD-NEXT:    ucvtf s6, x11
; CHECK-SD-NEXT:    mov x11, v5.d[1]
; CHECK-SD-NEXT:    ucvtf s5, x9
; CHECK-SD-NEXT:    mov v0.s[1], v2.s[0]
; CHECK-SD-NEXT:    ucvtf s2, x10
; CHECK-SD-NEXT:    ucvtf s17, x12
; CHECK-SD-NEXT:    fmov x9, d3
; CHECK-SD-NEXT:    fmov x12, d7
; CHECK-SD-NEXT:    mov v4.s[1], v16.s[0]
; CHECK-SD-NEXT:    ucvtf s16, x8
; CHECK-SD-NEXT:    mov x8, v3.d[1]
; CHECK-SD-NEXT:    mov x10, v7.d[1]
; CHECK-SD-NEXT:    mov v6.s[1], v1.s[0]
; CHECK-SD-NEXT:    ucvtf s7, x11
; CHECK-SD-NEXT:    ucvtf s3, x9
; CHECK-SD-NEXT:    ucvtf s1, x12
; CHECK-SD-NEXT:    mov v0.s[2], v5.s[0]
; CHECK-SD-NEXT:    ucvtf s5, x13
; CHECK-SD-NEXT:    mov v17.s[1], v16.s[0]
; CHECK-SD-NEXT:    mov v4.s[2], v2.s[0]
; CHECK-SD-NEXT:    ucvtf s2, x8
; CHECK-SD-NEXT:    mov v6.s[2], v3.s[0]
; CHECK-SD-NEXT:    mov v0.s[3], v5.s[0]
; CHECK-SD-NEXT:    mov v17.s[2], v1.s[0]
; CHECK-SD-NEXT:    ucvtf s1, x10
; CHECK-SD-NEXT:    mov v4.s[3], v7.s[0]
; CHECK-SD-NEXT:    mov v6.s[3], v2.s[0]
; CHECK-SD-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-SD-NEXT:    mov v17.s[3], v1.s[0]
; CHECK-SD-NEXT:    bfcvtn v1.4h, v4.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v6.4s
; CHECK-SD-NEXT:    bfcvtn2 v1.8h, v17.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_v16i64_v16bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    fmov x10, d0
; CHECK-GI-NEXT:    mov x8, v0.d[1]
; CHECK-GI-NEXT:    mov x9, v4.d[1]
; CHECK-GI-NEXT:    fmov x11, d1
; CHECK-GI-NEXT:    fmov x13, d2
; CHECK-GI-NEXT:    mov x12, v2.d[1]
; CHECK-GI-NEXT:    ucvtf s0, x10
; CHECK-GI-NEXT:    fmov x10, d4
; CHECK-GI-NEXT:    ucvtf s16, x8
; CHECK-GI-NEXT:    ucvtf s17, x9
; CHECK-GI-NEXT:    mov x8, v6.d[1]
; CHECK-GI-NEXT:    mov x9, v1.d[1]
; CHECK-GI-NEXT:    ucvtf s1, x11
; CHECK-GI-NEXT:    ucvtf s4, x13
; CHECK-GI-NEXT:    ucvtf s2, x10
; CHECK-GI-NEXT:    fmov x11, d5
; CHECK-GI-NEXT:    fmov x13, d6
; CHECK-GI-NEXT:    mov x10, v5.d[1]
; CHECK-GI-NEXT:    ucvtf s6, x12
; CHECK-GI-NEXT:    ucvtf s19, x8
; CHECK-GI-NEXT:    mov v0.s[1], v16.s[0]
; CHECK-GI-NEXT:    mov x8, v3.d[1]
; CHECK-GI-NEXT:    ucvtf s18, x11
; CHECK-GI-NEXT:    ucvtf s5, x13
; CHECK-GI-NEXT:    ucvtf s16, x9
; CHECK-GI-NEXT:    mov v2.s[1], v17.s[0]
; CHECK-GI-NEXT:    fmov x9, d3
; CHECK-GI-NEXT:    fmov x11, d7
; CHECK-GI-NEXT:    mov v4.s[1], v6.s[0]
; CHECK-GI-NEXT:    mov v0.s[2], v1.s[0]
; CHECK-GI-NEXT:    ucvtf s1, x8
; CHECK-GI-NEXT:    ucvtf s3, x9
; CHECK-GI-NEXT:    mov x9, v7.d[1]
; CHECK-GI-NEXT:    ucvtf s7, x10
; CHECK-GI-NEXT:    ucvtf s17, x11
; CHECK-GI-NEXT:    mov v2.s[2], v18.s[0]
; CHECK-GI-NEXT:    mov v5.s[1], v19.s[0]
; CHECK-GI-NEXT:    mov v0.s[3], v16.s[0]
; CHECK-GI-NEXT:    ucvtf s6, x9
; CHECK-GI-NEXT:    mov v4.s[2], v3.s[0]
; CHECK-GI-NEXT:    mov v2.s[3], v7.s[0]
; CHECK-GI-NEXT:    mov v5.s[2], v17.s[0]
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    mov v4.s[3], v1.s[0]
; CHECK-GI-NEXT:    mov v5.s[3], v6.s[0]
; CHECK-GI-NEXT:    bfcvtn v1.4h, v2.4s
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v4.4s
; CHECK-GI-NEXT:    bfcvtn2 v1.8h, v5.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp <16 x i64> %a to <16 x bfloat>
  ret <16 x bfloat> %c
}

define <32 x bfloat> @stofp_v32i64_v32bf16(<32 x i64> %a) {
; CHECK-SD-LABEL: stofp_v32i64_v32bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    ldp x8, x9, [sp, #32]
; CHECK-SD-NEXT:    mov x14, v2.d[1]
; CHECK-SD-NEXT:    ldp x10, x11, [sp]
; CHECK-SD-NEXT:    ldp x12, x13, [sp, #96]
; CHECK-SD-NEXT:    scvtf s18, x9
; CHECK-SD-NEXT:    scvtf s16, x8
; CHECK-SD-NEXT:    ldp x8, x9, [sp, #64]
; CHECK-SD-NEXT:    scvtf s17, x10
; CHECK-SD-NEXT:    scvtf s19, x11
; CHECK-SD-NEXT:    scvtf s21, x13
; CHECK-SD-NEXT:    mov x13, v4.d[1]
; CHECK-SD-NEXT:    scvtf s20, x9
; CHECK-SD-NEXT:    ldp x10, x9, [sp, #16]
; CHECK-SD-NEXT:    mov v16.s[1], v18.s[0]
; CHECK-SD-NEXT:    scvtf s18, x8
; CHECK-SD-NEXT:    mov v17.s[1], v19.s[0]
; CHECK-SD-NEXT:    scvtf s19, x12
; CHECK-SD-NEXT:    mov x12, v0.d[1]
; CHECK-SD-NEXT:    scvtf s22, x10
; CHECK-SD-NEXT:    ldp x11, x10, [sp, #80]
; CHECK-SD-NEXT:    ldp x15, x8, [sp, #48]
; CHECK-SD-NEXT:    mov v18.s[1], v20.s[0]
; CHECK-SD-NEXT:    scvtf s23, x11
; CHECK-SD-NEXT:    fmov x11, d2
; CHECK-SD-NEXT:    mov v19.s[1], v21.s[0]
; CHECK-SD-NEXT:    mov v17.s[2], v22.s[0]
; CHECK-SD-NEXT:    scvtf s22, x14
; CHECK-SD-NEXT:    fmov x14, d1
; CHECK-SD-NEXT:    scvtf s2, x15
; CHECK-SD-NEXT:    scvtf s20, x11
; CHECK-SD-NEXT:    fmov x11, d0
; CHECK-SD-NEXT:    scvtf s0, x12
; CHECK-SD-NEXT:    fmov x12, d4
; CHECK-SD-NEXT:    mov v18.s[2], v23.s[0]
; CHECK-SD-NEXT:    scvtf s23, x9
; CHECK-SD-NEXT:    mov x9, v6.d[1]
; CHECK-SD-NEXT:    scvtf s21, x11
; CHECK-SD-NEXT:    mov x11, v1.d[1]
; CHECK-SD-NEXT:    scvtf s1, x13
; CHECK-SD-NEXT:    scvtf s4, x12
; CHECK-SD-NEXT:    fmov x12, d6
; CHECK-SD-NEXT:    mov v20.s[1], v22.s[0]
; CHECK-SD-NEXT:    mov x13, v5.d[1]
; CHECK-SD-NEXT:    mov v16.s[2], v2.s[0]
; CHECK-SD-NEXT:    mov v17.s[3], v23.s[0]
; CHECK-SD-NEXT:    scvtf s6, x9
; CHECK-SD-NEXT:    scvtf s2, x8
; CHECK-SD-NEXT:    mov v21.s[1], v0.s[0]
; CHECK-SD-NEXT:    scvtf s0, x14
; CHECK-SD-NEXT:    scvtf s22, x12
; CHECK-SD-NEXT:    fmov x14, d5
; CHECK-SD-NEXT:    mov v4.s[1], v1.s[0]
; CHECK-SD-NEXT:    ldp x9, x12, [sp, #112]
; CHECK-SD-NEXT:    mov v16.s[3], v2.s[0]
; CHECK-SD-NEXT:    bfcvtn v2.4h, v17.4s
; CHECK-SD-NEXT:    scvtf s1, x14
; CHECK-SD-NEXT:    fmov x14, d3
; CHECK-SD-NEXT:    mov v22.s[1], v6.s[0]
; CHECK-SD-NEXT:    scvtf s6, x11
; CHECK-SD-NEXT:    fmov x11, d7
; CHECK-SD-NEXT:    scvtf s5, x9
; CHECK-SD-NEXT:    mov x9, v3.d[1]
; CHECK-SD-NEXT:    scvtf s3, x10
; CHECK-SD-NEXT:    mov v21.s[2], v0.s[0]
; CHECK-SD-NEXT:    scvtf s0, x14
; CHECK-SD-NEXT:    mov x10, v7.d[1]
; CHECK-SD-NEXT:    bfcvtn2 v2.8h, v16.4s
; CHECK-SD-NEXT:    scvtf s7, x11
; CHECK-SD-NEXT:    mov v4.s[2], v1.s[0]
; CHECK-SD-NEXT:    scvtf s1, x13
; CHECK-SD-NEXT:    mov v19.s[2], v5.s[0]
; CHECK-SD-NEXT:    mov v18.s[3], v3.s[0]
; CHECK-SD-NEXT:    mov v21.s[3], v6.s[0]
; CHECK-SD-NEXT:    scvtf s3, x9
; CHECK-SD-NEXT:    mov v20.s[2], v0.s[0]
; CHECK-SD-NEXT:    scvtf s0, x12
; CHECK-SD-NEXT:    mov v22.s[2], v7.s[0]
; CHECK-SD-NEXT:    mov v4.s[3], v1.s[0]
; CHECK-SD-NEXT:    scvtf s1, x10
; CHECK-SD-NEXT:    mov v19.s[3], v0.s[0]
; CHECK-SD-NEXT:    mov v20.s[3], v3.s[0]
; CHECK-SD-NEXT:    bfcvtn v0.4h, v21.4s
; CHECK-SD-NEXT:    bfcvtn v3.4h, v18.4s
; CHECK-SD-NEXT:    mov v22.s[3], v1.s[0]
; CHECK-SD-NEXT:    bfcvtn v1.4h, v4.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v20.4s
; CHECK-SD-NEXT:    bfcvtn2 v3.8h, v19.4s
; CHECK-SD-NEXT:    bfcvtn2 v1.8h, v22.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_v32i64_v32bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    str d10, [sp, #-32]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    stp d9, d8, [sp, #16] // 16-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 32
; CHECK-GI-NEXT:    .cfi_offset b8, -8
; CHECK-GI-NEXT:    .cfi_offset b9, -16
; CHECK-GI-NEXT:    .cfi_offset b10, -32
; CHECK-GI-NEXT:    mov x9, v1.d[1]
; CHECK-GI-NEXT:    fmov x10, d0
; CHECK-GI-NEXT:    mov x11, v2.d[1]
; CHECK-GI-NEXT:    mov x8, v0.d[1]
; CHECK-GI-NEXT:    ldp q26, q23, [sp, #32]
; CHECK-GI-NEXT:    fmov x12, d4
; CHECK-GI-NEXT:    mov x13, v6.d[1]
; CHECK-GI-NEXT:    scvtf s0, x10
; CHECK-GI-NEXT:    fmov x10, d1
; CHECK-GI-NEXT:    scvtf s1, x9
; CHECK-GI-NEXT:    mov x9, v4.d[1]
; CHECK-GI-NEXT:    scvtf s20, x11
; CHECK-GI-NEXT:    fmov x11, d3
; CHECK-GI-NEXT:    ldp q30, q27, [sp, #96]
; CHECK-GI-NEXT:    scvtf s18, x10
; CHECK-GI-NEXT:    mov x10, v5.d[1]
; CHECK-GI-NEXT:    scvtf s28, x8
; CHECK-GI-NEXT:    fmov x8, d2
; CHECK-GI-NEXT:    ldp q24, q22, [sp, #64]
; CHECK-GI-NEXT:    scvtf s19, x11
; CHECK-GI-NEXT:    fmov x11, d5
; CHECK-GI-NEXT:    scvtf s2, x12
; CHECK-GI-NEXT:    scvtf s8, x9
; CHECK-GI-NEXT:    ldp q31, q17, [sp, #128]
; CHECK-GI-NEXT:    fmov x9, d6
; CHECK-GI-NEXT:    fmov x12, d7
; CHECK-GI-NEXT:    scvtf s16, x8
; CHECK-GI-NEXT:    mov x8, v3.d[1]
; CHECK-GI-NEXT:    scvtf s21, x11
; CHECK-GI-NEXT:    scvtf s3, x10
; CHECK-GI-NEXT:    mov x10, v26.d[1]
; CHECK-GI-NEXT:    mov x11, v23.d[1]
; CHECK-GI-NEXT:    scvtf s25, x13
; CHECK-GI-NEXT:    scvtf s4, x9
; CHECK-GI-NEXT:    mov x9, v7.d[1]
; CHECK-GI-NEXT:    fmov x13, d26
; CHECK-GI-NEXT:    scvtf s7, x12
; CHECK-GI-NEXT:    mov x12, v30.d[1]
; CHECK-GI-NEXT:    mov x14, v24.d[1]
; CHECK-GI-NEXT:    mov v0.s[1], v28.s[0]
; CHECK-GI-NEXT:    mov v2.s[1], v8.s[0]
; CHECK-GI-NEXT:    mov v16.s[1], v20.s[0]
; CHECK-GI-NEXT:    scvtf s5, x13
; CHECK-GI-NEXT:    scvtf s10, x10
; CHECK-GI-NEXT:    fmov x10, d23
; CHECK-GI-NEXT:    fmov x13, d24
; CHECK-GI-NEXT:    scvtf s23, x11
; CHECK-GI-NEXT:    fmov x11, d30
; CHECK-GI-NEXT:    scvtf s9, x12
; CHECK-GI-NEXT:    fmov x12, d22
; CHECK-GI-NEXT:    scvtf s29, x14
; CHECK-GI-NEXT:    fmov x14, d27
; CHECK-GI-NEXT:    scvtf s26, x10
; CHECK-GI-NEXT:    mov x10, v22.d[1]
; CHECK-GI-NEXT:    scvtf s6, x13
; CHECK-GI-NEXT:    mov x13, v31.d[1]
; CHECK-GI-NEXT:    scvtf s24, x11
; CHECK-GI-NEXT:    mov x11, v27.d[1]
; CHECK-GI-NEXT:    scvtf s27, x12
; CHECK-GI-NEXT:    fmov x12, d31
; CHECK-GI-NEXT:    scvtf s30, x14
; CHECK-GI-NEXT:    mov v5.s[1], v10.s[0]
; CHECK-GI-NEXT:    mov v4.s[1], v25.s[0]
; CHECK-GI-NEXT:    mov v0.s[2], v18.s[0]
; CHECK-GI-NEXT:    mov v2.s[2], v21.s[0]
; CHECK-GI-NEXT:    scvtf s18, x8
; CHECK-GI-NEXT:    scvtf s22, x12
; CHECK-GI-NEXT:    scvtf s31, x13
; CHECK-GI-NEXT:    mov v24.s[1], v9.s[0]
; CHECK-GI-NEXT:    ldp d9, d8, [sp, #16] // 16-byte Folded Reload
; CHECK-GI-NEXT:    fmov x12, d17
; CHECK-GI-NEXT:    scvtf s28, x11
; CHECK-GI-NEXT:    mov x11, v17.d[1]
; CHECK-GI-NEXT:    mov v6.s[1], v29.s[0]
; CHECK-GI-NEXT:    mov v5.s[2], v26.s[0]
; CHECK-GI-NEXT:    scvtf s20, x9
; CHECK-GI-NEXT:    scvtf s21, x10
; CHECK-GI-NEXT:    scvtf s17, x12
; CHECK-GI-NEXT:    mov v22.s[1], v31.s[0]
; CHECK-GI-NEXT:    mov v24.s[2], v30.s[0]
; CHECK-GI-NEXT:    mov v16.s[2], v19.s[0]
; CHECK-GI-NEXT:    mov v4.s[2], v7.s[0]
; CHECK-GI-NEXT:    mov v0.s[3], v1.s[0]
; CHECK-GI-NEXT:    scvtf s25, x11
; CHECK-GI-NEXT:    mov v6.s[2], v27.s[0]
; CHECK-GI-NEXT:    mov v2.s[3], v3.s[0]
; CHECK-GI-NEXT:    mov v5.s[3], v23.s[0]
; CHECK-GI-NEXT:    mov v22.s[2], v17.s[0]
; CHECK-GI-NEXT:    mov v24.s[3], v28.s[0]
; CHECK-GI-NEXT:    mov v16.s[3], v18.s[0]
; CHECK-GI-NEXT:    mov v4.s[3], v20.s[0]
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    mov v6.s[3], v21.s[0]
; CHECK-GI-NEXT:    bfcvtn v1.4h, v2.4s
; CHECK-GI-NEXT:    bfcvtn v2.4h, v5.4s
; CHECK-GI-NEXT:    mov v22.s[3], v25.s[0]
; CHECK-GI-NEXT:    bfcvtn v3.4h, v24.4s
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v16.4s
; CHECK-GI-NEXT:    bfcvtn2 v1.8h, v4.4s
; CHECK-GI-NEXT:    bfcvtn2 v2.8h, v6.4s
; CHECK-GI-NEXT:    bfcvtn2 v3.8h, v22.4s
; CHECK-GI-NEXT:    ldr d10, [sp], #32 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp <32 x i64> %a to <32 x bfloat>
  ret <32 x bfloat> %c
}

define <32 x bfloat> @utofp_v32i64_v32bf16(<32 x i64> %a) {
; CHECK-SD-LABEL: utofp_v32i64_v32bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    ldp x8, x9, [sp, #32]
; CHECK-SD-NEXT:    mov x14, v2.d[1]
; CHECK-SD-NEXT:    ldp x10, x11, [sp]
; CHECK-SD-NEXT:    ldp x12, x13, [sp, #96]
; CHECK-SD-NEXT:    ucvtf s18, x9
; CHECK-SD-NEXT:    ucvtf s16, x8
; CHECK-SD-NEXT:    ldp x8, x9, [sp, #64]
; CHECK-SD-NEXT:    ucvtf s17, x10
; CHECK-SD-NEXT:    ucvtf s19, x11
; CHECK-SD-NEXT:    ucvtf s21, x13
; CHECK-SD-NEXT:    mov x13, v4.d[1]
; CHECK-SD-NEXT:    ucvtf s20, x9
; CHECK-SD-NEXT:    ldp x10, x9, [sp, #16]
; CHECK-SD-NEXT:    mov v16.s[1], v18.s[0]
; CHECK-SD-NEXT:    ucvtf s18, x8
; CHECK-SD-NEXT:    mov v17.s[1], v19.s[0]
; CHECK-SD-NEXT:    ucvtf s19, x12
; CHECK-SD-NEXT:    mov x12, v0.d[1]
; CHECK-SD-NEXT:    ucvtf s22, x10
; CHECK-SD-NEXT:    ldp x11, x10, [sp, #80]
; CHECK-SD-NEXT:    ldp x15, x8, [sp, #48]
; CHECK-SD-NEXT:    mov v18.s[1], v20.s[0]
; CHECK-SD-NEXT:    ucvtf s23, x11
; CHECK-SD-NEXT:    fmov x11, d2
; CHECK-SD-NEXT:    mov v19.s[1], v21.s[0]
; CHECK-SD-NEXT:    mov v17.s[2], v22.s[0]
; CHECK-SD-NEXT:    ucvtf s22, x14
; CHECK-SD-NEXT:    fmov x14, d1
; CHECK-SD-NEXT:    ucvtf s2, x15
; CHECK-SD-NEXT:    ucvtf s20, x11
; CHECK-SD-NEXT:    fmov x11, d0
; CHECK-SD-NEXT:    ucvtf s0, x12
; CHECK-SD-NEXT:    fmov x12, d4
; CHECK-SD-NEXT:    mov v18.s[2], v23.s[0]
; CHECK-SD-NEXT:    ucvtf s23, x9
; CHECK-SD-NEXT:    mov x9, v6.d[1]
; CHECK-SD-NEXT:    ucvtf s21, x11
; CHECK-SD-NEXT:    mov x11, v1.d[1]
; CHECK-SD-NEXT:    ucvtf s1, x13
; CHECK-SD-NEXT:    ucvtf s4, x12
; CHECK-SD-NEXT:    fmov x12, d6
; CHECK-SD-NEXT:    mov v20.s[1], v22.s[0]
; CHECK-SD-NEXT:    mov x13, v5.d[1]
; CHECK-SD-NEXT:    mov v16.s[2], v2.s[0]
; CHECK-SD-NEXT:    mov v17.s[3], v23.s[0]
; CHECK-SD-NEXT:    ucvtf s6, x9
; CHECK-SD-NEXT:    ucvtf s2, x8
; CHECK-SD-NEXT:    mov v21.s[1], v0.s[0]
; CHECK-SD-NEXT:    ucvtf s0, x14
; CHECK-SD-NEXT:    ucvtf s22, x12
; CHECK-SD-NEXT:    fmov x14, d5
; CHECK-SD-NEXT:    mov v4.s[1], v1.s[0]
; CHECK-SD-NEXT:    ldp x9, x12, [sp, #112]
; CHECK-SD-NEXT:    mov v16.s[3], v2.s[0]
; CHECK-SD-NEXT:    bfcvtn v2.4h, v17.4s
; CHECK-SD-NEXT:    ucvtf s1, x14
; CHECK-SD-NEXT:    fmov x14, d3
; CHECK-SD-NEXT:    mov v22.s[1], v6.s[0]
; CHECK-SD-NEXT:    ucvtf s6, x11
; CHECK-SD-NEXT:    fmov x11, d7
; CHECK-SD-NEXT:    ucvtf s5, x9
; CHECK-SD-NEXT:    mov x9, v3.d[1]
; CHECK-SD-NEXT:    ucvtf s3, x10
; CHECK-SD-NEXT:    mov v21.s[2], v0.s[0]
; CHECK-SD-NEXT:    ucvtf s0, x14
; CHECK-SD-NEXT:    mov x10, v7.d[1]
; CHECK-SD-NEXT:    bfcvtn2 v2.8h, v16.4s
; CHECK-SD-NEXT:    ucvtf s7, x11
; CHECK-SD-NEXT:    mov v4.s[2], v1.s[0]
; CHECK-SD-NEXT:    ucvtf s1, x13
; CHECK-SD-NEXT:    mov v19.s[2], v5.s[0]
; CHECK-SD-NEXT:    mov v18.s[3], v3.s[0]
; CHECK-SD-NEXT:    mov v21.s[3], v6.s[0]
; CHECK-SD-NEXT:    ucvtf s3, x9
; CHECK-SD-NEXT:    mov v20.s[2], v0.s[0]
; CHECK-SD-NEXT:    ucvtf s0, x12
; CHECK-SD-NEXT:    mov v22.s[2], v7.s[0]
; CHECK-SD-NEXT:    mov v4.s[3], v1.s[0]
; CHECK-SD-NEXT:    ucvtf s1, x10
; CHECK-SD-NEXT:    mov v19.s[3], v0.s[0]
; CHECK-SD-NEXT:    mov v20.s[3], v3.s[0]
; CHECK-SD-NEXT:    bfcvtn v0.4h, v21.4s
; CHECK-SD-NEXT:    bfcvtn v3.4h, v18.4s
; CHECK-SD-NEXT:    mov v22.s[3], v1.s[0]
; CHECK-SD-NEXT:    bfcvtn v1.4h, v4.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v20.4s
; CHECK-SD-NEXT:    bfcvtn2 v3.8h, v19.4s
; CHECK-SD-NEXT:    bfcvtn2 v1.8h, v22.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_v32i64_v32bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    str d10, [sp, #-32]! // 8-byte Folded Spill
; CHECK-GI-NEXT:    stp d9, d8, [sp, #16] // 16-byte Folded Spill
; CHECK-GI-NEXT:    .cfi_def_cfa_offset 32
; CHECK-GI-NEXT:    .cfi_offset b8, -8
; CHECK-GI-NEXT:    .cfi_offset b9, -16
; CHECK-GI-NEXT:    .cfi_offset b10, -32
; CHECK-GI-NEXT:    mov x9, v1.d[1]
; CHECK-GI-NEXT:    fmov x10, d0
; CHECK-GI-NEXT:    mov x11, v2.d[1]
; CHECK-GI-NEXT:    mov x8, v0.d[1]
; CHECK-GI-NEXT:    ldp q26, q23, [sp, #32]
; CHECK-GI-NEXT:    fmov x12, d4
; CHECK-GI-NEXT:    mov x13, v6.d[1]
; CHECK-GI-NEXT:    ucvtf s0, x10
; CHECK-GI-NEXT:    fmov x10, d1
; CHECK-GI-NEXT:    ucvtf s1, x9
; CHECK-GI-NEXT:    mov x9, v4.d[1]
; CHECK-GI-NEXT:    ucvtf s20, x11
; CHECK-GI-NEXT:    fmov x11, d3
; CHECK-GI-NEXT:    ldp q30, q27, [sp, #96]
; CHECK-GI-NEXT:    ucvtf s18, x10
; CHECK-GI-NEXT:    mov x10, v5.d[1]
; CHECK-GI-NEXT:    ucvtf s28, x8
; CHECK-GI-NEXT:    fmov x8, d2
; CHECK-GI-NEXT:    ldp q24, q22, [sp, #64]
; CHECK-GI-NEXT:    ucvtf s19, x11
; CHECK-GI-NEXT:    fmov x11, d5
; CHECK-GI-NEXT:    ucvtf s2, x12
; CHECK-GI-NEXT:    ucvtf s8, x9
; CHECK-GI-NEXT:    ldp q31, q17, [sp, #128]
; CHECK-GI-NEXT:    fmov x9, d6
; CHECK-GI-NEXT:    fmov x12, d7
; CHECK-GI-NEXT:    ucvtf s16, x8
; CHECK-GI-NEXT:    mov x8, v3.d[1]
; CHECK-GI-NEXT:    ucvtf s21, x11
; CHECK-GI-NEXT:    ucvtf s3, x10
; CHECK-GI-NEXT:    mov x10, v26.d[1]
; CHECK-GI-NEXT:    mov x11, v23.d[1]
; CHECK-GI-NEXT:    ucvtf s25, x13
; CHECK-GI-NEXT:    ucvtf s4, x9
; CHECK-GI-NEXT:    mov x9, v7.d[1]
; CHECK-GI-NEXT:    fmov x13, d26
; CHECK-GI-NEXT:    ucvtf s7, x12
; CHECK-GI-NEXT:    mov x12, v30.d[1]
; CHECK-GI-NEXT:    mov x14, v24.d[1]
; CHECK-GI-NEXT:    mov v0.s[1], v28.s[0]
; CHECK-GI-NEXT:    mov v2.s[1], v8.s[0]
; CHECK-GI-NEXT:    mov v16.s[1], v20.s[0]
; CHECK-GI-NEXT:    ucvtf s5, x13
; CHECK-GI-NEXT:    ucvtf s10, x10
; CHECK-GI-NEXT:    fmov x10, d23
; CHECK-GI-NEXT:    fmov x13, d24
; CHECK-GI-NEXT:    ucvtf s23, x11
; CHECK-GI-NEXT:    fmov x11, d30
; CHECK-GI-NEXT:    ucvtf s9, x12
; CHECK-GI-NEXT:    fmov x12, d22
; CHECK-GI-NEXT:    ucvtf s29, x14
; CHECK-GI-NEXT:    fmov x14, d27
; CHECK-GI-NEXT:    ucvtf s26, x10
; CHECK-GI-NEXT:    mov x10, v22.d[1]
; CHECK-GI-NEXT:    ucvtf s6, x13
; CHECK-GI-NEXT:    mov x13, v31.d[1]
; CHECK-GI-NEXT:    ucvtf s24, x11
; CHECK-GI-NEXT:    mov x11, v27.d[1]
; CHECK-GI-NEXT:    ucvtf s27, x12
; CHECK-GI-NEXT:    fmov x12, d31
; CHECK-GI-NEXT:    ucvtf s30, x14
; CHECK-GI-NEXT:    mov v5.s[1], v10.s[0]
; CHECK-GI-NEXT:    mov v4.s[1], v25.s[0]
; CHECK-GI-NEXT:    mov v0.s[2], v18.s[0]
; CHECK-GI-NEXT:    mov v2.s[2], v21.s[0]
; CHECK-GI-NEXT:    ucvtf s18, x8
; CHECK-GI-NEXT:    ucvtf s22, x12
; CHECK-GI-NEXT:    ucvtf s31, x13
; CHECK-GI-NEXT:    mov v24.s[1], v9.s[0]
; CHECK-GI-NEXT:    ldp d9, d8, [sp, #16] // 16-byte Folded Reload
; CHECK-GI-NEXT:    fmov x12, d17
; CHECK-GI-NEXT:    ucvtf s28, x11
; CHECK-GI-NEXT:    mov x11, v17.d[1]
; CHECK-GI-NEXT:    mov v6.s[1], v29.s[0]
; CHECK-GI-NEXT:    mov v5.s[2], v26.s[0]
; CHECK-GI-NEXT:    ucvtf s20, x9
; CHECK-GI-NEXT:    ucvtf s21, x10
; CHECK-GI-NEXT:    ucvtf s17, x12
; CHECK-GI-NEXT:    mov v22.s[1], v31.s[0]
; CHECK-GI-NEXT:    mov v24.s[2], v30.s[0]
; CHECK-GI-NEXT:    mov v16.s[2], v19.s[0]
; CHECK-GI-NEXT:    mov v4.s[2], v7.s[0]
; CHECK-GI-NEXT:    mov v0.s[3], v1.s[0]
; CHECK-GI-NEXT:    ucvtf s25, x11
; CHECK-GI-NEXT:    mov v6.s[2], v27.s[0]
; CHECK-GI-NEXT:    mov v2.s[3], v3.s[0]
; CHECK-GI-NEXT:    mov v5.s[3], v23.s[0]
; CHECK-GI-NEXT:    mov v22.s[2], v17.s[0]
; CHECK-GI-NEXT:    mov v24.s[3], v28.s[0]
; CHECK-GI-NEXT:    mov v16.s[3], v18.s[0]
; CHECK-GI-NEXT:    mov v4.s[3], v20.s[0]
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    mov v6.s[3], v21.s[0]
; CHECK-GI-NEXT:    bfcvtn v1.4h, v2.4s
; CHECK-GI-NEXT:    bfcvtn v2.4h, v5.4s
; CHECK-GI-NEXT:    mov v22.s[3], v25.s[0]
; CHECK-GI-NEXT:    bfcvtn v3.4h, v24.4s
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v16.4s
; CHECK-GI-NEXT:    bfcvtn2 v1.8h, v4.4s
; CHECK-GI-NEXT:    bfcvtn2 v2.8h, v6.4s
; CHECK-GI-NEXT:    bfcvtn2 v3.8h, v22.4s
; CHECK-GI-NEXT:    ldr d10, [sp], #32 // 8-byte Folded Reload
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp <32 x i64> %a to <32 x bfloat>
  ret <32 x bfloat> %c
}

define <2 x bfloat> @stofp_v2i32_v2bf16(<2 x i32> %a) {
; CHECK-SD-LABEL: stofp_v2i32_v2bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    // kill: def $d0 killed $d0 def $q0
; CHECK-SD-NEXT:    scvtf v0.4s, v0.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_v2i32_v2bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    scvtf v0.2s, v0.2s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp <2 x i32> %a to <2 x bfloat>
  ret <2 x bfloat> %c
}

define <2 x bfloat> @utofp_v2i32_v2bf16(<2 x i32> %a) {
; CHECK-SD-LABEL: utofp_v2i32_v2bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    // kill: def $d0 killed $d0 def $q0
; CHECK-SD-NEXT:    ucvtf v0.4s, v0.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_v2i32_v2bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    ucvtf v0.2s, v0.2s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp <2 x i32> %a to <2 x bfloat>
  ret <2 x bfloat> %c
}

define <3 x bfloat> @stofp_v3i32_v3bf16(<3 x i32> %a) {
; CHECK-LABEL: stofp_v3i32_v3bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    scvtf v0.4s, v0.4s
; CHECK-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-NEXT:    ret
entry:
  %c = sitofp <3 x i32> %a to <3 x bfloat>
  ret <3 x bfloat> %c
}

define <3 x bfloat> @utofp_v3i32_v3bf16(<3 x i32> %a) {
; CHECK-LABEL: utofp_v3i32_v3bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    ucvtf v0.4s, v0.4s
; CHECK-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-NEXT:    ret
entry:
  %c = uitofp <3 x i32> %a to <3 x bfloat>
  ret <3 x bfloat> %c
}

define <4 x bfloat> @stofp_v4i32_v4bf16(<4 x i32> %a) {
; CHECK-LABEL: stofp_v4i32_v4bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    scvtf v0.4s, v0.4s
; CHECK-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-NEXT:    ret
entry:
  %c = sitofp <4 x i32> %a to <4 x bfloat>
  ret <4 x bfloat> %c
}

define <4 x bfloat> @utofp_v4i32_v4bf16(<4 x i32> %a) {
; CHECK-LABEL: utofp_v4i32_v4bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    ucvtf v0.4s, v0.4s
; CHECK-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-NEXT:    ret
entry:
  %c = uitofp <4 x i32> %a to <4 x bfloat>
  ret <4 x bfloat> %c
}

define <8 x bfloat> @stofp_v8i32_v8bf16(<8 x i32> %a) {
; CHECK-LABEL: stofp_v8i32_v8bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    scvtf v0.4s, v0.4s
; CHECK-NEXT:    scvtf v1.4s, v1.4s
; CHECK-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-NEXT:    bfcvtn2 v0.8h, v1.4s
; CHECK-NEXT:    ret
entry:
  %c = sitofp <8 x i32> %a to <8 x bfloat>
  ret <8 x bfloat> %c
}

define <8 x bfloat> @utofp_v8i32_v8bf16(<8 x i32> %a) {
; CHECK-LABEL: utofp_v8i32_v8bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    ucvtf v0.4s, v0.4s
; CHECK-NEXT:    ucvtf v1.4s, v1.4s
; CHECK-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-NEXT:    bfcvtn2 v0.8h, v1.4s
; CHECK-NEXT:    ret
entry:
  %c = uitofp <8 x i32> %a to <8 x bfloat>
  ret <8 x bfloat> %c
}

define <16 x bfloat> @stofp_v16i32_v16bf16(<16 x i32> %a) {
; CHECK-SD-LABEL: stofp_v16i32_v16bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    scvtf v0.4s, v0.4s
; CHECK-SD-NEXT:    scvtf v2.4s, v2.4s
; CHECK-SD-NEXT:    scvtf v4.4s, v1.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-SD-NEXT:    bfcvtn v1.4h, v2.4s
; CHECK-SD-NEXT:    scvtf v2.4s, v3.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v4.4s
; CHECK-SD-NEXT:    bfcvtn2 v1.8h, v2.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_v16i32_v16bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    scvtf v0.4s, v0.4s
; CHECK-GI-NEXT:    scvtf v2.4s, v2.4s
; CHECK-GI-NEXT:    scvtf v4.4s, v1.4s
; CHECK-GI-NEXT:    scvtf v3.4s, v3.4s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    bfcvtn v1.4h, v2.4s
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v4.4s
; CHECK-GI-NEXT:    bfcvtn2 v1.8h, v3.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp <16 x i32> %a to <16 x bfloat>
  ret <16 x bfloat> %c
}

define <16 x bfloat> @utofp_v16i32_v16bf16(<16 x i32> %a) {
; CHECK-SD-LABEL: utofp_v16i32_v16bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    ucvtf v0.4s, v0.4s
; CHECK-SD-NEXT:    ucvtf v2.4s, v2.4s
; CHECK-SD-NEXT:    ucvtf v4.4s, v1.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-SD-NEXT:    bfcvtn v1.4h, v2.4s
; CHECK-SD-NEXT:    ucvtf v2.4s, v3.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v4.4s
; CHECK-SD-NEXT:    bfcvtn2 v1.8h, v2.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_v16i32_v16bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    ucvtf v0.4s, v0.4s
; CHECK-GI-NEXT:    ucvtf v2.4s, v2.4s
; CHECK-GI-NEXT:    ucvtf v4.4s, v1.4s
; CHECK-GI-NEXT:    ucvtf v3.4s, v3.4s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    bfcvtn v1.4h, v2.4s
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v4.4s
; CHECK-GI-NEXT:    bfcvtn2 v1.8h, v3.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp <16 x i32> %a to <16 x bfloat>
  ret <16 x bfloat> %c
}

define <32 x bfloat> @stofp_v32i32_v32bf16(<32 x i32> %a) {
; CHECK-LABEL: stofp_v32i32_v32bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    scvtf v0.4s, v0.4s
; CHECK-NEXT:    scvtf v2.4s, v2.4s
; CHECK-NEXT:    scvtf v4.4s, v4.4s
; CHECK-NEXT:    scvtf v6.4s, v6.4s
; CHECK-NEXT:    scvtf v16.4s, v1.4s
; CHECK-NEXT:    scvtf v17.4s, v3.4s
; CHECK-NEXT:    scvtf v5.4s, v5.4s
; CHECK-NEXT:    scvtf v7.4s, v7.4s
; CHECK-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-NEXT:    bfcvtn v1.4h, v2.4s
; CHECK-NEXT:    bfcvtn v2.4h, v4.4s
; CHECK-NEXT:    bfcvtn v3.4h, v6.4s
; CHECK-NEXT:    bfcvtn2 v0.8h, v16.4s
; CHECK-NEXT:    bfcvtn2 v1.8h, v17.4s
; CHECK-NEXT:    bfcvtn2 v2.8h, v5.4s
; CHECK-NEXT:    bfcvtn2 v3.8h, v7.4s
; CHECK-NEXT:    ret
entry:
  %c = sitofp <32 x i32> %a to <32 x bfloat>
  ret <32 x bfloat> %c
}

define <32 x bfloat> @utofp_v32i32_v32bf16(<32 x i32> %a) {
; CHECK-LABEL: utofp_v32i32_v32bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    ucvtf v0.4s, v0.4s
; CHECK-NEXT:    ucvtf v2.4s, v2.4s
; CHECK-NEXT:    ucvtf v4.4s, v4.4s
; CHECK-NEXT:    ucvtf v6.4s, v6.4s
; CHECK-NEXT:    ucvtf v16.4s, v1.4s
; CHECK-NEXT:    ucvtf v17.4s, v3.4s
; CHECK-NEXT:    ucvtf v5.4s, v5.4s
; CHECK-NEXT:    ucvtf v7.4s, v7.4s
; CHECK-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-NEXT:    bfcvtn v1.4h, v2.4s
; CHECK-NEXT:    bfcvtn v2.4h, v4.4s
; CHECK-NEXT:    bfcvtn v3.4h, v6.4s
; CHECK-NEXT:    bfcvtn2 v0.8h, v16.4s
; CHECK-NEXT:    bfcvtn2 v1.8h, v17.4s
; CHECK-NEXT:    bfcvtn2 v2.8h, v5.4s
; CHECK-NEXT:    bfcvtn2 v3.8h, v7.4s
; CHECK-NEXT:    ret
entry:
  %c = uitofp <32 x i32> %a to <32 x bfloat>
  ret <32 x bfloat> %c
}

define <2 x bfloat> @stofp_v2i16_v2bf16(<2 x i16> %a) {
; CHECK-SD-LABEL: stofp_v2i16_v2bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    uzp1 v0.4h, v0.4h, v0.4h
; CHECK-SD-NEXT:    sshll v0.4s, v0.4h, #0
; CHECK-SD-NEXT:    scvtf v0.4s, v0.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_v2i16_v2bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    shl v0.2s, v0.2s, #16
; CHECK-GI-NEXT:    sshr v0.2s, v0.2s, #16
; CHECK-GI-NEXT:    scvtf v0.2s, v0.2s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp <2 x i16> %a to <2 x bfloat>
  ret <2 x bfloat> %c
}

define <2 x bfloat> @utofp_v2i16_v2bf16(<2 x i16> %a) {
; CHECK-SD-LABEL: utofp_v2i16_v2bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    uzp1 v0.4h, v0.4h, v0.4h
; CHECK-SD-NEXT:    ushll v0.4s, v0.4h, #0
; CHECK-SD-NEXT:    ucvtf v0.4s, v0.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_v2i16_v2bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    movi d1, #0x00ffff0000ffff
; CHECK-GI-NEXT:    and v0.8b, v0.8b, v1.8b
; CHECK-GI-NEXT:    ucvtf v0.2s, v0.2s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp <2 x i16> %a to <2 x bfloat>
  ret <2 x bfloat> %c
}

define <3 x bfloat> @stofp_v3i16_v3bf16(<3 x i16> %a) {
; CHECK-LABEL: stofp_v3i16_v3bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    sshll v0.4s, v0.4h, #0
; CHECK-NEXT:    scvtf v0.4s, v0.4s
; CHECK-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-NEXT:    ret
entry:
  %c = sitofp <3 x i16> %a to <3 x bfloat>
  ret <3 x bfloat> %c
}

define <3 x bfloat> @utofp_v3i16_v3bf16(<3 x i16> %a) {
; CHECK-LABEL: utofp_v3i16_v3bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    ushll v0.4s, v0.4h, #0
; CHECK-NEXT:    ucvtf v0.4s, v0.4s
; CHECK-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-NEXT:    ret
entry:
  %c = uitofp <3 x i16> %a to <3 x bfloat>
  ret <3 x bfloat> %c
}

define <4 x bfloat> @stofp_v4i16_v4bf16(<4 x i16> %a) {
; CHECK-LABEL: stofp_v4i16_v4bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    sshll v0.4s, v0.4h, #0
; CHECK-NEXT:    scvtf v0.4s, v0.4s
; CHECK-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-NEXT:    ret
entry:
  %c = sitofp <4 x i16> %a to <4 x bfloat>
  ret <4 x bfloat> %c
}

define <4 x bfloat> @utofp_v4i16_v4bf16(<4 x i16> %a) {
; CHECK-LABEL: utofp_v4i16_v4bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    ushll v0.4s, v0.4h, #0
; CHECK-NEXT:    ucvtf v0.4s, v0.4s
; CHECK-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-NEXT:    ret
entry:
  %c = uitofp <4 x i16> %a to <4 x bfloat>
  ret <4 x bfloat> %c
}

define <8 x bfloat> @stofp_v8i16_v8bf16(<8 x i16> %a) {
; CHECK-SD-LABEL: stofp_v8i16_v8bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    sshll v1.4s, v0.4h, #0
; CHECK-SD-NEXT:    sshll2 v2.4s, v0.8h, #0
; CHECK-SD-NEXT:    scvtf v1.4s, v1.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v1.4s
; CHECK-SD-NEXT:    scvtf v1.4s, v2.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v1.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_v8i16_v8bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    sshll v1.4s, v0.4h, #0
; CHECK-GI-NEXT:    sshll2 v0.4s, v0.8h, #0
; CHECK-GI-NEXT:    scvtf v1.4s, v1.4s
; CHECK-GI-NEXT:    scvtf v2.4s, v0.4s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v1.4s
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v2.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp <8 x i16> %a to <8 x bfloat>
  ret <8 x bfloat> %c
}

define <8 x bfloat> @utofp_v8i16_v8bf16(<8 x i16> %a) {
; CHECK-SD-LABEL: utofp_v8i16_v8bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    ushll v1.4s, v0.4h, #0
; CHECK-SD-NEXT:    ushll2 v2.4s, v0.8h, #0
; CHECK-SD-NEXT:    ucvtf v1.4s, v1.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v1.4s
; CHECK-SD-NEXT:    ucvtf v1.4s, v2.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v1.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_v8i16_v8bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    ushll v1.4s, v0.4h, #0
; CHECK-GI-NEXT:    ushll2 v0.4s, v0.8h, #0
; CHECK-GI-NEXT:    ucvtf v1.4s, v1.4s
; CHECK-GI-NEXT:    ucvtf v2.4s, v0.4s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v1.4s
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v2.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp <8 x i16> %a to <8 x bfloat>
  ret <8 x bfloat> %c
}

define <16 x bfloat> @stofp_v16i16_v16bf16(<16 x i16> %a) {
; CHECK-SD-LABEL: stofp_v16i16_v16bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    sshll v2.4s, v0.4h, #0
; CHECK-SD-NEXT:    sshll v3.4s, v1.4h, #0
; CHECK-SD-NEXT:    sshll2 v4.4s, v0.8h, #0
; CHECK-SD-NEXT:    sshll2 v5.4s, v1.8h, #0
; CHECK-SD-NEXT:    scvtf v2.4s, v2.4s
; CHECK-SD-NEXT:    scvtf v3.4s, v3.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v2.4s
; CHECK-SD-NEXT:    scvtf v2.4s, v4.4s
; CHECK-SD-NEXT:    bfcvtn v1.4h, v3.4s
; CHECK-SD-NEXT:    scvtf v3.4s, v5.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v2.4s
; CHECK-SD-NEXT:    bfcvtn2 v1.8h, v3.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_v16i16_v16bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    sshll v2.4s, v0.4h, #0
; CHECK-GI-NEXT:    sshll v3.4s, v1.4h, #0
; CHECK-GI-NEXT:    sshll2 v0.4s, v0.8h, #0
; CHECK-GI-NEXT:    sshll2 v1.4s, v1.8h, #0
; CHECK-GI-NEXT:    scvtf v2.4s, v2.4s
; CHECK-GI-NEXT:    scvtf v3.4s, v3.4s
; CHECK-GI-NEXT:    scvtf v4.4s, v0.4s
; CHECK-GI-NEXT:    scvtf v5.4s, v1.4s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v2.4s
; CHECK-GI-NEXT:    bfcvtn v1.4h, v3.4s
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v4.4s
; CHECK-GI-NEXT:    bfcvtn2 v1.8h, v5.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp <16 x i16> %a to <16 x bfloat>
  ret <16 x bfloat> %c
}

define <16 x bfloat> @utofp_v16i16_v16bf16(<16 x i16> %a) {
; CHECK-SD-LABEL: utofp_v16i16_v16bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    ushll v2.4s, v0.4h, #0
; CHECK-SD-NEXT:    ushll v3.4s, v1.4h, #0
; CHECK-SD-NEXT:    ushll2 v4.4s, v0.8h, #0
; CHECK-SD-NEXT:    ushll2 v5.4s, v1.8h, #0
; CHECK-SD-NEXT:    ucvtf v2.4s, v2.4s
; CHECK-SD-NEXT:    ucvtf v3.4s, v3.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v2.4s
; CHECK-SD-NEXT:    ucvtf v2.4s, v4.4s
; CHECK-SD-NEXT:    bfcvtn v1.4h, v3.4s
; CHECK-SD-NEXT:    ucvtf v3.4s, v5.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v2.4s
; CHECK-SD-NEXT:    bfcvtn2 v1.8h, v3.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_v16i16_v16bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    ushll v2.4s, v0.4h, #0
; CHECK-GI-NEXT:    ushll v3.4s, v1.4h, #0
; CHECK-GI-NEXT:    ushll2 v0.4s, v0.8h, #0
; CHECK-GI-NEXT:    ushll2 v1.4s, v1.8h, #0
; CHECK-GI-NEXT:    ucvtf v2.4s, v2.4s
; CHECK-GI-NEXT:    ucvtf v3.4s, v3.4s
; CHECK-GI-NEXT:    ucvtf v4.4s, v0.4s
; CHECK-GI-NEXT:    ucvtf v5.4s, v1.4s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v2.4s
; CHECK-GI-NEXT:    bfcvtn v1.4h, v3.4s
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v4.4s
; CHECK-GI-NEXT:    bfcvtn2 v1.8h, v5.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp <16 x i16> %a to <16 x bfloat>
  ret <16 x bfloat> %c
}

define <32 x bfloat> @stofp_v32i16_v32bf16(<32 x i16> %a) {
; CHECK-LABEL: stofp_v32i16_v32bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    sshll v4.4s, v0.4h, #0
; CHECK-NEXT:    sshll v5.4s, v1.4h, #0
; CHECK-NEXT:    sshll v6.4s, v2.4h, #0
; CHECK-NEXT:    sshll v7.4s, v3.4h, #0
; CHECK-NEXT:    sshll2 v0.4s, v0.8h, #0
; CHECK-NEXT:    sshll2 v1.4s, v1.8h, #0
; CHECK-NEXT:    sshll2 v2.4s, v2.8h, #0
; CHECK-NEXT:    sshll2 v3.4s, v3.8h, #0
; CHECK-NEXT:    scvtf v4.4s, v4.4s
; CHECK-NEXT:    scvtf v5.4s, v5.4s
; CHECK-NEXT:    scvtf v6.4s, v6.4s
; CHECK-NEXT:    scvtf v7.4s, v7.4s
; CHECK-NEXT:    scvtf v16.4s, v0.4s
; CHECK-NEXT:    scvtf v17.4s, v1.4s
; CHECK-NEXT:    scvtf v18.4s, v2.4s
; CHECK-NEXT:    scvtf v19.4s, v3.4s
; CHECK-NEXT:    bfcvtn v0.4h, v4.4s
; CHECK-NEXT:    bfcvtn v1.4h, v5.4s
; CHECK-NEXT:    bfcvtn v2.4h, v6.4s
; CHECK-NEXT:    bfcvtn v3.4h, v7.4s
; CHECK-NEXT:    bfcvtn2 v0.8h, v16.4s
; CHECK-NEXT:    bfcvtn2 v1.8h, v17.4s
; CHECK-NEXT:    bfcvtn2 v2.8h, v18.4s
; CHECK-NEXT:    bfcvtn2 v3.8h, v19.4s
; CHECK-NEXT:    ret
entry:
  %c = sitofp <32 x i16> %a to <32 x bfloat>
  ret <32 x bfloat> %c
}

define <32 x bfloat> @utofp_v32i16_v32bf16(<32 x i16> %a) {
; CHECK-LABEL: utofp_v32i16_v32bf16:
; CHECK:       // %bb.0: // %entry
; CHECK-NEXT:    ushll v4.4s, v0.4h, #0
; CHECK-NEXT:    ushll v5.4s, v1.4h, #0
; CHECK-NEXT:    ushll v6.4s, v2.4h, #0
; CHECK-NEXT:    ushll v7.4s, v3.4h, #0
; CHECK-NEXT:    ushll2 v0.4s, v0.8h, #0
; CHECK-NEXT:    ushll2 v1.4s, v1.8h, #0
; CHECK-NEXT:    ushll2 v2.4s, v2.8h, #0
; CHECK-NEXT:    ushll2 v3.4s, v3.8h, #0
; CHECK-NEXT:    ucvtf v4.4s, v4.4s
; CHECK-NEXT:    ucvtf v5.4s, v5.4s
; CHECK-NEXT:    ucvtf v6.4s, v6.4s
; CHECK-NEXT:    ucvtf v7.4s, v7.4s
; CHECK-NEXT:    ucvtf v16.4s, v0.4s
; CHECK-NEXT:    ucvtf v17.4s, v1.4s
; CHECK-NEXT:    ucvtf v18.4s, v2.4s
; CHECK-NEXT:    ucvtf v19.4s, v3.4s
; CHECK-NEXT:    bfcvtn v0.4h, v4.4s
; CHECK-NEXT:    bfcvtn v1.4h, v5.4s
; CHECK-NEXT:    bfcvtn v2.4h, v6.4s
; CHECK-NEXT:    bfcvtn v3.4h, v7.4s
; CHECK-NEXT:    bfcvtn2 v0.8h, v16.4s
; CHECK-NEXT:    bfcvtn2 v1.8h, v17.4s
; CHECK-NEXT:    bfcvtn2 v2.8h, v18.4s
; CHECK-NEXT:    bfcvtn2 v3.8h, v19.4s
; CHECK-NEXT:    ret
entry:
  %c = uitofp <32 x i16> %a to <32 x bfloat>
  ret <32 x bfloat> %c
}

define <2 x bfloat> @stofp_v2i8_v2bf16(<2 x i8> %a) {
; CHECK-SD-LABEL: stofp_v2i8_v2bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    // kill: def $d0 killed $d0 def $q0
; CHECK-SD-NEXT:    mov w8, v0.s[1]
; CHECK-SD-NEXT:    fmov w9, s0
; CHECK-SD-NEXT:    sxtb w9, w9
; CHECK-SD-NEXT:    sxtb w8, w8
; CHECK-SD-NEXT:    scvtf s1, w9
; CHECK-SD-NEXT:    scvtf s0, w8
; CHECK-SD-NEXT:    bfcvt h2, s0
; CHECK-SD-NEXT:    bfcvt h0, s1
; CHECK-SD-NEXT:    mov v0.h[1], v2.h[0]
; CHECK-SD-NEXT:    // kill: def $d0 killed $d0 killed $q0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_v2i8_v2bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    shl v0.2s, v0.2s, #24
; CHECK-GI-NEXT:    sshr v0.2s, v0.2s, #24
; CHECK-GI-NEXT:    scvtf v0.2s, v0.2s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp <2 x i8> %a to <2 x bfloat>
  ret <2 x bfloat> %c
}

define <2 x bfloat> @utofp_v2i8_v2bf16(<2 x i8> %a) {
; CHECK-SD-LABEL: utofp_v2i8_v2bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    // kill: def $d0 killed $d0 def $q0
; CHECK-SD-NEXT:    mov w8, v0.s[1]
; CHECK-SD-NEXT:    fmov w9, s0
; CHECK-SD-NEXT:    and w9, w9, #0xff
; CHECK-SD-NEXT:    and w8, w8, #0xff
; CHECK-SD-NEXT:    ucvtf s1, w9
; CHECK-SD-NEXT:    ucvtf s0, w8
; CHECK-SD-NEXT:    bfcvt h2, s0
; CHECK-SD-NEXT:    bfcvt h0, s1
; CHECK-SD-NEXT:    mov v0.h[1], v2.h[0]
; CHECK-SD-NEXT:    // kill: def $d0 killed $d0 killed $q0
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_v2i8_v2bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    movi d1, #0x0000ff000000ff
; CHECK-GI-NEXT:    and v0.8b, v0.8b, v1.8b
; CHECK-GI-NEXT:    ucvtf v0.2s, v0.2s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp <2 x i8> %a to <2 x bfloat>
  ret <2 x bfloat> %c
}

define <3 x bfloat> @stofp_v3i8_v3bf16(<3 x i8> %a) {
; CHECK-SD-LABEL: stofp_v3i8_v3bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    fmov s0, w0
; CHECK-SD-NEXT:    mov v0.h[1], w1
; CHECK-SD-NEXT:    mov v0.h[2], w2
; CHECK-SD-NEXT:    shl v0.4h, v0.4h, #8
; CHECK-SD-NEXT:    sshr v0.4h, v0.4h, #8
; CHECK-SD-NEXT:    sshll v0.4s, v0.4h, #0
; CHECK-SD-NEXT:    scvtf v0.4s, v0.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_v3i8_v3bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    fmov s0, w0
; CHECK-GI-NEXT:    mov v0.h[1], w1
; CHECK-GI-NEXT:    mov v0.h[2], w2
; CHECK-GI-NEXT:    shl v0.4h, v0.4h, #8
; CHECK-GI-NEXT:    sshr v0.4h, v0.4h, #8
; CHECK-GI-NEXT:    mov v1.h[0], v0.h[2]
; CHECK-GI-NEXT:    mov v1.h[1], v0.h[3]
; CHECK-GI-NEXT:    sshll v0.4s, v0.4h, #0
; CHECK-GI-NEXT:    sshll v1.4s, v1.4h, #0
; CHECK-GI-NEXT:    mov v0.d[1], v1.d[0]
; CHECK-GI-NEXT:    scvtf v0.4s, v0.4s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp <3 x i8> %a to <3 x bfloat>
  ret <3 x bfloat> %c
}

define <3 x bfloat> @utofp_v3i8_v3bf16(<3 x i8> %a) {
; CHECK-SD-LABEL: utofp_v3i8_v3bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    fmov s0, w0
; CHECK-SD-NEXT:    mov v0.h[1], w1
; CHECK-SD-NEXT:    mov v0.h[2], w2
; CHECK-SD-NEXT:    bic v0.4h, #255, lsl #8
; CHECK-SD-NEXT:    ushll v0.4s, v0.4h, #0
; CHECK-SD-NEXT:    ucvtf v0.4s, v0.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_v3i8_v3bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    fmov s0, w0
; CHECK-GI-NEXT:    movi d1, #0xff00ff00ff00ff
; CHECK-GI-NEXT:    mov v0.h[1], w1
; CHECK-GI-NEXT:    mov v0.h[2], w2
; CHECK-GI-NEXT:    and v0.8b, v0.8b, v1.8b
; CHECK-GI-NEXT:    mov v1.h[0], v0.h[2]
; CHECK-GI-NEXT:    mov v1.h[1], v0.h[3]
; CHECK-GI-NEXT:    ushll v0.4s, v0.4h, #0
; CHECK-GI-NEXT:    ushll v1.4s, v1.4h, #0
; CHECK-GI-NEXT:    mov v0.d[1], v1.d[0]
; CHECK-GI-NEXT:    ucvtf v0.4s, v0.4s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp <3 x i8> %a to <3 x bfloat>
  ret <3 x bfloat> %c
}

define <4 x bfloat> @stofp_v4i8_v4bf16(<4 x i8> %a) {
; CHECK-SD-LABEL: stofp_v4i8_v4bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    shl v0.4h, v0.4h, #8
; CHECK-SD-NEXT:    sshr v0.4h, v0.4h, #8
; CHECK-SD-NEXT:    sshll v0.4s, v0.4h, #0
; CHECK-SD-NEXT:    scvtf v0.4s, v0.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_v4i8_v4bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    ushll v0.4s, v0.4h, #0
; CHECK-GI-NEXT:    shl v0.4s, v0.4s, #24
; CHECK-GI-NEXT:    sshr v0.4s, v0.4s, #24
; CHECK-GI-NEXT:    scvtf v0.4s, v0.4s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp <4 x i8> %a to <4 x bfloat>
  ret <4 x bfloat> %c
}

define <4 x bfloat> @utofp_v4i8_v4bf16(<4 x i8> %a) {
; CHECK-SD-LABEL: utofp_v4i8_v4bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    bic v0.4h, #255, lsl #8
; CHECK-SD-NEXT:    ushll v0.4s, v0.4h, #0
; CHECK-SD-NEXT:    ucvtf v0.4s, v0.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_v4i8_v4bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    movi v1.2d, #0x0000ff000000ff
; CHECK-GI-NEXT:    ushll v0.4s, v0.4h, #0
; CHECK-GI-NEXT:    and v0.16b, v0.16b, v1.16b
; CHECK-GI-NEXT:    ucvtf v0.4s, v0.4s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v0.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp <4 x i8> %a to <4 x bfloat>
  ret <4 x bfloat> %c
}

define <8 x bfloat> @stofp_v8i8_v8bf16(<8 x i8> %a) {
; CHECK-SD-LABEL: stofp_v8i8_v8bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    sshll v0.8h, v0.8b, #0
; CHECK-SD-NEXT:    sshll v1.4s, v0.4h, #0
; CHECK-SD-NEXT:    sshll2 v2.4s, v0.8h, #0
; CHECK-SD-NEXT:    scvtf v1.4s, v1.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v1.4s
; CHECK-SD-NEXT:    scvtf v1.4s, v2.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v1.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_v8i8_v8bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    sshll v0.8h, v0.8b, #0
; CHECK-GI-NEXT:    sshll v1.4s, v0.4h, #0
; CHECK-GI-NEXT:    sshll2 v0.4s, v0.8h, #0
; CHECK-GI-NEXT:    scvtf v1.4s, v1.4s
; CHECK-GI-NEXT:    scvtf v2.4s, v0.4s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v1.4s
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v2.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp <8 x i8> %a to <8 x bfloat>
  ret <8 x bfloat> %c
}

define <8 x bfloat> @utofp_v8i8_v8bf16(<8 x i8> %a) {
; CHECK-SD-LABEL: utofp_v8i8_v8bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    ushll v0.8h, v0.8b, #0
; CHECK-SD-NEXT:    ushll v1.4s, v0.4h, #0
; CHECK-SD-NEXT:    ushll2 v2.4s, v0.8h, #0
; CHECK-SD-NEXT:    ucvtf v1.4s, v1.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v1.4s
; CHECK-SD-NEXT:    ucvtf v1.4s, v2.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v1.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_v8i8_v8bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    ushll v0.8h, v0.8b, #0
; CHECK-GI-NEXT:    ushll v1.4s, v0.4h, #0
; CHECK-GI-NEXT:    ushll2 v0.4s, v0.8h, #0
; CHECK-GI-NEXT:    ucvtf v1.4s, v1.4s
; CHECK-GI-NEXT:    ucvtf v2.4s, v0.4s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v1.4s
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v2.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp <8 x i8> %a to <8 x bfloat>
  ret <8 x bfloat> %c
}

define <16 x bfloat> @stofp_v16i8_v16bf16(<16 x i8> %a) {
; CHECK-SD-LABEL: stofp_v16i8_v16bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    sshll2 v1.8h, v0.16b, #0
; CHECK-SD-NEXT:    sshll v0.8h, v0.8b, #0
; CHECK-SD-NEXT:    sshll v2.4s, v1.4h, #0
; CHECK-SD-NEXT:    sshll v3.4s, v0.4h, #0
; CHECK-SD-NEXT:    sshll2 v4.4s, v1.8h, #0
; CHECK-SD-NEXT:    sshll2 v5.4s, v0.8h, #0
; CHECK-SD-NEXT:    scvtf v2.4s, v2.4s
; CHECK-SD-NEXT:    scvtf v3.4s, v3.4s
; CHECK-SD-NEXT:    bfcvtn v1.4h, v2.4s
; CHECK-SD-NEXT:    scvtf v2.4s, v4.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v3.4s
; CHECK-SD-NEXT:    scvtf v3.4s, v5.4s
; CHECK-SD-NEXT:    bfcvtn2 v1.8h, v2.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v3.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_v16i8_v16bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    sshll v1.8h, v0.8b, #0
; CHECK-GI-NEXT:    sshll2 v0.8h, v0.16b, #0
; CHECK-GI-NEXT:    sshll v2.4s, v1.4h, #0
; CHECK-GI-NEXT:    sshll v3.4s, v0.4h, #0
; CHECK-GI-NEXT:    sshll2 v1.4s, v1.8h, #0
; CHECK-GI-NEXT:    sshll2 v0.4s, v0.8h, #0
; CHECK-GI-NEXT:    scvtf v2.4s, v2.4s
; CHECK-GI-NEXT:    scvtf v3.4s, v3.4s
; CHECK-GI-NEXT:    scvtf v4.4s, v1.4s
; CHECK-GI-NEXT:    scvtf v5.4s, v0.4s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v2.4s
; CHECK-GI-NEXT:    bfcvtn v1.4h, v3.4s
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v4.4s
; CHECK-GI-NEXT:    bfcvtn2 v1.8h, v5.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp <16 x i8> %a to <16 x bfloat>
  ret <16 x bfloat> %c
}

define <16 x bfloat> @utofp_v16i8_v16bf16(<16 x i8> %a) {
; CHECK-SD-LABEL: utofp_v16i8_v16bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    ushll2 v1.8h, v0.16b, #0
; CHECK-SD-NEXT:    ushll v0.8h, v0.8b, #0
; CHECK-SD-NEXT:    ushll v2.4s, v1.4h, #0
; CHECK-SD-NEXT:    ushll v3.4s, v0.4h, #0
; CHECK-SD-NEXT:    ushll2 v4.4s, v1.8h, #0
; CHECK-SD-NEXT:    ushll2 v5.4s, v0.8h, #0
; CHECK-SD-NEXT:    ucvtf v2.4s, v2.4s
; CHECK-SD-NEXT:    ucvtf v3.4s, v3.4s
; CHECK-SD-NEXT:    bfcvtn v1.4h, v2.4s
; CHECK-SD-NEXT:    ucvtf v2.4s, v4.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v3.4s
; CHECK-SD-NEXT:    ucvtf v3.4s, v5.4s
; CHECK-SD-NEXT:    bfcvtn2 v1.8h, v2.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v3.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_v16i8_v16bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    ushll v1.8h, v0.8b, #0
; CHECK-GI-NEXT:    ushll2 v0.8h, v0.16b, #0
; CHECK-GI-NEXT:    ushll v2.4s, v1.4h, #0
; CHECK-GI-NEXT:    ushll v3.4s, v0.4h, #0
; CHECK-GI-NEXT:    ushll2 v1.4s, v1.8h, #0
; CHECK-GI-NEXT:    ushll2 v0.4s, v0.8h, #0
; CHECK-GI-NEXT:    ucvtf v2.4s, v2.4s
; CHECK-GI-NEXT:    ucvtf v3.4s, v3.4s
; CHECK-GI-NEXT:    ucvtf v4.4s, v1.4s
; CHECK-GI-NEXT:    ucvtf v5.4s, v0.4s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v2.4s
; CHECK-GI-NEXT:    bfcvtn v1.4h, v3.4s
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v4.4s
; CHECK-GI-NEXT:    bfcvtn2 v1.8h, v5.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp <16 x i8> %a to <16 x bfloat>
  ret <16 x bfloat> %c
}

define <32 x bfloat> @stofp_v32i8_v32bf16(<32 x i8> %a) {
; CHECK-SD-LABEL: stofp_v32i8_v32bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    sshll v2.8h, v0.8b, #0
; CHECK-SD-NEXT:    sshll2 v0.8h, v0.16b, #0
; CHECK-SD-NEXT:    sshll2 v3.8h, v1.16b, #0
; CHECK-SD-NEXT:    sshll v1.8h, v1.8b, #0
; CHECK-SD-NEXT:    sshll v4.4s, v2.4h, #0
; CHECK-SD-NEXT:    sshll v5.4s, v0.4h, #0
; CHECK-SD-NEXT:    sshll v6.4s, v3.4h, #0
; CHECK-SD-NEXT:    sshll v7.4s, v1.4h, #0
; CHECK-SD-NEXT:    sshll2 v0.4s, v0.8h, #0
; CHECK-SD-NEXT:    sshll2 v3.4s, v3.8h, #0
; CHECK-SD-NEXT:    sshll2 v2.4s, v2.8h, #0
; CHECK-SD-NEXT:    sshll2 v1.4s, v1.8h, #0
; CHECK-SD-NEXT:    scvtf v4.4s, v4.4s
; CHECK-SD-NEXT:    scvtf v5.4s, v5.4s
; CHECK-SD-NEXT:    scvtf v6.4s, v6.4s
; CHECK-SD-NEXT:    scvtf v7.4s, v7.4s
; CHECK-SD-NEXT:    scvtf v16.4s, v0.4s
; CHECK-SD-NEXT:    scvtf v17.4s, v3.4s
; CHECK-SD-NEXT:    scvtf v18.4s, v2.4s
; CHECK-SD-NEXT:    scvtf v19.4s, v1.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v4.4s
; CHECK-SD-NEXT:    bfcvtn v1.4h, v5.4s
; CHECK-SD-NEXT:    bfcvtn v3.4h, v6.4s
; CHECK-SD-NEXT:    bfcvtn v2.4h, v7.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v18.4s
; CHECK-SD-NEXT:    bfcvtn2 v1.8h, v16.4s
; CHECK-SD-NEXT:    bfcvtn2 v3.8h, v17.4s
; CHECK-SD-NEXT:    bfcvtn2 v2.8h, v19.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: stofp_v32i8_v32bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    sshll v2.8h, v0.8b, #0
; CHECK-GI-NEXT:    sshll2 v0.8h, v0.16b, #0
; CHECK-GI-NEXT:    sshll v3.8h, v1.8b, #0
; CHECK-GI-NEXT:    sshll2 v1.8h, v1.16b, #0
; CHECK-GI-NEXT:    sshll v4.4s, v2.4h, #0
; CHECK-GI-NEXT:    sshll v5.4s, v0.4h, #0
; CHECK-GI-NEXT:    sshll v6.4s, v3.4h, #0
; CHECK-GI-NEXT:    sshll v7.4s, v1.4h, #0
; CHECK-GI-NEXT:    sshll2 v2.4s, v2.8h, #0
; CHECK-GI-NEXT:    sshll2 v0.4s, v0.8h, #0
; CHECK-GI-NEXT:    sshll2 v3.4s, v3.8h, #0
; CHECK-GI-NEXT:    sshll2 v1.4s, v1.8h, #0
; CHECK-GI-NEXT:    scvtf v4.4s, v4.4s
; CHECK-GI-NEXT:    scvtf v5.4s, v5.4s
; CHECK-GI-NEXT:    scvtf v6.4s, v6.4s
; CHECK-GI-NEXT:    scvtf v7.4s, v7.4s
; CHECK-GI-NEXT:    scvtf v16.4s, v2.4s
; CHECK-GI-NEXT:    scvtf v17.4s, v0.4s
; CHECK-GI-NEXT:    scvtf v18.4s, v3.4s
; CHECK-GI-NEXT:    scvtf v19.4s, v1.4s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v4.4s
; CHECK-GI-NEXT:    bfcvtn v1.4h, v5.4s
; CHECK-GI-NEXT:    bfcvtn v2.4h, v6.4s
; CHECK-GI-NEXT:    bfcvtn v3.4h, v7.4s
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v16.4s
; CHECK-GI-NEXT:    bfcvtn2 v1.8h, v17.4s
; CHECK-GI-NEXT:    bfcvtn2 v2.8h, v18.4s
; CHECK-GI-NEXT:    bfcvtn2 v3.8h, v19.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = sitofp <32 x i8> %a to <32 x bfloat>
  ret <32 x bfloat> %c
}

define <32 x bfloat> @utofp_v32i8_v32bf16(<32 x i8> %a) {
; CHECK-SD-LABEL: utofp_v32i8_v32bf16:
; CHECK-SD:       // %bb.0: // %entry
; CHECK-SD-NEXT:    ushll v2.8h, v0.8b, #0
; CHECK-SD-NEXT:    ushll2 v0.8h, v0.16b, #0
; CHECK-SD-NEXT:    ushll2 v3.8h, v1.16b, #0
; CHECK-SD-NEXT:    ushll v1.8h, v1.8b, #0
; CHECK-SD-NEXT:    ushll v4.4s, v2.4h, #0
; CHECK-SD-NEXT:    ushll v5.4s, v0.4h, #0
; CHECK-SD-NEXT:    ushll v6.4s, v3.4h, #0
; CHECK-SD-NEXT:    ushll v7.4s, v1.4h, #0
; CHECK-SD-NEXT:    ushll2 v0.4s, v0.8h, #0
; CHECK-SD-NEXT:    ushll2 v3.4s, v3.8h, #0
; CHECK-SD-NEXT:    ushll2 v2.4s, v2.8h, #0
; CHECK-SD-NEXT:    ushll2 v1.4s, v1.8h, #0
; CHECK-SD-NEXT:    ucvtf v4.4s, v4.4s
; CHECK-SD-NEXT:    ucvtf v5.4s, v5.4s
; CHECK-SD-NEXT:    ucvtf v6.4s, v6.4s
; CHECK-SD-NEXT:    ucvtf v7.4s, v7.4s
; CHECK-SD-NEXT:    ucvtf v16.4s, v0.4s
; CHECK-SD-NEXT:    ucvtf v17.4s, v3.4s
; CHECK-SD-NEXT:    ucvtf v18.4s, v2.4s
; CHECK-SD-NEXT:    ucvtf v19.4s, v1.4s
; CHECK-SD-NEXT:    bfcvtn v0.4h, v4.4s
; CHECK-SD-NEXT:    bfcvtn v1.4h, v5.4s
; CHECK-SD-NEXT:    bfcvtn v3.4h, v6.4s
; CHECK-SD-NEXT:    bfcvtn v2.4h, v7.4s
; CHECK-SD-NEXT:    bfcvtn2 v0.8h, v18.4s
; CHECK-SD-NEXT:    bfcvtn2 v1.8h, v16.4s
; CHECK-SD-NEXT:    bfcvtn2 v3.8h, v17.4s
; CHECK-SD-NEXT:    bfcvtn2 v2.8h, v19.4s
; CHECK-SD-NEXT:    ret
;
; CHECK-GI-LABEL: utofp_v32i8_v32bf16:
; CHECK-GI:       // %bb.0: // %entry
; CHECK-GI-NEXT:    ushll v2.8h, v0.8b, #0
; CHECK-GI-NEXT:    ushll2 v0.8h, v0.16b, #0
; CHECK-GI-NEXT:    ushll v3.8h, v1.8b, #0
; CHECK-GI-NEXT:    ushll2 v1.8h, v1.16b, #0
; CHECK-GI-NEXT:    ushll v4.4s, v2.4h, #0
; CHECK-GI-NEXT:    ushll v5.4s, v0.4h, #0
; CHECK-GI-NEXT:    ushll v6.4s, v3.4h, #0
; CHECK-GI-NEXT:    ushll v7.4s, v1.4h, #0
; CHECK-GI-NEXT:    ushll2 v2.4s, v2.8h, #0
; CHECK-GI-NEXT:    ushll2 v0.4s, v0.8h, #0
; CHECK-GI-NEXT:    ushll2 v3.4s, v3.8h, #0
; CHECK-GI-NEXT:    ushll2 v1.4s, v1.8h, #0
; CHECK-GI-NEXT:    ucvtf v4.4s, v4.4s
; CHECK-GI-NEXT:    ucvtf v5.4s, v5.4s
; CHECK-GI-NEXT:    ucvtf v6.4s, v6.4s
; CHECK-GI-NEXT:    ucvtf v7.4s, v7.4s
; CHECK-GI-NEXT:    ucvtf v16.4s, v2.4s
; CHECK-GI-NEXT:    ucvtf v17.4s, v0.4s
; CHECK-GI-NEXT:    ucvtf v18.4s, v3.4s
; CHECK-GI-NEXT:    ucvtf v19.4s, v1.4s
; CHECK-GI-NEXT:    bfcvtn v0.4h, v4.4s
; CHECK-GI-NEXT:    bfcvtn v1.4h, v5.4s
; CHECK-GI-NEXT:    bfcvtn v2.4h, v6.4s
; CHECK-GI-NEXT:    bfcvtn v3.4h, v7.4s
; CHECK-GI-NEXT:    bfcvtn2 v0.8h, v16.4s
; CHECK-GI-NEXT:    bfcvtn2 v1.8h, v17.4s
; CHECK-GI-NEXT:    bfcvtn2 v2.8h, v18.4s
; CHECK-GI-NEXT:    bfcvtn2 v3.8h, v19.4s
; CHECK-GI-NEXT:    ret
entry:
  %c = uitofp <32 x i8> %a to <32 x bfloat>
  ret <32 x bfloat> %c
}
;; NOTE: These prefixes are unused and the list is autogenerated. Do not add tests below this line:
; CHECK-GI-FP16: {{.*}}
; CHECK-GI-NOFP16: {{.*}}
; CHECK-SD-FP16: {{.*}}
; CHECK-SD-NOFP16: {{.*}}
