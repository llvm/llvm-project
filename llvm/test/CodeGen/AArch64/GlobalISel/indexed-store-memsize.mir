# NOTE: Assertions have been autogenerated by utils/update_mir_test_checks.py UTC_ARGS: --version 6
# RUN: llc -mtriple=aarch64-unknown-linux-gnu -global-isel -O2 -run-pass=instruction-select -verify-machineinstrs %s -o - | FileCheck %s --check-prefix=CHECK-GI
# RUN: llc -mtriple=aarch64-unknown-linux-gnu -O2 -run-pass=instruction-select -verify-machineinstrs %s -o - | FileCheck %s --check-prefix=CHECK-SD

--- |
  define void @pre_indexed_halfword(ptr %p, i32 %v, i64 %o) {
    ret void
  }

  define void @post_indexed_halfword(ptr %p, i32 %v, i64 %o) {
    ret void
  }

...
---
name:            pre_indexed_halfword
alignment:       4
legalized:       true
regBankSelected: true
tracksRegLiveness: true
liveins:
  - { reg: '$x0' }
  - { reg: '$w1' }
body:             |
  bb.0:
    liveins: $x0, $w1
    ; CHECK-GI-LABEL: name: pre_indexed_halfword
    ; CHECK-GI: liveins: $x0, $w1
    ; CHECK-GI-NEXT: {{  $}}
    ; CHECK-GI-NEXT: %ptr:gpr64sp = COPY $x0
    ; CHECK-GI-NEXT: %val32:gpr32 = COPY $w1
    ; CHECK-GI-NEXT: early-clobber %wb:gpr64sp = STRHHpre %val32, %ptr, 2 :: (store (s16) into %ir.p)
    ; CHECK-GI-NEXT: $x0 = COPY %wb
    ; CHECK-GI-NEXT: RET_ReallyLR
    ;
    ; CHECK-SD-LABEL: name: pre_indexed_halfword
    ; CHECK-SD: liveins: $x0, $w1
    ; CHECK-SD-NEXT: {{  $}}
    ; CHECK-SD-NEXT: %ptr:gpr64sp = COPY $x0
    ; CHECK-SD-NEXT: %val32:gpr32 = COPY $w1
    ; CHECK-SD-NEXT: early-clobber %wb:gpr64sp = STRHHpre %val32, %ptr, 2 :: (store (s16) into %ir.p)
    ; CHECK-SD-NEXT: $x0 = COPY %wb
    ; CHECK-SD-NEXT: RET_ReallyLR
    %ptr:gpr(p0) = COPY $x0
    %val32:gpr(s32) = COPY $w1
    %off:gpr(s64) = G_CONSTANT i64 2
    %wb:gpr(p0) = G_INDEXED_STORE %val32(s32), %ptr, %off, 1 :: (store (s16) into %ir.p)
    $x0 = COPY %wb
    RET_ReallyLR

...
---
name:            post_indexed_halfword
alignment:       4
legalized:       true
regBankSelected: true
tracksRegLiveness: true
liveins:
  - { reg: '$x0' }
  - { reg: '$w1' }
body:             |
  bb.0:
    liveins: $x0, $w1
    ; CHECK-GI-LABEL: name: post_indexed_halfword
    ; CHECK-GI: liveins: $x0, $w1
    ; CHECK-GI-NEXT: {{  $}}
    ; CHECK-GI-NEXT: %ptr:gpr64sp = COPY $x0
    ; CHECK-GI-NEXT: %val32:gpr32 = COPY $w1
    ; CHECK-GI-NEXT: early-clobber %wb:gpr64sp = STRHHpost %val32, %ptr, 2 :: (store (s16) into %ir.p)
    ; CHECK-GI-NEXT: $x0 = COPY %wb
    ; CHECK-GI-NEXT: RET_ReallyLR
    ;
    ; CHECK-SD-LABEL: name: post_indexed_halfword
    ; CHECK-SD: liveins: $x0, $w1
    ; CHECK-SD-NEXT: {{  $}}
    ; CHECK-SD-NEXT: %ptr:gpr64sp = COPY $x0
    ; CHECK-SD-NEXT: %val32:gpr32 = COPY $w1
    ; CHECK-SD-NEXT: early-clobber %wb:gpr64sp = STRHHpost %val32, %ptr, 2 :: (store (s16) into %ir.p)
    ; CHECK-SD-NEXT: $x0 = COPY %wb
    ; CHECK-SD-NEXT: RET_ReallyLR
    %ptr:gpr(p0) = COPY $x0
    %val32:gpr(s32) = COPY $w1
    %off:gpr(s64) = G_CONSTANT i64 2
    %wb:gpr(p0) = G_INDEXED_STORE %val32(s32), %ptr, %off, 0 :: (store (s16) into %ir.p)
    $x0 = COPY %wb
    RET_ReallyLR

...
