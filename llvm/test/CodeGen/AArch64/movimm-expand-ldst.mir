# NOTE: Assertions have been autogenerated by utils/update_mir_test_checks.py UTC_ARGS: --version 4
# RUN: llc -mtriple=aarch64 -verify-machineinstrs -run-pass=aarch64-expand-pseudo -run-pass=aarch64-ldst-opt -debug-only=aarch64-ldst-opt %s -o - | FileCheck %s
# REQUIRES: asserts
---
name: test_fold_repeating_constant_load
tracksRegLiveness: true
body:             |
  bb.0:
    liveins: $x0
    ; CHECK-LABEL: name: test_fold_repeating_constant_load
    ; CHECK: liveins: $x0
    ; CHECK-NEXT: {{  $}}
    ; CHECK-NEXT: renamable $x0 = MOVZXi 49370, 0
    ; CHECK-NEXT: renamable $x0 = MOVKXi $x0, 320, 16
    ; CHECK-NEXT: renamable $x0 = ORRXrs $x0, $x0, 32
    ; CHECK-NEXT: RET undef $lr, implicit $x0
    renamable $x0 = MOVi64imm 90284035103834330
    RET_ReallyLR implicit $x0
...
---
name: test_fold_repeating_constant_load_neg
tracksRegLiveness: true
body:             |
  bb.0:
    liveins: $x0
    ; CHECK-LABEL: name: test_fold_repeating_constant_load_neg
    ; CHECK: liveins: $x0
    ; CHECK-NEXT: {{  $}}
    ; CHECK-NEXT: renamable $x0 = MOVZXi 320, 0
    ; CHECK-NEXT: renamable $x0 = MOVKXi $x0, 49370, 16
    ; CHECK-NEXT: renamable $x0 = ORRXrs $x0, $x0, 32
    ; CHECK-NEXT: RET undef $lr, implicit $x0
    renamable $x0 = MOVi64imm -4550323095879417536
    RET_ReallyLR implicit $x0
...
---
name: test_fold_repeating_constant_store
tracksRegLiveness: true
body:             |
  bb.0:
    liveins: $x0
    ; CHECK-LABEL: name: test_fold_repeating_constant_store
    ; CHECK: liveins: $x0
    ; CHECK-NEXT: {{  $}}
    ; CHECK-NEXT: renamable $x8 = MOVZXi 49370, 0
    ; CHECK-NEXT: renamable $x8 = MOVKXi $x8, 320, 16
    ; CHECK-NEXT: STPWi killed renamable $w8, killed renamable $w8, killed renamable $x0, 0
    ; CHECK-NEXT: RET undef $lr
    renamable $x8 = MOVi64imm 90284035103834330
    STRXui killed renamable $x8, killed renamable $x0, 0
    RET_ReallyLR
...
---
name: test_fold_repeating_constant_store_neg
tracksRegLiveness: true
body:             |
  bb.0:
    liveins: $x0
    ; CHECK-LABEL: name: test_fold_repeating_constant_store_neg
    ; CHECK: liveins: $x0
    ; CHECK-NEXT: {{  $}}
    ; CHECK-NEXT: renamable $x8 = MOVZXi 320, 0
    ; CHECK-NEXT: renamable $x8 = MOVKXi $x8, 49370, 16
    ; CHECK-NEXT: STPWi killed renamable $w8, killed renamable $w8, killed renamable $x0, 0
    ; CHECK-NEXT: RET undef $lr
    renamable $x8 = MOVi64imm -4550323095879417536
    STRXui killed renamable $x8, killed renamable $x0, 0
    RET_ReallyLR
...
---
name: test_fold_repeating_constant_store_16bit_unit
tracksRegLiveness: true
body:             |
  bb.0:
    liveins: $x0
    ; CHECK-LABEL: name: test_fold_repeating_constant_store_16bit_unit
    ; CHECK: liveins: $x0
    ; CHECK-NEXT: {{  $}}
    ; CHECK-NEXT: renamable $x8 = MOVZXi 21845, 16
    ; CHECK-NEXT: STPWi killed renamable $w8, killed renamable $w8, killed renamable $x0, 0
    ; CHECK-NEXT: RET undef $lr
    renamable $x8 = MOVZXi 21845, 16
    renamable $x8 = MOVKXi $x8, 21845, 48
    STRXui killed renamable $x8, killed renamable $x0, 0
    RET undef $lr
...
---
name: test_fold_repeating_constant_store_offset_min
tracksRegLiveness: true
body:             |
  bb.0:
    liveins: $x0
    ; CHECK-LABEL: name: test_fold_repeating_constant_store_offset_min
    ; CHECK: liveins: $x0
    ; CHECK-NEXT: {{  $}}
    ; CHECK-NEXT: renamable $x8 = MOVZXi 22136, 0
    ; CHECK-NEXT: renamable $x8 = MOVKXi $x8, 4660, 16
    ; CHECK-NEXT: STPWi killed renamable $w8, killed renamable $w8, killed renamable $x0, 0
    ; CHECK-NEXT: RET undef $lr
    renamable $x8 = MOVZXi 22136, 0
    renamable $x8 = MOVKXi $x8, 4660, 16
    renamable $x8 = ORRXrs $x8, $x8, 32
    STRXui killed renamable $x8, killed renamable $x0, 0
    RET undef $lr
...
---
name: test_fold_repeating_constant_store_offset_max
tracksRegLiveness: true
body:             |
  bb.0:
    liveins: $x0
    ; CHECK-LABEL: name: test_fold_repeating_constant_store_offset_max
    ; CHECK: liveins: $x0
    ; CHECK-NEXT: {{  $}}
    ; CHECK-NEXT: renamable $x8 = MOVZXi 22136, 0
    ; CHECK-NEXT: renamable $x8 = MOVKXi $x8, 4660, 16
    ; CHECK-NEXT: STPWi killed renamable $w8, killed renamable $w8, killed renamable $x0, 62
    ; CHECK-NEXT: RET undef $lr
    renamable $x8 = MOVZXi 22136, 0
    renamable $x8 = MOVKXi $x8, 4660, 16
    renamable $x8 = ORRXrs $x8, $x8, 32
    STRXui killed renamable $x8, killed renamable $x0, 31
    RET undef $lr
...
---
name: test_fold_repeating_constant_store_offset_min_lower
tracksRegLiveness: true
body:             |
  bb.0:
    liveins: $x0
    ; CHECK-LABEL: name: test_fold_repeating_constant_store_offset_min_lower
    ; CHECK: liveins: $x0
    ; CHECK-NEXT: {{  $}}
    ; CHECK-NEXT: renamable $x8 = MOVZXi 22136, 0
    ; CHECK-NEXT: renamable $x8 = MOVKXi $x8, 4660, 16
    ; CHECK-NEXT: STPWi killed renamable $w8, killed renamable $w8, killed renamable $x0, 0
    ; CHECK-NEXT: RET undef $lr
    renamable $x8 = MOVZXi 22136, 0
    renamable $x8 = MOVKXi $x8, 4660, 16
    renamable $x8 = ORRXrs $x8, $x8, 32
    STRXui killed renamable $x8, killed renamable $x0, 0
    RET undef $lr
...
---
name: test_fold_repeating_constant_store_offset_max_over
tracksRegLiveness: true
body:             |
  bb.0:
    liveins: $x0
    ; CHECK-LABEL: name: test_fold_repeating_constant_store_offset_max_over
    ; CHECK: liveins: $x0
    ; CHECK-NEXT: {{  $}}
    ; CHECK-NEXT: renamable $x8 = MOVZXi 22136, 0
    ; CHECK-NEXT: renamable $x8 = MOVKXi $x8, 4660, 16
    ; CHECK-NEXT: renamable $x8 = ORRXrs $x8, $x8, 32
    ; CHECK-NEXT: STRXui killed renamable $x8, killed renamable $x0, 32
    ; CHECK-NEXT: RET undef $lr
    renamable $x8 = MOVZXi 22136, 0
    renamable $x8 = MOVKXi $x8, 4660, 16
    renamable $x8 = ORRXrs $x8, $x8, 32
    STRXui killed renamable $x8, killed renamable $x0, 32
    RET undef $lr
