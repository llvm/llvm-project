; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --version 5
; RUN: llc -verify-machineinstrs < %s -mcpu=ppc -mtriple powerpc-ibm-aix-xcoff | FileCheck %s

%_type = type <{ [90112 x i8] }>

@g = external global %_type

define void @foo(ptr %p) {
; CHECK-LABEL: foo:
; CHECK:     	 stfd 31, 0(31)
; CHECK-NEXT:    lwz 3, -32(30)
; CHECK-NEXT:    lwz 4, -28(30)
; CHECK-NEXT:    cmplwi 3, 0
; CHECK-NEXT:    cmpwi 1, 3, 0
; CHECK-NEXT:    crandc 20, 5, 2
; CHECK-NEXT:    cmpwi 1, 4, 0
entry:
  %0 = load double, ptr getelementptr inbounds nuw (i8, ptr @g, i32 83272), align 8
  %1 = call i32 @bar(ptr getelementptr inbounds nuw (i8, ptr @g, i32 83272))
  %2 = call i32 @bar(ptr getelementptr inbounds nuw (i8, ptr @g, i32 83240))
  store double %0, ptr %p, align 8
  %3 = load i64, ptr getelementptr inbounds nuw (i8, ptr @g, i32 83240), align 8
  %4 = icmp slt i64 %3, 1
  br i1 %4, label %then, label %else

then:                                                     ; preds = %entry
  ret void

else:                                                     ; preds = %entry
  ret void
}

declare signext i32 @bar(ptr)
