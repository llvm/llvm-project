# NOTE: Assertions have been autogenerated by utils/update_mir_test_checks.py
# RUN: llc -march=amdgcn -mcpu=gfx908 -run-pass=regallocfast -o - %s | FileCheck -check-prefix=GFX908-SPILLED %s
# RUN: llc -march=amdgcn -mcpu=gfx908 -run-pass=regallocfast,prologepilog -o - %s | FileCheck -check-prefix=GFX908-EXPANDED %s
# RUN: llc -march=amdgcn -mcpu=gfx90a -run-pass=regallocfast -o - %s | FileCheck -check-prefix=GFX90A-SPILLED %s
# RUN: llc -march=amdgcn -mcpu=gfx90a -run-pass=regallocfast,prologepilog -o - %s | FileCheck -check-prefix=GFX90A-EXPANDED %s

---
name: spill_restore_agpr32
tracksRegLiveness: true
machineFunctionInfo:
  scratchRSrcReg: $sgpr0_sgpr1_sgpr2_sgpr3
  stackPtrOffsetReg: $sgpr32
body: |
  ; GFX908-SPILLED-LABEL: name: spill_restore_agpr32
  ; GFX908-SPILLED: bb.0:
  ; GFX908-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0
  ; GFX908-SPILLED-NEXT:   SI_SPILL_A32_SAVE killed $agpr0, %stack.1, $sgpr32, 0, implicit $exec :: (store (s32) into %stack.1, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0
  ; GFX908-SPILLED-NEXT:   SI_SPILL_A32_SAVE killed $agpr0, %stack.0, $sgpr32, 0, implicit $exec :: (store (s32) into %stack.0, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.1:
  ; GFX908-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 1
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.2:
  ; GFX908-SPILLED-NEXT:   $agpr0 = SI_SPILL_A32_RESTORE %stack.1, $sgpr32, 0, implicit $exec :: (load (s32) from %stack.1, addrspace 5)
  ; GFX908-SPILLED-NEXT:   $agpr1 = SI_SPILL_A32_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s32) from %stack.0, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0, implicit killed renamable $agpr1
  ; GFX908-EXPANDED-LABEL: name: spill_restore_agpr32
  ; GFX908-EXPANDED: bb.0:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0
  ; GFX908-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0
  ; GFX908-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec
  ; GFX908-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.1:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   S_NOP 1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.2:
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0, implicit killed renamable $agpr1
  ; GFX90A-SPILLED-LABEL: name: spill_restore_agpr32
  ; GFX90A-SPILLED: bb.0:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0
  ; GFX90A-SPILLED-NEXT:   SI_SPILL_A32_SAVE killed $agpr0, %stack.1, $sgpr32, 0, implicit $exec :: (store (s32) into %stack.1, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0
  ; GFX90A-SPILLED-NEXT:   SI_SPILL_A32_SAVE killed $agpr0, %stack.0, $sgpr32, 0, implicit $exec :: (store (s32) into %stack.0, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.1:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 1
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.2:
  ; GFX90A-SPILLED-NEXT:   $agpr0 = SI_SPILL_A32_RESTORE %stack.1, $sgpr32, 0, implicit $exec :: (load (s32) from %stack.1, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   $agpr1 = SI_SPILL_A32_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s32) from %stack.0, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0, implicit killed renamable $agpr1
  ; GFX90A-EXPANDED-LABEL: name: spill_restore_agpr32
  ; GFX90A-EXPANDED: bb.0:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0
  ; GFX90A-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0
  ; GFX90A-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.1:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   S_NOP 1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.2:
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0, implicit killed renamable $agpr1
  bb.0:
    S_NOP 0, implicit-def %0:agpr_32
    S_NOP 0, implicit-def %1:agpr_32
    S_CBRANCH_SCC1 implicit undef $scc, %bb.1

  bb.1:
    S_NOP 1

  bb.2:
    S_NOP 0, implicit %0, implicit %1
...

---
name: spill_restore_agpr64
tracksRegLiveness: true
machineFunctionInfo:
  scratchRSrcReg: $sgpr0_sgpr1_sgpr2_sgpr3
  stackPtrOffsetReg: $sgpr32
body: |
  ; GFX908-SPILLED-LABEL: name: spill_restore_agpr64
  ; GFX908-SPILLED: bb.0:
  ; GFX908-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1
  ; GFX908-SPILLED-NEXT:   SI_SPILL_A64_SAVE killed $agpr0_agpr1, %stack.0, $sgpr32, 0, implicit $exec :: (store (s64) into %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.1:
  ; GFX908-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 1
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.2:
  ; GFX908-SPILLED-NEXT:   $agpr0_agpr1 = SI_SPILL_A64_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s64) from %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1
  ; GFX908-EXPANDED-LABEL: name: spill_restore_agpr64
  ; GFX908-EXPANDED: bb.0:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1
  ; GFX908-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1, implicit $agpr0_agpr1
  ; GFX908-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec, implicit killed $agpr0_agpr1
  ; GFX908-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.1:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   S_NOP 1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.2:
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec, implicit-def $agpr0_agpr1
  ; GFX908-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1
  ; GFX90A-SPILLED-LABEL: name: spill_restore_agpr64
  ; GFX90A-SPILLED: bb.0:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1
  ; GFX90A-SPILLED-NEXT:   SI_SPILL_A64_SAVE killed $agpr0_agpr1, %stack.0, $sgpr32, 0, implicit $exec :: (store (s64) into %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.1:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 1
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.2:
  ; GFX90A-SPILLED-NEXT:   $agpr0_agpr1 = SI_SPILL_A64_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s64) from %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1
  ; GFX90A-EXPANDED-LABEL: name: spill_restore_agpr64
  ; GFX90A-EXPANDED: bb.0:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1
  ; GFX90A-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1, implicit $agpr0_agpr1
  ; GFX90A-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec, implicit killed $agpr0_agpr1
  ; GFX90A-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.1:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   S_NOP 1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.2:
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec, implicit-def $agpr0_agpr1
  ; GFX90A-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1
  bb.0:
    S_NOP 0, implicit-def %0:areg_64
    S_CBRANCH_SCC1 implicit undef $scc, %bb.1

  bb.1:
    S_NOP 1

  bb.2:
    S_NOP 0, implicit %0
...

---
name: spill_restore_agpr32_used_all_vgprs
tracksRegLiveness: true
machineFunctionInfo:
  scratchRSrcReg: $sgpr0_sgpr1_sgpr2_sgpr3
  stackPtrOffsetReg: $sgpr32
body: |
  ; GFX908-SPILLED-LABEL: name: spill_restore_agpr32_used_all_vgprs
  ; GFX908-SPILLED: bb.0:
  ; GFX908-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-SPILLED-NEXT:   liveins: $vgpr0_vgpr1_vgpr2_vgpr3_vgpr4_vgpr5_vgpr6_vgpr7_vgpr8_vgpr9_vgpr10_vgpr11_vgpr12_vgpr13_vgpr14_vgpr15, $vgpr16_vgpr17_vgpr18_vgpr19_vgpr20_vgpr21_vgpr22_vgpr23_vgpr24_vgpr25_vgpr26_vgpr27_vgpr28_vgpr29_vgpr30_vgpr31, $vgpr32_vgpr33_vgpr34_vgpr35_vgpr36_vgpr37_vgpr38_vgpr39_vgpr40_vgpr41_vgpr42_vgpr43_vgpr44_vgpr45_vgpr46_vgpr47, $vgpr48_vgpr49_vgpr50_vgpr51_vgpr52_vgpr53_vgpr54_vgpr55_vgpr56_vgpr57_vgpr58_vgpr59_vgpr60_vgpr61_vgpr62_vgpr63, $vgpr64_vgpr65_vgpr66_vgpr67_vgpr68_vgpr69_vgpr70_vgpr71_vgpr72_vgpr73_vgpr74_vgpr75_vgpr76_vgpr77_vgpr78_vgpr79, $vgpr80_vgpr81_vgpr82_vgpr83_vgpr84_vgpr85_vgpr86_vgpr87_vgpr88_vgpr89_vgpr90_vgpr91_vgpr92_vgpr93_vgpr94_vgpr95, $vgpr96_vgpr97_vgpr98_vgpr99_vgpr100_vgpr101_vgpr102_vgpr103_vgpr104_vgpr105_vgpr106_vgpr107_vgpr108_vgpr109_vgpr110_vgpr111, $vgpr112_vgpr113_vgpr114_vgpr115_vgpr116_vgpr117_vgpr118_vgpr119_vgpr120_vgpr121_vgpr122_vgpr123_vgpr124_vgpr125_vgpr126_vgpr127, $vgpr128_vgpr129_vgpr130_vgpr131_vgpr132_vgpr133_vgpr134_vgpr135_vgpr136_vgpr137_vgpr138_vgpr139_vgpr140_vgpr141_vgpr142_vgpr143, $vgpr144_vgpr145_vgpr146_vgpr147_vgpr148_vgpr149_vgpr150_vgpr151_vgpr152_vgpr153_vgpr154_vgpr155_vgpr156_vgpr157_vgpr158_vgpr159, $vgpr160_vgpr161_vgpr162_vgpr163_vgpr164_vgpr165_vgpr166_vgpr167_vgpr168_vgpr169_vgpr170_vgpr171_vgpr172_vgpr173_vgpr174_vgpr175, $vgpr176_vgpr177_vgpr178_vgpr179_vgpr180_vgpr181_vgpr182_vgpr183_vgpr184_vgpr185_vgpr186_vgpr187_vgpr188_vgpr189_vgpr190_vgpr191, $vgpr192_vgpr193_vgpr194_vgpr195_vgpr196_vgpr197_vgpr198_vgpr199_vgpr200_vgpr201_vgpr202_vgpr203_vgpr204_vgpr205_vgpr206_vgpr207, $vgpr208_vgpr209_vgpr210_vgpr211_vgpr212_vgpr213_vgpr214_vgpr215_vgpr216_vgpr217_vgpr218_vgpr219_vgpr220_vgpr221_vgpr222_vgpr223, $vgpr224_vgpr225_vgpr226_vgpr227_vgpr228_vgpr229_vgpr230_vgpr231_vgpr232_vgpr233_vgpr234_vgpr235_vgpr236_vgpr237_vgpr238_vgpr239, $vgpr240_vgpr241_vgpr242_vgpr243_vgpr244_vgpr245_vgpr246_vgpr247, $vgpr248_vgpr249_vgpr250_vgpr251_vgpr252_vgpr253_vgpr254_vgpr255
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0
  ; GFX908-SPILLED-NEXT:   SI_SPILL_A32_SAVE killed $agpr0, %stack.0, $sgpr32, 0, implicit $exec :: (store (s32) into %stack.0, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.1:
  ; GFX908-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.2:
  ; GFX908-SPILLED-NEXT:   $agpr0 = SI_SPILL_A32_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s32) from %stack.0, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr0_vgpr1_vgpr2_vgpr3_vgpr4_vgpr5_vgpr6_vgpr7_vgpr8_vgpr9_vgpr10_vgpr11_vgpr12_vgpr13_vgpr14_vgpr15_vgpr16_vgpr17_vgpr18_vgpr19_vgpr20_vgpr21_vgpr22_vgpr23_vgpr24_vgpr25_vgpr26_vgpr27_vgpr28_vgpr29_vgpr30_vgpr31
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr32_vgpr33_vgpr34_vgpr35_vgpr36_vgpr37_vgpr38_vgpr39_vgpr40_vgpr41_vgpr42_vgpr43_vgpr44_vgpr45_vgpr46_vgpr47
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr48_vgpr49_vgpr50_vgpr51_vgpr52_vgpr53_vgpr54_vgpr55_vgpr56_vgpr57_vgpr58_vgpr59_vgpr60_vgpr61_vgpr62_vgpr63
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr64_vgpr65_vgpr66_vgpr67_vgpr68_vgpr69_vgpr70_vgpr71_vgpr72_vgpr73_vgpr74_vgpr75_vgpr76_vgpr77_vgpr78_vgpr79
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr80_vgpr81_vgpr82_vgpr83_vgpr84_vgpr85_vgpr86_vgpr87_vgpr88_vgpr89_vgpr90_vgpr91_vgpr92_vgpr93_vgpr94_vgpr95
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr96_vgpr97_vgpr98_vgpr99_vgpr100_vgpr101_vgpr102_vgpr103_vgpr104_vgpr105_vgpr106_vgpr107_vgpr108_vgpr109_vgpr110_vgpr111
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr112_vgpr113_vgpr114_vgpr115_vgpr116_vgpr117_vgpr118_vgpr119_vgpr120_vgpr121_vgpr122_vgpr123_vgpr124_vgpr125_vgpr126_vgpr127
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr128_vgpr129_vgpr130_vgpr131_vgpr132_vgpr133_vgpr134_vgpr135_vgpr136_vgpr137_vgpr138_vgpr139_vgpr140_vgpr141_vgpr142_vgpr143
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr144_vgpr145_vgpr146_vgpr147_vgpr148_vgpr149_vgpr150_vgpr151_vgpr152_vgpr153_vgpr154_vgpr155_vgpr156_vgpr157_vgpr158_vgpr159
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr160_vgpr161_vgpr162_vgpr163_vgpr164_vgpr165_vgpr166_vgpr167_vgpr168_vgpr169_vgpr170_vgpr171_vgpr172_vgpr173_vgpr174_vgpr175
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr176_vgpr177_vgpr178_vgpr179_vgpr180_vgpr181_vgpr182_vgpr183_vgpr184_vgpr185_vgpr186_vgpr187_vgpr188_vgpr189_vgpr190_vgpr191
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr192_vgpr193_vgpr194_vgpr195_vgpr196_vgpr197_vgpr198_vgpr199_vgpr200_vgpr201_vgpr202_vgpr203_vgpr204_vgpr205_vgpr206_vgpr207
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr208_vgpr209_vgpr210_vgpr211_vgpr212_vgpr213_vgpr214_vgpr215_vgpr216_vgpr217_vgpr218_vgpr219_vgpr220_vgpr221_vgpr222_vgpr223
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr224_vgpr225_vgpr226_vgpr227_vgpr228_vgpr229_vgpr230_vgpr231_vgpr232_vgpr233_vgpr234_vgpr235_vgpr236_vgpr237_vgpr238_vgpr239
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr240_vgpr241_vgpr242_vgpr243_vgpr244_vgpr245_vgpr246_vgpr247
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr248_vgpr249_vgpr250_vgpr251_vgpr252_vgpr253_vgpr254_vgpr255
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0
  ; GFX908-EXPANDED-LABEL: name: spill_restore_agpr32_used_all_vgprs
  ; GFX908-EXPANDED: bb.0:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr240_vgpr241_vgpr242_vgpr243_vgpr244_vgpr245_vgpr246_vgpr247, $vgpr248_vgpr249_vgpr250_vgpr251_vgpr252_vgpr253_vgpr254_vgpr255, $vgpr0_vgpr1_vgpr2_vgpr3_vgpr4_vgpr5_vgpr6_vgpr7_vgpr8_vgpr9_vgpr10_vgpr11_vgpr12_vgpr13_vgpr14_vgpr15, $vgpr16_vgpr17_vgpr18_vgpr19_vgpr20_vgpr21_vgpr22_vgpr23_vgpr24_vgpr25_vgpr26_vgpr27_vgpr28_vgpr29_vgpr30_vgpr31, $vgpr32_vgpr33_vgpr34_vgpr35_vgpr36_vgpr37_vgpr38_vgpr39_vgpr40_vgpr41_vgpr42_vgpr43_vgpr44_vgpr45_vgpr46_vgpr47, $vgpr48_vgpr49_vgpr50_vgpr51_vgpr52_vgpr53_vgpr54_vgpr55_vgpr56_vgpr57_vgpr58_vgpr59_vgpr60_vgpr61_vgpr62_vgpr63, $vgpr64_vgpr65_vgpr66_vgpr67_vgpr68_vgpr69_vgpr70_vgpr71_vgpr72_vgpr73_vgpr74_vgpr75_vgpr76_vgpr77_vgpr78_vgpr79, $vgpr80_vgpr81_vgpr82_vgpr83_vgpr84_vgpr85_vgpr86_vgpr87_vgpr88_vgpr89_vgpr90_vgpr91_vgpr92_vgpr93_vgpr94_vgpr95, $vgpr96_vgpr97_vgpr98_vgpr99_vgpr100_vgpr101_vgpr102_vgpr103_vgpr104_vgpr105_vgpr106_vgpr107_vgpr108_vgpr109_vgpr110_vgpr111, $vgpr112_vgpr113_vgpr114_vgpr115_vgpr116_vgpr117_vgpr118_vgpr119_vgpr120_vgpr121_vgpr122_vgpr123_vgpr124_vgpr125_vgpr126_vgpr127, $vgpr128_vgpr129_vgpr130_vgpr131_vgpr132_vgpr133_vgpr134_vgpr135_vgpr136_vgpr137_vgpr138_vgpr139_vgpr140_vgpr141_vgpr142_vgpr143, $vgpr144_vgpr145_vgpr146_vgpr147_vgpr148_vgpr149_vgpr150_vgpr151_vgpr152_vgpr153_vgpr154_vgpr155_vgpr156_vgpr157_vgpr158_vgpr159, $vgpr160_vgpr161_vgpr162_vgpr163_vgpr164_vgpr165_vgpr166_vgpr167_vgpr168_vgpr169_vgpr170_vgpr171_vgpr172_vgpr173_vgpr174_vgpr175, $vgpr176_vgpr177_vgpr178_vgpr179_vgpr180_vgpr181_vgpr182_vgpr183_vgpr184_vgpr185_vgpr186_vgpr187_vgpr188_vgpr189_vgpr190_vgpr191, $vgpr192_vgpr193_vgpr194_vgpr195_vgpr196_vgpr197_vgpr198_vgpr199_vgpr200_vgpr201_vgpr202_vgpr203_vgpr204_vgpr205_vgpr206_vgpr207, $vgpr208_vgpr209_vgpr210_vgpr211_vgpr212_vgpr213_vgpr214_vgpr215_vgpr216_vgpr217_vgpr218_vgpr219_vgpr220_vgpr221_vgpr222_vgpr223, $vgpr224_vgpr225_vgpr226_vgpr227_vgpr228_vgpr229_vgpr230_vgpr231_vgpr232_vgpr233_vgpr234_vgpr235_vgpr236_vgpr237_vgpr238_vgpr239
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0
  ; GFX908-EXPANDED-NEXT:   $vgpr63 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec
  ; GFX908-EXPANDED-NEXT:   BUFFER_STORE_DWORD_OFFSET killed $vgpr63, $sgpr0_sgpr1_sgpr2_sgpr3, $sgpr32, 0, 0, 0, implicit $exec :: (store (s32) into %stack.0, addrspace 5)
  ; GFX908-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.1:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.2:
  ; GFX908-EXPANDED-NEXT:   $vgpr63 = BUFFER_LOAD_DWORD_OFFSET $sgpr0_sgpr1_sgpr2_sgpr3, $sgpr32, 0, 0, 0, implicit $exec :: (load (s32) from %stack.0, addrspace 5)
  ; GFX908-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 killed $vgpr63, implicit $exec
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr0_vgpr1_vgpr2_vgpr3_vgpr4_vgpr5_vgpr6_vgpr7_vgpr8_vgpr9_vgpr10_vgpr11_vgpr12_vgpr13_vgpr14_vgpr15_vgpr16_vgpr17_vgpr18_vgpr19_vgpr20_vgpr21_vgpr22_vgpr23_vgpr24_vgpr25_vgpr26_vgpr27_vgpr28_vgpr29_vgpr30_vgpr31
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr32_vgpr33_vgpr34_vgpr35_vgpr36_vgpr37_vgpr38_vgpr39_vgpr40_vgpr41_vgpr42_vgpr43_vgpr44_vgpr45_vgpr46_vgpr47
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr48_vgpr49_vgpr50_vgpr51_vgpr52_vgpr53_vgpr54_vgpr55_vgpr56_vgpr57_vgpr58_vgpr59_vgpr60_vgpr61_vgpr62_vgpr63
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr64_vgpr65_vgpr66_vgpr67_vgpr68_vgpr69_vgpr70_vgpr71_vgpr72_vgpr73_vgpr74_vgpr75_vgpr76_vgpr77_vgpr78_vgpr79
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr80_vgpr81_vgpr82_vgpr83_vgpr84_vgpr85_vgpr86_vgpr87_vgpr88_vgpr89_vgpr90_vgpr91_vgpr92_vgpr93_vgpr94_vgpr95
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr96_vgpr97_vgpr98_vgpr99_vgpr100_vgpr101_vgpr102_vgpr103_vgpr104_vgpr105_vgpr106_vgpr107_vgpr108_vgpr109_vgpr110_vgpr111
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr112_vgpr113_vgpr114_vgpr115_vgpr116_vgpr117_vgpr118_vgpr119_vgpr120_vgpr121_vgpr122_vgpr123_vgpr124_vgpr125_vgpr126_vgpr127
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr128_vgpr129_vgpr130_vgpr131_vgpr132_vgpr133_vgpr134_vgpr135_vgpr136_vgpr137_vgpr138_vgpr139_vgpr140_vgpr141_vgpr142_vgpr143
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr144_vgpr145_vgpr146_vgpr147_vgpr148_vgpr149_vgpr150_vgpr151_vgpr152_vgpr153_vgpr154_vgpr155_vgpr156_vgpr157_vgpr158_vgpr159
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr160_vgpr161_vgpr162_vgpr163_vgpr164_vgpr165_vgpr166_vgpr167_vgpr168_vgpr169_vgpr170_vgpr171_vgpr172_vgpr173_vgpr174_vgpr175
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr176_vgpr177_vgpr178_vgpr179_vgpr180_vgpr181_vgpr182_vgpr183_vgpr184_vgpr185_vgpr186_vgpr187_vgpr188_vgpr189_vgpr190_vgpr191
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr192_vgpr193_vgpr194_vgpr195_vgpr196_vgpr197_vgpr198_vgpr199_vgpr200_vgpr201_vgpr202_vgpr203_vgpr204_vgpr205_vgpr206_vgpr207
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr208_vgpr209_vgpr210_vgpr211_vgpr212_vgpr213_vgpr214_vgpr215_vgpr216_vgpr217_vgpr218_vgpr219_vgpr220_vgpr221_vgpr222_vgpr223
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr224_vgpr225_vgpr226_vgpr227_vgpr228_vgpr229_vgpr230_vgpr231_vgpr232_vgpr233_vgpr234_vgpr235_vgpr236_vgpr237_vgpr238_vgpr239
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr240_vgpr241_vgpr242_vgpr243_vgpr244_vgpr245_vgpr246_vgpr247
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr248_vgpr249_vgpr250_vgpr251_vgpr252_vgpr253_vgpr254_vgpr255
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0
  ; GFX90A-SPILLED-LABEL: name: spill_restore_agpr32_used_all_vgprs
  ; GFX90A-SPILLED: bb.0:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-SPILLED-NEXT:   liveins: $vgpr0_vgpr1_vgpr2_vgpr3_vgpr4_vgpr5_vgpr6_vgpr7_vgpr8_vgpr9_vgpr10_vgpr11_vgpr12_vgpr13_vgpr14_vgpr15, $vgpr16_vgpr17_vgpr18_vgpr19_vgpr20_vgpr21_vgpr22_vgpr23_vgpr24_vgpr25_vgpr26_vgpr27_vgpr28_vgpr29_vgpr30_vgpr31, $vgpr32_vgpr33_vgpr34_vgpr35_vgpr36_vgpr37_vgpr38_vgpr39_vgpr40_vgpr41_vgpr42_vgpr43_vgpr44_vgpr45_vgpr46_vgpr47, $vgpr48_vgpr49_vgpr50_vgpr51_vgpr52_vgpr53_vgpr54_vgpr55_vgpr56_vgpr57_vgpr58_vgpr59_vgpr60_vgpr61_vgpr62_vgpr63, $vgpr64_vgpr65_vgpr66_vgpr67_vgpr68_vgpr69_vgpr70_vgpr71_vgpr72_vgpr73_vgpr74_vgpr75_vgpr76_vgpr77_vgpr78_vgpr79, $vgpr80_vgpr81_vgpr82_vgpr83_vgpr84_vgpr85_vgpr86_vgpr87_vgpr88_vgpr89_vgpr90_vgpr91_vgpr92_vgpr93_vgpr94_vgpr95, $vgpr96_vgpr97_vgpr98_vgpr99_vgpr100_vgpr101_vgpr102_vgpr103_vgpr104_vgpr105_vgpr106_vgpr107_vgpr108_vgpr109_vgpr110_vgpr111, $vgpr112_vgpr113_vgpr114_vgpr115_vgpr116_vgpr117_vgpr118_vgpr119_vgpr120_vgpr121_vgpr122_vgpr123_vgpr124_vgpr125_vgpr126_vgpr127, $vgpr128_vgpr129_vgpr130_vgpr131_vgpr132_vgpr133_vgpr134_vgpr135_vgpr136_vgpr137_vgpr138_vgpr139_vgpr140_vgpr141_vgpr142_vgpr143, $vgpr144_vgpr145_vgpr146_vgpr147_vgpr148_vgpr149_vgpr150_vgpr151_vgpr152_vgpr153_vgpr154_vgpr155_vgpr156_vgpr157_vgpr158_vgpr159, $vgpr160_vgpr161_vgpr162_vgpr163_vgpr164_vgpr165_vgpr166_vgpr167_vgpr168_vgpr169_vgpr170_vgpr171_vgpr172_vgpr173_vgpr174_vgpr175, $vgpr176_vgpr177_vgpr178_vgpr179_vgpr180_vgpr181_vgpr182_vgpr183_vgpr184_vgpr185_vgpr186_vgpr187_vgpr188_vgpr189_vgpr190_vgpr191, $vgpr192_vgpr193_vgpr194_vgpr195_vgpr196_vgpr197_vgpr198_vgpr199_vgpr200_vgpr201_vgpr202_vgpr203_vgpr204_vgpr205_vgpr206_vgpr207, $vgpr208_vgpr209_vgpr210_vgpr211_vgpr212_vgpr213_vgpr214_vgpr215_vgpr216_vgpr217_vgpr218_vgpr219_vgpr220_vgpr221_vgpr222_vgpr223, $vgpr224_vgpr225_vgpr226_vgpr227_vgpr228_vgpr229_vgpr230_vgpr231_vgpr232_vgpr233_vgpr234_vgpr235_vgpr236_vgpr237_vgpr238_vgpr239, $vgpr240_vgpr241_vgpr242_vgpr243_vgpr244_vgpr245_vgpr246_vgpr247, $vgpr248_vgpr249_vgpr250_vgpr251_vgpr252_vgpr253_vgpr254_vgpr255
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0
  ; GFX90A-SPILLED-NEXT:   SI_SPILL_A32_SAVE killed $agpr0, %stack.0, $sgpr32, 0, implicit $exec :: (store (s32) into %stack.0, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.1:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.2:
  ; GFX90A-SPILLED-NEXT:   $agpr0 = SI_SPILL_A32_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s32) from %stack.0, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr0_vgpr1_vgpr2_vgpr3_vgpr4_vgpr5_vgpr6_vgpr7_vgpr8_vgpr9_vgpr10_vgpr11_vgpr12_vgpr13_vgpr14_vgpr15_vgpr16_vgpr17_vgpr18_vgpr19_vgpr20_vgpr21_vgpr22_vgpr23_vgpr24_vgpr25_vgpr26_vgpr27_vgpr28_vgpr29_vgpr30_vgpr31
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr32_vgpr33_vgpr34_vgpr35_vgpr36_vgpr37_vgpr38_vgpr39_vgpr40_vgpr41_vgpr42_vgpr43_vgpr44_vgpr45_vgpr46_vgpr47
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr48_vgpr49_vgpr50_vgpr51_vgpr52_vgpr53_vgpr54_vgpr55_vgpr56_vgpr57_vgpr58_vgpr59_vgpr60_vgpr61_vgpr62_vgpr63
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr64_vgpr65_vgpr66_vgpr67_vgpr68_vgpr69_vgpr70_vgpr71_vgpr72_vgpr73_vgpr74_vgpr75_vgpr76_vgpr77_vgpr78_vgpr79
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr80_vgpr81_vgpr82_vgpr83_vgpr84_vgpr85_vgpr86_vgpr87_vgpr88_vgpr89_vgpr90_vgpr91_vgpr92_vgpr93_vgpr94_vgpr95
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr96_vgpr97_vgpr98_vgpr99_vgpr100_vgpr101_vgpr102_vgpr103_vgpr104_vgpr105_vgpr106_vgpr107_vgpr108_vgpr109_vgpr110_vgpr111
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr112_vgpr113_vgpr114_vgpr115_vgpr116_vgpr117_vgpr118_vgpr119_vgpr120_vgpr121_vgpr122_vgpr123_vgpr124_vgpr125_vgpr126_vgpr127
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr128_vgpr129_vgpr130_vgpr131_vgpr132_vgpr133_vgpr134_vgpr135_vgpr136_vgpr137_vgpr138_vgpr139_vgpr140_vgpr141_vgpr142_vgpr143
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr144_vgpr145_vgpr146_vgpr147_vgpr148_vgpr149_vgpr150_vgpr151_vgpr152_vgpr153_vgpr154_vgpr155_vgpr156_vgpr157_vgpr158_vgpr159
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr160_vgpr161_vgpr162_vgpr163_vgpr164_vgpr165_vgpr166_vgpr167_vgpr168_vgpr169_vgpr170_vgpr171_vgpr172_vgpr173_vgpr174_vgpr175
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr176_vgpr177_vgpr178_vgpr179_vgpr180_vgpr181_vgpr182_vgpr183_vgpr184_vgpr185_vgpr186_vgpr187_vgpr188_vgpr189_vgpr190_vgpr191
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr192_vgpr193_vgpr194_vgpr195_vgpr196_vgpr197_vgpr198_vgpr199_vgpr200_vgpr201_vgpr202_vgpr203_vgpr204_vgpr205_vgpr206_vgpr207
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr208_vgpr209_vgpr210_vgpr211_vgpr212_vgpr213_vgpr214_vgpr215_vgpr216_vgpr217_vgpr218_vgpr219_vgpr220_vgpr221_vgpr222_vgpr223
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr224_vgpr225_vgpr226_vgpr227_vgpr228_vgpr229_vgpr230_vgpr231_vgpr232_vgpr233_vgpr234_vgpr235_vgpr236_vgpr237_vgpr238_vgpr239
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr240_vgpr241_vgpr242_vgpr243_vgpr244_vgpr245_vgpr246_vgpr247
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit undef $vgpr248_vgpr249_vgpr250_vgpr251_vgpr252_vgpr253_vgpr254_vgpr255
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0
  ; GFX90A-EXPANDED-LABEL: name: spill_restore_agpr32_used_all_vgprs
  ; GFX90A-EXPANDED: bb.0:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr240_vgpr241_vgpr242_vgpr243_vgpr244_vgpr245_vgpr246_vgpr247, $vgpr248_vgpr249_vgpr250_vgpr251_vgpr252_vgpr253_vgpr254_vgpr255, $vgpr0_vgpr1_vgpr2_vgpr3_vgpr4_vgpr5_vgpr6_vgpr7_vgpr8_vgpr9_vgpr10_vgpr11_vgpr12_vgpr13_vgpr14_vgpr15, $vgpr16_vgpr17_vgpr18_vgpr19_vgpr20_vgpr21_vgpr22_vgpr23_vgpr24_vgpr25_vgpr26_vgpr27_vgpr28_vgpr29_vgpr30_vgpr31, $vgpr32_vgpr33_vgpr34_vgpr35_vgpr36_vgpr37_vgpr38_vgpr39_vgpr40_vgpr41_vgpr42_vgpr43_vgpr44_vgpr45_vgpr46_vgpr47, $vgpr48_vgpr49_vgpr50_vgpr51_vgpr52_vgpr53_vgpr54_vgpr55_vgpr56_vgpr57_vgpr58_vgpr59_vgpr60_vgpr61_vgpr62_vgpr63, $vgpr64_vgpr65_vgpr66_vgpr67_vgpr68_vgpr69_vgpr70_vgpr71_vgpr72_vgpr73_vgpr74_vgpr75_vgpr76_vgpr77_vgpr78_vgpr79, $vgpr80_vgpr81_vgpr82_vgpr83_vgpr84_vgpr85_vgpr86_vgpr87_vgpr88_vgpr89_vgpr90_vgpr91_vgpr92_vgpr93_vgpr94_vgpr95, $vgpr96_vgpr97_vgpr98_vgpr99_vgpr100_vgpr101_vgpr102_vgpr103_vgpr104_vgpr105_vgpr106_vgpr107_vgpr108_vgpr109_vgpr110_vgpr111, $vgpr112_vgpr113_vgpr114_vgpr115_vgpr116_vgpr117_vgpr118_vgpr119_vgpr120_vgpr121_vgpr122_vgpr123_vgpr124_vgpr125_vgpr126_vgpr127, $vgpr128_vgpr129_vgpr130_vgpr131_vgpr132_vgpr133_vgpr134_vgpr135_vgpr136_vgpr137_vgpr138_vgpr139_vgpr140_vgpr141_vgpr142_vgpr143, $vgpr144_vgpr145_vgpr146_vgpr147_vgpr148_vgpr149_vgpr150_vgpr151_vgpr152_vgpr153_vgpr154_vgpr155_vgpr156_vgpr157_vgpr158_vgpr159, $vgpr160_vgpr161_vgpr162_vgpr163_vgpr164_vgpr165_vgpr166_vgpr167_vgpr168_vgpr169_vgpr170_vgpr171_vgpr172_vgpr173_vgpr174_vgpr175, $vgpr176_vgpr177_vgpr178_vgpr179_vgpr180_vgpr181_vgpr182_vgpr183_vgpr184_vgpr185_vgpr186_vgpr187_vgpr188_vgpr189_vgpr190_vgpr191, $vgpr192_vgpr193_vgpr194_vgpr195_vgpr196_vgpr197_vgpr198_vgpr199_vgpr200_vgpr201_vgpr202_vgpr203_vgpr204_vgpr205_vgpr206_vgpr207, $vgpr208_vgpr209_vgpr210_vgpr211_vgpr212_vgpr213_vgpr214_vgpr215_vgpr216_vgpr217_vgpr218_vgpr219_vgpr220_vgpr221_vgpr222_vgpr223, $vgpr224_vgpr225_vgpr226_vgpr227_vgpr228_vgpr229_vgpr230_vgpr231_vgpr232_vgpr233_vgpr234_vgpr235_vgpr236_vgpr237_vgpr238_vgpr239
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0
  ; GFX90A-EXPANDED-NEXT:   BUFFER_STORE_DWORD_OFFSET killed $agpr0, $sgpr0_sgpr1_sgpr2_sgpr3, $sgpr32, 0, 0, 0, implicit $exec :: (store (s32) into %stack.0, addrspace 5)
  ; GFX90A-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.1:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.2:
  ; GFX90A-EXPANDED-NEXT:   $agpr0 = BUFFER_LOAD_DWORD_OFFSET $sgpr0_sgpr1_sgpr2_sgpr3, $sgpr32, 0, 0, 0, implicit $exec :: (load (s32) from %stack.0, addrspace 5)
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr0_vgpr1_vgpr2_vgpr3_vgpr4_vgpr5_vgpr6_vgpr7_vgpr8_vgpr9_vgpr10_vgpr11_vgpr12_vgpr13_vgpr14_vgpr15_vgpr16_vgpr17_vgpr18_vgpr19_vgpr20_vgpr21_vgpr22_vgpr23_vgpr24_vgpr25_vgpr26_vgpr27_vgpr28_vgpr29_vgpr30_vgpr31
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr32_vgpr33_vgpr34_vgpr35_vgpr36_vgpr37_vgpr38_vgpr39_vgpr40_vgpr41_vgpr42_vgpr43_vgpr44_vgpr45_vgpr46_vgpr47
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr48_vgpr49_vgpr50_vgpr51_vgpr52_vgpr53_vgpr54_vgpr55_vgpr56_vgpr57_vgpr58_vgpr59_vgpr60_vgpr61_vgpr62_vgpr63
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr64_vgpr65_vgpr66_vgpr67_vgpr68_vgpr69_vgpr70_vgpr71_vgpr72_vgpr73_vgpr74_vgpr75_vgpr76_vgpr77_vgpr78_vgpr79
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr80_vgpr81_vgpr82_vgpr83_vgpr84_vgpr85_vgpr86_vgpr87_vgpr88_vgpr89_vgpr90_vgpr91_vgpr92_vgpr93_vgpr94_vgpr95
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr96_vgpr97_vgpr98_vgpr99_vgpr100_vgpr101_vgpr102_vgpr103_vgpr104_vgpr105_vgpr106_vgpr107_vgpr108_vgpr109_vgpr110_vgpr111
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr112_vgpr113_vgpr114_vgpr115_vgpr116_vgpr117_vgpr118_vgpr119_vgpr120_vgpr121_vgpr122_vgpr123_vgpr124_vgpr125_vgpr126_vgpr127
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr128_vgpr129_vgpr130_vgpr131_vgpr132_vgpr133_vgpr134_vgpr135_vgpr136_vgpr137_vgpr138_vgpr139_vgpr140_vgpr141_vgpr142_vgpr143
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr144_vgpr145_vgpr146_vgpr147_vgpr148_vgpr149_vgpr150_vgpr151_vgpr152_vgpr153_vgpr154_vgpr155_vgpr156_vgpr157_vgpr158_vgpr159
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr160_vgpr161_vgpr162_vgpr163_vgpr164_vgpr165_vgpr166_vgpr167_vgpr168_vgpr169_vgpr170_vgpr171_vgpr172_vgpr173_vgpr174_vgpr175
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr176_vgpr177_vgpr178_vgpr179_vgpr180_vgpr181_vgpr182_vgpr183_vgpr184_vgpr185_vgpr186_vgpr187_vgpr188_vgpr189_vgpr190_vgpr191
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr192_vgpr193_vgpr194_vgpr195_vgpr196_vgpr197_vgpr198_vgpr199_vgpr200_vgpr201_vgpr202_vgpr203_vgpr204_vgpr205_vgpr206_vgpr207
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr208_vgpr209_vgpr210_vgpr211_vgpr212_vgpr213_vgpr214_vgpr215_vgpr216_vgpr217_vgpr218_vgpr219_vgpr220_vgpr221_vgpr222_vgpr223
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr224_vgpr225_vgpr226_vgpr227_vgpr228_vgpr229_vgpr230_vgpr231_vgpr232_vgpr233_vgpr234_vgpr235_vgpr236_vgpr237_vgpr238_vgpr239
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr240_vgpr241_vgpr242_vgpr243_vgpr244_vgpr245_vgpr246_vgpr247
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit undef $vgpr248_vgpr249_vgpr250_vgpr251_vgpr252_vgpr253_vgpr254_vgpr255
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0
  bb.0:
    liveins: $vgpr0_vgpr1_vgpr2_vgpr3_vgpr4_vgpr5_vgpr6_vgpr7_vgpr8_vgpr9_vgpr10_vgpr11_vgpr12_vgpr13_vgpr14_vgpr15, $vgpr16_vgpr17_vgpr18_vgpr19_vgpr20_vgpr21_vgpr22_vgpr23_vgpr24_vgpr25_vgpr26_vgpr27_vgpr28_vgpr29_vgpr30_vgpr31, $vgpr32_vgpr33_vgpr34_vgpr35_vgpr36_vgpr37_vgpr38_vgpr39_vgpr40_vgpr41_vgpr42_vgpr43_vgpr44_vgpr45_vgpr46_vgpr47, $vgpr48_vgpr49_vgpr50_vgpr51_vgpr52_vgpr53_vgpr54_vgpr55_vgpr56_vgpr57_vgpr58_vgpr59_vgpr60_vgpr61_vgpr62_vgpr63, $vgpr64_vgpr65_vgpr66_vgpr67_vgpr68_vgpr69_vgpr70_vgpr71_vgpr72_vgpr73_vgpr74_vgpr75_vgpr76_vgpr77_vgpr78_vgpr79, $vgpr80_vgpr81_vgpr82_vgpr83_vgpr84_vgpr85_vgpr86_vgpr87_vgpr88_vgpr89_vgpr90_vgpr91_vgpr92_vgpr93_vgpr94_vgpr95, $vgpr96_vgpr97_vgpr98_vgpr99_vgpr100_vgpr101_vgpr102_vgpr103_vgpr104_vgpr105_vgpr106_vgpr107_vgpr108_vgpr109_vgpr110_vgpr111, $vgpr112_vgpr113_vgpr114_vgpr115_vgpr116_vgpr117_vgpr118_vgpr119_vgpr120_vgpr121_vgpr122_vgpr123_vgpr124_vgpr125_vgpr126_vgpr127, $vgpr128_vgpr129_vgpr130_vgpr131_vgpr132_vgpr133_vgpr134_vgpr135_vgpr136_vgpr137_vgpr138_vgpr139_vgpr140_vgpr141_vgpr142_vgpr143, $vgpr144_vgpr145_vgpr146_vgpr147_vgpr148_vgpr149_vgpr150_vgpr151_vgpr152_vgpr153_vgpr154_vgpr155_vgpr156_vgpr157_vgpr158_vgpr159, $vgpr160_vgpr161_vgpr162_vgpr163_vgpr164_vgpr165_vgpr166_vgpr167_vgpr168_vgpr169_vgpr170_vgpr171_vgpr172_vgpr173_vgpr174_vgpr175, $vgpr176_vgpr177_vgpr178_vgpr179_vgpr180_vgpr181_vgpr182_vgpr183_vgpr184_vgpr185_vgpr186_vgpr187_vgpr188_vgpr189_vgpr190_vgpr191, $vgpr192_vgpr193_vgpr194_vgpr195_vgpr196_vgpr197_vgpr198_vgpr199_vgpr200_vgpr201_vgpr202_vgpr203_vgpr204_vgpr205_vgpr206_vgpr207, $vgpr208_vgpr209_vgpr210_vgpr211_vgpr212_vgpr213_vgpr214_vgpr215_vgpr216_vgpr217_vgpr218_vgpr219_vgpr220_vgpr221_vgpr222_vgpr223, $vgpr224_vgpr225_vgpr226_vgpr227_vgpr228_vgpr229_vgpr230_vgpr231_vgpr232_vgpr233_vgpr234_vgpr235_vgpr236_vgpr237_vgpr238_vgpr239, $vgpr240_vgpr241_vgpr242_vgpr243_vgpr244_vgpr245_vgpr246_vgpr247, $vgpr248_vgpr249_vgpr250_vgpr251_vgpr252_vgpr253_vgpr254_vgpr255

    S_NOP 0, implicit-def %0:agpr_32
    S_CBRANCH_SCC1 implicit undef $scc, %bb.1

  bb.1:

  bb.2:
    S_NOP 0, implicit undef $vgpr0_vgpr1_vgpr2_vgpr3_vgpr4_vgpr5_vgpr6_vgpr7_vgpr8_vgpr9_vgpr10_vgpr11_vgpr12_vgpr13_vgpr14_vgpr15_vgpr16_vgpr17_vgpr18_vgpr19_vgpr20_vgpr21_vgpr22_vgpr23_vgpr24_vgpr25_vgpr26_vgpr27_vgpr28_vgpr29_vgpr30_vgpr31
    S_NOP 0, implicit undef $vgpr32_vgpr33_vgpr34_vgpr35_vgpr36_vgpr37_vgpr38_vgpr39_vgpr40_vgpr41_vgpr42_vgpr43_vgpr44_vgpr45_vgpr46_vgpr47
    S_NOP 0, implicit undef $vgpr48_vgpr49_vgpr50_vgpr51_vgpr52_vgpr53_vgpr54_vgpr55_vgpr56_vgpr57_vgpr58_vgpr59_vgpr60_vgpr61_vgpr62_vgpr63
    S_NOP 0, implicit undef $vgpr64_vgpr65_vgpr66_vgpr67_vgpr68_vgpr69_vgpr70_vgpr71_vgpr72_vgpr73_vgpr74_vgpr75_vgpr76_vgpr77_vgpr78_vgpr79
    S_NOP 0, implicit undef $vgpr80_vgpr81_vgpr82_vgpr83_vgpr84_vgpr85_vgpr86_vgpr87_vgpr88_vgpr89_vgpr90_vgpr91_vgpr92_vgpr93_vgpr94_vgpr95
    S_NOP 0, implicit undef $vgpr96_vgpr97_vgpr98_vgpr99_vgpr100_vgpr101_vgpr102_vgpr103_vgpr104_vgpr105_vgpr106_vgpr107_vgpr108_vgpr109_vgpr110_vgpr111
    S_NOP 0, implicit undef $vgpr112_vgpr113_vgpr114_vgpr115_vgpr116_vgpr117_vgpr118_vgpr119_vgpr120_vgpr121_vgpr122_vgpr123_vgpr124_vgpr125_vgpr126_vgpr127
    S_NOP 0, implicit undef $vgpr128_vgpr129_vgpr130_vgpr131_vgpr132_vgpr133_vgpr134_vgpr135_vgpr136_vgpr137_vgpr138_vgpr139_vgpr140_vgpr141_vgpr142_vgpr143
    S_NOP 0, implicit undef $vgpr144_vgpr145_vgpr146_vgpr147_vgpr148_vgpr149_vgpr150_vgpr151_vgpr152_vgpr153_vgpr154_vgpr155_vgpr156_vgpr157_vgpr158_vgpr159
    S_NOP 0, implicit undef $vgpr160_vgpr161_vgpr162_vgpr163_vgpr164_vgpr165_vgpr166_vgpr167_vgpr168_vgpr169_vgpr170_vgpr171_vgpr172_vgpr173_vgpr174_vgpr175
    S_NOP 0, implicit undef $vgpr176_vgpr177_vgpr178_vgpr179_vgpr180_vgpr181_vgpr182_vgpr183_vgpr184_vgpr185_vgpr186_vgpr187_vgpr188_vgpr189_vgpr190_vgpr191
    S_NOP 0, implicit undef $vgpr192_vgpr193_vgpr194_vgpr195_vgpr196_vgpr197_vgpr198_vgpr199_vgpr200_vgpr201_vgpr202_vgpr203_vgpr204_vgpr205_vgpr206_vgpr207
    S_NOP 0, implicit undef $vgpr208_vgpr209_vgpr210_vgpr211_vgpr212_vgpr213_vgpr214_vgpr215_vgpr216_vgpr217_vgpr218_vgpr219_vgpr220_vgpr221_vgpr222_vgpr223
    S_NOP 0, implicit undef $vgpr224_vgpr225_vgpr226_vgpr227_vgpr228_vgpr229_vgpr230_vgpr231_vgpr232_vgpr233_vgpr234_vgpr235_vgpr236_vgpr237_vgpr238_vgpr239
    S_NOP 0, implicit undef $vgpr240_vgpr241_vgpr242_vgpr243_vgpr244_vgpr245_vgpr246_vgpr247
    S_NOP 0, implicit undef $vgpr248_vgpr249_vgpr250_vgpr251_vgpr252_vgpr253_vgpr254_vgpr255
    S_NOP 0, implicit %0
...

---
name: spill_restore_agpr96
tracksRegLiveness: true
machineFunctionInfo:
  scratchRSrcReg: $sgpr0_sgpr1_sgpr2_sgpr3
  stackPtrOffsetReg: $sgpr32
body: |
  ; GFX908-SPILLED-LABEL: name: spill_restore_agpr96
  ; GFX908-SPILLED: bb.0:
  ; GFX908-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2
  ; GFX908-SPILLED-NEXT:   SI_SPILL_A96_SAVE killed $agpr0_agpr1_agpr2, %stack.0, $sgpr32, 0, implicit $exec :: (store (s96) into %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.1:
  ; GFX908-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 1
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.2:
  ; GFX908-SPILLED-NEXT:   $agpr0_agpr1_agpr2 = SI_SPILL_A96_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s96) from %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2
  ; GFX908-EXPANDED-LABEL: name: spill_restore_agpr96
  ; GFX908-EXPANDED: bb.0:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2
  ; GFX908-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2, implicit $agpr0_agpr1_agpr2
  ; GFX908-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec, implicit killed $agpr0_agpr1_agpr2
  ; GFX908-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.1:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   S_NOP 1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.2:
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec, implicit-def $agpr0_agpr1_agpr2
  ; GFX908-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2
  ; GFX90A-SPILLED-LABEL: name: spill_restore_agpr96
  ; GFX90A-SPILLED: bb.0:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2
  ; GFX90A-SPILLED-NEXT:   SI_SPILL_A96_SAVE killed $agpr0_agpr1_agpr2, %stack.0, $sgpr32, 0, implicit $exec :: (store (s96) into %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.1:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 1
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.2:
  ; GFX90A-SPILLED-NEXT:   $agpr0_agpr1_agpr2 = SI_SPILL_A96_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s96) from %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2
  ; GFX90A-EXPANDED-LABEL: name: spill_restore_agpr96
  ; GFX90A-EXPANDED: bb.0:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2
  ; GFX90A-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2, implicit $agpr0_agpr1_agpr2
  ; GFX90A-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec, implicit killed $agpr0_agpr1_agpr2
  ; GFX90A-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.1:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   S_NOP 1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.2:
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec, implicit-def $agpr0_agpr1_agpr2
  ; GFX90A-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2
  bb.0:
    S_NOP 0, implicit-def %0:areg_96
    S_CBRANCH_SCC1 implicit undef $scc, %bb.1

  bb.1:
    S_NOP 1

  bb.2:
    S_NOP 0, implicit %0
...

---
name: spill_restore_agpr128
tracksRegLiveness: true
machineFunctionInfo:
  scratchRSrcReg: $sgpr0_sgpr1_sgpr2_sgpr3
  stackPtrOffsetReg: $sgpr32
body: |
  ; GFX908-SPILLED-LABEL: name: spill_restore_agpr128
  ; GFX908-SPILLED: bb.0:
  ; GFX908-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3
  ; GFX908-SPILLED-NEXT:   SI_SPILL_A128_SAVE killed $agpr0_agpr1_agpr2_agpr3, %stack.0, $sgpr32, 0, implicit $exec :: (store (s128) into %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.1:
  ; GFX908-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 1
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.2:
  ; GFX908-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3 = SI_SPILL_A128_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s128) from %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3
  ; GFX908-EXPANDED-LABEL: name: spill_restore_agpr128
  ; GFX908-EXPANDED: bb.0:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3
  ; GFX908-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3, implicit $agpr0_agpr1_agpr2_agpr3
  ; GFX908-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3
  ; GFX908-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.1:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   S_NOP 1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.2:
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3
  ; GFX908-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3
  ; GFX90A-SPILLED-LABEL: name: spill_restore_agpr128
  ; GFX90A-SPILLED: bb.0:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3
  ; GFX90A-SPILLED-NEXT:   SI_SPILL_A128_SAVE killed $agpr0_agpr1_agpr2_agpr3, %stack.0, $sgpr32, 0, implicit $exec :: (store (s128) into %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.1:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 1
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.2:
  ; GFX90A-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3 = SI_SPILL_A128_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s128) from %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3
  ; GFX90A-EXPANDED-LABEL: name: spill_restore_agpr128
  ; GFX90A-EXPANDED: bb.0:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3
  ; GFX90A-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3, implicit $agpr0_agpr1_agpr2_agpr3
  ; GFX90A-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3
  ; GFX90A-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.1:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   S_NOP 1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.2:
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3
  ; GFX90A-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3
  bb.0:
    S_NOP 0, implicit-def %0:areg_128
    S_CBRANCH_SCC1 implicit undef $scc, %bb.1

  bb.1:
    S_NOP 1

  bb.2:
    S_NOP 0, implicit %0
...

---
name: spill_restore_agpr160
tracksRegLiveness: true
machineFunctionInfo:
  scratchRSrcReg: $sgpr0_sgpr1_sgpr2_sgpr3
  stackPtrOffsetReg: $sgpr32
body: |
  ; GFX908-SPILLED-LABEL: name: spill_restore_agpr160
  ; GFX908-SPILLED: bb.0:
  ; GFX908-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4
  ; GFX908-SPILLED-NEXT:   SI_SPILL_A160_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4, %stack.0, $sgpr32, 0, implicit $exec :: (store (s160) into %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.1:
  ; GFX908-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 1
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.2:
  ; GFX908-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4 = SI_SPILL_A160_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s160) from %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4
  ; GFX908-EXPANDED-LABEL: name: spill_restore_agpr160
  ; GFX908-EXPANDED: bb.0:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4
  ; GFX908-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4, implicit $agpr0_agpr1_agpr2_agpr3_agpr4
  ; GFX908-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4
  ; GFX908-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.1:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   S_NOP 1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.2:
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4
  ; GFX908-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4
  ; GFX90A-SPILLED-LABEL: name: spill_restore_agpr160
  ; GFX90A-SPILLED: bb.0:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4
  ; GFX90A-SPILLED-NEXT:   SI_SPILL_A160_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4, %stack.0, $sgpr32, 0, implicit $exec :: (store (s160) into %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.1:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 1
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.2:
  ; GFX90A-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4 = SI_SPILL_A160_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s160) from %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4
  ; GFX90A-EXPANDED-LABEL: name: spill_restore_agpr160
  ; GFX90A-EXPANDED: bb.0:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4
  ; GFX90A-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4, implicit $agpr0_agpr1_agpr2_agpr3_agpr4
  ; GFX90A-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4
  ; GFX90A-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.1:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   S_NOP 1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.2:
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4
  ; GFX90A-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4
  bb.0:
    S_NOP 0, implicit-def %0:areg_160
    S_CBRANCH_SCC1 implicit undef $scc, %bb.1

  bb.1:
    S_NOP 1

  bb.2:
    S_NOP 0, implicit %0
...

---
name: spill_restore_agpr192
tracksRegLiveness: true
machineFunctionInfo:
  scratchRSrcReg: $sgpr0_sgpr1_sgpr2_sgpr3
  stackPtrOffsetReg: $sgpr32
body: |
  ; GFX908-SPILLED-LABEL: name: spill_restore_agpr192
  ; GFX908-SPILLED: bb.0:
  ; GFX908-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5
  ; GFX908-SPILLED-NEXT:   SI_SPILL_A192_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5, %stack.0, $sgpr32, 0, implicit $exec :: (store (s192) into %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.1:
  ; GFX908-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 1
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.2:
  ; GFX908-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5 = SI_SPILL_A192_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s192) from %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5
  ; GFX908-EXPANDED-LABEL: name: spill_restore_agpr192
  ; GFX908-EXPANDED: bb.0:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr5_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr5_lo16
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5
  ; GFX908-EXPANDED-NEXT:   $vgpr5 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5
  ; GFX908-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr5, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5
  ; GFX908-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.1:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   S_NOP 1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.2:
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr5, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5
  ; GFX908-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr5 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5
  ; GFX90A-SPILLED-LABEL: name: spill_restore_agpr192
  ; GFX90A-SPILLED: bb.0:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5
  ; GFX90A-SPILLED-NEXT:   SI_SPILL_A192_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5, %stack.0, $sgpr32, 0, implicit $exec :: (store (s192) into %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.1:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 1
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.2:
  ; GFX90A-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5 = SI_SPILL_A192_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s192) from %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5
  ; GFX90A-EXPANDED-LABEL: name: spill_restore_agpr192
  ; GFX90A-EXPANDED: bb.0:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr5_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr5_lo16
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5
  ; GFX90A-EXPANDED-NEXT:   $vgpr5 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5
  ; GFX90A-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr5, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5
  ; GFX90A-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.1:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   S_NOP 1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.2:
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr5, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5
  ; GFX90A-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr5 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5
  bb.0:
    S_NOP 0, implicit-def %0:areg_192
    S_CBRANCH_SCC1 implicit undef $scc, %bb.1

  bb.1:
    S_NOP 1

  bb.2:
    S_NOP 0, implicit %0
...

---
name: spill_restore_agpr256
tracksRegLiveness: true
machineFunctionInfo:
  scratchRSrcReg: $sgpr0_sgpr1_sgpr2_sgpr3
  stackPtrOffsetReg: $sgpr32
body: |
  ; GFX908-SPILLED-LABEL: name: spill_restore_agpr256
  ; GFX908-SPILLED: bb.0:
  ; GFX908-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7
  ; GFX908-SPILLED-NEXT:   SI_SPILL_A256_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7, %stack.0, $sgpr32, 0, implicit $exec :: (store (s256) into %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.1:
  ; GFX908-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 1
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.2:
  ; GFX908-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7 = SI_SPILL_A256_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s256) from %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7
  ; GFX908-EXPANDED-LABEL: name: spill_restore_agpr256
  ; GFX908-EXPANDED: bb.0:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr5_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr6_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr7_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr5_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr6_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr7_lo16
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7
  ; GFX908-EXPANDED-NEXT:   $vgpr7 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7
  ; GFX908-EXPANDED-NEXT:   $vgpr6 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr5 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr5, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr6, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr7, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7
  ; GFX908-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.1:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   S_NOP 1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.2:
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr7, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7
  ; GFX908-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr6, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr5, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr5 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr6 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr7 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7
  ; GFX90A-SPILLED-LABEL: name: spill_restore_agpr256
  ; GFX90A-SPILLED: bb.0:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7
  ; GFX90A-SPILLED-NEXT:   SI_SPILL_A256_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7, %stack.0, $sgpr32, 0, implicit $exec :: (store (s256) into %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.1:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 1
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.2:
  ; GFX90A-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7 = SI_SPILL_A256_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s256) from %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7
  ; GFX90A-EXPANDED-LABEL: name: spill_restore_agpr256
  ; GFX90A-EXPANDED: bb.0:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr5_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr6_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr7_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr5_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr6_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr7_lo16
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7
  ; GFX90A-EXPANDED-NEXT:   $vgpr7 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7
  ; GFX90A-EXPANDED-NEXT:   $vgpr6 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr5 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr5, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr6, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr7, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7
  ; GFX90A-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.1:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   S_NOP 1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.2:
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr7, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7
  ; GFX90A-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr6, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr5, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr5 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr6 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr7 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7
  bb.0:
    S_NOP 0, implicit-def %0:areg_256
    S_CBRANCH_SCC1 implicit undef $scc, %bb.1

  bb.1:
    S_NOP 1

  bb.2:
    S_NOP 0, implicit %0
...

---
name: spill_restore_agpr288
tracksRegLiveness: true
machineFunctionInfo:
  scratchRSrcReg: $sgpr0_sgpr1_sgpr2_sgpr3
  stackPtrOffsetReg: $sgpr32
body: |
  ; GFX908-SPILLED-LABEL: name: spill_restore_agpr288
  ; GFX908-SPILLED: bb.0:
  ; GFX908-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8
  ; GFX908-SPILLED-NEXT:   SI_SPILL_A288_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8, %stack.0, $sgpr32, 0, implicit $exec :: (store (s288) into %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.1:
  ; GFX908-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 1
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.2:
  ; GFX908-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8 = SI_SPILL_A288_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s288) from %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8
  ; GFX908-EXPANDED-LABEL: name: spill_restore_agpr288
  ; GFX908-EXPANDED: bb.0:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr5_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr6_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr7_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr8_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr5_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr6_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr7_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr8_lo16
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8
  ; GFX908-EXPANDED-NEXT:   $vgpr8 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8
  ; GFX908-EXPANDED-NEXT:   $vgpr7 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr6 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr5 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr5, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr6, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr7, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr8, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8
  ; GFX908-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.1:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   S_NOP 1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.2:
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr8, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8
  ; GFX908-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr7, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr6, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr5, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr5 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr6 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr7 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr8 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8
  ; GFX90A-SPILLED-LABEL: name: spill_restore_agpr288
  ; GFX90A-SPILLED: bb.0:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8
  ; GFX90A-SPILLED-NEXT:   SI_SPILL_A288_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8, %stack.0, $sgpr32, 0, implicit $exec :: (store (s288) into %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.1:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 1
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.2:
  ; GFX90A-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8 = SI_SPILL_A288_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s288) from %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8
  ; GFX90A-EXPANDED-LABEL: name: spill_restore_agpr288
  ; GFX90A-EXPANDED: bb.0:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr5_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr6_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr7_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr8_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr5_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr6_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr7_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr8_lo16
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8
  ; GFX90A-EXPANDED-NEXT:   $vgpr8 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8
  ; GFX90A-EXPANDED-NEXT:   $vgpr7 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr6 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr5 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr5, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr6, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr7, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr8, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8
  ; GFX90A-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.1:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   S_NOP 1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.2:
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr8, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8
  ; GFX90A-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr7, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr6, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr5, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr5 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr6 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr7 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr8 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8
  bb.0:
    S_NOP 0, implicit-def %0:areg_288
    S_CBRANCH_SCC1 implicit undef $scc, %bb.1

  bb.1:
    S_NOP 1

  bb.2:
    S_NOP 0, implicit %0
...

---
name: spill_restore_agpr320
tracksRegLiveness: true
machineFunctionInfo:
  scratchRSrcReg: $sgpr0_sgpr1_sgpr2_sgpr3
  stackPtrOffsetReg: $sgpr32
body: |
  ; GFX908-SPILLED-LABEL: name: spill_restore_agpr320
  ; GFX908-SPILLED: bb.0:
  ; GFX908-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9
  ; GFX908-SPILLED-NEXT:   SI_SPILL_A320_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9, %stack.0, $sgpr32, 0, implicit $exec :: (store (s320) into %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.1:
  ; GFX908-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 1
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.2:
  ; GFX908-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9 = SI_SPILL_A320_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s320) from %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9
  ; GFX908-EXPANDED-LABEL: name: spill_restore_agpr320
  ; GFX908-EXPANDED: bb.0:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr5_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr6_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr7_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr8_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr9_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr5_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr6_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr7_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr8_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr9_lo16
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9
  ; GFX908-EXPANDED-NEXT:   $vgpr9 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9
  ; GFX908-EXPANDED-NEXT:   $vgpr8 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr7 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr6 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr5 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr5, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr6, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr7, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr8, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr9, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9
  ; GFX908-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.1:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   S_NOP 1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.2:
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr9, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9
  ; GFX908-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr8, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr7, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr6, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr5, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr5 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr6 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr7 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr8 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr9 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9
  ; GFX90A-SPILLED-LABEL: name: spill_restore_agpr320
  ; GFX90A-SPILLED: bb.0:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9
  ; GFX90A-SPILLED-NEXT:   SI_SPILL_A320_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9, %stack.0, $sgpr32, 0, implicit $exec :: (store (s320) into %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.1:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 1
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.2:
  ; GFX90A-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9 = SI_SPILL_A320_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s320) from %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9
  ; GFX90A-EXPANDED-LABEL: name: spill_restore_agpr320
  ; GFX90A-EXPANDED: bb.0:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr5_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr6_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr7_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr8_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr9_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr5_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr6_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr7_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr8_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr9_lo16
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9
  ; GFX90A-EXPANDED-NEXT:   $vgpr9 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9
  ; GFX90A-EXPANDED-NEXT:   $vgpr8 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr7 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr6 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr5 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr5, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr6, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr7, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr8, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr9, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9
  ; GFX90A-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.1:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   S_NOP 1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.2:
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr9, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9
  ; GFX90A-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr8, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr7, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr6, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr5, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr5 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr6 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr7 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr8 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr9 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9
  bb.0:
    S_NOP 0, implicit-def %0:areg_320
    S_CBRANCH_SCC1 implicit undef $scc, %bb.1

  bb.1:
    S_NOP 1

  bb.2:
    S_NOP 0, implicit %0
...

---
name: spill_restore_agpr352
tracksRegLiveness: true
machineFunctionInfo:
  scratchRSrcReg: $sgpr0_sgpr1_sgpr2_sgpr3
  stackPtrOffsetReg: $sgpr32
body: |
  ; GFX908-SPILLED-LABEL: name: spill_restore_agpr352
  ; GFX908-SPILLED: bb.0:
  ; GFX908-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10
  ; GFX908-SPILLED-NEXT:   SI_SPILL_A352_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10, %stack.0, $sgpr32, 0, implicit $exec :: (store (s352) into %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.1:
  ; GFX908-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 1
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.2:
  ; GFX908-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10 = SI_SPILL_A352_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s352) from %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10
  ; GFX908-EXPANDED-LABEL: name: spill_restore_agpr352
  ; GFX908-EXPANDED: bb.0:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr5_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr6_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr7_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr8_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr9_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr10_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr5_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr6_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr7_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr8_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr9_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr10_lo16
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10
  ; GFX908-EXPANDED-NEXT:   $vgpr10 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10
  ; GFX908-EXPANDED-NEXT:   $vgpr9 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr8 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr7 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr6 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr5 = V_ACCVGPR_READ_B32_e64 killed $agpr5, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr6, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr7, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr8, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr9, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr10, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10
  ; GFX908-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.1:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   S_NOP 1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.2:
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr10, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10
  ; GFX908-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr9, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr8, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr7, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr6, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr5 = V_ACCVGPR_WRITE_B32_e64 $vgpr5, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr6 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr7 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr8 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr9 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr10 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10
  ; GFX90A-SPILLED-LABEL: name: spill_restore_agpr352
  ; GFX90A-SPILLED: bb.0:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10
  ; GFX90A-SPILLED-NEXT:   SI_SPILL_A352_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10, %stack.0, $sgpr32, 0, implicit $exec :: (store (s352) into %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.1:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 1
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.2:
  ; GFX90A-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10 = SI_SPILL_A352_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s352) from %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10
  ; GFX90A-EXPANDED-LABEL: name: spill_restore_agpr352
  ; GFX90A-EXPANDED: bb.0:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr5_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr6_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr7_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr8_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr9_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr10_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr5_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr6_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr7_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr8_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr9_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr10_lo16
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10
  ; GFX90A-EXPANDED-NEXT:   $vgpr10 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10
  ; GFX90A-EXPANDED-NEXT:   $vgpr9 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr8 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr7 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr6 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr5 = V_ACCVGPR_READ_B32_e64 killed $agpr5, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr6, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr7, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr8, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr9, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr10, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10
  ; GFX90A-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.1:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   S_NOP 1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.2:
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr10, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10
  ; GFX90A-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr9, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr8, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr7, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr6, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr5 = V_ACCVGPR_WRITE_B32_e64 $vgpr5, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr6 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr7 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr8 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr9 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr10 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10
  bb.0:
    S_NOP 0, implicit-def %0:areg_352
    S_CBRANCH_SCC1 implicit undef $scc, %bb.1

  bb.1:
    S_NOP 1

  bb.2:
    S_NOP 0, implicit %0
...

---
name: spill_restore_agpr384
tracksRegLiveness: true
machineFunctionInfo:
  scratchRSrcReg: $sgpr0_sgpr1_sgpr2_sgpr3
  stackPtrOffsetReg: $sgpr32
body: |
  ; GFX908-SPILLED-LABEL: name: spill_restore_agpr384
  ; GFX908-SPILLED: bb.0:
  ; GFX908-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11
  ; GFX908-SPILLED-NEXT:   SI_SPILL_A384_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11, %stack.0, $sgpr32, 0, implicit $exec :: (store (s384) into %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.1:
  ; GFX908-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 1
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.2:
  ; GFX908-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11 = SI_SPILL_A384_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s384) from %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11
  ; GFX908-EXPANDED-LABEL: name: spill_restore_agpr384
  ; GFX908-EXPANDED: bb.0:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr5_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr6_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr7_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr8_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr9_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr10_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr11_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr5_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr6_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr7_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr8_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr9_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr10_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr11_lo16
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11
  ; GFX908-EXPANDED-NEXT:   $vgpr11 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11
  ; GFX908-EXPANDED-NEXT:   $vgpr10 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr9 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr8 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr7 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr6 = V_ACCVGPR_READ_B32_e64 killed $agpr5, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr5 = V_ACCVGPR_READ_B32_e64 killed $agpr6, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr7, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr8, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr9, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr10, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr11, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11
  ; GFX908-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.1:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   S_NOP 1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.2:
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr11, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11
  ; GFX908-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr10, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr9, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr8, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr7, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr5 = V_ACCVGPR_WRITE_B32_e64 $vgpr6, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr6 = V_ACCVGPR_WRITE_B32_e64 $vgpr5, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr7 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr8 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr9 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr10 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr11 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11
  ; GFX90A-SPILLED-LABEL: name: spill_restore_agpr384
  ; GFX90A-SPILLED: bb.0:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11
  ; GFX90A-SPILLED-NEXT:   SI_SPILL_A384_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11, %stack.0, $sgpr32, 0, implicit $exec :: (store (s384) into %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.1:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 1
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.2:
  ; GFX90A-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11 = SI_SPILL_A384_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s384) from %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11
  ; GFX90A-EXPANDED-LABEL: name: spill_restore_agpr384
  ; GFX90A-EXPANDED: bb.0:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr5_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr6_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr7_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr8_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr9_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr10_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr11_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr5_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr6_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr7_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr8_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr9_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr10_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr11_lo16
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11
  ; GFX90A-EXPANDED-NEXT:   $vgpr11 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11
  ; GFX90A-EXPANDED-NEXT:   $vgpr10 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr9 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr8 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr7 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr6 = V_ACCVGPR_READ_B32_e64 killed $agpr5, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr5 = V_ACCVGPR_READ_B32_e64 killed $agpr6, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr7, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr8, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr9, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr10, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr11, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11
  ; GFX90A-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.1:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   S_NOP 1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.2:
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr11, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11
  ; GFX90A-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr10, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr9, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr8, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr7, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr5 = V_ACCVGPR_WRITE_B32_e64 $vgpr6, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr6 = V_ACCVGPR_WRITE_B32_e64 $vgpr5, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr7 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr8 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr9 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr10 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr11 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11
  bb.0:
    S_NOP 0, implicit-def %0:areg_384
    S_CBRANCH_SCC1 implicit undef $scc, %bb.1

  bb.1:
    S_NOP 1

  bb.2:
    S_NOP 0, implicit %0
...

---
name: spill_restore_agpr512
tracksRegLiveness: true
machineFunctionInfo:
  scratchRSrcReg: $sgpr0_sgpr1_sgpr2_sgpr3
  stackPtrOffsetReg: $sgpr32
body: |
  ; GFX908-SPILLED-LABEL: name: spill_restore_agpr512
  ; GFX908-SPILLED: bb.0:
  ; GFX908-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15
  ; GFX908-SPILLED-NEXT:   SI_SPILL_A512_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15, %stack.0, $sgpr32, 0, implicit $exec :: (store (s512) into %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.1:
  ; GFX908-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 1
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.2:
  ; GFX908-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15 = SI_SPILL_A512_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s512) from %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15
  ; GFX908-EXPANDED-LABEL: name: spill_restore_agpr512
  ; GFX908-EXPANDED: bb.0:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11, $vgpr12, $vgpr13, $vgpr14, $vgpr15
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr5_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr6_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr7_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr8_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr9_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr10_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr11_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr12_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr13_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr14_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr15_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr5_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr6_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr7_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr8_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr9_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr10_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr11_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr12_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr13_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr14_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr15_lo16
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15
  ; GFX908-EXPANDED-NEXT:   $vgpr15 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15
  ; GFX908-EXPANDED-NEXT:   $vgpr14 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr13 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr12 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr11 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr10 = V_ACCVGPR_READ_B32_e64 killed $agpr5, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr9 = V_ACCVGPR_READ_B32_e64 killed $agpr6, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr8 = V_ACCVGPR_READ_B32_e64 killed $agpr7, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr7 = V_ACCVGPR_READ_B32_e64 killed $agpr8, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr6 = V_ACCVGPR_READ_B32_e64 killed $agpr9, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr5 = V_ACCVGPR_READ_B32_e64 killed $agpr10, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr11, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr12, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr13, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr14, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr15, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15
  ; GFX908-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.1:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11, $vgpr12, $vgpr13, $vgpr14, $vgpr15
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   S_NOP 1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.2:
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11, $vgpr12, $vgpr13, $vgpr14, $vgpr15
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr15, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15
  ; GFX908-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr14, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr13, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr12, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr11, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr5 = V_ACCVGPR_WRITE_B32_e64 $vgpr10, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr6 = V_ACCVGPR_WRITE_B32_e64 $vgpr9, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr7 = V_ACCVGPR_WRITE_B32_e64 $vgpr8, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr8 = V_ACCVGPR_WRITE_B32_e64 $vgpr7, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr9 = V_ACCVGPR_WRITE_B32_e64 $vgpr6, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr10 = V_ACCVGPR_WRITE_B32_e64 $vgpr5, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr11 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr12 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr13 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr14 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr15 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15
  ; GFX90A-SPILLED-LABEL: name: spill_restore_agpr512
  ; GFX90A-SPILLED: bb.0:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15
  ; GFX90A-SPILLED-NEXT:   SI_SPILL_A512_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15, %stack.0, $sgpr32, 0, implicit $exec :: (store (s512) into %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.1:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 1
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.2:
  ; GFX90A-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15 = SI_SPILL_A512_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s512) from %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15
  ; GFX90A-EXPANDED-LABEL: name: spill_restore_agpr512
  ; GFX90A-EXPANDED: bb.0:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11, $vgpr12, $vgpr13, $vgpr14, $vgpr15
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr5_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr6_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr7_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr8_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr9_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr10_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr11_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr12_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr13_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr14_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr15_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr5_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr6_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr7_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr8_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr9_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr10_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr11_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr12_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr13_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr14_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr15_lo16
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15
  ; GFX90A-EXPANDED-NEXT:   $vgpr15 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15
  ; GFX90A-EXPANDED-NEXT:   $vgpr14 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr13 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr12 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr11 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr10 = V_ACCVGPR_READ_B32_e64 killed $agpr5, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr9 = V_ACCVGPR_READ_B32_e64 killed $agpr6, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr8 = V_ACCVGPR_READ_B32_e64 killed $agpr7, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr7 = V_ACCVGPR_READ_B32_e64 killed $agpr8, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr6 = V_ACCVGPR_READ_B32_e64 killed $agpr9, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr5 = V_ACCVGPR_READ_B32_e64 killed $agpr10, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr11, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr12, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr13, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr14, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr15, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15
  ; GFX90A-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.1:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11, $vgpr12, $vgpr13, $vgpr14, $vgpr15
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   S_NOP 1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.2:
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11, $vgpr12, $vgpr13, $vgpr14, $vgpr15
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr15, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15
  ; GFX90A-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr14, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr13, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr12, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr11, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr5 = V_ACCVGPR_WRITE_B32_e64 $vgpr10, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr6 = V_ACCVGPR_WRITE_B32_e64 $vgpr9, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr7 = V_ACCVGPR_WRITE_B32_e64 $vgpr8, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr8 = V_ACCVGPR_WRITE_B32_e64 $vgpr7, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr9 = V_ACCVGPR_WRITE_B32_e64 $vgpr6, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr10 = V_ACCVGPR_WRITE_B32_e64 $vgpr5, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr11 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr12 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr13 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr14 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr15 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15
  bb.0:
    S_NOP 0, implicit-def %0:areg_512
    S_CBRANCH_SCC1 implicit undef $scc, %bb.1

  bb.1:
    S_NOP 1

  bb.2:
    S_NOP 0, implicit %0
...

---
name: spill_restore_agpr1024
tracksRegLiveness: true
machineFunctionInfo:
  scratchRSrcReg: $sgpr0_sgpr1_sgpr2_sgpr3
  stackPtrOffsetReg: $sgpr32
body: |
  ; GFX908-SPILLED-LABEL: name: spill_restore_agpr1024
  ; GFX908-SPILLED: bb.0:
  ; GFX908-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31
  ; GFX908-SPILLED-NEXT:   SI_SPILL_A1024_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31, %stack.0, $sgpr32, 0, implicit $exec :: (store (s1024) into %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.1:
  ; GFX908-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT:   S_NOP 1
  ; GFX908-SPILLED-NEXT: {{  $}}
  ; GFX908-SPILLED-NEXT: bb.2:
  ; GFX908-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31 = SI_SPILL_A1024_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s1024) from %stack.0, align 4, addrspace 5)
  ; GFX908-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31
  ; GFX908-EXPANDED-LABEL: name: spill_restore_agpr1024
  ; GFX908-EXPANDED: bb.0:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11, $vgpr12, $vgpr13, $vgpr14, $vgpr15, $vgpr16, $vgpr17, $vgpr18, $vgpr19, $vgpr20, $vgpr21, $vgpr22, $vgpr23, $vgpr24, $vgpr25, $vgpr26, $vgpr27, $vgpr28, $vgpr29, $vgpr30, $vgpr31
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr5_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr6_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr7_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr8_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr9_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr10_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr11_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr12_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr13_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr14_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr15_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr16_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr17_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr18_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr19_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr20_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr21_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr22_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr23_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr24_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr25_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr26_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr27_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr28_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr29_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr30_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr31_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr5_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr6_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr7_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr8_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr9_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr10_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr11_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr12_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr13_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr14_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr15_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr16_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr17_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr18_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr19_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr20_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr21_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr22_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr23_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr24_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr25_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr26_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr27_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr28_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr29_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr30_lo16
  ; GFX908-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr31_lo16
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31
  ; GFX908-EXPANDED-NEXT:   $vgpr31 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31
  ; GFX908-EXPANDED-NEXT:   $vgpr30 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr29 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr28 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr27 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr26 = V_ACCVGPR_READ_B32_e64 killed $agpr5, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr25 = V_ACCVGPR_READ_B32_e64 killed $agpr6, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr24 = V_ACCVGPR_READ_B32_e64 killed $agpr7, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr23 = V_ACCVGPR_READ_B32_e64 killed $agpr8, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr22 = V_ACCVGPR_READ_B32_e64 killed $agpr9, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr21 = V_ACCVGPR_READ_B32_e64 killed $agpr10, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr20 = V_ACCVGPR_READ_B32_e64 killed $agpr11, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr19 = V_ACCVGPR_READ_B32_e64 killed $agpr12, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr18 = V_ACCVGPR_READ_B32_e64 killed $agpr13, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr17 = V_ACCVGPR_READ_B32_e64 killed $agpr14, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr16 = V_ACCVGPR_READ_B32_e64 killed $agpr15, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr15 = V_ACCVGPR_READ_B32_e64 killed $agpr16, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr14 = V_ACCVGPR_READ_B32_e64 killed $agpr17, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr13 = V_ACCVGPR_READ_B32_e64 killed $agpr18, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr12 = V_ACCVGPR_READ_B32_e64 killed $agpr19, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr11 = V_ACCVGPR_READ_B32_e64 killed $agpr20, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr10 = V_ACCVGPR_READ_B32_e64 killed $agpr21, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr9 = V_ACCVGPR_READ_B32_e64 killed $agpr22, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr8 = V_ACCVGPR_READ_B32_e64 killed $agpr23, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr7 = V_ACCVGPR_READ_B32_e64 killed $agpr24, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr6 = V_ACCVGPR_READ_B32_e64 killed $agpr25, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr5 = V_ACCVGPR_READ_B32_e64 killed $agpr26, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr27, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr28, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr29, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr30, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr31, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31
  ; GFX908-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.1:
  ; GFX908-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11, $vgpr12, $vgpr13, $vgpr14, $vgpr15, $vgpr16, $vgpr17, $vgpr18, $vgpr19, $vgpr20, $vgpr21, $vgpr22, $vgpr23, $vgpr24, $vgpr25, $vgpr26, $vgpr27, $vgpr28, $vgpr29, $vgpr30, $vgpr31
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   S_NOP 1
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT: bb.2:
  ; GFX908-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11, $vgpr12, $vgpr13, $vgpr14, $vgpr15, $vgpr16, $vgpr17, $vgpr18, $vgpr19, $vgpr20, $vgpr21, $vgpr22, $vgpr23, $vgpr24, $vgpr25, $vgpr26, $vgpr27, $vgpr28, $vgpr29, $vgpr30, $vgpr31
  ; GFX908-EXPANDED-NEXT: {{  $}}
  ; GFX908-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr31, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31
  ; GFX908-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr30, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr29, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr28, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr27, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr5 = V_ACCVGPR_WRITE_B32_e64 $vgpr26, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr6 = V_ACCVGPR_WRITE_B32_e64 $vgpr25, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr7 = V_ACCVGPR_WRITE_B32_e64 $vgpr24, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr8 = V_ACCVGPR_WRITE_B32_e64 $vgpr23, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr9 = V_ACCVGPR_WRITE_B32_e64 $vgpr22, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr10 = V_ACCVGPR_WRITE_B32_e64 $vgpr21, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr11 = V_ACCVGPR_WRITE_B32_e64 $vgpr20, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr12 = V_ACCVGPR_WRITE_B32_e64 $vgpr19, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr13 = V_ACCVGPR_WRITE_B32_e64 $vgpr18, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr14 = V_ACCVGPR_WRITE_B32_e64 $vgpr17, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr15 = V_ACCVGPR_WRITE_B32_e64 $vgpr16, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr16 = V_ACCVGPR_WRITE_B32_e64 $vgpr15, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr17 = V_ACCVGPR_WRITE_B32_e64 $vgpr14, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr18 = V_ACCVGPR_WRITE_B32_e64 $vgpr13, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr19 = V_ACCVGPR_WRITE_B32_e64 $vgpr12, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr20 = V_ACCVGPR_WRITE_B32_e64 $vgpr11, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr21 = V_ACCVGPR_WRITE_B32_e64 $vgpr10, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr22 = V_ACCVGPR_WRITE_B32_e64 $vgpr9, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr23 = V_ACCVGPR_WRITE_B32_e64 $vgpr8, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr24 = V_ACCVGPR_WRITE_B32_e64 $vgpr7, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr25 = V_ACCVGPR_WRITE_B32_e64 $vgpr6, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr26 = V_ACCVGPR_WRITE_B32_e64 $vgpr5, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr27 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr28 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr29 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr30 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX908-EXPANDED-NEXT:   $agpr31 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31
  ; GFX908-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31
  ; GFX90A-SPILLED-LABEL: name: spill_restore_agpr1024
  ; GFX90A-SPILLED: bb.0:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31
  ; GFX90A-SPILLED-NEXT:   SI_SPILL_A1024_SAVE killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31, %stack.0, $sgpr32, 0, implicit $exec :: (store (s1024) into %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.1:
  ; GFX90A-SPILLED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT:   S_NOP 1
  ; GFX90A-SPILLED-NEXT: {{  $}}
  ; GFX90A-SPILLED-NEXT: bb.2:
  ; GFX90A-SPILLED-NEXT:   $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31 = SI_SPILL_A1024_RESTORE %stack.0, $sgpr32, 0, implicit $exec :: (load (s1024) from %stack.0, align 4, addrspace 5)
  ; GFX90A-SPILLED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31
  ; GFX90A-EXPANDED-LABEL: name: spill_restore_agpr1024
  ; GFX90A-EXPANDED: bb.0:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.1(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11, $vgpr12, $vgpr13, $vgpr14, $vgpr15, $vgpr16, $vgpr17, $vgpr18, $vgpr19, $vgpr20, $vgpr21, $vgpr22, $vgpr23, $vgpr24, $vgpr25, $vgpr26, $vgpr27, $vgpr28, $vgpr29, $vgpr30, $vgpr31
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION llvm_def_aspace_cfa $sgpr32_lo16, 0, 6
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION escape 0x10, 0x10, 0x08, 0x90, 0x3e, 0x93, 0x04, 0x90, 0x3f, 0x93, 0x04
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr5_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr6_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr7_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr8_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr9_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr10_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr11_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr12_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr13_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr14_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr15_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr16_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr17_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr18_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr19_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr20_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr21_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr22_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr23_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr24_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr25_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr26_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr27_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr28_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr29_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr30_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $vgpr31_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr0_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr1_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr2_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr3_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr4_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr5_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr6_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr7_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr8_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr9_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr10_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr11_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr12_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr13_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr14_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr15_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr16_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr17_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr18_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr19_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr20_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr21_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr22_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr23_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr24_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr25_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr26_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr27_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr28_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr29_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr30_lo16
  ; GFX90A-EXPANDED-NEXT:   frame-setup CFI_INSTRUCTION undefined $agpr31_lo16
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit-def renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31
  ; GFX90A-EXPANDED-NEXT:   $vgpr31 = V_ACCVGPR_READ_B32_e64 killed $agpr0, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31
  ; GFX90A-EXPANDED-NEXT:   $vgpr30 = V_ACCVGPR_READ_B32_e64 killed $agpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr29 = V_ACCVGPR_READ_B32_e64 killed $agpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr28 = V_ACCVGPR_READ_B32_e64 killed $agpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr27 = V_ACCVGPR_READ_B32_e64 killed $agpr4, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr26 = V_ACCVGPR_READ_B32_e64 killed $agpr5, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr25 = V_ACCVGPR_READ_B32_e64 killed $agpr6, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr24 = V_ACCVGPR_READ_B32_e64 killed $agpr7, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr23 = V_ACCVGPR_READ_B32_e64 killed $agpr8, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr22 = V_ACCVGPR_READ_B32_e64 killed $agpr9, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr21 = V_ACCVGPR_READ_B32_e64 killed $agpr10, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr20 = V_ACCVGPR_READ_B32_e64 killed $agpr11, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr19 = V_ACCVGPR_READ_B32_e64 killed $agpr12, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr18 = V_ACCVGPR_READ_B32_e64 killed $agpr13, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr17 = V_ACCVGPR_READ_B32_e64 killed $agpr14, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr16 = V_ACCVGPR_READ_B32_e64 killed $agpr15, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr15 = V_ACCVGPR_READ_B32_e64 killed $agpr16, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr14 = V_ACCVGPR_READ_B32_e64 killed $agpr17, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr13 = V_ACCVGPR_READ_B32_e64 killed $agpr18, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr12 = V_ACCVGPR_READ_B32_e64 killed $agpr19, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr11 = V_ACCVGPR_READ_B32_e64 killed $agpr20, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr10 = V_ACCVGPR_READ_B32_e64 killed $agpr21, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr9 = V_ACCVGPR_READ_B32_e64 killed $agpr22, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr8 = V_ACCVGPR_READ_B32_e64 killed $agpr23, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr7 = V_ACCVGPR_READ_B32_e64 killed $agpr24, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr6 = V_ACCVGPR_READ_B32_e64 killed $agpr25, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr5 = V_ACCVGPR_READ_B32_e64 killed $agpr26, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr4 = V_ACCVGPR_READ_B32_e64 killed $agpr27, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr3 = V_ACCVGPR_READ_B32_e64 killed $agpr28, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr2 = V_ACCVGPR_READ_B32_e64 killed $agpr29, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr1 = V_ACCVGPR_READ_B32_e64 killed $agpr30, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $vgpr0 = V_ACCVGPR_READ_B32_e64 killed $agpr31, implicit $exec, implicit killed $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31
  ; GFX90A-EXPANDED-NEXT:   S_CBRANCH_SCC1 %bb.1, implicit undef $scc
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.1:
  ; GFX90A-EXPANDED-NEXT:   successors: %bb.2(0x80000000)
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11, $vgpr12, $vgpr13, $vgpr14, $vgpr15, $vgpr16, $vgpr17, $vgpr18, $vgpr19, $vgpr20, $vgpr21, $vgpr22, $vgpr23, $vgpr24, $vgpr25, $vgpr26, $vgpr27, $vgpr28, $vgpr29, $vgpr30, $vgpr31
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   S_NOP 1
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT: bb.2:
  ; GFX90A-EXPANDED-NEXT:   liveins: $vgpr0, $vgpr1, $vgpr2, $vgpr3, $vgpr4, $vgpr5, $vgpr6, $vgpr7, $vgpr8, $vgpr9, $vgpr10, $vgpr11, $vgpr12, $vgpr13, $vgpr14, $vgpr15, $vgpr16, $vgpr17, $vgpr18, $vgpr19, $vgpr20, $vgpr21, $vgpr22, $vgpr23, $vgpr24, $vgpr25, $vgpr26, $vgpr27, $vgpr28, $vgpr29, $vgpr30, $vgpr31
  ; GFX90A-EXPANDED-NEXT: {{  $}}
  ; GFX90A-EXPANDED-NEXT:   $agpr0 = V_ACCVGPR_WRITE_B32_e64 $vgpr31, implicit $exec, implicit-def $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31
  ; GFX90A-EXPANDED-NEXT:   $agpr1 = V_ACCVGPR_WRITE_B32_e64 $vgpr30, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr2 = V_ACCVGPR_WRITE_B32_e64 $vgpr29, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr3 = V_ACCVGPR_WRITE_B32_e64 $vgpr28, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr4 = V_ACCVGPR_WRITE_B32_e64 $vgpr27, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr5 = V_ACCVGPR_WRITE_B32_e64 $vgpr26, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr6 = V_ACCVGPR_WRITE_B32_e64 $vgpr25, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr7 = V_ACCVGPR_WRITE_B32_e64 $vgpr24, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr8 = V_ACCVGPR_WRITE_B32_e64 $vgpr23, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr9 = V_ACCVGPR_WRITE_B32_e64 $vgpr22, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr10 = V_ACCVGPR_WRITE_B32_e64 $vgpr21, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr11 = V_ACCVGPR_WRITE_B32_e64 $vgpr20, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr12 = V_ACCVGPR_WRITE_B32_e64 $vgpr19, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr13 = V_ACCVGPR_WRITE_B32_e64 $vgpr18, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr14 = V_ACCVGPR_WRITE_B32_e64 $vgpr17, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr15 = V_ACCVGPR_WRITE_B32_e64 $vgpr16, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr16 = V_ACCVGPR_WRITE_B32_e64 $vgpr15, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr17 = V_ACCVGPR_WRITE_B32_e64 $vgpr14, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr18 = V_ACCVGPR_WRITE_B32_e64 $vgpr13, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr19 = V_ACCVGPR_WRITE_B32_e64 $vgpr12, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr20 = V_ACCVGPR_WRITE_B32_e64 $vgpr11, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr21 = V_ACCVGPR_WRITE_B32_e64 $vgpr10, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr22 = V_ACCVGPR_WRITE_B32_e64 $vgpr9, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr23 = V_ACCVGPR_WRITE_B32_e64 $vgpr8, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr24 = V_ACCVGPR_WRITE_B32_e64 $vgpr7, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr25 = V_ACCVGPR_WRITE_B32_e64 $vgpr6, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr26 = V_ACCVGPR_WRITE_B32_e64 $vgpr5, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr27 = V_ACCVGPR_WRITE_B32_e64 $vgpr4, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr28 = V_ACCVGPR_WRITE_B32_e64 $vgpr3, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr29 = V_ACCVGPR_WRITE_B32_e64 $vgpr2, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr30 = V_ACCVGPR_WRITE_B32_e64 $vgpr1, implicit $exec
  ; GFX90A-EXPANDED-NEXT:   $agpr31 = V_ACCVGPR_WRITE_B32_e64 $vgpr0, implicit $exec, implicit $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31
  ; GFX90A-EXPANDED-NEXT:   S_NOP 0, implicit killed renamable $agpr0_agpr1_agpr2_agpr3_agpr4_agpr5_agpr6_agpr7_agpr8_agpr9_agpr10_agpr11_agpr12_agpr13_agpr14_agpr15_agpr16_agpr17_agpr18_agpr19_agpr20_agpr21_agpr22_agpr23_agpr24_agpr25_agpr26_agpr27_agpr28_agpr29_agpr30_agpr31
  bb.0:
    S_NOP 0, implicit-def %0:areg_1024
    S_CBRANCH_SCC1 implicit undef $scc, %bb.1

  bb.1:
    S_NOP 1

  bb.2:
    S_NOP 0, implicit %0
...
