; NOTE: Assertions have been autogenerated by utils/update_test_checks.py UTC_ARGS: --version 5
; RUN: opt -S -mtriple=amdgcn-unknown-amdhsa -passes=amdgpu-promote-alloca < %s | FileCheck %s

; Verify that we do not crash and not promote non-byte alloca types.
define <8 x i1> @non_byte_alloca_type() {
; CHECK-LABEL: define <8 x i1> @non_byte_alloca_type() {
; CHECK-NEXT:  [[ENTRY:.*:]]
; CHECK-NEXT:    [[C:%.*]] = icmp ugt <16 x i1> zeroinitializer, zeroinitializer
; CHECK-NEXT:    [[RP:%.*]] = alloca <8 x i1>, align 1
; CHECK-NEXT:    [[TMP0:%.*]] = load <8 x i1>, ptr [[RP]], align 1
; CHECK-NEXT:    store <16 x i1> [[C]], ptr [[RP]], align 2
; CHECK-NEXT:    ret <8 x i1> [[TMP0]]
;
entry:
  %C = icmp ugt <16 x i1> zeroinitializer, zeroinitializer
  %RP = alloca <8 x i1>, align 1
  %0 = load <8 x i1>, ptr %RP, align 1
  store <16 x i1> %C, ptr %RP, align 2
  ret <8 x i1> %0
}

