# RUN: llc -mtriple=amdgcn -run-pass=instruction-select -verify-machineinstrs -global-isel %s -o - | FileCheck %s
# RUN: not llc -mtriple=amdgcn -mcpu=gfx1100 -run-pass=instruction-select -verify-machineinstrs -global-isel -global-isel-abort=0 %s -o - 2>&1 | FileCheck --check-prefix=ERR %s

# ERR: error: <unknown>:0:0: in function exp0 void (): intrinsic not supported on subtarget

---
name: exp0
legalized:       true
regBankSelected: true

# CHECK: name: exp0
body: |
  bb.0:
    liveins: $vgpr0
    ; CHECK: [[UNDEF0:%[0-9]+]]:vgpr_32 = IMPLICIT_DEF
    ; CHECK: [[UNDEF1:%[0-9]+]]:vgpr_32 = IMPLICIT_DEF
    ; CHECK: EXP 1, %0, %0, [[UNDEF1]], [[UNDEF0]], 0, 1, 15, implicit $exec
    %0:vgpr(i32) = COPY $vgpr0
    %1:vgpr(<2 x i16>) = G_BITCAST %0(i32)
    G_INTRINSIC_W_SIDE_EFFECTS intrinsic(@llvm.amdgcn.exp.compr), 1, 15, %1(<2 x i16>), %1(<2 x i16>), 0, 0
    G_INTRINSIC_W_SIDE_EFFECTS intrinsic(@llvm.amdgcn.exp.compr), 1, 15, %1(<2 x i16>), %1(<2 x i16>), -1, 0
...
