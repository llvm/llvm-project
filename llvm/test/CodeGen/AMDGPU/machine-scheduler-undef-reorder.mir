# NOTE: Assertions have been autogenerated by utils/update_mir_test_checks.py
# RUN: llc -mtriple=amdgcn -mcpu=gfx900 -run-pass=machine-scheduler -verify-machineinstrs %s -o - | FileCheck -check-prefix=GFX900 %s

---
name:            test_undef_reorder
tracksRegLiveness: true
machineFunctionInfo:
  isEntryFunction: true
body:             |
  bb.0:
    liveins: $vgpr2
    ; GFX900-LABEL: name: test_undef_reorder
    ; GFX900: liveins: $vgpr2
    ; GFX900-NEXT: {{  $}}
    ; GFX900-NEXT: $vgpr5 = COPY $vgpr2
    ; GFX900-NEXT: undef [[COPY:%[0-9]+]].sub0:vreg_64 = COPY $vgpr5
    ; GFX900-NEXT: $vgpr4 = COPY $vgpr2
    ; GFX900-NEXT: [[COPY:%[0-9]+]].sub1:vreg_64 = COPY $vgpr4
    ; GFX900-NEXT: dead [[COPY1:%[0-9]+]]:vreg_64 = COPY [[COPY]]
    ; GFX900-NEXT: S_ENDPGM 0
    $vgpr5 = COPY $vgpr2
    $vgpr4 = COPY $vgpr2
    undef %18.sub1:vreg_64 = COPY killed $vgpr4
    %18.sub0:vreg_64 = COPY killed $vgpr5
    %19: vreg_64 = COPY %18
    S_ENDPGM 0
...
