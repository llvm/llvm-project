; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --version 3
; RUN: llc -global-isel=0 -march=amdgcn -mcpu=gfx1210 -verify-machineinstrs < %s | FileCheck -check-prefix=GCN %s
; RUN: llc -global-isel=1 -march=amdgcn -mcpu=gfx1210 -verify-machineinstrs < %s | FileCheck -check-prefix=GCN %s

define amdgpu_ps float @add_max_u32_vvv(i32 %a, i32 %b, i32 %c) {
; GCN-LABEL: add_max_u32_vvv:
; GCN:       ; %bb.0:
; GCN-NEXT:    v_add_max_u32_e64 v0, v0, v1, v2
; GCN-NEXT:    ; return to shader part epilog
  %add = add i32 %a, %b
  %max = call i32 @llvm.umax.i32(i32 %add, i32 %c)
  %ret = bitcast i32 %max to float
  ret float %ret
}

define amdgpu_ps float @add_max_u32_svv(i32 inreg %a, i32 %b, i32 %c) {
; GCN-LABEL: add_max_u32_svv:
; GCN:       ; %bb.0:
; GCN-NEXT:    v_add_max_u32_e64 v0, s0, v0, v1
; GCN-NEXT:    ; return to shader part epilog
  %add = add i32 %a, %b
  %max = call i32 @llvm.umax.i32(i32 %add, i32 %c)
  %ret = bitcast i32 %max to float
  ret float %ret
}

define amdgpu_ps float @add_max_u32_ssv(i32 inreg %a, i32 inreg %b, i32 %c) {
  %add = add i32 %a, %b
  %max = call i32 @llvm.umax.i32(i32 %add, i32 %c)
  %ret = bitcast i32 %max to float
  ret float %ret
}

define amdgpu_ps float @add_max_u32_sss(i32 inreg %a, i32 inreg %b, i32 inreg %c) {
; GCN-LABEL: add_max_u32_sss:
; GCN:       ; %bb.0:
; GCN-NEXT:    s_add_co_i32 s0, s0, s1
; GCN-NEXT:    s_delay_alu instid0(SALU_CYCLE_1) | instskip(NEXT) | instid1(SALU_CYCLE_1)
; GCN-NEXT:    s_max_u32 s0, s0, s2
; GCN-NEXT:    v_mov_b32_e32 v0, s0
; GCN-NEXT:    ; return to shader part epilog
  %add = add i32 %a, %b
  %max = call i32 @llvm.umax.i32(i32 %add, i32 %c)
  %ret = bitcast i32 %max to float
  ret float %ret
}

define amdgpu_ps float @add_max_u32_vsi(i32 %a, i32 inreg %b) {
; GCN-LABEL: add_max_u32_vsi:
; GCN:       ; %bb.0:
; GCN-NEXT:    v_add_max_u32_e64 v0, v0, s0, 4
; GCN-NEXT:    ; return to shader part epilog
  %add = add i32 %a, %b
  %max = call i32 @llvm.umax.i32(i32 %add, i32 4)
  %ret = bitcast i32 %max to float
  ret float %ret
}

define amdgpu_ps float @add_max_u32_svl(i32 inreg %a, i32 %b) {
; GCN-LABEL: add_max_u32_svl:
; GCN:       ; %bb.0:
; GCN-NEXT:    v_add_max_u32_e64 v0, s0, v0, 0x64
; GCN-NEXT:    ; return to shader part epilog
  %add = add i32 %a, %b
  %max = call i32 @llvm.umax.i32(i32 %add, i32 100)
  %ret = bitcast i32 %max to float
  ret float %ret
}

define amdgpu_ps float @add_max_u32_slv(i32 inreg %a, i32 %b) {
  %add = add i32 %a, 100
  %max = call i32 @llvm.umax.i32(i32 %add, i32 %b)
  %ret = bitcast i32 %max to float
  ret float %ret
}

define amdgpu_ps float @add_max_i32_vvv(i32 %a, i32 %b, i32 %c) {
; GCN-LABEL: add_max_i32_vvv:
; GCN:       ; %bb.0:
; GCN-NEXT:    v_add_max_i32_e64 v0, v0, v1, v2
; GCN-NEXT:    ; return to shader part epilog
  %add = add i32 %a, %b
  %max = call i32 @llvm.smax.i32(i32 %add, i32 %c)
  %ret = bitcast i32 %max to float
  ret float %ret
}

define amdgpu_ps float @add_min_u32_vvv(i32 %a, i32 %b, i32 %c) {
; GCN-LABEL: add_min_u32_vvv:
; GCN:       ; %bb.0:
; GCN-NEXT:    v_add_min_u32_e64 v0, v0, v1, v2
; GCN-NEXT:    ; return to shader part epilog
  %add = add i32 %a, %b
  %max = call i32 @llvm.umin.i32(i32 %add, i32 %c)
  %ret = bitcast i32 %max to float
  ret float %ret
}

define amdgpu_ps float @add_min_i32_vvv(i32 %a, i32 %b, i32 %c) {
; GCN-LABEL: add_min_i32_vvv:
; GCN:       ; %bb.0:
; GCN-NEXT:    v_add_min_i32_e64 v0, v0, v1, v2
; GCN-NEXT:    ; return to shader part epilog
  %add = add i32 %a, %b
  %max = call i32 @llvm.smin.i32(i32 %add, i32 %c)
  %ret = bitcast i32 %max to float
  ret float %ret
}

declare i32 @llvm.smin.i32(i32, i32)
declare i32 @llvm.smax.i32(i32, i32)
declare i32 @llvm.umin.i32(i32, i32)
declare i32 @llvm.umax.i32(i32, i32)
