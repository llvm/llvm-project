# NOTE: Assertions have been autogenerated by utils/update_mir_test_checks.py UTC_ARGS: --version 5
# RUN: llc -mtriple=amdgcn -mcpu=gfx1010 -run-pass=machine-cse %s -o - | FileCheck %s

# Check only that V_CMP_EQ_U32_e32 does not lead to a crash.

---
name: depends_on_exec_check_can_handle_vopc
tracksRegLiveness: true
body:             |
  bb.0:
    ; CHECK-LABEL: name: depends_on_exec_check_can_handle_vopc
    ; CHECK: [[DEF:%[0-9]+]]:vgpr_32 = IMPLICIT_DEF
    ; CHECK-NEXT: V_CMP_EQ_U32_e32 1, killed undef [[DEF]], implicit-def $vcc_lo, implicit $exec
    ; CHECK-NEXT: [[V_CNDMASK_B32_e32_:%[0-9]+]]:vgpr_32 = V_CNDMASK_B32_e32 16256, undef [[DEF]], implicit $vcc_lo, implicit $exec
    ; CHECK-NEXT: [[V_LSHLREV_B32_e64_:%[0-9]+]]:vgpr_32 = V_LSHLREV_B32_e64 16, undef [[V_CNDMASK_B32_e32_]], implicit $exec
    ; CHECK-NEXT: SI_RETURN
    %0:vgpr_32 = IMPLICIT_DEF
    V_CMP_EQ_U32_e32 1, killed undef %0, implicit-def $vcc, implicit $exec
    %1:vgpr_32 = V_CNDMASK_B32_e32 16256, undef %0, implicit $vcc, implicit $exec
    V_CMP_EQ_U32_e32 1, killed undef %0, implicit-def $vcc, implicit $exec
    %2:vgpr_32 = V_CNDMASK_B32_e32 16256, undef %0, implicit $vcc, implicit $exec
    %3:vgpr_32 = V_LSHLREV_B32_e64 16, killed undef %2, implicit $exec
    %4:vgpr_32 = V_LSHLREV_B32_e64 16, killed undef %1, implicit $exec
    SI_RETURN
...
