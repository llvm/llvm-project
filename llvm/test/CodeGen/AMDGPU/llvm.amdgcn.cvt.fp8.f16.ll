; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --version 4
; RUN: llc -global-isel=0 -mtriple=amdgcn -mcpu=gfx1210 -verify-machineinstrs < %s | FileCheck -check-prefix=GFX1210 %s
; RUN: llc -global-isel=1 -mtriple=amdgcn -mcpu=gfx1210 -verify-machineinstrs < %s | FileCheck -check-prefix=GFX1210 %s

declare i16 @llvm.amdgcn.cvt.pk.bf8.f16(half, half)
declare i16 @llvm.amdgcn.cvt.pk.fp8.f16(half, half)

define amdgpu_ps void @test_cvt_pk_bf8_f16_vv(half %a, half %b, ptr addrspace(1) %out) {
; GFX1210-LABEL: test_cvt_pk_bf8_f16_vv:
; GFX1210:       ; %bb.0:
; GFX1210-NEXT:    v_cvt_pk_bf8_f16 v0, v0, v1
; GFX1210-NEXT:    global_store_b16 v[2:3], v0, off
; GFX1210-NEXT:    s_sendmsg sendmsg(MSG_DEALLOC_VGPRS)
; GFX1210-NEXT:    s_endpgm
  %cvt = tail call i16 @llvm.amdgcn.cvt.pk.bf8.f16(half %a, half %b)
  store i16 %cvt, ptr addrspace(1) %out
  ret void
}

define amdgpu_ps void @test_cvt_pk_bf8_f16_ss(half inreg %a, half inreg %b, ptr addrspace(1) %out) {
; GFX1210-LABEL: test_cvt_pk_bf8_f16_ss:
; GFX1210:       ; %bb.0:
; GFX1210-NEXT:    v_cvt_pk_bf8_f16 v2, s0, s1
; GFX1210-NEXT:    global_store_b16 v[0:1], v2, off
; GFX1210-NEXT:    s_sendmsg sendmsg(MSG_DEALLOC_VGPRS)
; GFX1210-NEXT:    s_endpgm
  %cvt = tail call i16 @llvm.amdgcn.cvt.pk.bf8.f16(half %a, half %b)
  store i16 %cvt, ptr addrspace(1) %out
  ret void
}

define amdgpu_ps void @test_cvt_pk_bf8_f16_sl(half inreg %a, ptr addrspace(1) %out) {
; GFX1210-LABEL: test_cvt_pk_bf8_f16_sl:
; GFX1210:       ; %bb.0:
; GFX1210-NEXT:    v_cvt_pk_bf8_f16 v2, s0, 0x5640
; GFX1210-NEXT:    global_store_b16 v[0:1], v2, off
; GFX1210-NEXT:    s_sendmsg sendmsg(MSG_DEALLOC_VGPRS)
; GFX1210-NEXT:    s_endpgm
  %cvt = tail call i16 @llvm.amdgcn.cvt.pk.bf8.f16(half %a, half 100.0)
  store i16 %cvt, ptr addrspace(1) %out
  ret void
}

define amdgpu_ps void @test_cvt_pk_fp8_f16_vv(half %a, half %b, ptr addrspace(1) %out) {
; GFX1210-LABEL: test_cvt_pk_fp8_f16_vv:
; GFX1210:       ; %bb.0:
; GFX1210-NEXT:    v_cvt_pk_fp8_f16 v0, v0, v1
; GFX1210-NEXT:    global_store_b16 v[2:3], v0, off
; GFX1210-NEXT:    s_sendmsg sendmsg(MSG_DEALLOC_VGPRS)
; GFX1210-NEXT:    s_endpgm
  %cvt = tail call i16 @llvm.amdgcn.cvt.pk.fp8.f16(half %a, half %b)
  store i16 %cvt, ptr addrspace(1) %out
  ret void
}

define amdgpu_ps void @test_cvt_pk_fp8_f16_ss(half inreg %a, half inreg %b, ptr addrspace(1) %out) {
; GFX1210-LABEL: test_cvt_pk_fp8_f16_ss:
; GFX1210:       ; %bb.0:
; GFX1210-NEXT:    v_cvt_pk_fp8_f16 v2, s0, s1
; GFX1210-NEXT:    global_store_b16 v[0:1], v2, off
; GFX1210-NEXT:    s_sendmsg sendmsg(MSG_DEALLOC_VGPRS)
; GFX1210-NEXT:    s_endpgm
  %cvt = tail call i16 @llvm.amdgcn.cvt.pk.fp8.f16(half %a, half %b)
  store i16 %cvt, ptr addrspace(1) %out
  ret void
}

define amdgpu_ps void @test_cvt_pk_fp8_f16_sl(half inreg %a, ptr addrspace(1) %out) {
; GFX1210-LABEL: test_cvt_pk_fp8_f16_sl:
; GFX1210:       ; %bb.0:
; GFX1210-NEXT:    v_cvt_pk_fp8_f16 v2, s0, 0x5640
; GFX1210-NEXT:    global_store_b16 v[0:1], v2, off
; GFX1210-NEXT:    s_sendmsg sendmsg(MSG_DEALLOC_VGPRS)
; GFX1210-NEXT:    s_endpgm
  %cvt = tail call i16 @llvm.amdgcn.cvt.pk.fp8.f16(half %a, half 100.0)
  store i16 %cvt, ptr addrspace(1) %out
  ret void
}
