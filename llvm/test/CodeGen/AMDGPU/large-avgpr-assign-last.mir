# NOTE: Assertions have been autogenerated by utils/update_mir_test_checks.py UTC_ARGS: --version 5

# RUN: llc -mtriple=amdgcn-amd-amdhsa -mcpu=gfx950 -verify-regalloc -amdgpu-mfma-vgpr-form=1 --greedy-regclass-priority-trumps-globalness=1  -start-after=machine-scheduler -stop-after=virtregrewriter,2 -o - %s | FileCheck %s

--- |
  define void @av_allocation_order() #0 {
  entry:
    unreachable
  }

  attributes #0 = {"amdgpu-waves-per-eu"="8,8"}
...


---
name:            av_allocation_order
tracksRegLiveness: true
machineFunctionInfo:
  isEntryFunction: true
  scratchRSrcReg:  '$sgpr96_sgpr97_sgpr98_sgpr99'
  stackPtrOffsetReg: '$sgpr32'
  argumentInfo:
    privateSegmentBuffer: { reg: '$sgpr0_sgpr1_sgpr2_sgpr3' }
    kernargSegmentPtr: { reg: '$sgpr4_sgpr5' }
    workGroupIDX:    { reg: '$sgpr6' }
    privateSegmentWaveByteOffset: { reg: '$sgpr7' }
    workItemIDX:     { reg: '$vgpr0' }
  sgprForEXECCopy: '$sgpr100_sgpr101'
body:             |
  bb.0:
   liveins: $vgpr0, $sgpr4_sgpr5
    ; CHECK-LABEL: name: av_allocation_order
    ; CHECK: liveins: $vgpr0, $sgpr4_sgpr5
    ; CHECK-NEXT: {{  $}}
    ; CHECK-NEXT: renamable $vgpr51 = IMPLICIT_DEF
    ; CHECK-NEXT: dead renamable $vgpr0 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr52 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr14 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr15 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr16 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr17 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr18 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr19 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr20 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr21 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr22 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr23 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr24 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr25 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr26 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr27 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr28 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr29 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr30 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr31 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr32 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr33 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr34 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr0_vgpr1 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr2_vgpr3 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr4_vgpr5 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr6_vgpr7 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr8_vgpr9 = IMPLICIT_DEF
    ; CHECK-NEXT: renamable $vgpr10_vgpr11 = IMPLICIT_DEF
    ; CHECK-NEXT: KILL killed renamable $vgpr14, killed renamable $vgpr15, killed renamable $vgpr16, killed renamable $vgpr17, killed renamable $vgpr18, killed renamable $vgpr19, killed renamable $vgpr20, killed renamable $vgpr21, killed renamable $vgpr22, killed renamable $vgpr23, killed renamable $vgpr24, killed renamable $vgpr25, killed renamable $vgpr26, killed renamable $vgpr27, killed renamable $vgpr28
    ; CHECK-NEXT: S_NOP 0, implicit-def renamable $vgpr35_vgpr36_vgpr37_vgpr38_vgpr39_vgpr40_vgpr41_vgpr42_vgpr43_vgpr44_vgpr45_vgpr46_vgpr47_vgpr48_vgpr49_vgpr50
    ; CHECK-NEXT: S_NOP 0, implicit-def renamable $vgpr12_vgpr13_vgpr14_vgpr15_vgpr16_vgpr17_vgpr18_vgpr19_vgpr20_vgpr21_vgpr22_vgpr23_vgpr24_vgpr25_vgpr26_vgpr27
    ; CHECK-NEXT: KILL killed renamable $vgpr51, killed renamable $vgpr52, killed renamable $vgpr29, killed renamable $vgpr30, killed renamable $vgpr31, killed renamable $vgpr32, killed renamable $vgpr33, killed renamable $vgpr34, killed renamable $vgpr0_vgpr1, killed renamable $vgpr2_vgpr3, killed renamable $vgpr4_vgpr5, killed renamable $vgpr6_vgpr7, killed renamable $vgpr8_vgpr9, killed renamable $vgpr10_vgpr11
    ; CHECK-NEXT: S_NOP 0, implicit killed renamable $vgpr35_vgpr36_vgpr37_vgpr38_vgpr39_vgpr40_vgpr41_vgpr42_vgpr43_vgpr44_vgpr45_vgpr46_vgpr47_vgpr48_vgpr49_vgpr50, implicit killed renamable $vgpr12_vgpr13_vgpr14_vgpr15_vgpr16_vgpr17_vgpr18_vgpr19_vgpr20_vgpr21_vgpr22_vgpr23_vgpr24_vgpr25_vgpr26_vgpr27
    ; CHECK-NEXT: S_ENDPGM 0
    %1:vgpr_32 = IMPLICIT_DEF
    %2:vgpr_32 = IMPLICIT_DEF
    %2:vgpr_32 = IMPLICIT_DEF
    %3:vgpr_32 = IMPLICIT_DEF
    %4:vgpr_32 = IMPLICIT_DEF
    %5:vgpr_32 = IMPLICIT_DEF
    %6:vgpr_32 = IMPLICIT_DEF
    %7:vgpr_32 = IMPLICIT_DEF
    %8:vgpr_32 = IMPLICIT_DEF
    %9:vgpr_32 = IMPLICIT_DEF
    %10:vgpr_32 = IMPLICIT_DEF
    %11:vgpr_32 = IMPLICIT_DEF
    %12:vgpr_32 = IMPLICIT_DEF
    %13:vgpr_32 = IMPLICIT_DEF
    %14:vgpr_32 = IMPLICIT_DEF
    %15:vgpr_32 = IMPLICIT_DEF
    %16:vgpr_32 = IMPLICIT_DEF
    %17:vgpr_32 = IMPLICIT_DEF
    %18:vgpr_32 = IMPLICIT_DEF
    %19:vgpr_32 = IMPLICIT_DEF
    %20:vgpr_32 = IMPLICIT_DEF
    %21:vgpr_32 = IMPLICIT_DEF
    %22:vgpr_32 = IMPLICIT_DEF
    %23:vgpr_32 = IMPLICIT_DEF
    %24:vreg_64 = IMPLICIT_DEF
    %25:vreg_64 = IMPLICIT_DEF
    %26:vreg_64 = IMPLICIT_DEF
    %27:vreg_64 = IMPLICIT_DEF
    %28:vreg_64 = IMPLICIT_DEF
    %29:vreg_64 = IMPLICIT_DEF
    KILL %3, %4, %5, %6, %7, %8, %9, %10, %11, %12, %13, %14, %15, %16, %17
    S_NOP 0, implicit-def %50:av_512
    S_NOP 0, implicit-def %51:av_512
    KILL %1, %2, %18, %19, %20, %21, %22, %23, %24, %25, %26, %27, %28, %29
    S_NOP 0, implicit %50, implicit %51
    S_ENDPGM 0
...
