; NOTE: Assertions have been autogenerated by utils/update_mir_test_checks.py
; RUN: llc -global-isel=0 -stop-after=finalize-isel -mtriple=amdgcn-mesa-mesa3d -mcpu=gfx900 -verify-machineinstrs -o - %s | FileCheck -enable-var-scope %s

; Test that we don't explode on calls from shaders to functions with the C calling convention.

define amdgpu_ps void @amdgpu_ps_call_default_cc() {
  ; CHECK-LABEL: name: amdgpu_ps_call_default_cc
  ; CHECK: bb.0.main_body:
  ; CHECK-NEXT:   S_ENDPGM 0
main_body:
  call void null()
  ret void
}

define amdgpu_gfx void @amdgpu_gfx_call_default_cc() {
  ; CHECK-LABEL: name: amdgpu_gfx_call_default_cc
  ; CHECK: bb.0.main_body:
  ; CHECK-NEXT:   SI_RETURN
main_body:
  call void null()
  ret void
}
