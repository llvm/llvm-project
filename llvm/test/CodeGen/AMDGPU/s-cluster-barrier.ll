; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --version 5
; RUN: llc -global-isel=0 -mtriple=amdgcn -mcpu=gfx1250 -verify-machineinstrs < %s | FileCheck -check-prefixes=GFX12-SDAG %s
; RUN: llc -global-isel=0 -mtriple=amdgcn -mcpu=gfx1250 -verify-machineinstrs < %s | FileCheck -check-prefixes=GFX12-ISEL %s

define amdgpu_kernel void @kernel1() #0 {
; GFX12-SDAG-LABEL: kernel1:
; GFX12-SDAG:       ; %bb.0:
; GFX12-SDAG-NEXT:    s_barrier_signal -3
; GFX12-SDAG-NEXT:    s_barrier_wait -3
; GFX12-SDAG-NEXT:    s_get_barrier_state s0, -3
; GFX12-SDAG-NEXT:    s_endpgm
;
; GFX12-ISEL-LABEL: kernel1:
; GFX12-ISEL:       ; %bb.0:
; GFX12-ISEL-NEXT:    s_barrier_signal -3
; GFX12-ISEL-NEXT:    s_barrier_wait -3
; GFX12-ISEL-NEXT:    s_get_barrier_state s0, -3
; GFX12-ISEL-NEXT:    s_endpgm
    call void @llvm.amdgcn.s.cluster.barrier()
    %state3 = call i32 @llvm.amdgcn.s.get.barrier.state(i32 -3)
    ret void
}

declare void @llvm.amdgcn.s.cluster.barrier() #1
declare i32 @llvm.amdgcn.s.get.barrier.state(i32) #1

attributes #0 = { nounwind }
attributes #1 = { convergent nounwind }
attributes #2 = { nounwind readnone }
