; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py
; RUN: llc < %s -mtriple=arm-eabi -mattr=+v4t -verify-machineinstrs | FileCheck %s

define i8 @abd_ext_i8_i8(i8 %a, i8 %b) nounwind {
; CHECK-LABEL: abd_ext_i8_i8:
; CHECK:       @ %bb.0:
; CHECK-NEXT:    lsl r0, r0, #24
; CHECK-NEXT:    lsl r1, r1, #24
; CHECK-NEXT:    asr r0, r0, #24
; CHECK-NEXT:    subs r0, r0, r1, asr #24
; CHECK-NEXT:    rsbmi r0, r0, #0
; CHECK-NEXT:    bx lr
  %aext = sext i8 %a to i64
  %bext = sext i8 %b to i64
  %sub = sub i64 %aext, %bext
  %abs = call i64 @llvm.abs.i64(i64 %sub, i1 false)
  %trunc = trunc i64 %abs to i8
  ret i8 %trunc
}
