; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py UTC_ARGS: --version 5
; RUN: llc -mtriple=armv7-unknown-linux-gnueabihf < %s | FileCheck %s

; Check for assertion when extractelement of load optimization
; involves a result element type different from the input vector
; element type.

define i8 @baz(ptr %ptr, i32 %arg) {
; CHECK-LABEL: baz:
; CHECK:       @ %bb.0: @ %bb
; CHECK-NEXT:    add r1, r1, r1
; CHECK-NEXT:    and r1, r1, #3
; CHECK-NEXT:    ldr r0, [r0, r1, lsl #2]
; CHECK-NEXT:    bx lr
bb:
  %load = load <2 x i64>, ptr %ptr, align 8
  %extractelement = extractelement <2 x i64> %load, i32 %arg
  %trunc = trunc i64 %extractelement to i8
  ret i8 %trunc
}
