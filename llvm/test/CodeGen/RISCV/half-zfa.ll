; NOTE: Assertions have been autogenerated by utils/update_llc_test_checks.py
; RUN: llc -mtriple=riscv32 -target-abi ilp32f -mattr=+experimental-zfa,+zfh < %s \
; RUN:     | FileCheck --check-prefix=RV32IHZFA %s
; RUN: llc -mtriple=riscv64 -target-abi lp64f -mattr=+experimental-zfa,+zfh < %s \
; RUN:     | FileCheck --check-prefix=RV64HZFA %s

declare half @llvm.minimum.f16(half, half)

define half @fminm_h(half %a, half %b) nounwind {
; RV32IHZFA-LABEL: fminm_h:
; RV32IHZFA:       # %bb.0:
; RV32IHZFA-NEXT:    fminm.h fa0, fa0, fa1
; RV32IHZFA-NEXT:    ret
;
; RV64HZFA-LABEL: fminm_h:
; RV64HZFA:       # %bb.0:
; RV64HZFA-NEXT:    fminm.h fa0, fa0, fa1
; RV64HZFA-NEXT:    ret
  %1 = call half @llvm.minimum.f16(half %a, half %b)
  ret half %1
}

declare half @llvm.maximum.f16(half, half)

define half @fmaxm_h(half %a, half %b) nounwind {
; RV32IHZFA-LABEL: fmaxm_h:
; RV32IHZFA:       # %bb.0:
; RV32IHZFA-NEXT:    fmaxm.h fa0, fa0, fa1
; RV32IHZFA-NEXT:    ret
;
; RV64HZFA-LABEL: fmaxm_h:
; RV64HZFA:       # %bb.0:
; RV64HZFA-NEXT:    fmaxm.h fa0, fa0, fa1
; RV64HZFA-NEXT:    ret
  %1 = tail call half @llvm.maximum.f16(half %a, half %b)
  ret half %1
}

define half @fround_h_1(half %a) nounwind {
; RV32IHZFA-LABEL: fround_h_1:
; RV32IHZFA:       # %bb.0:
; RV32IHZFA-NEXT:    fround.h fa0, fa0, rmm
; RV32IHZFA-NEXT:    ret
;
; RV64HZFA-LABEL: fround_h_1:
; RV64HZFA:       # %bb.0:
; RV64HZFA-NEXT:    fround.h fa0, fa0, rmm
; RV64HZFA-NEXT:    ret
  %call = tail call half @llvm.round.f16(half %a) nounwind readnone
  ret half %call
}

declare half @llvm.round.f16(half) nounwind readnone


define half @fround_h_2(half %a) nounwind {
; RV32IHZFA-LABEL: fround_h_2:
; RV32IHZFA:       # %bb.0:
; RV32IHZFA-NEXT:    fround.h fa0, fa0, rup
; RV32IHZFA-NEXT:    ret
;
; RV64HZFA-LABEL: fround_h_2:
; RV64HZFA:       # %bb.0:
; RV64HZFA-NEXT:    fround.h fa0, fa0, rup
; RV64HZFA-NEXT:    ret
  %call = tail call half @llvm.floor.f16(half %a) nounwind readnone
  ret half %call
}

declare half @llvm.floor.f16(half) nounwind readnone


define half @fround_h_3(half %a) nounwind {
; RV32IHZFA-LABEL: fround_h_3:
; RV32IHZFA:       # %bb.0:
; RV32IHZFA-NEXT:    fround.h fa0, fa0, rdn
; RV32IHZFA-NEXT:    ret
;
; RV64HZFA-LABEL: fround_h_3:
; RV64HZFA:       # %bb.0:
; RV64HZFA-NEXT:    fround.h fa0, fa0, rdn
; RV64HZFA-NEXT:    ret
  %call = tail call half @llvm.ceil.f16(half %a) nounwind readnone
  ret half %call
}

declare half @llvm.ceil.f16(half) nounwind readnone


define half @fround_h_4(half %a) nounwind {
; RV32IHZFA-LABEL: fround_h_4:
; RV32IHZFA:       # %bb.0:
; RV32IHZFA-NEXT:    fround.h fa0, fa0, rtz
; RV32IHZFA-NEXT:    ret
;
; RV64HZFA-LABEL: fround_h_4:
; RV64HZFA:       # %bb.0:
; RV64HZFA-NEXT:    fround.h fa0, fa0, rtz
; RV64HZFA-NEXT:    ret
  %call = tail call half @llvm.trunc.f16(half %a) nounwind readnone
  ret half %call
}

declare half @llvm.trunc.f16(half) nounwind readnone


define half @fround_h_5(half %a) nounwind {
; RV32IHZFA-LABEL: fround_h_5:
; RV32IHZFA:       # %bb.0:
; RV32IHZFA-NEXT:    fround.h fa0, fa0
; RV32IHZFA-NEXT:    ret
;
; RV64HZFA-LABEL: fround_h_5:
; RV64HZFA:       # %bb.0:
; RV64HZFA-NEXT:    fround.h fa0, fa0
; RV64HZFA-NEXT:    ret
  %call = tail call half @llvm.nearbyint.f16(half %a) nounwind readnone
  ret half %call
}

declare half @llvm.nearbyint.f16(half) nounwind readnone


define half @froundnx_h(half %a) nounwind {
; RV32IHZFA-LABEL: froundnx_h:
; RV32IHZFA:       # %bb.0:
; RV32IHZFA-NEXT:    froundnx.h fa0, fa0
; RV32IHZFA-NEXT:    ret
;
; RV64HZFA-LABEL: froundnx_h:
; RV64HZFA:       # %bb.0:
; RV64HZFA-NEXT:    froundnx.h fa0, fa0
; RV64HZFA-NEXT:    ret
  %call = tail call half @llvm.rint.f16(half %a) nounwind readnone
  ret half %call
}

declare half @llvm.rint.f16(half) nounwind readnone

declare i1 @llvm.experimental.constrained.fcmp.f16(half, half, metadata, metadata)

define i32 @fcmp_olt_q(half %a, half %b) nounwind strictfp {
; RV32IHZFA-LABEL: fcmp_olt_q:
; RV32IHZFA:       # %bb.0:
; RV32IHZFA-NEXT:    fltq.h a0, fa0, fa1
; RV32IHZFA-NEXT:    ret
;
; RV64HZFA-LABEL: fcmp_olt_q:
; RV64HZFA:       # %bb.0:
; RV64HZFA-NEXT:    fltq.h a0, fa0, fa1
; RV64HZFA-NEXT:    ret
  %1 = call i1 @llvm.experimental.constrained.fcmp.f16(half %a, half %b, metadata !"olt", metadata !"fpexcept.strict") strictfp
  %2 = zext i1 %1 to i32
  ret i32 %2
}

define i32 @fcmp_ole_q(half %a, half %b) nounwind strictfp {
; RV32IHZFA-LABEL: fcmp_ole_q:
; RV32IHZFA:       # %bb.0:
; RV32IHZFA-NEXT:    fleq.h a0, fa0, fa1
; RV32IHZFA-NEXT:    ret
;
; RV64HZFA-LABEL: fcmp_ole_q:
; RV64HZFA:       # %bb.0:
; RV64HZFA-NEXT:    fleq.h a0, fa0, fa1
; RV64HZFA-NEXT:    ret
  %1 = call i1 @llvm.experimental.constrained.fcmp.f16(half %a, half %b, metadata !"ole", metadata !"fpexcept.strict") strictfp
  %2 = zext i1 %1 to i32
  ret i32 %2
}
