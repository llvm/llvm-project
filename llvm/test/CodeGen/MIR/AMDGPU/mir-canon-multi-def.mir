# RUN: llc -mtriple=amdgcn -run-pass mir-canonicalizer -mir-vreg-namer-use-stable-hash -verify-machineinstrs %s -o - | FileCheck %s

---
name: multi_def_renaming
tracksRegLiveness: true
body:             |
  bb.0:
    liveins: $vgpr3, $vgpr4_vgpr5

    ; CHECK-LABEL: name: multi_def_renaming
    ; CHECK: liveins: $vgpr3, $vgpr4_vgpr5
    ; CHECK-NEXT: {{  $}}
    ; CHECK-NEXT: %bb0_[[V_MAD_DEF_HASH:[[:xdigit:]]+]]__1:vreg_64, %bb0_[[V_MAD_DEF_HASH]]__2:sreg_64 = V_MAD_U64_U32_e64 $vgpr3, $vgpr3, $vgpr4_vgpr5, 0, implicit $exec
    ; CHECK-NEXT: S_NOP 0, implicit-def %bb0_[[S_NOP_DEF_HASH:[[:xdigit:]]+]]__1, implicit-def %bb0_[[S_NOP_DEF_HASH]]__2, implicit-def %bb0_[[S_NOP_DEF_HASH]]__3
    ; CHECK-NEXT: %bb0_[[COPY_DEF_HASH:[[:xdigit:]]+]]__1:vgpr_32 = COPY %bb0_[[V_MAD_DEF_HASH]]__2.sub0
    ; CHECK-NEXT: S_ENDPGM 0
    %0:vreg_64, %1:sreg_64 = V_MAD_U64_U32_e64 $vgpr3, $vgpr3, $vgpr4_vgpr5, 0, implicit $exec
    S_NOP 0, implicit-def %2:vreg_256, implicit-def %3:vreg_256, implicit-def %4:vreg_256
    %5:vgpr_32 = COPY %1.sub0

    S_ENDPGM 0
...
