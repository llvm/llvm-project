/* --- PESubtarget.h --- */
/* ------------------------------------------
Author: 高宇翔
Date: 4/2/2025
------------------------------------------ */

#ifndef PESUBTARGET_H
#define PESUBTARGET_H

#include "PEInstrInfo.h"
#include "PERegisterInfo.h"
#include "PEFrameLowering.h"
#include "PEISelLowering.h"

#define GET_SUBTARGETINFO_HEADER
#include "PEGenSubtargetInfo.inc"
#include "llvm/CodeGen/SelectionDAGTargetInfo.h"

namespace llvm{
class PESubtarget : public PEGenSubtargetInfo{
private:
    PEInstrInfo InstrInfo;
    PERegisterInfo RegInfo;
    PEFrameLowering FrameLowering;
    PETargetLowering TLI;
    SelectionDAGTargetInfo TSInfo;
public:
    PESubtarget(const Triple &TT, StringRef CPU,
        StringRef Features, const TargetMachine &TM);
   PESubtarget &initializeSubtargetDependencies(const Triple &TT,
        StringRef CPU,
        StringRef TuneCPU,
        StringRef FS,
        StringRef ABIName);

    // Parses features string setting specified subtarget options. The
    // definition of this function is auto-generated by tblgen.
    void ParseSubtargetFeatures(StringRef CPU, StringRef TuneCPU, StringRef FS);

    const PEInstrInfo *getInstrInfo() const override { return &InstrInfo; }

    const PERegisterInfo *getRegisterInfo() const override {
      return &RegInfo;
    }

    const PEFrameLowering *getFrameLowering() const override {
        return &FrameLowering;
    }
    const PETargetLowering *getTargetLowering() const override{
        return &TLI;
    }
    const SelectionDAGTargetInfo *getSelectionDAGInfo() const override {
        return &TSInfo;
    }

private:

};
}
#endif // PESUBTARGET_H
