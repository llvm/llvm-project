2006-05-03  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/posix/getaddrinfo.c: Implement configuration file
	handling.  /etc/gai.conf can contain replacements for the label
	and precedence table.  Fix byte order of default label and
	precedence table.
	* posix/gai.conf: New file.
	* posix/tst-rfc3484.c: Adjust for changes to getaddrinfo.c.
	* posix/tst-rfc3484-2.c: Likewise.

2006-05-02  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1201]
	* posix/regex.h: g++ still cannot handled [restrict].

	[BZ #2509]
	* stdio-common/vfprintf.c (process_arg): Fix reading of signed
	short and byte values from parameter list.
	* stdio-common/tst-printf.c (main): Add more tests.
	* stdio-common/tst-printf.sh: Adjust for tst-printf.c change.

	* iconvdata/testdate/MIK: Fix format to match expected output.

	[BZ #2632]
	* nscd/connections.c (nscd_init): Correct initialization of
	in-memory database structure.

2006-05-02  Thorsten Kukuk  <kukuk@suse.de>

	* sysdeps/unix/sysv/linux/alpha/bits/mman.h: Fix MADV_REMOVE value.
	* sysdeps/unix/sysv/linux/i386/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/ia64/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/s390/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/sh/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/sparc/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/bits/mman.h: Likewise.

2006-05-01  Ulrich Drepper  <drepper@redhat.com>

	[BZ #2502]
	* iconvdata/utf-7.c: Don't require more than one character after
	the '+' sign starting Unicode shifted sequences.

	* misc/tsearch.c (__tdelete): Remove unnecessary test
	[Coverity CID 75].

	* sysdeps/generic/unwind-dw2.c (execute_cfa_program): Print error
	message for invalid DWARF data instead of crashing.

	* nis/nss_nis/nis-pwd.c (internal_nis_getpwent_r): Don't try to
	free outkey in error case when batch_read is set.

	* nis/nss_nis/nis-grp.c (internal_nis_getgrent_r): Don't try to
	free outkey in error case when batch_read is set [Coverity CID 196].

	[BZ #2517]
	* misc/sys/queue.h: Update to more recent version.

2006-05-01  Alexander Shopov  <ash@contact.bg>

	[BZ #2625]
	* iconvdata/Makefile (modules): Added MIK.
	(distribute): Added mik.c.
	(gen-8bit-gap-modules): Added mik.
	* iconvdata/TESTS: Added MIK.
	* iconvdata/gconv-modules: Added MIK.
	* iconvdata/tst-tables.sh: Added MIK.
	* iconvdata/mik.c: New file.
	* iconvdata/testdata/MIK: New file.
	* iconvdata/testdata/MIK..UTF8: New file.

2006-04-30  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-load.c (_dl_map_object_from_fd): Move state change
	notification...
	(lose): ...to here.

	* posix/Makefile (tests): Add tst-getaddrinfo3.
	* posix/tst-getaddrinfo3.c: New file.

	* sysdeps/posix/getaddrinfo.c (gaih_inet): Add parenthesis in test
	for better readability.

	* nscd/nscd.h (struct database_dyn): Change filename to an array
	to avoid relocations.

	* elf/ldd.bash.in: If --verify loop fails to find a dynamic linker
	for the file don't just try the first one listed in RTLDLIST
	again.  We already have the status.

	* nis/nss_nisplus/nisplus-publickey.c (parse_grp_str): PIDLIST is
	supposed to have NGRPS elements.

	* nis/nss_nisplus/nisplus-parser.c: Minor optimizations and
	cleanups.  Avoid copying data if it can be used in the old place.

2006-04-29  Ulrich Drepper  <drepper@redhat.com>

	* nis/nss_nisplus/nisplus-ethers.c: Add missing null pointer check.
	* nis/nss_nisplus/nisplus-hosts.c: Likewise.
	* nis/nss_nisplus/nisplus-network.c: Likewise.
	* nis/nss_nisplus/nisplus-proto.c: Likewise.
	* nis/nss_nisplus/nisplus-rpc.c: Likewise.
	* nis/nss_nisplus/nisplus-service.c: Likewise.
	* nis/nss_nisplus/nisplus-spwd.c: Likewise.

	* nis/nisplus-parser.h (_nss_nisplus_parse_pwent): Add entry
	parameter.
	(_nss_nisplus_parse_pwent_chk): New prototype.
	* nis/nss_nisplus/nisplus-parser.c (_nss_nisplus_parse_pwent):
	Add entry parameter.  Use it for column value in all accesses.
	Move checks for well-formed reply to...
	(_nss_nisplus_parse_pwent_chk): ...here.  New function.
	* nis/nss_nisplus/nisplus-pwd.c: Support SETENT_BATCH_READ option.

	* nis/nss_nisplus/nisplus-parser.c: Some cleanups.  Remove
	hidden_def definitions.
	* nis/nisplus-parser.h: Add parameter names.  Remove hidden_proto
	definitions.

2006-04-28  Ulrich Drepper  <drepper@redhat.com>

	* nis/nss_nis/nis-spwd.c (internal_nis_getspent_r): Remove data
	variable.

	* nis/nss-nis.h: Define response_t and intern_t.  Declare _nis_saveit.
	* nis/nss_nis/nis-pwd.c: Remove response_t and intern_t definition.
	(saveit): Renamed to _nis_saveit.  Take parameter which is pointer
	to the intern_t object.  Change all users.
	* nis/nss_nis/nis-grp.c: Remove response_t, intern_t, and saveit
	definition.  Use _nis_saveit instead of saveit.
	* nis/nss_nis/nis-service.c: Likewise.
	* nis/nss_nis/nis-initgroups.c: Likewise.
	(internal_setgrent): Adjust for buffer handling.
	(internal_getgrent_r): Likewise.
	* nis/nss_nis/nis-rpc.c: Likewise.

	* nis/nss-default.c (vars): Add SETENT_BATCH_READ.
	* nis/nss: Document SETENT_BATCH_READ.
	* nis/libnsl.h: Define NSS_FLAG_SETENT_BATCH_READ.
	* nis/nss_nis/nis-service.c (saveit): Don't add NUL byte if the
	string is already NUL terminated.
	(internal_nis_endservent): No need to return anything.  Change callers.
	(internal_nis_setservent): One more initialization.
	* nis/nss_nis/nis-pwd.c: Support SETENT_BATCH_READ option.
	* nis/nss_nis/nis-grp.c: Likewise.

	* nis/nss-default.c (init): Rewrite parser to get the variables
	from a table.

	* nis/nss_nis/nis-service.c: Avoid passing pointer to static
	variable around.  Reduce number of memory allocations by creating
	list of memory pools.

	* nis/ypclnt.c (__xdr_ypresp_all): Minor optimization in string
	handling.  Fix typo in comment.

2006-04-27  Ulrich Drepper  <drepper@redhat.com>

	* nscd/connections.c (restart): If we want to switch back to the
	old ID use setresuid and setresgid.
	(finish_drop_privileges): Likewise.

2006-04-27  Jakub Jelinek  <jakub@redhat.com>

	* nscd/nscd.conf: Fix a typo.

2006-04-27  Ulrich Drepper  <drepper@redhat.com>

	[BZ #2611]
	* stdio-common/renameat.c (renameat): Fix typo.

2006-04-26  Roland McGrath  <roland@redhat.com>

	* Makeconfig (%.v.i rule): Don't use -DASSEMBLER.
	The predefined __ASSEMBLER__ is sufficient.

2006-04-26  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1386]
	* iconvdata/ibm932.c: Change mapping to allow round-trips.
	* iconvdata/ibm943.c: Likewise.
	Patch by Masahide Washizawa <WASHI@jp.ibm.com>.

	* sysdeps/unix/sysv/linux/syscalls.list: Add vmsplice.
	* sysdeps/unix/sysv/linux/Versions: Export vmsplice@@GLIBC_2.5.
	* sysdeps/unix/sysv/linux/sparc/bits/fcntl.h: Declare vmsplice.
	* sysdeps/unix/sysv/linux/ia64/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/sh/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/i386/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/s390/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/alpha/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/bits/fcntl.h: Likewise.

	* sysdeps/unix/sysv/linux/bits/uio.h: Fix a typo in a comment.

	* sysdeps/posix/getaddrinfo.c (getaddrinfo): Fix typo which caused
	errors not to be reported.

	* nscd/nscd.h (struct database_dyn): Add propagate field.
	* nscd/nscd_conf.c (nscd_parse_file): Parse auto-propagate lines.
	* nscd/nscd.conf: Add auto-propagate lines.
	* nscd/connections.c (dbs): Initialize .propagate fields.
	* nscd/grpcache.c (cache_addgr): Do not add ID entry for name lookups
	and vice versa if propagation is disabled for the database.
	* nscd/pwdcache.c (cache_addpw): Likewise.

2006-04-26  James Antill  <james.antill@redhat.com>
	    Ulrich Drepper  <drepper@redhat.com>

	* config.make.in: Add have-libcap.
	* configure.in: Check for libcap.
	* nscd/Makefile (selinux-LIBS): Add -lcap if possible.
	* nscd/connections.c (finish_drop_privileges): When libcap is available
	call preserve_capabilities and install_real_capabilities.
	* nscd/selinux.c: Define preserve_capabilities and
	install_real_capabilities.
	* nscd/selinux.h: Declare preserve_capabilities and
	install_real_capabilities.

2006-04-26  Ulrich Drepper  <drepper@redhat.com>

	* locale/iso-4217.def: Update.

2006-04-25  Ulrich Drepper  <drepper@redhat.com>

	[BZ #2420]
	* stdlib/strfmon_l.c (__vstrfmon_l): Fix handling of ! modifier.
	* localedata/Makefile: Add rules to build and run tst-strfmon1.
	* localedata/tst-strfmon1.c: New file.

	[BZ #2571]
	* nscd/nscd_helper.c (__nscd_get_map_ref): Make mapptr argument a
	volatile pointer so that the mapptr->mapped value is re-read after
	the lock is retrieved.
	* nscd/nscd-client.h: Update __nscd_get_map_ref prototype.

	* include/features.h [_GNU_SOURCE] (_POSIX_C_SOURCE): Define to
	200112L.

	* resolv/res_hconf.c: Minor surgery to 'cmd' and the referenced
	functions to avoid relocations.

	[BZ #2389]
	* resolv/res_hconf.c: Remove 'order' parsing.  Just ignore the line.
	* resolv/res_hconf.h: Remove Name_Service definition.
	(struct hconf): Replace service related fields with placeholders.

	[BZ #2386]
	* sysdeps/unix/sysv/linux/ia64/clone2.S: Check for NULL stack
	pointers to match other architectures.
	* sysdeps/unix/sysv/linux/Makefile [subdirs=misc] (tests): Add
	tst-clone.
	* sysdeps/unix/sysv/linux/tst-clone.c: New file.

	[BZ #2072]
	* stdio-common/printf_fp.c: Fix potential memory leaks for
	malloc'ed wbuffer which isn't freed in error conditions.

	[BZ #2569]
	* iconv/gconv_db.c (__gconv_release_step): Fix condition of assert
	call.
	* iconvdata/Makefile (tests): Add tst-iconv6.
	* iconvdata/tst-iconv6.c: New file.

2006-04-24  Ulrich Drepper  <drepper@redhat.com>

	* posix/tst-rfc3484.c (do_test): Also initialize source_addr_flags
	field.
	* posix/tst-rfc3484-2.c (do_test): Likewise.

	* posix/tst-rfc3484.c: Include <ifaddrs.h> early.
	* posix/tst-rfc3484-2.c: Likewise.

	* version.h (VERSION): Bump to 2.4.90 for the trunk.

2006-04-24  Jakub Jelinek  <jakub@redhat.com>

	* malloc/arena.c (ptmalloc_init): Don't call __malloc_check_init
	if MALLOC_CHECK_ env var contains an empty string.

2006-04-24  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/posix/getaddrinfo.c (getaddrinfo): Always initialize in6ai.

2006-04-24  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/sync_file_range.c (sync_file_range): Use
	__LONG_LONG_PAIR macro.

	* posix/bits/unistd.h (__readlinkat_chk): New prototype.
	(__readlinkat_alias): New alias.
	(readlinkat): New inline function.
	* include/unistd.h (readlinkat): Add libc_hidden_proto.
	* sysdeps/unix/sysv/linux/readlinkat.c (readlinkat): Add
	libc_hidden_def.
	* io/readlinkat.c (readlinkat): Likewise.
	* debug/readlinkat_chk.c: New file.
	* debug/Makefile (routines): Add readlinkat_chk.
	* debug/Versions (libc): Export __readlinkat_chk@@GLIBC_2.5.
	* debug/tst-chk1.c (do_test): Add readlinkat tests.

2006-04-23  Ulrich Drepper  <drepper@redhat.com>

	* nis/nss_nisplus/nisplus-netgrp.c: Cleanups.

	[BZ #1951]
	* sysdeps/posix/sigset.c (sigset): Return correct value reflecting
	previous signal state.
	* signal/Makefile (tests): Add tst-sigset2.
	* signal/tst-sigset2.c: New file.

2006-04-21  Jakub Jelinek  <jakub@redhat.com>

	* argp/argp.h (__option_is_short): Check upper limit of
	__key.  isprint() requires its argument to have the value
	of an unsigned char or EOF.
	Patch by Sergey Poznyakoff <gray@Mirddin.farlep.net>.

2006-04-21  Ulrich Drepper  <drepper@redhat.com>

	[BZ #2534, BZ #2535]
	* posix/regex.h: Remove obsolete <sys/types.h> comment and special
	handling for VMS.

	* iconvdata/ibm437.c: Define HAS_HOLES to 0.
	* iconvdata/ibm861.c: Likewise.
	* iconvdata/ibm862.c: Likewise.
	* iconvdata/ibm863.c: Likewise.
	* iconvdata/ibm865.c: Likewise.
	Reported by <ash@contact.bg>.

2006-04-19  Ulrich Drepper  <drepper@redhat.com>

	* include/ifaddrs.h: Get uint32_t definition.
	* posix/tst-rfc3484.c: Update fake __check_pf implementation.
	* posix/tst-rfc3484-2.c: Likewise.

	* sysdeps/unix/sysv/linux/kernel-features.h: Define
	__ASSUME_PROC_SELF_FD_SYMLINK.
	* sysdeps/unix/sysv/linux/ttyname.c: Cleanups.  Avoid compatibility
	code is possible.  Move compatibility code in .text.compat section.
	* sysdeps/unix/sysv/linux/ttyname_r.c: Likewise.

2006-04-18  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/posix/getaddrinfo.c (getaddrinfo): Rewrite to avoid loop
	over gaih array.  There is only one function to call in the moment.

2006-04-16  Ulrich Drepper  <drepper@redhat.com>

	* include/ifaddrs.h: Define struct in6addrinfo.
	Add two more parameters to __check_pf.
	* sysdeps/unix/sysv/linux/check_pf.c: When using the netlink
	interface, determine whether IPv6 addresses are deprecated or
	temporary.  Create array of those addresses.
	* inet/check_pf.c: Always tell caller there are no depracated
	and temporary addresses.
	* sysdeps/posix/getaddrinfo.c: Pretty printing.
	(struct sort_result): Add source_addr_flags field.
	(rfc3484_sort): Implement rule 3 and 7.
	(in6aicmp): New function.
	(getaddrinfo): Call __check_pf also when we need info about IPv6
	source addresses.  When creating array for sorting addresses,
	look up deprecated and temporary addresses returned by __check_pf
	and add flag if necessary.

2006-04-15  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/posix/getaddrinfo.c: Fix precedence for IP V4-to-V6
	mapped addresses.
	* posix/Makefile (tests): Add tst-rfc3484-2.
	* posix/tst-rfc3484-2.c: New file.

	* nis/nss_nisplus/nisplus-publickey.c: Minor cleanups throughout.
	* nis/nss_nisplus/nisplus-service.c (_nss_nisplus_parse_servent):
	Significant cleanups.  Correct adjustment for pointer array.
	* nis/nss_nisplus/nisplus-rpc.c (_nss_nisplus_parse_rpcent):
	Likewise.
	* nis/nss_nisplus/nisplus-proto.c (_nss_nisplus_parse_protoent):
	Likewise.
	* nis/nss_nisplus/nisplus-network.c (_nss_nisplus_parse_netent):
	Likewise.
	* nis/nss_nisplus/nisplus-hosts.c (_nss_nisplus_parse_hostent):
	Likewise.

2006-04-14  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/syscalls.list: Add tee syscall.
	* sysdeps/unix/sysv/linux/Versions: Export tee@GLIBC_2.5.
	* sysdeps/unix/sysv/linux/sparc/bits/fcntl.h: Add prototype for tee.
	* sysdeps/unix/sysv/linux/ia64/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/sh/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/i386/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/s390/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/alpha/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/bits/fcntl.h: Likewise.

	* nis/nss_nisplus/nisplus-ethers.c (_nss_nisplus_parse_etherent):
	Minor cleanups.  NUL terminate name string.

	* nis/Versions: No need to export _nss_nisplus_parse_grent,
	_nss_nisplus_parse_pwent, and _nss_nisplus_parse_spent.

	* nis/nss_nisplus/nisplus-alias.c (_nss_nisplus_parse_aliasent):
	Avoid unnecessary allocation.  Fix adjustment for pointer value.

	* nis/nss_nisplus/nisplus-parser.c: Cleanups, use NIS_RES_*
	macros.  Avoid unnecessary allocation.

	* sysdeps/unix/sysv/linux/sync_file_range.c: New file.

2006-04-13  Ulrich Drepper  <drepper@redhat.com>

	* nis/Makefile (libnsl-routimes): Add nss-default.
	* nis/Versions (libnsl) [GLIBC_PRIVATE]: Export _nsl_default_nss.
	* nis/nss-nis.c: Move /etc/default/nss handling to...
	* nis/nss-default.c: ...here.  New file.
	* nis/libnsl.h: New file.
	* nis/nss-nis.h: Remove NSS_FLAG_* definitions and _nis_default_nss
	plus auxilary definitions.
	* nis/nss_nis/nis-initgroups.c: Use _nsl_default_nss instead of
	_nis_default_nss.
	* nis/nss_nis/nis-service.c: Likewise.

2006-04-07  Steven Munroe  <sjmunroe@us.ibm.com>

	* sysdeps/powerpc/fpu/bits/mathinline.h
	[__WORDSIZE == 64 || _ARCH_PWR4]: Define __CPU_HAS_FSQRT.
	(__ieee754_sqrt): Fix comment.
	(__ieee754_sqrtf): Fix comment.
	* sysdeps/powerpc/fpu/e_sqrt.c (__ieee754_sqrt): Fix comment.
	Check __CPU_HAS_FSQRT instead of dl_hwcap.
	* sysdeps/powerpc/fpu/e_sqrtf.c (__ieee754_sqrtf): Likewise.

2006-04-08  Ulrich Drepper  <drepper@redhat.com>

	* inet/inet_ntoa.c: Rewrite to use TLS instead of TSD.

	* nis/nss_nis/nis-alias.c: Optimize use of yperr2nss.  Avoid calling
	it for YPERR_SUCCESS.  Minor cleanups.  Add __builtin_expect.
	* nis/nss_nis/nis-ethers.c: Likewise.
	* nis/nss_nis/nis-grp.c: Likewise.
	* nis/nss_nis/nis-hosts.c: Likewise.
	* nis/nss_nis/nis-initgroups.c: Likewise.
	* nis/nss_nis/nis-netgrp.c: Likewise.
	* nis/nss_nis/nis-network.c: Likewise.
	* nis/nss_nis/nis-proto.c: Likewise.
	* nis/nss_nis/nis-publickey.c: Likewise.
	* nis/nss_nis/nis-pwd.c: Likewise.
	* nis/nss_nis/nis-rpc.c: Likewise.
	* nis/nss_nis/nis-service.c: Likewise.
	* nis/nss_nis/nis-spwd.c: Likewise.

	* nis/nis_ping.c: Remove unnecessary conditionals before
	nis_freeresult calls.
	* nis/nis_ismember.c: Likewise.

	* elf/rtld.c (process_envvars): Fix handling of LD_POINTER_GUARD.
	Reported by genesh@comcast.net.

	* io/fts.c (fts_build): Call fts_lfree in the two error cases
	after the loop [Coverity CID 187].

	* nis/nis_getservlist.c (nis_getservlist): Also free lookup result
	in error case [Coverity CID 189].

	* nis/nis_getservlist.c (nis_getservlist): One more free call
	needed [Coverity CID 190].

2006-04-07  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/generic/unwind-dw2-fde.c (end_fde_sort): Remove
	unnecessary test for accu->linear == NULL [Coverity CID 79].

2006-04-07  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/posix/tempname.c (__gen_tempname): Change attempts_min
	into a macro.  Use preprocessor to decide how to initialize
	attempts [Coverity CID 67].

	* io/fts.c (fts_build): Comment out dead code [Coverity CID 68].

	* sunrpc/rpc_parse.c (def_union): Comment out dead code
	[Coverity CID 70].

	* locale/programs/linereader.c (lr_token): Remove duplicate
	handling of EOF [Coverity CID 71].

	* locale/programs/ld-numeric.c (numeric_read) [case tok_grouping]:
	We bail out early if ignore_content is set, so there is no need to
	check it later again [Coverity CID 72].

	* inet/inet6_option.c (inet6_option_find): Check *tptrp for NULL,
	not tptrp [Coverity CID 73].

	* inet/inet6_option.c (inet6_option_next): Check *tptrp for NULL,
	not tptrp [Coverity CID 74].

	* misc/tsearch.c (__tsearch): Don't rotate tree if memory
	allocation failed [Coverity CID 78].

2006-04-07  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/generic/unwind-dw2.c (execute_cfa_program): Fix typo in
	the last change.

2006-04-07  Ulrich Drepper  <drepper@redhat.com>

	* inet/rexec.c (rexec_af): If we have no canonical name don't
	proceed further [Coverity CID 86].

	* iconv/iconv_charmap.c (process_fd): Initialize inptr from inbuf,
	not to NULL [Coverity CID 88].

2006-04-06  Ulrich Drepper  <drepper@redhat.com>

	* elf/ldconfig.c (main): Use rawmemchr instead of strchr.
	* nis/nis_call.c (rec_dirsearch): Likewise.
	* nis/nis_local_names.c (nis_local_host): Likewise.
	(nis_local_directory): Likewise.
	* intl/explodename.c (_nl_explode_name): Likewise.

	* sysdeps/generic/unwind-dw2.c (execute_cfa_program): Don't handle
	DW_CFA_GNU_window_save if it obviously cannot work [Coverity CID 102].

	* locale/programs/ld-address.c (address_finish): Fix conditions
	for error messages [Coverity CID 104].

	* libio/fmemopen.c (fmemopen): Free stream memory in case of
	invalid length [Coverity CID 106].

	* nss/nss_files/files-key.c (search): Close stream before
	successful return [Coverity CID 107].

	* io/fts.c (fts_open): Don't allocate parent if *argv==NULL
	[Coverity CID 108].

	* sunrpc/rpc_cout.c (inline_struct): Free sizestr after use
	[Coverity CID 110, 109].

	* sunrpc/rpc_scan.c (docppline): Free file string if it is not
	going to be used [Coverity CID 111].

	* sysdeps/unix/sysv/linux/getsourcefilter.c (getsourcefilter): Free
	memory if socket level value cannot be retrieved [Coverity CID 112].

	* nis/nis_clone_dir.c (nis_clone_directory): Free all memory in
	error case [Coverity CID 114].

	* nis/nis_clone_res.c (nis_clone_result): Free all memory in the
	error cases [Coverity CID 115].

	* sunrpc/rpc_parse.c (get_definition): Free defp if tok ==
	TOK_EOF [Coverity CID 116].

	* sysdeps/unix/sysv/linux/setsourcefilter.c (setsourcefilter): Free
	memory if socket level value cannot be retrieved [Coverity CID 117].

	* elf/cache.c (save_cache): Initialize pad to avoid writing
	uninitialized data to disk.

	* elf/cache.c (save_cache): Free file_entries_new [Coverity CID 118].

	* intl/finddomain.c (_nl_find_domain): Avoid strdup of expand
	locale name, use strdupa.  Remove free call [Coverity CID 119].

	* sunrpc/rpc_main.c (generate_guard): Avoid extra allocation and
	the resulting leak [Coverity CID 121].

	* sunrpc/rpc_main.c (mkfile_output): Free all allocated memory
	[Coverity CID 122].

	* sunrpc/rpc_main.c (h_output): Free guard after we are done
	[Coverity CID 123].

	* sunrpc/svc_udp.c (cache_set): Free victim if newbuf allocation
	fails [Coverity CID 126].

	* sunrpc/svc_udp.c (svcudp_enablecache): Free memory in error
	cases [Coverity CID 127].

	* nis/nis_table.c (__create_ib_request): Free ibreq in case strdup
	fails [Coverity CID 128].

	* nis/nis_getservlist.c (nis_getservlist): Free all memory in case
	of an error [Coverity CID 130, 129].

	* nis/nis_print_group_entry.c (nis_print_group_entry): If
	nis_lookup call failed, return.  Free lookup result in error
	cases [Coverity CID 131].

	* nis/nis_removemember.c (nis_removemember): Free all memory in
	error cases [Coverity CID 132].

	* nis/nss_nisplus/nisplus-alias.c (_nss_nisplus_getaliasbyname_r):
	Always free lookup result [Coverity CID 134].

	* nis/nss_nisplus/nisplus-ethers.c (_nss_nisplus_gethostton_r):
	Always free lookup result [Coverity CID 135].

	* nis/nss_nisplus/nisplus-ethers.c (_nss_nisplus_getntohost_r):
	Always free lookup result [Coverity CID 136].

	* nis/nss_nisplus/nisplus-network.c (_nss_nisplus_getnetbyaddr_r):
	Before retrying, free old result [Coverity CID 137].

	* nis/nss_nisplus/nisplus-publickey.c (_nss_nisplus_netname2user):
	Free res in case UID is zero [Coverity CID 138].

	* nis/ypclnt.c (yp_update): Always free master string
	[Coverity CID 140].

	* nis/nis_creategroup.c (nis_creategroup): Free all memory in
	error cases [Coverity CID 143, 142, 141].

	* nis/nss_nis/nis-publickey.c (_nss_nis_getpublickey): Free result
	if yp_match call succeeded [Coverity CID 155].

	* nis/nss_nis/nis-publickey.c (_nss_nis_getsecretkey): Free string
	allocated in yp_match at all times [Coverity CID 157, 156].

	* nscd/nscd.c (write_pid): Close stream also if writing failed
	[Coverity CID 165].

	* nis/nis_table.c (nis_add_entry): Move test for NULL parameter
	ahead of first use [Coverity CID 167].

	* nis/nss_nis/nis-alias.c (_nss_nis_getaliasbyname_r): Move test
	for NULL parameter ahead of first use [Coverity CID 168].

	* intl/finddomain.c (_nl_find_domain): We never return NULL if we
	found the locale [Coverity CID 169].

	* inet/getnameinfo.c (getnameinfo): __getservbyport_r does not set
	herrno [Coverity CID 178].

	* nis/nis_checkpoint.c (nis_checkpoint): Don't access and returned
	freed object [Coverity CID 182].

2006-04-05  Alan Modra  <amodra@bigpond.net.au>
	    Jakub Jelinek  <jakub@redhat.com>

	* posix/bits/unistd.h (readlink, __readlink_chk, __readlink_alias):
	Change return value to ssize_t.

2006-04-04  Roland McGrath  <roland@redhat.com>

	* string/Makefile (CFLAGS-inl-tester.c): New variable.
	(CFLAGS-tst-inlcall.c): Likewise.

	[BZ #2508]
	* nscd/Makefile ($(objpfx)nscd_stat.o: sysincludes): Move setting
	inside [$(have-selinux) = yes].
	($(objpfx)selinux.o: sysincludes): Likewise.

	* iconvdata/Makefile (generate-8bit-table): Use LC_ALL=C.
	(generate-8bit-gap-table): Likewise.
	($(objpfx)iso8859-7jp.stmp): Likewise.
	Reported by S.Çağlar Onur <caglar@uludag.org.tr>.

2006-03-21  Joseph S. Myers  <joseph@codesourcery.com>

	* soft-fp/adddf3.c: Add libgcc exception.  Update FSF address.
	* soft-fp/addsf3.c: Likewise.
	* soft-fp/addtf3.c: Likewise.
	* soft-fp/divdf3.c: Likewise.
	* soft-fp/divsf3.c: Likewise.
	* soft-fp/divtf3.c: Likewise.
	* soft-fp/double.h: Likewise.
	* soft-fp/eqdf2.c: Likewise.
	* soft-fp/eqsf2.c: Likewise.
	* soft-fp/eqtf2.c: Likewise.
	* soft-fp/extenddftf2.c: Likewise.
	* soft-fp/extended.h: Likewise.
	* soft-fp/extendsfdf2.c: Likewise.
	* soft-fp/extendsftf2.c: Likewise.
	* soft-fp/fixdfdi.c: Likewise.
	* soft-fp/fixdfsi.c: Likewise.
	* soft-fp/fixsfdi.c: Likewise.
	* soft-fp/fixsfsi.c: Likewise.
	* soft-fp/fixtfdi.c: Likewise.
	* soft-fp/fixtfsi.c: Likewise.
	* soft-fp/fixunsdfdi.c: Likewise.
	* soft-fp/fixunsdfsi.c: Likewise.
	* soft-fp/fixunssfdi.c: Likewise.
	* soft-fp/fixunssfsi.c: Likewise.
	* soft-fp/fixunstfdi.c: Likewise.
	* soft-fp/fixunstfsi.c: Likewise.
	* soft-fp/floatdidf.c: Likewise.
	* soft-fp/floatdisf.c: Likewise.
	* soft-fp/floatditf.c: Likewise.
	* soft-fp/floatsidf.c: Likewise.
	* soft-fp/floatsisf.c: Likewise.
	* soft-fp/floatsitf.c: Likewise.
	* soft-fp/floatundidf.c: Likewise.
	* soft-fp/floatundisf.c: Likewise.
	* soft-fp/floatunditf.c: Likewise.
	* soft-fp/floatunsidf.c: Likewise.
	* soft-fp/floatunsisf.c: Likewise.
	* soft-fp/floatunsitf.c: Likewise.
	* soft-fp/gedf2.c: Likewise.
	* soft-fp/gesf2.c: Likewise.
	* soft-fp/getf2.c: Likewise.
	* soft-fp/ledf2.c: Likewise.
	* soft-fp/lesf2.c: Likewise.
	* soft-fp/letf2.c: Likewise.
	* soft-fp/muldf3.c: Likewise.
	* soft-fp/mulsf3.c: Likewise.
	* soft-fp/multf3.c: Likewise.
	* soft-fp/negdf2.c: Likewise.
	* soft-fp/negsf2.c: Likewise.
	* soft-fp/negtf2.c: Likewise.
	* soft-fp/op-1.h: Likewise.
	* soft-fp/op-2.h: Likewise.
	* soft-fp/op-4.h: Likewise.
	* soft-fp/op-8.h: Likewise.
	* soft-fp/op-common.h: Likewise.
	* soft-fp/quad.h: Likewise.
	* soft-fp/single.h: Likewise.
	* soft-fp/soft-fp.h: Likewise.
	* soft-fp/sqrtdf2.c: Likewise.
	* soft-fp/sqrtsf2.c: Likewise.
	* soft-fp/sqrttf2.c: Likewise.
	* soft-fp/subdf3.c: Likewise.
	* soft-fp/subsf3.c: Likewise.
	* soft-fp/subtf3.c: Likewise.
	* soft-fp/truncdfsf2.c: Likewise.
	* soft-fp/trunctfdf2.c: Likewise.
	* soft-fp/trunctfsf2.c: Likewise.
	* soft-fp/unorddf2.c: Likewise.
	* soft-fp/unordsf2.c: Likewise.
	* soft-fp/unordtf2.c: Likewise.

2006-04-03  Steven Munroe  <sjmunroe@us.ibm.com>

	[BZ #2505]
	* sysdeps/powerpc/powerpc32/bits/atomic.h [_ARCH_PWR4]:
	Define atomic_read_barrier and __ARCH_REL_INSTR using lwsync.

2006-04-03  Andreas Schwab  <schwab@suse.de>

	* sysdeps/unix/sysv/linux/powerpc/powerpc32/clone.S: Terminate FDE
	before syscall.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/clone.S: Likewise.

	* sysdeps/unix/sysv/linux/powerpc/sys/procfs.h: Test for <asm/elf.h>
	with [! _ASM_POWERPC_ELF_H] as well as [!__PPC64_ELF_H].

2006-04-03  Roland McGrath  <roland@frob.com>

	[BZ #2507]
	* mach/Machrules (.udeps-targets): New variable.
	($(objpfx)%.udeps static pattern rule): Use it to avoid \ inside
	quoted string.

2006-04-02  Ulrich Drepper  <drepper@redhat.com>

	[BZ #2501]
	* nscd/nscd_helper.c (get_mapping): Rewrite code to send request
	so it uses send and not writev.

	[BZ #2418]
	* sysdeps/unix/sysv/linux/getcwd.c (__getcwd): Use larger of PATH_MAX
	and page size when allocating buffer.

	* sysdeps/unix/sysv/linux/bits/socket.h (struct msghdr): Document
	msg_controllen type issue.
	(struct cmsghdr): Same for cmsg_len.

2006-04-01  Ulrich Drepper  <drepper@redhat.com>

	[BZ #2415]
	* elf/ldd.bash.in: Create better error messages for invalid input
	files.

	[BZ #2477]
	* sysdeps/unix/sysv/linux/i386/sysdep.h: Create correct LOADARGS_*
	macros for non-shared position-independent code.

	[BZ #2472]
	* bits/siginfo.h: Fix typo in ILL_ILLOPN definition.

	[BZ #2450]
	* posix/unistd.h: Match return value of readlink to what POSIX
	says these days.
	* io/readlink.c: Likewise.
	* io/readlinkat.c: Likewise.
	* sysdeps/unix/sysv/linux/readlinkat.c: Likewise.

	[BZ #2498]
	* nscd/connections.c (main_loop_poll): If the connection cannot be
	accepted because of user-imposed limits close the descriptor.

2006-03-31  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/Versions: Export sync_file_range with
	GLIBC_2.5.
	* sysdeps/unix/sysv/linux/sparc/bits/fcntl.h: Remove
	LINUX_FADV_ASYNC_WRITE and LINUX_FADV_WRITE_WAIT.
	Declare sync_file_range and splice.
	* sysdeps/unix/sysv/linux/ia64/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/sh/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/i386/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/s390/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/alpha/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/wordsize-64/syscalls.list: Add
	sync_file_range.
	* sysdeps/unix/sysv/linux/i386/sync_file_range.S: New file.
	* sysdeps/unix/sysv/linux/syscalls.list: Add splice syscall.
	* sysdeps/unix/sysv/linux/Versions: Export splice with GLIBC_2.5
	version.
	* Versions.def: Define GLIBC_2.5 for libc.

2006-03-29  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/posix/getaddrinfo.c (gaih_inet): No need to duplicate
	'name' for 'canon'.  The final allocation will happen later.

2006-03-27  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/kernel-features.h: Remove support for
	architectures which moved to ports.

	* sysdeps/unix/sysv/linux/kernel-features.h: Add
	__ASSUME_SET_ROBUST_LIST.

2006-03-27  Jakub Jelinek  <jakub@redhat.com>

	* wcsmbs/wchar.h (btowc, wctob): Don't optimize in C++.

2006-03-24  David S. Miller  <davem@sunset.davemloft.net>

	* sysdeps/sparc/sparc32/bits/atomic.h
	(__v9_compare_and_exchange_val_32_acq): Add "memory" clobber.
	* sysdeps/sparc/sparc32/sparcv9/bits/atomic.h
	(__arch_compare_and_exchange_val_32_acq, atomic_exchange_acq):
	Likewise.
	* sysdeps/sparc/sparc64/bits/atomic.h
	(__arch_compare_and_exchange_val_32_acq,
	__arch_compare_and_exchange_val_64_acq, atomic_exchange_acq): Likewise.

2006-03-24  Jakub Jelinek  <jakub@redhat.com>

	* nis/nss_nisplus/nisplus-proto.c (_nss_create_tablename): Check the
	return value of malloc rather than the static var again.
	* nis/nss_nisplus/nisplus-grp.c (_nss_create_tablename): Likewise.
	* nis/nss_nisplus/nisplus-network.c (_nss_create_tablename): Likewise.
	* nis/nss_nisplus/nisplus-ethers.c (_nss_create_tablename): Likewise.
	* nis/nss_nisplus/nisplus-rpc.c (_nss_create_tablename): Likewise.
	* nis/nss_nisplus/nisplus-service.c (_nss_create_tablename): Likewise.
	* nis/nss_nisplus/nisplus-hosts.c (_nss_create_tablename): Likewise.
	* nis/nss_nisplus/nisplus-alias.c (_nss_create_tablename): Likewise.
	* nis/nss_nisplus/nisplus-pwd.c (_nss_pwd_create_tablename): Likewise.

2006-03-25  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/sparc/bits/poll.h: Add POLLMSG,
	POLLREMOVE, and POLLRDHUP.
	* sysdeps/unix/sysv/linux/bits/poll.h: Add POLLREMOVE and POLLRDHUP.

2006-03-24  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/sparc/bits/fcntl.h: Define
	LINUX_FADV_ASYNC_WRITE and LINUX_FADV_WRITE_WAIT.
	* sysdeps/unix/sysv/linux/ia64/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/sh/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/i386/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/s390/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/alpha/bits/fcntl.h: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/bits/fcntl.h: Likewise.

2006-03-17  Roland McGrath  <roland@redhat.com>

	* elf/rtld.c (dl_main): Run final self-relocation after setting up TLS.
	From Alexandre Oliva <aoliva@redhat.com>.

	* elf/tst-audit2.c: New file.
	* elf/Makefile (tests): Add it.
	($(objpfx)tst-audit2.out): New target.
	(tst-audit2-ENV): New variable.

	* elf/tst-leaks1.c: Include <stdio.h>.

2006-03-16  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/sysv/linux/alpha/getcontext.S (__getcontext_x):
	Use .set noat to quiet assembler warning.

	* math/gen-libm-test.pl (parse_args): Take function name for pretty
	output as an argument.
	(generate_testfile): Pass it the name given in the START macro.

	[BZ #2466]
	* math/libm-test.inc (llrint_test, llround_test): Fix last change to
	protect large-precision cases with [LDBL_MANT_DIG > 100].
	(llrint_test_tonearest, llrint_test_towardzero): Likewise.
	(llrint_test_downward, llrint_test_upward): Likewise.

2006-03-15  Steven Munroe  <sjmunroe@us.ibm.com>
	    Alan Modra  <amodra@bigpond.net.au>

	[BZ #2466]
	* math/libm-test.inc (llrint_test, llround_test) [TEST_LDOUBLE]:
	Add new test values.
	(llrint_test_tonearest, llrint_test_towardzero, llrint_test_downward,
	llrint_test_upward): New functions.
	(main): Call them.

	* sysdeps/ieee754/ldbl-128ibm/s_llrintl.c (__llrintl): Handle
	rounding that spans doubles in IBM long double format.
	* sysdeps/ieee754/ldbl-128ibm/s_llroundl.c (__llroundl): Likewise.
	* sysdeps/powerpc/powerpc64/fpu/s_llrintl.S: Removed.
	* sysdeps/powerpc/powerpc64/fpu/s_llroundl.S: Removed.
	* sysdeps/powerpc/powerpc64/fpu/s_lrintl.S: Removed.
	* sysdeps/powerpc/powerpc64/fpu/s_lroundl.S: Removed.

2006-03-16  Roland McGrath  <roland@redhat.com>

	* wcsmbs/wchar.h (__wcstol_internal, __wcstoul_internal): Declare these
	 only when we will use them, under [__OPTIMIZE__ && __GNUC__ >= 2].
	(__wcstoll_internal, __wcstoull_internal_defined): Likewise.

2006-03-06  Steven Munroe  <sjmunroe@us.ibm.com>

	* sysdeps/powerpc/powerpc32/fpu/fprsave.S: Add cfi_offset for spilling
	of non-volatile floating-point registers to the stack (fp14-fp31).
	* sysdeps/powerpc/powerpc32/gprsave0.S: Add cfi_offset for spilling of
	non-volatile general-purpose registers to the stack (gpr13-gpr31).
	* sysdeps/powerpc/powerpc64/dl-trampoline.S: Add cfi_offset
	for non-volatiles gpr30 - grp31 spilled to the stack.
	* sysdeps/powerpc/powerpc64/memcpy.S: Add cfi_offset for non-volatile
	gpr31 spill to the stack.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/setcontext-common.S:
	Add cfi_offset for non-volatile gpr31 spill to the stack.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/clone.S: Add cfi_offset
	for non-volatiles gpr28 - grp31 spilled to the stack.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/getcontext.S: Add
	cfi_adjust_cfa_offset when a frame is stacked.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/setcontext.S:
	(__novec_setcontext) : Add cfi_offset for non-volatile gpr31 spill
	add LR saved to the stack.  Add cfi_adjust_cfa_offset when frame is
	stacked.
	(__setcontext) : Add cfi_offset for non-volatile gpr31 spill to
	the stack.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/swapcontext.S:
	(__novec_swapcontext) : Add cfi_offset for non-volatile gpr31 spill
	add LR saved to the stack.
	(__swapcontext) : Add cfi_offset for non-volatile gpr31 spill add LR
	saved to the stack.  Add cfi_adjust_cfa_offset when frame is stacked.

2006-03-07  Jakub Jelinek  <jakub@redhat.com>

	[BZ #2423]
	* math/libm-test.inc [TEST_LDOUBLE] (ceil_test, floor_test, rint_test,
	round_test, trunc_test): Only run some of the new tests if
	LDBL_MANT_DIG > 100.

2006-03-03  Steven Munroe  <sjmunroe@us.ibm.com>
	    Alan Modra  <amodra@bigpond.net.au>

	* sysdeps/powerpc/fpu/fenv_libc.h (__fegetround, __fesetround):
	Define inline implementations.
	* sysdeps/powerpc/fpu/fegetround.c: Use __fegetround.
	* sysdeps/powerpc/fpu/fesetround.c: Use __fesetround.

	* sysdeps/powerpc/fpu/math_ldbl.h: New file.

	[BZ #2423]
	* math/libm-test.inc [TEST_LDOUBLE] (ceil_test, floor_test, rint_test,
	round_test, trunc_test): Add new tests.
	* sysdeps/ieee754/ldbl-128ibm/math_ldbl.h
	(EXTRACT_IBM_EXTENDED_MANTISSA, INSERT_IBM_EXTENDED_MANTISSA):
	Removed, replaced with ...
	(ldbl_extract_mantissa, ldbl_insert_mantissa, ldbl_pack, ldbl_unpack,
	ldbl_canonicalise, ldbl_nearbyint): New functions.
	* sysdeps/ieee754/ldbl-128ibm/e_fmodl.c (__ieee754_fmodl): Replace
	EXTRACT_IBM_EXTENDED_MANTISSA and INSERT_IBM_EXTENDED_MANTISSA
	with ldbl_extract_mantissa and ldbl_insert_mantissa.
	* sysdeps/ieee754/ldbl-128ibm/e_rem_pio2l.c (__ieee754_rem_pio2l):
	Replace EXTRACT_IBM_EXTENDED_MANTISSA with ldbl_extract_mantissa.
	(ldbl_extract_mantissa, ldbl_insert_mantissa): New inline functions.
	* sysdeps/ieee754/ldbl-128ibm/s_ceill.c (__ceill): Handle rounding
	that spans doubles in IBM long double format.
	* sysdeps/ieee754/ldbl-128ibm/s_floorl.c: Likewise.
	* sysdeps/ieee754/ldbl-128ibm/s_rintl.c: Likewise.
	* sysdeps/ieee754/ldbl-128ibm/s_roundl.c: Likewise.
	* sysdeps/ieee754/ldbl-128ibm/s_truncl.c: Likewise.
	* sysdeps/powerpc/powerpc64/fpu/s_rintl.S: File removed.

2004-12-09  Randolph Chung  <tausq@debian.org>

	* sysdeps/unix/sysv/linux/kernel-features.h (__ASSUME_UTIMES): Don't
	define for hppa, which doesn't support this syscall.

2006-03-13  Jakub Jelinek  <jakub@redhat.com>

	[BZ #2451]
	* elf/dl-load.c (open_verify): Add free_name argument, if true, free
	name before calling lose.
	(open_path): Adjust caller.
	(_dl_map_object): Adjust callers.  Free name_copy before calling
	_dl_signal_error.
	* elf/Makefile: Add rules to build and run tst-leaks1.
	* elf/tst-leaks1.c: New test.

2006-03-06  Roland McGrath  <roland@redhat.com>

	* version.h (VERSION): 2.4
	* README.template: Update for 2.4.
	* README: Regenerated.
	* manual/install.texi (Configuring and compiling): Separate build
	directory is mandatory.  Use glibc-2.4 in example.
	Update --enable-add-ons description.
	(Supported Configurations): Remove section.
	* INSTALL: Regenerated.

	* sysdeps/unix/sysv/linux/x86_64/sysconf.c
	(handle_intel, handle_amd): Add __attribute__ ((noinline)).
	* sysdeps/unix/sysv/linux/i386/sysconf.c
	(handle_i486, handle_intel, handle_amd): Likewise.

	* sysdeps/unix/sysv/linux/i386/sysconf.c (__sysconf): Don't handle
	_SC_CPUTIME and _SC_THREAD_CPUTIME here.
	* sysdeps/unix/sysv/linux/x86_64/sysconf.c (__sysconf): Likewise.

2006-03-05  Roland McGrath  <roland@redhat.com>

	* malloc/malloc.c (MALLOC_ALIGNMENT): Revert to (2 * SIZE_SZ) value.
	The correct value differs only on powerpc32, and for now changing it
	there is causing more trouble than it's worth.

	* malloc/arena.c: Add compile-time sanity check on padding calculation.

2006-03-05  Jakub Jelinek  <jakub@redhat.com>

	* malloc/arena.c (heap_info): Adjust the padding size if
	MALLOC_ALIGNMENT > 2 * SIZE_SZ.

2006-03-05  Roland McGrath  <roland@frob.com>

	* sysdeps/mach/hurd/faccessat.c: New file.
	* sysdeps/mach/hurd/fchmodat.c: New file.
	* sysdeps/mach/hurd/fchownat.c: New file.
	* sysdeps/mach/hurd/fxstatat.c: New file.
	* sysdeps/mach/hurd/fxstatat64.c: New file.
	* sysdeps/mach/hurd/linkat.c: New file.
	* sysdeps/mach/hurd/mkdirat.c: New file.
	* sysdeps/mach/hurd/openat.c: New file.
	* sysdeps/mach/hurd/openat64.c: New file.
	* sysdeps/mach/hurd/symlinkat.c: New file.
	* sysdeps/mach/hurd/unlinkat.c: New file.
	* sysdeps/mach/hurd/xmknod.c (__xmknod): Just call __xmknodat.
	Guts move to ...
	* sysdeps/mach/hurd/xmknodat.c: ... here, new file.

	* hurd/lookup-at.c: New file.
	* hurd/Makefile (routines): Add it.
	* hurd/hurd/fd.h: Declare __file_name_lookup_at,
	__file_name_split_at and __directory_name_split_at.

	* hurd/hurd/lookup.h: Declare {,__}hurd_directory_name_split.

	* hurd/hurdlookup.c (__hurd_directory_name_split): Use __memrchr
	unconditionally.

	* sysdeps/mach/hurd/open.c: Define {,__,__libc_,}open64 as aliases.
	* sysdeps/mach/hurd/open64.c: New file.

	* sysdeps/posix/sysconf.c (__sysconf): Use #if _POSIX_FOO > 0
	rather than #ifdef _POSIX_FOO for options.  We should return -1
	at runtime for an option defined to 0 at compile time.

	* sysdeps/mach/hurd/bits/posix_opt.h: Define many missing options,
	many to -1 or 0.

2006-03-05  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/sysv/linux/sysconf.c (__sysconf)
	[__NR_clock_getres || HP_TIMING_AVAIL]: Handle _SC_CPUTIME,
	_SC_THREAD_CPUTIME.

2006-03-05  David S. Miller  <davem@sunset.davemloft.net>

	* sysdeps/sparc/sparc32/dl-trampoline.S: Add CFI markings.
	* sysdeps/sparc/sparc32/elf/start.S: Likewise.
	* sysdeps/sparc/sparc64/dl-trampoline.S: Likewise.
	* sysdeps/sparc/sparc64/elf/start.S: Likewise.
	* sysdeps/sparc/sparc32/memchr.S: Rearrange code to reside
	within ENTRY/END.
	* sysdeps/sparc/sparc32/memcpy.S: Likewise.
	* sysdeps/sparc/sparc32/stpcpy.S: Likewise.
	* sysdeps/sparc/sparc32/strcat.S: Likewise.
	* sysdeps/sparc/sparc32/strchr.S: Likewise.
	* sysdeps/sparc/sparc32/strcmp.S: Likewise.
	* sysdeps/sparc/sparc32/strcpy.S: Likewise.
	* sysdeps/sparc/sparc32/strlen.S: Likewise.
	* sysdeps/sparc/sparc64/memcpy.S: Likewise.
	* sysdeps/sparc/sparc64/sparcv9v/memset.S: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc32/clone.S: Add CFI markings
	and use __syscall_error.
	* sysdeps/unix/sysv/linux/sparc/sparc64/clone.S: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc64/brk.S: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc32/pipe.S: Use __syscall_error.
	* sysdeps/unix/sysv/linux/sparc/sparc64/pipe.S: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc32/socket.S: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc64/socket.S: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc32/syscall.S: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc64/syscall.S: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc32/sysdep.h: Rewrite to use
	CFI markings and __syscall_error.
	* sysdeps/unix/sysv/linux/sparc/sparc64/sysdep.h: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc64/setcontext.S: Rearrange
	code to reside within ENTRY/END.
	* sysdeps/unix/sysv/linux/sparc/sparc64/setjmp.S: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sysdep.c: New file.
	* sysdeps/unix/sysv/linux/sparc/sysdep.S: File removed.
	* sysdeps/unix/sysv/linux/sparc/rt-sysdep.c: New file.
	* sysdeps/unix/sysv/linux/sparc/Makefile (librt-routines): Add it.

	* shlib-versions: Use sparc64.*- for CPU patterns.

2006-03-05  Roland McGrath  <roland@frob.com>

	* bits/resource.h (RLIMIT_SBSIZE, RLIMIT_AS, RLIMIT_VMEM): Define.

	* sysdeps/mach/hurd/fdopendir.c (__fdopendir): Use O_DIRECTORY
	to force directory check.
	* sysdeps/mach/hurd/opendir.c (__opendir): Likewise.

2006-03-04  Roland McGrath  <roland@frob.com>

	* sysdeps/mach/hurd/i386/tls.h (_hurd_tls_init): Make sure high bits
	of SEL are clear after copying %gs to low bits.
	(_hurd_tls_fork): Likewise.

2006-03-03  Roland McGrath  <roland@redhat.com>

	[BZ #2414]
	* stdlib/tst-setcontext.c (f1): Take arguments of type int.

2006-03-02  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/alpha/sysdep.h (PTR_MANGLE): Use __typeof in cast.

2006-03-02  Daniel Jacobowitz  <dan@codesourcery.com>

	* sysdeps/unix/sysv/linux/configure.in: Remove MIPS cases.  Allow
	libc_cv_slibdir et al. to be overridden.
	* sysdeps/unix/sysv/linux/configure: Regenerated.

2005-12-27  Jakub Jelinek  <jakub@redhat.com>

	* elf/ldconfig.c (search_dir): Skip prelink temporaries.

2006-03-02  H.J. Lu  <hongjiu.lu@intel.com>

	* elf/check-textrel.c: Don't include "config.h".

2006-03-02  Jakub Jelinek  <jakub@redhat.com>

	* io/ftw.c (process_entry): If dir->streamfd != -1,
	use FXSTATAT rather than LXSTAT to find if unstatable
	file is a dead symlink.

	* elf/check-textrel.c: Include config.h.
	(AB(handle_file)): Don't fail if PF_X | PF_W on architectures known
	to have executable writable PLT.
	* sysdeps/powerpc/powerpc32/configure.in (HAVE_PPC_SECURE_PLT): New
	test.
	* config.h.in (HAVE_PPC_SECURE_PLT): Add.

	* malloc/malloc.c (MALLOC_ALIGNMENT): Set to __alignof__ (long double)
	if long double is more aligned than 2 * SIZE_SZ.
	(misaligned_chunk): Define.
	(public_rEALLOc, _int_free, _int_realloc): Use it.

2006-01-05  H.J. Lu  <hongjiu.lu@intel.com>

	[BZ #2013]
	* sysdeps/ia64/memccpy.S: Properly handle recovery for
	predicated speculative load.

2006-03-01  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/sparc/sparc64/fpu/libm-test-ulps: Update.

	* sysdeps/unix/sysv/linux/i386/fxstatat.c (__fxstatat64): Use
	libc_hidden_ver rather than libc_hidden_def.

	* sysdeps/sparc/sparc32/fpu/libm-test-ulps: Update.
	* sysdeps/sparc/fpu/fraiseexcpt.c (__feraiseexcept):
	Use inline asm to make sure the compiler doesn't optimize insns out.

	* sysdeps/unix/sysv/linux/s390/s390-64/sysdep.h
	(DECLARGS_6): Fix a typo.

2006-03-01  Roland McGrath  <roland@redhat.com>

	* version.h (VERSION): 2.3.91

	* Makeconfig (sysdeps-srcdirs): New variable.
	(sysdeps-add-ons-srcdirs): Use it.
	* csu/Makefile (all-Banner-files): Use it.

	* Makefile (dist-selector): New variable.
	(glibc-%.tar rule): Use it.  Make $(dist-separate) tarballs
	contain one version-named directory.

	* Makefile (format-me): Use  --plaintext --no-number-sections.

	* NOTES, INSTALL: Regenerated.

	* NEWS: Update 2.4 items.

2006-03-01  David S. Miller  <davem@sunset.davemloft.net>

	* configure.in (machine): Match sparcv9v and sparc64v.
	* configure: Regenerated.
	* sysdeps/sparc/sparc32/sparcv9v/memcpy.S: New file.
	* sysdeps/sparc/sparc32/sparcv9v/memset.S: New file.
	* sysdeps/sparc/sparc64/sparcv9v/memcpy.S: New file.
	* sysdeps/sparc/sparc64/sparcv9v/memset.S: New file.

2006-03-01  Roland McGrath  <roland@frob.com>

	* sysdeps/mach/hurd/Subdirs: Use "first hurd".

2006-02-28  Roland McGrath  <roland@redhat.com>

	* sysdeps/rs6000: Directory removed, saved in ports repository.

2006-03-01  Kaz Kojima  <kkojima@rr.iij4u.or.jp>

	* sysdeps/unix/sysv/linux/sh/pread.c: Copy in mips pread.c.
	* sysdeps/unix/sysv/linux/sh/pwrite.c: Copy in mips pwrite.c.
	* sysdeps/unix/sysv/linux/sh/pread64.c: Copy in mips pread64.c.
	* sysdeps/unix/sysv/linux/sh/pwrite64.c: Copy in mips pwrite64.c.

2006-02-28  Roland McGrath  <roland@redhat.com>

	* elf/tst-tls-dlinfo.c: New file.
	* elf/Makefile (tests): Add it.
	($(objpfx)tst-tls-dlinfo): Depend on $(libdl).
	($(objpfx)tst-tls-dlinfo.out): Depend on $(objpfx)tst-tlsmod2.so.

	* dlfcn/dlfcn.h (RTLD_DI_PROFILENAME, RTLD_DI_PROFILEOUT): New enum
	values, reserve unsupported requested names used on Solaris.
	(RTLD_DI_TLS_MODID, RTLD_DI_TLS_DATA): New enum values.
	(RTLD_DI_MAX): Likewise.
	* dlfcn/dlinfo.c (dlinfo_doit): Handle RTLD_DI_TLS_MODID and
	RTLD_DI_TLS_DATA.

	* elf/dl-tls.c (_dl_tls_get_addr_soft): New function.
	* sysdeps/generic/ldsodefs.h: Declare it.
	* elf/Versions (ld: GLIBC_PRIVATE): Add it.
	* elf/link.h (struct dl_phdr_info): New members dlpi_tls_modid,
	dlpi_tls_data.
	* elf/dl-iteratephdr.c (__dl_iterate_phdr): Fill them in.

	* include/link.h: Don't copy contents from elf/link.h.
	Instead, #include it while #define'ing around link_map.
	* elf/dl-debug.c (_dl_debug_initialize): Add a cast.
	Add bogus extern decl to verify link_map members.
	* elf/loadtest.c (MAPS): New macro, cast _r_debug._r_map.
	(OUT, main): Use it in place of _r_debug._r_map.
	* elf/unload.c: Likewise.
	* elf/unload2.c: Likewise.
	* elf/neededtest.c (check_loaded_objects): Likewise.
	* elf/neededtest2.c (check_loaded_objects): Likewise.
	* elf/neededtest3.c (check_loaded_objects): Likewise.
	* elf/neededtest4.c (check_loaded_objects): Likewise.
	* elf/circleload1.c (check_loaded_objects): Likewise.

	* nscd/nscd_helper.c: Include <time.h> for `time' declaration.

	* include/fcntl.h: Declare __openat, __open64.  Use libc_hidden_proto.
	* io/openat.c (__openat): Define instead of openat.
	Use libc_hidden_def.  Define openat with weak_alias.
	* io/openat64.c (__openat64): Define instead of openat64.
	Use libc_hidden_def.  Define openat64 with weak_alias.
	* sysdeps/unix/sysv/linux/openat.c: Likewise.

	* libio/genops.c: Include <sched.h> for __sched_yield decl.

	* Makeconfig (+includes): Add back $(includes)
	after $(+sysdep-includes).

	* Makerules ($(common-objpfx)%.make): Use -DASSEMBLER.

2006-02-28  Jakub Jelinek  <jakub@redhat.com>

	* posix/sys/types.h [!__GNUC_PREREQ (2, 7)] (int64_t, u_int64_t):
	typedef to long int resp. unsigned long int on 64-bit arches.

	* sysdeps/unix/sysv/linux/powerpc/powerpc64/umount.c: Include x86_64
	umount.c rather than hppa umount.c.
	* sysdeps/unix/sysv/linux/sparc/sparc32/chown.c: Include sh chown.c
	rather than m68k chown.c.
	* sysdeps/unix/sysv/linux/sparc/sparc32/fchownat.c: Include sh
	fchownat.c rather than m68k fchownat.c.
	* sysdeps/unix/sysv/linux/sh/chown.c: Copy over from m68k chown.c.
	* sysdeps/unix/sysv/linux/sh/fchownat.c: Copy over from m68k
	fchownat.c.
	* sysdeps/unix/sysv/linux/x86_64/brk.c: Copy over from hppa brk.c.
	* sysdeps/unix/sysv/linux/x86_64/umount.c: Copy over from hppa
	umount.c.

2006-02-28  Roland McGrath  <roland@redhat.com>

	* sysdeps/hppa: Directory removed, saved in ports repository.
	* sysdeps/mach/hppa: Likewise.
	* sysdeps/mach/hurd/hppa: Likewise.
	* sysdeps/unix/sysv/linux/hppa: Likewise.
	* configure.in (machine): Remove hppa* cases.
	* configure: Regenerated.
	* shlib-versions: Remove hppa cases.

	* sysdeps/m68k: Directory removed, saved in ports repository.
	* sysdeps/unix/bsd/m68k: Likewise.
	* sysdeps/unix/sysv/linux/m68k: Likewise.
	* configure.in (machine): Remove m68* cases.
	* configure: Regenerated.

	* elf/rtld-Rules (subdir-args): New variable.
	(rtld-subdir-make): Use it.

2006-02-22  Martin Schwidefsky  <schwidefsky@de.ibm.com>

	* sysdeps/unix/sysv/linux/s390/s390-32/sysdep.h
	(DO_CALL): Add support for 6 system call parameters.
	(DECLARGS_6, ASMFMT_6): Define.
	* sysdeps/unix/sysv/linux/s390/s390-64/sysdep.h: Likewise.

2006-02-28  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/sysv/linux/sh/bits/fcntl.h: Copy in i386/bits/fcntl.h.

2006-02-27  Roland McGrath  <roland@redhat.com>

	* scripts/config.guess: Update from master, timestamp='2006-02-27'.
	* scripts/config.sub: Update from master, timestamp='2006-02-27'.

	* Makefile (subdir-target-args): New variable.
	($(all-subdirs-targets)): Use it in place of -C option.
	* Rules: Use $(..) instead of ../ if it's already defined.
	* Makeconfig (subdir-srcdirs): New variable.
	* csu/Makefile (all-Banner-files): Use it.

	* configure.in (--enable-add-ons): Set to "yes" by default.
	Handle absolute add-on directory names when looking for configure
	fragments.  Also look for sysdeps/*/preconfigure fragments in add-ons.
	Require add-on configure to set $libc_add_on_canonical, use
	that in $add_ons_sfx.  Substitute add_on_subdirs with computed list
	of subdir names each add-on configure set in libc_add_on_subdirs.
	* configure: Regenerated.
	* Makefile (%/preconfigure: %/preconfigure.in): New pattern rule.
	* config.make.in (add-on-subdirs): New substituted variable.
	* Makeconfig (all-subdirs): Include $(add-on-subdirs).
	Remove $(add-ons), $(sysdep-subdirs).
	Don't filter out $(sysdep-inhibit-subdirs).
	($(common-objpfx)sysd-dirs): Target removed.  Don't include it.
	($(common-objpfx)sysd-sorted): Rewritten to feed Depend and Subdirs
	files together to gen-sorted.awk, and $(subdirs) via -v.
	(subdirs): Remove magic reordering for mach and hurd.
	* scripts/gen-sorted.awk: Use subdirs from command line.
	Process Subdirs and Depend files directly.
	Let Subdirs files use "first dir" and "inhibit dir".
	Always move elf to the end of the list.
	* hurd/Depend: New file.
	* sysdeps/mach/Subdirs: Use "first mach".

	* Makefile (dist-separate): Remove linuxthreads.
	(dist-separate-linuxthreads): Variable removed.
	(glibc-%.tar rule): Use $(sysdeps-add-ons).

	* Makerules ($(common-objpfx)Versions.v.i): Use $(subdirs),
	not $(all-subdirs).
	(sysdep-makefiles): Use $(sysdirs).
	(sysdirs): Remove export.
	($(+sysdir_pfx)sysd-rules): Handle absolute directory names in
	$(config-sysdirs).
	(+sysdir_pfx): Variable removed.
	(sysd-rules): Use $(common-objpfx) in place of it.
	(sysdirs): Variable moved to ...
	* Makeconfig (sysdirs): ... here.
	Handle absolute directory names in $(config-sysdirs).
	(full_config_sysdirs): Variable removed.
	* csu/Makefile: Use $(sysdirs) in vpath directive.
	* math/Makefile (ulps-file): Use $(sysdirs).
	* sysdeps/gnu/Makefile (errlist-c): Likewise.
	($(objpfx)errlist-compat.c): Likewise.
	* Makeconfig (all-Subdirs-files): Likewise.
	($(common-objpfx)config.status): Likewise.

	* configure.in (sysnames): Handle absolute add-on directory names.
	(sysdeps_add_ons): New variable, AC_SUBST it.
	Compute which add-ons contributed sysdeps directories.
	* configure: Regenerated.
	* config.make.in (sysdeps-add-ons): New substituted variable.
	* Makerules (+sysdep_dirs, +sysdep-includes): Variables moved ...
	* Makeconfig: ... to here.
	(+sysdep_dirs): Append $(sysdeps-add-ons) here.
	(+includes): Remove $(objpfx) include, already in $(+sysdep_dirs).
	Remove $(includes).
	(sysdep-makeconfigs): Use $(+sysdep_dirs).
	($(common-objpfx)shlib-versions.v.i): Likewise.

	* Makeconfig: Remove hair to set Makeconfig-add-on.

	* sysdeps/unix/Makefile (sysdirs): Remove export.
	(asm_CPP): Variable removed.
	($(common-objpfx)sysd-syscalls): Pass them directly for the script.

	* sysdeps/posix/Makefile: New file.
	* Makerules (L_tmpnam, TMP_MAX, L_ctermid, L_cuserid): Set non-posix
	values here with ?=.

	* stdlib/gen-mpn-copy: File removed.
	* stdlib/Makefile (distribute): Remove it.
	* configure.in: Don't grok --with-gmp.
	* configure: Regenerated.

	* configure.in (libc_cv_idn): Don't check it; libidn/configure does it.
	* configure: Regenerated.

2006-02-27  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/linkat.c (linkat): Allow flags to be set
	when syscall is used.
	* io/fcntl.h (AT_SYMLINK_FOLLOW): Define.

2006-02-26  Roland McGrath  <roland@redhat.com>

	* bare: Directory removed, saved in ports repository.

	* sysdeps/unix/common/Makefile: File removed.
	* sysdeps/unix/common/glue-ctype.c: File removed.
	* sysdeps/unix/common/configure.in: File removed.
	* sysdeps/unix/common/configure: File removed.

	* sysdeps/unix/configure.in: File removed.
	* sysdeps/unix/configure: File removed.
	* sysdeps/unix/make_errlist.c: File removed.
	* sysdeps/unix/Makefile ($(objpfx)errlist.c, $(objpfx)make_errlist):
	Rules removed.

	* timezone/africa: Update from tzdata2006b (comment changes only).
	* timezone/antarctica: Likewise.
	* timezone/asia: Likewise.
	* timezone/australasia: Likewise.
	* timezone/backward: Likewise.
	* timezone/etcetera: Likewise.
	* timezone/europe: Likewise.
	* timezone/factory: Likewise.
	* timezone/iso3166.tab: Likewise.
	* timezone/leapseconds: Likewise.
	* timezone/northamerica: Likewise.
	* timezone/pacificnew: Likewise.
	* timezone/solar87: Likewise.
	* timezone/solar88: Likewise.
	* timezone/solar89: Likewise.
	* timezone/southamerica: Likewise.
	* timezone/systemv: Likewise.
	* timezone/zone.tab: Likewise.

2006-02-26  Ulrich Drepper  <drepper@redhat.com>

	* posix/unistd.h: Add fifth parameter to linkat.
	* io/linkat.c: Likewise.
	* sysdeps/unix/sysv/linux/linkat.c: Likewise.
	* io/tst-linkat.c (do_test): Pass new parameter to linkat.

	* elf/do-lookup.h (do_lookup_x): No need to compare SKIP to NULL
	before comparison with MAP.

	* elf/dl-sym.c (do_sym): For RTLD_NEXT, pass MATCH to
	dl_lookup_symbol_x instead of L.

2006-02-24  Mike Frysinger  <vapier@gentoo.org>

	* sysdeps/gnu/net/if.h (IFF_DYNAMIC): New macro.

2006-02-24  David S. Miller  <davem@sunset.davemloft.net>

	* configure.in: Use sparc/sparc32/sparcv9/sparcv9b in place
	of sparc/sparc32/sparcv9b.
	* sysdeps/sparc/sparc32/sparcv9b/Implies: File removed.
	* sysdeps/unix/sysv/linux/sparc/sparc32/sparcv9b/Implies: File removed.

2006-02-24  Roland McGrath  <roland@redhat.com>

	* elf/elf.h (HWCAP_SPARC_BLKINIT): New macro.
	* sysdeps/sparc/dl-procinfo.h (HWCAP_IMPORTANT): Add it.
	(_DL_HWCAP_COUNT): Increase to 7.
	* sysdeps/sparc/dl-procinfo.c (_dl_sparc_cap_flags): Add "v9v".
	From David S. Miller <davem@sunset.davemloft.net>.

	* sysdeps/unix/sysv/linux/sparc/sparc64/dl-procinfo.c: Moved to ...
	* sysdeps/sparc/dl-procinfo.c: ... here, new file.
	* sysdeps/unix/sysv/linux/sparc/sparc64/dl-procinfo.h: Moved to ...
	* sysdeps/sparc/dl-procinfo.h: ... here, new file.
	(HWCAP_IMPORTANT): Include HWCAP_SPARC_V9 when [__WORDSIZE != 64].
	* sysdeps/unix/sysv/linux/sparc/sparc32/dl-procinfo.c: File removed.
	* sysdeps/unix/sysv/linux/sparc/sparc32/dl-procinfo.h: File removed.

	* elf/sofini.c (__FRAME_END__): Mark as const.
	* elf/soinit.c (__EH_FRAME_BEGIN__): Likewise.  Add used attribute.

2006-02-18  Joseph S. Myers  <joseph@codesourcery.com>

	* soft-fp/single.h (SFtype): Define.
	(union _FP_UNION_S): Use it.
	* soft-fp/double.h (DFtype): Define.
	(union _FP_UNION_D): Use it.
	* soft-fp/extended.h (XFtype): Define.
	(union _FP_UNION_E): Use it.
	* soft-fp/quad.h (TFtype): Define.
	(union _FP_UNION_Q): Use it.
	* soft-fp/soft-fp.h: Add _LIBC conditionals.
	(SI_BITS, DI_BITS): Define.
	* soft-fp/op-common.h (_FP_DECL): Add __attribute__((unused)) for
	X##_c.
	(_FP_CMP_EQ): Use parentheses for && inside ||.
	(_FP_TO_INT): Use statement expressions in conditional controlling
	constant shift.
	(_FP_FROM_INT): Likewise.  Take unsigned type as argument.
	* soft-fp/op-2.h (_FP_FRAC_SLL_2, _FP_FRAC_SRL_2, _FP_FRAC_SRST_2,
	_FP_FRAC_SRS_2, _FP_FRAC_ASSEMBLE_2): Use statement expressions in
	conditional controlling possibly constant shift.
	(_FP_FRAC_SRST_2, _FP_FRAC_SRS_2): Avoid left shift by exactly
	_FP_W_TYPE_SIZE.
	(_FP_FRAC_GT_2, _FP_FRAC_GE_2): Use parentheses for && inside ||.
	* soft-fp/op-4.h (_FP_FRAC_SRST_4): Avoid left shift by exactly
	_FP_W_TYPE_SIZE.
	(__FP_FRAC_ADD_3, __FP_FRAC_ADD_4, __FP_FRAC_SUB_3,
	__FP_FRAC_SUB_4): Use _FP_W_TYPE for carry flags.
	* soft-fp/op-8.h (_FP_FRAC_SRS_8): Avoid left shift by exactly
	_FP_W_TYPE_SIZE.
	* soft-fp/floatdidf.c: Pass unsigned type and macro for type size.
	* soft-fp/floatdisf.c: Likewise.
	* soft-fp/floatditf.c: Likewise.
	* soft-fp/floatsidf.c: Likewise.
	* soft-fp/floatsisf.c: Likewise.
	* soft-fp/floatsitf.c: Likewise.
	* soft-fp/floatundidf.c: Likewise.
	* soft-fp/floatundisf.c: Likewise.
	* soft-fp/floatunditf.c: Likewise.
	* soft-fp/floatunsidf.c: Likewise.
	* soft-fp/floatunsisf.c: Likewise.
	* soft-fp/floatunsitf.c: Likewise.
	* soft-fp/fixdfdi.c: Pass macro for type size.
	* soft-fp/fixdfsi.c: Likewise.
	* soft-fp/fixsfdi.c: Likewise.
	* soft-fp/fixsfsi.c: Likewise.
	* soft-fp/fixtfdi.c: Likewise.
	* soft-fp/fixtfsi.c: Likewise.
	* soft-fp/fixunsdfdi.c: Likewise.
	* soft-fp/fixunsdfsi.c: Likewise.
	* soft-fp/fixunssfdi.c: Likewise.
	* soft-fp/fixunssfsi.c: Likewise.
	* soft-fp/fixunstfdi.c: Likewise.
	* soft-fp/fixunstfsi.c: Likewise.
	* sysdeps/alpha/soft-fp/ots_cvtqux.c: Pass unsigned type.
	* sysdeps/alpha/soft-fp/ots_cvtqx.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_itoq.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_lltoq.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_ulltoq.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_utoq.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_itoq.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_lltoq.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_ulltoq.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_utoq.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_itoq.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_uitoq.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_uxtoq.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_xtoq.c: Likewise.
	* soft-fp/adddf3.c: Use typedefs for argument and return types.
        * soft-fp/addsf3.c: Likewise.
        * soft-fp/addtf3.c: Likewise.
        * soft-fp/divdf3.c: Likewise.
        * soft-fp/divsf3.c: Likewise.
        * soft-fp/divtf3.c: Likewise.
        * soft-fp/eqdf2.c: Likewise.
        * soft-fp/eqsf2.c: Likewise.
        * soft-fp/eqtf2.c: Likewise.
        * soft-fp/extenddftf2.c: Likewise.
        * soft-fp/extendsfdf2.c: Likewise.
        * soft-fp/extendsftf2.c: Likewise.
        * soft-fp/fixdfdi.c: Likewise.
        * soft-fp/fixdfsi.c: Likewise.
        * soft-fp/fixsfdi.c: Likewise.
        * soft-fp/fixsfsi.c: Likewise.
        * soft-fp/fixtfdi.c: Likewise.
        * soft-fp/fixtfsi.c: Likewise.
        * soft-fp/fixunsdfdi.c: Likewise.
        * soft-fp/fixunsdfsi.c: Likewise.
        * soft-fp/fixunssfdi.c: Likewise.
        * soft-fp/fixunssfsi.c: Likewise.
        * soft-fp/fixunstfdi.c: Likewise.
        * soft-fp/fixunstfsi.c: Likewise.
        * soft-fp/floatdidf.c: Likewise.
        * soft-fp/floatdisf.c: Likewise.
        * soft-fp/floatditf.c: Likewise.
        * soft-fp/floatsidf.c: Likewise.
        * soft-fp/floatsisf.c: Likewise.
        * soft-fp/floatsitf.c: Likewise.
        * soft-fp/floatundidf.c: Likewise.
        * soft-fp/floatundisf.c: Likewise.
        * soft-fp/floatunditf.c: Likewise.
        * soft-fp/floatunsidf.c: Likewise.
        * soft-fp/floatunsisf.c: Likewise.
        * soft-fp/floatunsitf.c: Likewise.
        * soft-fp/gedf2.c: Likewise.
        * soft-fp/gesf2.c: Likewise.
        * soft-fp/getf2.c: Likewise.
        * soft-fp/ledf2.c: Likewise.
        * soft-fp/lesf2.c: Likewise.
        * soft-fp/letf2.c: Likewise.
        * soft-fp/muldf3.c: Likewise.
        * soft-fp/mulsf3.c: Likewise.
        * soft-fp/multf3.c: Likewise.
        * soft-fp/negdf2.c: Likewise.
        * soft-fp/negsf2.c: Likewise.
        * soft-fp/negtf2.c: Likewise.
        * soft-fp/sqrtdf2.c: Likewise.
        * soft-fp/sqrtsf2.c: Likewise.
        * soft-fp/sqrttf2.c: Likewise.
        * soft-fp/subdf3.c: Likewise.
        * soft-fp/subsf3.c: Likewise.
        * soft-fp/subtf3.c: Likewise.
        * soft-fp/truncdfsf2.c: Likewise.
        * soft-fp/trunctfdf2.c: Likewise.
        * soft-fp/trunctfsf2.c: Likewise.
        * soft-fp/unorddf2.c: Likewise.
        * soft-fp/unordsf2.c: Likewise.
        * soft-fp/unordtf2.c: Likewise.

2006-02-09  Joseph S. Myers  <joseph@codesourcery.com>

	* soft-fp/op-common.h (_FP_UNPACK_SEMIRAW): Define.
	(_FP_OVERFLOW_SEMIRAW): Likewise.
	(_FP_CHECK_SIGNAN_SEMIRAW): Likewise.
	(_FP_CHOOSENAN_SEMIRAW): Likewise.
	(_FP_EXP_NORMAL): Likewise.
	(_FP_PACK_SEMIRAW): Likewise.
	(_FP_ADD_INTERNAL): Rewrite to operate on semi-raw value.
	(_FP_SUB): Likewise.
	(_FP_TO_INT): Rewrite to operate on raw values.  Don't set INVALID
	exception for conversions where most negative representable
	integer is correct truncated value, but do set INEXACT for such
	conversions where appropriate.  Don't always left-shift for
	converting to a wider integer.
	(_FP_FROM_INT): Rewrite to yield raw value.  Correct shift for
	integers with one more bits than (mantissa + guard) bits for the
	floating point format.  Don't use __FP_FRAC_SRS_1 for shifting
	integers that may be wider than _FP_W_TYPE_SIZE.
	(FP_CONV): Don't define.
	(FP_EXTEND): Define.
	(FP_TRUNC): Likewise.
	* soft-fp/op-1.h (_FP_FRAC_SRST_1, __FP_FRAC_SRST_1): Define.
	(_FP_FRAC_CONV_1_1): Don't define.
	(_FP_FRAC_COPY_1_1): Define.
	* soft-fp/op-2.h (_FP_FRAC_SRST_2): Define.
	(_FP_FRAC_CONV_1_2, _FP_FRAC_CONV_2_1): Don't define.
	(_FP_FRAC_COPY_1_2, _FP_FRAC_COPY_2_1): Define.
	* soft-fp/op-4.h (_FP_FRAC_SRST_4): Define.
	(_FP_FRAC_SRS_4): Define based on _FP_FRAC_SRST_4.
	(_FP_FRAC_CONV_1_4, _FP_FRAC_CONV_2_4): Don't define.
	(_FP_FRAC_COPY_1_4, _FP_FRAC_COPY_2_4): Define.
	(_FP_FRAC_CONV_4_1, _FP_FRAC_CONV_4_2): Don't define.
	(_FP_FRAC_COPY_4_1, _FP_FRAC_COPY_4_2): Define.
	* soft-fp/single.h (_FP_FRACTBITS_S): Define.
	(_FP_FRACXBITS_S): Define in terms of _FP_FRACXBITS_S.
	(_FP_WFRACXBITS_S): Likewise.
	(_FP_QNANBIT_SH_S, _FP_IMPLBIT_SH_S): Define.
	(FP_UNPACK_SEMIRAW_S, FP_UNPACK_SEMIRAW_SP): Define.
	(FP_PACK_SEMIRAW_S, FP_PACK_SEMIRAW_SP): Define.
	* soft-fp/double.h (_FP_QNANBIT_SH_D, _FP_IMPLBIT_SH_D): Define.
	(FP_UNPACK_SEMIRAW_D, FP_UNPACK_SEMIRAW_D): Define
	(FP_PACK_SEMIRAW_D, FP_PACK_SEMIRAW_DP): Define.
	* soft-fp/extended.h (_FP_QNANBIT_SH_E, _FP_IMPLBIT_SH_E): Define.
	(FP_UNPACK_EP): Correct typo.
	(FP_UNPACK_SEMIRAW_E, FP_UNPACK_SEMIRAW_EP): Define.
	(FP_PACK_SEMIRAW_E, FP_PACK_SEMIRAW_EP): Define.
	* soft-fp/quad.h (_FP_QNANBIT_SH_Q, _FP_IMPLBIT_SH_Q): Define.
	(FP_UNPACK_SEMIRAW_Q, FP_UNPACK_SEMIRAW_QP): Define.
	(FP_PACK_SEMIRAW_Q, FP_PACK_SEMIRAW_QP): Define.
	* soft-fp/fixdfdi.c: Use unsigned type for result of conversion.
	* soft-fp/fixdfsi.c: Likewise.
	* soft-fp/fixsfdi.c: Likewise.
	* soft-fp/fixsfsi.c: Likewise.
	* soft-fp/fixtfdi.c: Likewise.
	* soft-fp/fixtfsi.c: Likewise.
	* sysdeps/alpha/soft-fp/ots_cvtxq.c: Likewise.
	* sysdeps/alpha/soft-fp/ots_nintxq.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_qtoi.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_qtoll.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_qtoi.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_qtoll.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_qtoi.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_qtox.c: Likewise.
	* soft-fp/adddf3.c: Update for changed soft-fp interfaces.
	* soft-fp/addsf3.c: Likewise.
	* soft-fp/addtf3.c: Likewise.
	* soft-fp/extenddftf2.c: Likewise.
	* soft-fp/extendsfdf2.c: Likewise.
	* soft-fp/extendsftf2.c: Likewise.
	* soft-fp/fixdfdi.c: Likewise.
	* soft-fp/fixdfsi.c: Likewise.
	* soft-fp/fixsfdi.c: Likewise.
	* soft-fp/fixsfsi.c: Likewise.
	* soft-fp/fixtfdi.c: Likewise.
	* soft-fp/fixtfsi.c: Likewise.
	* soft-fp/fixunsdfdi.c: Likewise.
	* soft-fp/fixunsdfsi.c: Likewise.
	* soft-fp/fixunssfdi.c: Likewise.
	* soft-fp/fixunssfsi.c: Likewise.
	* soft-fp/fixunstfdi.c: Likewise.
	* soft-fp/fixunstfsi.c: Likewise.
	* soft-fp/floatdidf.c: Likewise.
	* soft-fp/floatdisf.c: Likewise.
	* soft-fp/floatditf.c: Likewise.
	* soft-fp/floatsidf.c: Likewise.
	* soft-fp/floatsisf.c: Likewise.
	* soft-fp/floatsitf.c: Likewise.
	* soft-fp/floatundidf.c: Likewise.
	* soft-fp/floatundisf.c: Likewise.
	* soft-fp/floatunditf.c: Likewise.
	* soft-fp/floatunsidf.c: Likewise.
	* soft-fp/floatunsisf.c: Likewise.
	* soft-fp/floatunsitf.c: Likewise.
	* soft-fp/subdf3.c: Likewise.
	* soft-fp/subsf3.c: Likewise.
	* soft-fp/subtf3.c: Likewise.
	* soft-fp/truncdfsf2.c: Likewise.
	* soft-fp/trunctfdf2.c: Likewise.
	* soft-fp/trunctfsf2.c: Likewise.
	* sysdeps/alpha/soft-fp/ots_add.c: Likewise.
	* sysdeps/alpha/soft-fp/ots_cvtqux.c: Likewise.
	* sysdeps/alpha/soft-fp/ots_cvtqx.c: Likewise.
	* sysdeps/alpha/soft-fp/ots_cvttx.c: Likewise.
	* sysdeps/alpha/soft-fp/ots_cvtxq.c: Likewise.
	* sysdeps/alpha/soft-fp/ots_cvtxt.c: Likewise.
	* sysdeps/alpha/soft-fp/ots_nintxq.c: Likewise.
	* sysdeps/alpha/soft-fp/ots_sub.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_add.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_dtoq.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_itoq.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_lltoq.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_qtod.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_qtoi.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_qtoll.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_qtos.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_qtou.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_qtoull.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_stoq.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_sub.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_ulltoq.c: Likewise.
	* sysdeps/powerpc/soft-fp/q_utoq.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_add.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_dtoq.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_itoq.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_lltoq.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_qtod.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_qtoi.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_qtoll.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_qtos.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_qtou.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_qtoull.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_stoq.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_sub.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_ulltoq.c: Likewise.
	* sysdeps/sparc/sparc32/soft-fp/q_utoq.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_add.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_dtoq.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_itoq.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_qtod.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_qtoi.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_qtos.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_qtoui.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_qtoux.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_qtox.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_stoq.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_sub.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_uitoq.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_uxtoq.c: Likewise.
	* sysdeps/sparc/sparc64/soft-fp/qp_xtoq.c: Likewise.

2006-02-23  Roland McGrath  <roland@redhat.com>

	* include/libc-symbols.h: Fix comment typo.
	From Peter Kjellerstedt <peter.kjellerstedt@axis.com>.

	* sysdeps/unix/sysv/linux/i386/fchownat.c: Diddle code so that "fail"
	label is always used.

	[BZ #2172]
	* bits/syslog-path.h: New file.
	* misc/Makefile (headers): Add it.
	* misc/sys/syslog.h: Include it.
	(_PATH_LOG): Macro removed.
	From Robert Millan <robertmh@gnu.org>.

	* sysdeps/unix/sysv/linux/ftruncate64.c: Find generic implementation
	in misc/, not posix/.
	Reported by David S. Miller <davem@davemloft.net>.

2006-02-23  Jakub Jelinek  <jakub@redhat.com>

	* posix/sched_yield.c (__sched_yield): Add libc_hidden_def.
	* sysdeps/mach/sched_yield.c (__sched_yield): Likewise.

2006-02-22  Roland McGrath  <roland@redhat.com>

	* po/libc.pot: Regenerated.

2006-02-22  Jakub Jelinek  <jakub@redhat.com>

	* nis/ypclnt.c (yperr_string, ypbinderr_string): Add N_()
	around string literals.

2005-10-03  Jakub Jelinek  <jakub@redhat.com>

	* nscd/selinux.c (audit_init): Print error string in the failure
	message.

2006-02-21  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/sysv/linux/kernel-features.h
	(__ASSUME_CLONE_THREAD_FLAGS): Consolidate definitions.

	* sysdeps/unix/sysv/linux/x86_64/sys/epoll.h: Update comment, remove
	__THROW from epoll_wait, to match .../linux/sys/epoll.h file.

2006-02-03  Jakub Jelinek  <jakub@redhat.com>

	* manual/filesys.texi (futimes): Fix prototype.

2004-08-09  Paul Eggert  <eggert@cs.ucla.edu>

	[BZ #315]
	* manual/memory.texi (Obstacks Data Alignment): The default
	alignment is not 4: it is enough to hold any type of data.
	Problem reported by Benno in
	<http://sources.redhat.com/ml/libc-alpha/2004-08/msg00055.html>.

2005-11-15  Robert Millan  <robertmh@gnu.org>

	[BZ #2161]
	* manual/llio.texi (read, write): Document EINVAL on unaligned access.

2006-02-21  Roland McGrath  <roland@redhat.com>

	* sysdeps/i386/i686/memset.S: Fix treatment of unaligned pointer.
	Reported by John Zulauf <john.zulauf@amd.com>.

2004-11-23  Richard Sandiford  <rsandifo@redhat.com>

	* configure.in (libc_cv_gcc_dwarf2_unwind_info): Delete.
	(HAVE_DWARF2_UNWIND_INFO{,_STATIC}): Remove AC_DEFINEs.
	* configure: Regenerate.
	* config.h.in (HAVE_DWARF2_UNWIND_INFO{,_STATIC}): Remove undefs.
	* elf/soinit.c: Don't include gccframe.h.
	(__EH_FRAME_BEGIN__): Define unconditionally.
	(__register_frame_info, __deregister_frame_info)
	(__register_frame_info_bases, __deregister_frame_info_bases)
	(__register_frame, __deregister_frame): Remove declarations.
	(__libc_global_ctors, __libc_fini): Don't call registry functions.
	* elf/sofini.c (__EH_FRAME_END__): Define unconditionally.

2006-01-18  Samuel Thibault  <samuel.thibault@ens-lyon.org>

	[BZ #2178]
	* sysdeps/mach/hurd/getsid.c (getsid): When parameter PID is zero,
	use _hurd_pid instead.

2006-02-20  Richard Henderson  <rth@redhat.com>

	* sysdeps/alpha/soft-fp/Makefile (CPPFLAGS): Add soft-fp include
	to math subdir.
	* sysdeps/alpha/soft-fp/e_sqrtl.c: Don't use local-soft-fp.h.
	(__ieee754_sqrtl): Add _round local variable.
	* sysdeps/unix/sysv/linux/alpha/fpu/Implies: Remove.

	* sysdeps/unix/sysv/linux/alpha/fxstatat.c: Fix hidden defs.

2006-02-20  Roland McGrath  <roland@redhat.com>

	* sysdeps/mips: Directory removed, saved in ports repository.
	* sysdeps/unix/mips: Likewise.
	* sysdeps/unix/sysv/linux/mips: Likewise.
	* sysdeps/mach/mips: Likewise.
	* sysdeps/mach/hurd/mips: Likewise.
	* shlib-versions: Remove mips matches, now in ports fragment.
	* sysdeps/unix/sysv/linux/kernel-features.h: Likewise.
	* configure.in (machine): Likewise.
	* configure: Regenerated.

	* hurd/hurd/xattr.h: New file.
	* hurd/xattr.c: New file.
	* hurd/Makefile (routines): Add it.
	* sysdeps/mach/hurd/fgetxattr.c: New file.
	* sysdeps/mach/hurd/flistxattr.c: New file.
	* sysdeps/mach/hurd/fremovexattr.c: New file.
	* sysdeps/mach/hurd/fsetxattr.c: New file.
	* sysdeps/mach/hurd/getxattr.c: New file.
	* sysdeps/mach/hurd/lgetxattr.c: New file.
	* sysdeps/mach/hurd/listxattr.c: New file.
	* sysdeps/mach/hurd/lsetxattr.c: New file.
	* sysdeps/mach/hurd/removexattr.c: New file.
	* sysdeps/mach/hurd/setxattr.c: New file.

2006-02-15  Thomas Schwinge  <tschwinge@gnu.org>

	[BZ #2329]
	* include/unistd.h (__getresuid, __getresgid, __setresuid)
	(__setresgid): Fix argument name order in prototypes.
	* posix/unistd.h (getresuid, getresgid, setresuid, setresgid):
	Likewise.
	* posix/getresuid.c (__getresuid): Fix argument order in definition.
	* posix/getresgid.c (__getresgid): Likewise.
	* posix/setresuid.c (__setresuid): Likewise.
	* posix/setresgid.c (__setresgid): Likewise.
	* sysdeps/mach/hurd/getresuid.c (__getresuid): Likewise.
	* sysdeps/mach/hurd/getresgid.c (__getresgid): Likewise.
	* sysdeps/mach/hurd/setresuid.c (__setresuid): Likewise.
	* sysdeps/mach/hurd/setresgid.c (__setresgid): Likewise.
	Reported by Samuel Thibault <samuel.thibault@ens-lyon.org>.

2006-02-13  Mike Frysinger  <vapier@gentoo.org>

	[BZ #2380]
	* string/tester.c (test_strnlen): New function.
	(test_strchr): Call it.
	(test_strncat): Test lengths where the sign bit is set.
	(test_strncmp): Likewise.

2006-02-17  Jakub Jelinek  <jakub@redhat.com>

	* include/atomic.h (atomic_and, atomic_or): Define.

2006-02-15  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/sparc/bits/mman.h: Define MADV_DONTFORK
	and MADV_DOFORK.
	* sysdeps/unix/sysv/linux/ia64/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/sh/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/i386/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/s390/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/alpha/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/m68k/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/bits/mman.h: Likewise.

2006-02-13  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/not-cancel.h (__openat_not_cancel,
	__openat64_not_cancel): Remove prototypes.
	(__openat_nocancel, __openat64_nocancel): New prototypes or defines.
	(openat_not_cancel, openat_not_cancel_3, openat64_not_cancel,
	openat64_not_cancel_3): Use them.

2006-02-12  Ulrich Drepper  <drepper@redhat.com>

	* io/ftw.c: Start using *at functions.
	* io/ftw64.c: Likewise.

	* sysdeps/generic/not-cancel.h: Define openat_not_cancel,
	openat_not_cancel_3, openat64_not_cancel, and openat64_not_cancel_3.
	* sysdeps/unix/sysv/linux/not-cancel.h: Likewise.

	* sysdeps/unix/sysv/linux/openat.c: Create separate _nocancel
	functions.

	* io/fxstatat.c: Add __fxstatat alias.
	* sysdeps/unix/sysv/linux/wordsize-64/fxstatat.c: Likewise.
	* sysdeps/unix/sysv/linux/fxstatat.c: Likewise.  Add support for
	newfstatat syscall.
	* sysdeps/unix/sysv/linux/i386/fxstatat.c: Add __fxstatat alias.
	Add support for fstatat64 syscall.
	* include/sys/stat.h: Declare __fxstatat.
	* io/fxstatat64.c: Add __fxstatat64 alias.
	* sysdeps/unix/sysv/linux/fxstatat64.c: Add support for fstatat64
	syscall.

	* dirent/fdopendir.c: Add __fdopendir alias.
	* sysdeps/unix/fdopendir.c: Likewise.
	* sysdeps/mach/hurd/fdopendir.c: Likewise.
	* include/dirent.h: Add __fdopendir declaration.

	[BZ #2226]
	* libio/wgenops.c (_IO_wsetb): Use correct size of wide char
	buffer in FREE_BUF call.

2006-02-08  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/bits/sched.h: Declare unshare.
	* sysdeps/unix/sysv/linux/Versions [libc, GLIBC_2.4]: Export
	unshare.
	* sysdeps/unix/sysv/linux/syscalls.list: Add unshare syscall.

	* sysdeps/unix/Makefile ($(objpfx)stub-syscalls.c): Add some
	preprocessor magic so that the compiler won't see the prototypes
	for the functions we are defining as stubs.

2006-02-05  Ulrich Drepper  <drepper@redhat.com>

	* io/ftw.c (ftw_startup): Use fchdir to return to original
	directory for FTW_CHDIR.

2006-02-03  Ulrich Drepper  <drepper@redhat.com>

	* manual/stdio.texi (Formatted Output Functions): Fix make_message
	example.  Patch by NIIBE Yutaka <gniibe@m17n.org>.

2006-02-03  Roland McGrath  <roland@redhat.com>

	[BZ #2268]
	* sysdeps/posix/profil.c (__profil): Use __profile_frequency to choose
	timer interval, don't assume smallest possible interval is it.

2006-02-03  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/powerpc/fpu/bits/fenvinline.h (fegetround): Make asm
	volatile.

	* stdlib/bits/stdlib-ldbl.h (qecvt, qfcvt, qgcvt, qecvt_r, qfcvt_r):
	Guard with [__USE_SVID || __USE_XOPEN_EXTENDED].

	* math/math.h [__LDBL_COMPAT && __USE_ISOC99] (nexttowardl): New
	prototype.

	* math/math.h (__nldbl_nexttowardf): Put __THROW before
	__attribute__ ((__const__)).
	(__MATHDECL_2): Use __REDIRECT_NTH instead of __REDIRECT
	followed by __THROW.

2006-02-02  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/futimesat.c [__NR_futimesat]
	(futimesat): If file is NULL use __futimes.
	* include/sys/time.h: Declare __futimes.

2006-02-02  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/sysv/linux/openat.c (__atfct_seterrno): Use the same
	fstat check for ENOENT that should be EBADF as for ENOTDIR, and also
	check for missing /proc the same way.

	* include/errno.h [__cplusplus]: Avoid extra header magic for C++.

	* manual/install.texi (Tools for Compilation): Require gcc 3.4,
	recommend 4.1, advise 4.0 for powerpc64, and note 4.1 required for
	powerpc, s390{x,} with new long double.
	* INSTALL: Regenerated.

	* timezone/private.h: Update from tzcode2006a.
	* timezone/scheck.c: Likewise.
	* timezone/asia: Update from tzdata2006a.
	* timezone/northamerica: Likewise.
	* timezone/zone.tab: Likewise.

	* sysdeps/powerpc/powerpc64/Makefile (no-special-regs): New variable.
	(CFLAGS-mcount.c): Use it instead of -msoft-float.
	* sysdeps/powerpc/powerpc64/elf/Makefile
	(CFLAGS-dl-runtime.os, CFLAGS-dl-lookup.os, CFLAGS-dl-misc.os,
	CFLAGS-rtld-mempcpy.os, CFLAGS-rtld-memmove.os, CFLAGS-rtld-memchr.os,
	CFLAGS-rtld-strnlen.os): Likewise.

2006-02-01  Roland McGrath  <roland@redhat.com>

	* sysdeps/ieee754/ldbl-opt/Makefile (sysdep-CFLAGS): Avoid adding
	-mlong-double-128 when it's already there.

2006-02-01  Roland McGrath  <roland@frob.com>

	* mach/Machrules ($(objpfx)%.uh, $(objpfx)%.__h): Use static pattern
	rules for these, not implicit rules.
	($(objpfx)%.h): Likewise.
	Reported by Thomas Schwinge <tschwinge@gnu.org>.

2006-02-01  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/ieee754/ldbl-128ibm/s_finitel.c: Use long_double_symbol
	even for libm.

	* libio/bits/libio-ldbl.h (_IO_vfwscanf, _IO_vfwprintf): Remove
	__LDBL_REDIR_DECL.

	* math/bits/mathcalls.h: Guard __END_NAMESPACE_C99 with the
	same #if condition as corresponding __BEGIN_NAMESPACE_C99.
	(scalb): Don't define only if __USE_ISOC99.

	* sysdeps/ieee754/ldbl-128/s_llrintl.c (__llrintl): Fix a typo.
	* sysdeps/s390/fpu/libm-test-ulps: Remove llrint ulps.

2006-01-19  Thomas Schwinge  <tschwinge@gnu.org>

	* libio/genops.c: Include <stdbool.h>.

2006-02-01  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/i386/sysconf.c (intel_02_known): Add
	some more entries.
	* sysdeps/unix/sysv/linux/x86_64/sysconf.c (intel_02_known): Likewise.

2006-01-31  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/alpha/fpu/Implies: New file.
	* sysdeps/alpha/fpu/s_ceil.c: Include math_ldbl_opt.h, add
	compat_symbol if LONG_DOUBLE_COMPAT.
	* sysdeps/alpha/fpu/s_copysign.c: Likewise.
	* sysdeps/alpha/fpu/s_fabs.c: Likewise.
	* sysdeps/alpha/fpu/s_floor.c: Likewise.
	* sysdeps/alpha/fpu/s_rint.c: Likewise.
	* sysdeps/alpha/soft-fp/e_sqrtl.c: New file.
	* sysdeps/alpha/Implies: Add ieee754/ldbl-128.

	* sysdeps/unix/sysv/linux/alpha/bits/wordsize.h: New file.
	* sysdeps/unix/sysv/linux/alpha/Implies: Add ieee754/ldbl-64-128,
	ieee754/ldbl-opt.
	* sysdeps/alpha/bits/mathdef.h (__NO_LONG_DOUBLE_MATH): Remove.
	* sysdeps/unix/sysv/linux/alpha/nldbl-abi.h: New file.
	* sysdeps/unix/sysv/linux/alpha/Makefile
	[$(subdir) = math] (libm-routines): Add multc3, divtc3.

	* math/divtc3.c: New file.
	* math/multc3.c: New file.
	* sysdeps/unix/sysv/linux/sparc/sparc32/Makefile
	[$(subdir) = math] (libm-routines): Add multc3, divtc3.

	* sysdeps/unix/sysv/linux/sparc/sparc32/fpu/Implies: New file.
	* sysdeps/sparc/sparc32/fpu/s_fabsl.c: Include math.h and
	math_ldbl_opt.h.
	(fabsl): Use long_double_symbol instead of weak_alias.
	* sysdeps/sparc/sparc32/fpu/s_fabs.c: Include math.h and
	math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (fabsl): Add compat_symbol.

2006-01-31  Martin Schwidefsky	<schwidefsky@de.ibm.com>
	    Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/s390/Implies: New file.
	* sysdeps/unix/sysv/linux/s390/fpu/Implies: New file.
	* sysdeps/unix/sysv/linux/s390/nldbl-abi.h: New file.
	* sysdeps/s390/fpu/bits/mathinline.h (signbitl, sqrtl): New inlines.
	* sysdeps/s390/bits/mathdef.h: New file.
	* sysdeps/s390/fpu/e_sqrtl.c: New file.
	* sysdeps/s390/s390-32/bits/wordsize.h (__LONG_DOUBLE_MATH_OPTIONAL,
	__NO_LONG_DOUBLE_MATH): Define.
	* sysdeps/s390/s390-64/bits/wordsize.h: Likewise.
	* sysdeps/s390/Implies: Add ieee754/ldbl-128.
	* sysdeps/s390/ldbl2mpn.c: File removed.
	* sysdeps/s390/fpu/libm-test-ulps: Updated.

2006-01-31  Roland McGrath  <roland@redhat.com>

	* sysdeps/alpha/fpu/bits/mathdef.h: Moved to ...
	* sysdeps/alpha/bits/mathdef.h: ... here.
	* sysdeps/i386/fpu/bits/mathdef.h: Moved to ...
	* sysdeps/i386/bits/mathdef.h: ... here.
	* sysdeps/mips/fpu/bits/mathdef.h: Moved to ...
	* sysdeps/mips/bits/mathdef.h: ... here.
	* sysdeps/m68k/fpu/bits/mathdef.h: Moved to ...
	* sysdeps/m68k/bits/mathdef.h: ... here.
	* sysdeps/powerpc/fpu/bits/mathdef.h: Moved to ...
	* sysdeps/powerpc/bits/mathdef.h: ... here.
	* sysdeps/sparc/fpu/bits/mathdef.h: Moved to ...
	* sysdeps/sparc/bits/mathdef.h: ... here.
	* sysdeps/ia64/fpu/bits/mathdef.h: Moved to ...
	* sysdeps/ia64/bits/mathdef.h: ... here.
	* sysdeps/sh/sh4/fpu/bits/mathdef.h: Moved to ...
	* sysdeps/sh/sh4/bits/mathdef.h: ... here.
	* sysdeps/x86_64/fpu/bits/mathdef.h: Moved to ...
	* sysdeps/x86_64/bits/mathdef.h: ... here.

2006-01-31  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/i386/fxstatat.c [XSTAT_IS_STAT64]
	(__fxstatat64): Add libc_hidden_ver.
	* sysdeps/unix/sysv/linux/fxstatat.c [XSTAT_IS_STAT64] (__fxstatat64):
	Likewise.

	* sysdeps/sparc/sparc64/jmpbuf-unwind.h: Remove jmpbuf-offsets.h
	include.

2006-01-31  Roland McGrath  <roland@redhat.com>

	* sysdeps/powerpc/fpu/libm-test-ulps: Update by Jakub.

	* inet/rcmd.c (iruserfopen): Remove redundant initialization.
	From Bernhard Fischer <rep.nop@aon.at>.

	* posix/regcomp.c (calc_eclosure_iter): Remove dead variables.
	Reported by Mike Frysinger <vapier@gentoo.org>.

2006-01-30  Steven Munroe  <sjmunroe@us.ibm.com>

	* sysdeps/ieee754/ldbl-128ibm/k_cosl.c (__kernel_cosl): Correct index
	for __sincosl_table.
	* sysdeps/ieee754/ldbl-128ibm/k_sincosl.c (__kernel_sincosl): Likewise.
	* sysdeps/ieee754/ldbl-128ibm/k_sinl.c (__kernel_sinl): Likewise.

	* sysdeps/ieee754/ldbl-128ibm/s_ceill.c: Correct sign of 0.0.
	* sysdeps/ieee754/ldbl-128ibm/s_floorl.c: Likewise.

	* sysdeps/ieee754/ldbl-128ibm/s_cprojl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_ctanhl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_ctanl.c: New file.

2006-01-29  Daniel Jacobowitz  <dan@codesourcery.com>

	* sysdeps/unix/sysv/linux/mips/bits/errno.h (ECANCELED,
	EOWNERDEAD, ENOTRECOVERABLE): Define.

	* sysdeps/unix/sysv/linux/mips/bits/mman.h (MADV_REMOVE): Define.

	* sysdeps/mips/dl-machine.h (RTLD_START): Correct offsets for
	N64.

	* sysdeps/unix/sysv/linux/mips/bits/socket.h (struct msghdr): Use
	size_t for msg_controllen.
	(__cmsg_nxthdr): Correct test.
	(__SCM_CONNECT): Delete.

2006-01-30  Alexandre Oliva  <aoliva@redhat.com>
            Roland McGrath  <roland@redhat.com>

	* configure.in (fno_unit_at_a_time): Set to
	-fno-toplevel-reorder if the compiler supports it.
	Otherwise use -fno-unit-at-a-time unconditionally.
	* configure: Regenerated.

2006-01-30  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/powerpc/fpu/libm-test-ulps: Merge ulps with older
	libm-test-ulps rather than overwrite it.  Remove excessively high ulps.

2006-01-29  Joseph S. Myers  <joseph@codesourcery.com>

	* soft-fp/double.h (FP_CMP_UNORD_D): Also define in
	[_FP_W_TYPE_SIZE >= 64] case.
	* soft-fp/extended.h (FP_CMP_UNORD_E): Likewise.
	* soft-fp/quad.h (FP_CMP_UNORD_Q): Likewise.

2006-01-27  Dwayne Grant McConnell  <decimal@us.ibm.com>
	    Jakub Jelinek  <jakub@redhat.com>
	    Roland McGrath  <roland@redhat.com>
	    Steven Munroe  <sjmunroe@us.ibm.com>
	    Alan Modra  <amodra@bigpond.net.au>

	* sysdeps/powerpc/powerpc64/fpu/s_truncf.S: Comment fix.
	* sysdeps/powerpc/powerpc32/fpu/s_truncf.S: Likewise.
	* sysdeps/powerpc/powerpc64/fpu/s_llroundf.S: Likewise.

	* sysdeps/powerpc/fpu/libm-test-ulps: Update.

	* math/libm-test.inc (check_float_internal): Allow ulp <= 0.5.
	(erfc_test): Don't run erfcl (27.0L) test if erfcl (27.0L) is
	denormal.
	[TEST_LDOUBLE] (ceil_test, floor_test, llrint_test, llround_test,
	rint_test, round_test, trunc_test): Add new tests.

	* sysdeps/powerpc/powerpc32/fpu/s_copysignl.S: New file.
	* sysdeps/powerpc/powerpc32/fpu/s_fabs.S: New file.
	* sysdeps/powerpc/powerpc32/fpu/s_fabsl.S: New file.
	* sysdeps/powerpc/powerpc32/fpu/s_fdim.c: New file.
	* sysdeps/powerpc/powerpc32/fpu/s_fmax.S: New file.
	* sysdeps/powerpc/powerpc32/fpu/s_fmin.S: New file.
	* sysdeps/powerpc/powerpc32/fpu/s_isnan.c: New file.

	* sysdeps/powerpc/powerpc64/fpu/s_ceill.S: New file.
	* sysdeps/powerpc/powerpc64/fpu/s_copysignl.S: New file.
	* sysdeps/powerpc/powerpc64/fpu/s_fabs.S: New file.
	* sysdeps/powerpc/powerpc64/fpu/s_fabsl.S: New file.
	* sysdeps/powerpc/powerpc64/fpu/s_fdim.c: New file.
	* sysdeps/powerpc/powerpc64/fpu/s_floorl.S: New file.
	* sysdeps/powerpc/powerpc64/fpu/s_fmax.S: New file.
	* sysdeps/powerpc/powerpc64/fpu/s_fmin.S: New file.
	* sysdeps/powerpc/powerpc64/fpu/s_isnan.c: New file.
	* sysdeps/powerpc/powerpc64/fpu/s_llrintl.S: New file.
	* sysdeps/powerpc/powerpc64/fpu/s_llroundl.S: New file.
	* sysdeps/powerpc/powerpc64/fpu/s_lrintl.S: New file.
	* sysdeps/powerpc/powerpc64/fpu/s_lroundl.S: New file.
	* sysdeps/powerpc/powerpc64/fpu/s_nearbyintl.S: New file.
	* sysdeps/powerpc/powerpc64/fpu/s_rintl.S: New file.
	* sysdeps/powerpc/powerpc64/fpu/s_roundl.S: New file.
	* sysdeps/powerpc/powerpc64/fpu/s_truncl.S: New file.

	* sysdeps/unix/sysv/linux/powerpc/Implies: New file.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/fpu/Implies: New file.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/fpu/Implies: New file.
	* sysdeps/unix/sysv/linux/powerpc/configure.in: New file.
	* sysdeps/unix/sysv/linux/powerpc/configure: New file.
	* sysdeps/unix/sysv/linux/powerpc/bits/wordsize.h
	(__LONG_DOUBLE_MATH_OPTIONAL): Define.
	(__NO_LONG_DOUBLE_MATH): Define.
	* sysdeps/unix/sysv/linux/powerpc/nldbl-abi.h: New file.
	* sysdeps/powerpc/fpu/s_isnan.c: Include math_ldbl_opt.h.
	* sysdeps/powerpc/powerpc64/fpu/s_ceil.S: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (ceill): Add compatibility symbols.
	* sysdeps/powerpc/powerpc64/fpu/s_copysign.S: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (copysignl): Add compatibility symbols.
	* sysdeps/powerpc/powerpc64/fpu/s_floor.S: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (floorl): Add compatibility symbols.
	* sysdeps/powerpc/powerpc64/fpu/s_llrint.S: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (llrintl, lrintl): Add compatibility symbols.
	* sysdeps/powerpc/powerpc64/fpu/s_llround.S: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (llroundl, lroundl): Add compatibility symbols.
	* sysdeps/powerpc/powerpc64/fpu/s_rint.S: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (rintl): Add compatibility symbols.
	* sysdeps/powerpc/powerpc64/fpu/s_round.S: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (roundl): Add compatibility symbols.
	* sysdeps/powerpc/powerpc64/fpu/s_trunc.S: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (truncl): Add compatibility symbols.
	* sysdeps/powerpc/powerpc32/fpu/s_ceil.S: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (ceill): Add compatibility symbols.
	* sysdeps/powerpc/powerpc32/fpu/s_copysign.S: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (copysignl): Add compatibility symbols.
	* sysdeps/powerpc/powerpc32/fpu/s_floor.S: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (floorl): Add compatibility symbols.
	* sysdeps/powerpc/powerpc32/fpu/s_lrint.S: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (lrintl): Add compatibility symbols.
	* sysdeps/powerpc/powerpc32/fpu/s_llrint.c: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (llrintl): Add compatibility symbols.
	* sysdeps/powerpc/powerpc32/fpu/s_lround.S: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (lroundl): Add compatibility symbols.
	* sysdeps/powerpc/powerpc32/fpu/s_rint.S: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (rintl): Add compatibility symbols.
	* sysdeps/powerpc/powerpc32/fpu/s_round.S: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (roundl): Add compatibility symbols.
	* sysdeps/powerpc/powerpc32/fpu/s_trunc.S: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (truncl): Add compatibility symbols.

	* misc/qefgcvt_r.c [LDBL_MIN_10_EXP == -291] (FLOAT_MIN_10_NORM): New.

	* sysdeps/powerpc/fpu/bits/mathdef.h (__NO_LONG_DOUBLE_MATH): Remove.
	* sysdeps/powerpc/Implies: Add ieee754/ldbl-128ibm.
	* sysdeps/powerpc/powerpc32/Implies: Remove powerpc/soft-fp.
	* sysdeps/ieee754/ldbl-128ibm/Makefile: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_acoshl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_acosl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_asinl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_atan2l.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_atanhl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_coshl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_expl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_fmodl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_gammal_r.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_hypotl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_j0l.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_j1l.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_jnl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_lgammal_r.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_log10l.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_log2l.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_logl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_powl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_rem_pio2l.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_remainderl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_sinhl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/e_sqrtl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/ieee754.h: New file.
	* sysdeps/ieee754/ldbl-128ibm/k_cosl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/k_sincosl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/k_sinl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/k_tanl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/ldbl2mpn.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/math_ldbl.h: New file.
	* sysdeps/ieee754/ldbl-128ibm/mpn2ldbl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/printf_fphex.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_asinhl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_atanl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_cbrtl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_cosl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_erfl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_expm1l.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_fabsl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_finitel.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_fpclassifyl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_frexpl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_ilogbl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_isinfl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_isnanl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_log1pl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_logbl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_modfl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_nextafterl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_nexttoward.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_nexttowardf.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_remquol.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_rintl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_scalblnl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_scalbnl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_signbitl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_sincosl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_sinl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_tanhl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_tanl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_truncl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/strtold_l.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/t_sincosl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/w_expl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_copysignl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_floorl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_llrintl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_llroundl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_roundl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_ceill.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_nearbyintl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_lrintl.c: New file.
	* sysdeps/ieee754/ldbl-128ibm/s_lroundl.c: New file.

	* sysdeps/ieee754/ldbl-128/e_powl.c: Fix old comment.

2006-01-22  Aurelien Jarno  <aurelien@aurel32.net>

	* sysdeps/gnu/errlist-compat.awk: Reduce required number of symbols in
	sanity check.

2006-01-21  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/renameat.c (__atfct_seterrno_2): Correctly
	return EBADF for non-existing file descriptors.
	* sysdeps/unix/sysv/linux/openat.c (__atfct_seterrno): Likewise.
	* io/tst-openat.c (do_test): Add some more tests.
	* io/tst-faccessat.c (do_test): Likewise.
	* io/tst-renameat.c (do_test): Likewise.
	* io/tst-fstatat.c (do_test): Likewise.
	* io/tst-fchmodat.c (do_test): Likewise.
	* io/tst-fchownat.c (do_test): Likewise.

2006-01-21  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/sysv/linux/faccessat.c: Move RESULT defn inside block.

	* misc/tst-pselect.c: Include <unistd.h>.

	* time/time.h [__need_timespec et al]: Include <bits/types.h> here too.

	* stdlib/fpioconst.c: Fix whitespace typo.

2006-01-20  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/ieee754/ldbl-64-128/s_nexttowardfd.c: Moved to...
	* sysdeps/ieee754/ldbl-opt/s_nexttowardfd.c: ... here.  New file.
	* sysdeps/ieee754/ldbl-opt/math_ldbl_opt.h (long_double_symbol_1): For
	C define again using _weak_alias, for assembler use weak_alias.

	* sysdeps/powerpc/powerpc64/fpu/e_sqrt.c: New file.
	* sysdeps/powerpc/powerpc64/fpu/e_sqrtf.c: New file.
	* sysdeps/powerpc/fpu/bits/mathinline.h (__CPU_HAS_FSQRT): New macro.
	(__ieee754_sqrt, __ieee754_sqrtf): Use it.

2006-01-21  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/pselect.c (__pselect): Allow actual
	system call code to be redefined in macro CALL_PSELECT6.
	* sysdeps/unix/sysv/linux/i386/Makefile [subdir=misc]
	(sysdep_routines): Add call_pselect6.
	* sysdeps/unix/sysv/linux/i386/call_pselect6.S: New file.
	* sysdeps/unix/sysv/linux/i386/pselect.c: New file.
	* misc/Makefile (tests): Add tst-pselect.
	* misc/tst-pselect.c: New file.

2006-01-20  Roland McGrath  <roland@frob.com>

	* sysdeps/mach/hurd/ppoll.c: New file.

2006-01-20  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/pselect.c: Fix typo in declaration.

	* sysdeps/unix/sysv/linux/xmknodat.c (__xmknodat): Cast k_dev
	value to unsigned int to match kernel.

	* sysdeps/unix/sysv/linux/faccessat.c (faccessat): Try using the
	syscall in more cases.

	* io/Makefile (tests): Add tst-symlinkat, tst-linkat, tst-readlinkat,
	tst-mkdirat, tst-mknodat, and tst-mkfifoat.
	* io/tst-symlinkat.c: New file.
	* io/tst-linkat.c: New file.
	* io/tst-readlinkat.c: New file.
	* io/tst-mkdirat.c: New file.
	* io/tst-mknodat.c: New file.
	* io/tst-mkfifoat.c: New file.

	* dirent/Makefile (tests): Add tst-fdopendir2.
	* dirent/tst-fdopendir2.c: New file.

2006-01-20  Alexandre Oliva  <aoliva@redhat.com>

	* sysdeps/unix/sysv/linux/x86_64/bits/sigcontext.h
	(sigcontext_struct) [__WORDSIZE == 32]: Define.

2006-01-20  Kaz Kojima  <kkojima@rr.iij4u.or.jp>

	* sysdeps/sh/sh4/__longjmp.S: Demangle also r14 and r15.
	* sysdeps/sh/sh3/__longjmp.S: Likewise.
	* sysdeps/sh/sh4/setjmp.S: Mangle also r14 and r15.
	* sysdeps/sh/sh3/setjmp.S: Likewise.
	* sysdeps/unix/sysv/linux/sh/sysdep.h [__ASSEMBLER__]
	(PTR_MANGLE): Add temporary register as the second parameter.
	(PTR_DEMANGLE): Likewize.
	(PTR_MANGLE2, PTR_DEMANGLE2): Define.

2006-01-19  Ulrich Drepper  <drepper@redhat.com>

	* include/fcntl.h: Declare __have_atfcts.
	* sysdeps/unix/sysv/linux/faccessat.c: Use syscall if available.
	* sysdeps/unix/sysv/linux/fchmodat.c: Likewise.
	* sysdeps/unix/sysv/linux/fchownat.c: Likewise.
	* sysdeps/unix/sysv/linux/futimesat.c: Likewise.
	* sysdeps/unix/sysv/linux/linkat.c: Likewise.
	* sysdeps/unix/sysv/linux/mkdirat.c: Likewise.
	* sysdeps/unix/sysv/linux/openat.c: Likewise.
	* sysdeps/unix/sysv/linux/readlinkat.c: Likewise.
	* sysdeps/unix/sysv/linux/renameat.c: Likewise.
	* sysdeps/unix/sysv/linux/symlinkat.c: Likewise.
	* sysdeps/unix/sysv/linux/unlinkat.c: Likewise.
	* sysdeps/unix/sysv/linux/xmknodat.c: Likewise.
	* sysdeps/unix/sysv/linux/wordsize-64/fxstatat.c: Likewise.
	* sysdeps/unix/sysv/linux/kernel-features.h: Define __ASSUME_PSELECT,
	__ASSUME_PPOLL, and __ASSUME_ATFCTS if possible.

	* io/ppoll.c: New file.
	* io/Makefile (routines): Add ppoll.
	(CFLAGS-ppoll.c): Define.
	* io/Versions: Export ppoll for GLIBC_2.4.
	* io/sys/poll.h: Declare ppoll.
	* sysdeps/unix/sysv/linux/ppoll.c: New file.

	* misc/pselect.c: Make it possible to include this file to define
	the generic code as a static function.
	* sysdeps/unix/sysv/linux/pselect.c: New file.

2006-01-19  Jakub Jelinek  <jakub@redhat.com>

	* misc/pselect.c (__pselect): Remove static.
	Include sysdep-cancel.h again.  Add LIBC_CANCEL_HANDLED ().

2006-01-18  Roland McGrath  <roland@redhat.com>

	* sysdeps/ieee754/ldbl-opt/math_ldbl_opt.h [__ASSEMBLER__]: Don't
	include problematic headers for assembler.

	* Makerules ($(+sysdir_pfx)sysd-rules): Don't emit m_%.c rules,
	instead emit m_%.o compilation rules from s_%.? source files.
	* math/Makefile ($(objpfx)m_%$o: s_%.c): New rule using o-iterator.

2006-01-18  Ulrich Drepper  <drepper@redhat.com>

	* misc/pselect.c (__pselect): No need to enable async cancellation
	here.  This is done in select.

	* sysdeps/unix/sysv/linux/fxstatat.c [STAT_IS_KERNEL_STAT]
	(__fxstatat): Correct handling of invalid vers values.

	[BZ #2173]
	* libio/fileops.c (_IO_new_file_fopen): If ,ccs= is given, also
	set vtable to the wide vtable.
	* libio/tst-fopenloc2.c: New file.
	* libio/Makefile (tests): Add tst-fopenloc2.

2006-01-18  Roland McGrath  <roland@redhat.com>

	* sysdeps/ieee754/ldbl-opt/nldbl-dprintf.c: Restore
	attribute_hidden here.

	* sysdeps/sparc/sparc64/Makefile (long-double-fcts): Move this ...
	* sysdeps/sparc/Makefile (long-double-fcts): ... to here.

2006-01-18  Jakub Jelinek  <jakub@redhat.com>

	* elf/dl-deps.c (_dl_map_object_deps): In case of failure also make a
	copy of objname string.

2006-01-16  Roland McGrath  <roland@redhat.com>

	* Makerules ($(+sysdir_pfx)sysd-rules): Emit pattern rules to install
	into $(inst_includedir)/%.h from sysdirs.
	[headers]: Change static pattern rule for installing
	$(headers) to do only those not matching %.h.
	($(inst_includedir)/%.h: $(objpfx)%.h): Add this pattern rule instead.
	($(inst_includedir)/%.h: %.h): Likewise.
	($(inst_includedir)/%.h: $(..)include/%.h): Likewise.

	* Makefile ($(inst_includedir)/gnu/stubs.h):
	Add $(make-target-directory).

	* stdlib/Makefile (headers): Restore headers removed in last change.

2006-01-16  Jakub Jelinek  <jakub@redhat.com>

	* math/e_exp2l.c: Don't include stdio.h, errno.h, stub-tag.h, include
	math_private.h.
	(__ieee754_exp2l): Compute for now as expl (M_LN2l * x)
	instead of failing.
	(exp2l): Remove stub_warning.

2006-01-15  Jakub Jelinek  <jakub@redhat.com>

	* io/tst-faccessat.c (do_test): Don't fail if geteuid () == 0.

2006-01-16  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/kernel-features.h: Define
	__ASSUME_TMPFS_NAME.
	* sysdeps/unix/sysv/linux/shm_open.c [__ASSUME_TMPFS_NAME]
	(where_is_shmfs): Don't test for obsolete shm filesystem name.

	* sysdeps/unix/sysv/linux/getsysstats.c: Don't search for proc
	mount point.  We assume procfs is mounted at /proc in many other
	places already.

2006-01-15  Andreas Jaeger  <aj@suse.de>

	[BZ #1950]
	* posix/regex_internal.c (re_string_reconstruct): Adjust for
	build_wcs_upper_buffer change.
	(build_wcs_upper_buffer): Change return type.

	[BZ #2153]
	* math/s_cacosh.c (__cacosh): Do not return a negative
	value. Patch by Wes Loewer <wjltemp-temp01@yahoo.com>.
	* math/s_cacoshl.c (__cacoshl): Likewise.
	* math/s_cacoshf.c (__cacoshf): Likewise.
	* math/libm-test.inc (cacosh_test): Adjust for change.

	* sysdeps/alpha/fpu/libm-test-ulps: Adopt for cacosh test change.
	* sysdeps/hppa/fpu/libm-test-ulps: Likewise.
	* sysdeps/i386/fpu/libm-test-ulps: Likewise.
	* sysdeps/ia64/fpu/libm-test-ulps: Likewise.
	* sysdeps/m68k/fpu/libm-test-ulps: Likewise.
	* sysdeps/mips/fpu/libm-test-ulps: Likewise.
	* sysdeps/powerpc/fpu/libm-test-ulps: Likewise.
	* sysdeps/s390/fpu/libm-test-ulps: Likewise.
	* sysdeps/x86_64/fpu/libm-test-ulps: Likewise.
	* sysdeps/sh/sh4/fpu/libm-test-ulps: Likewise.
	* sysdeps/sparc/sparc32/fpu/libm-test-ulps: Likewise.
	* sysdeps/sparc/sparc64/fpu/libm-test-ulps: Likewise.

	[BZ #2079]
	* libio/fputwc_u.c (fputwc_unlocked): Fix return value.
	* libio/getwc_u.c (__getwc_unlocked): Likewise.
	* libio/wfileops.c (_IO_wdo_write): Likewise.

	[BZ #2078]
	* libio/fputwc.c (fputwc): Use proper type for result.
	* libio/ioungetwc.c (ungetwc): Likewise.

2006-01-14  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/bits/sched.h: Define SCHED_BATCH.

2006-01-14  Roland McGrath  <roland@redhat.com>

	* sysdeps/ieee754/ldbl-opt/nldbl-compat.h (NLDBL_DECL): Don't try
	attribute_hidden here.
	* sysdeps/ieee754/ldbl-opt/nldbl-vsyslog.c (vsyslog): Restore
	attribute_hidden here.
	* sysdeps/ieee754/ldbl-opt/nldbl-asprintf.c (__asprintf): Likewise.
	* sysdeps/ieee754/ldbl-opt/nldbl-fprintf.c (fprintf): Likewise.
	* sysdeps/ieee754/ldbl-opt/nldbl-qecvt.c (qecvt): Likewise.
	* sysdeps/ieee754/ldbl-opt/nldbl-qfcvt.c (qfcvt): Likewise.
	* sysdeps/ieee754/ldbl-opt/nldbl-qgcvt.c (qgcvt): Likewise.

	* sysdeps/ieee754/ldbl-opt/configure.in: Use AC_TRY_COMPILE and
	verify __LONG_DOUBLE_128__ predefine.
	* sysdeps/ieee754/ldbl-opt/configure: Regenerated.

	* sysdeps/ieee754/ldbl-opt/nldbl-compat.h (NLDBL_HIDDEN): Removed.
	(NLDBL_DECL): Rewritten.
	Remove __THROW from NLDBL_DECL uses.
	Use NLDBL_DECL for __vstrfmon_l.
	(__nldbl___vsyslog_chk): Restore missing decl.
	* sysdeps/ieee754/ldbl-opt/nldbl-asinh.c: Restore attribute_hidden.

2006-01-14  Jakub Jelinek  <jakub@redhat.com>

	* misc/sys/cdefs.h (__LDBL_REDIR1_DECL): Define.
	(__LDBL_REDIR_DECL): Stringize __nldbl and name.
	* stdlib/bits/monetary-ldbl.h: Remove pastos from wchar-ldbl.h.
	(strfmon, strfmon_l): Add __LDBL_REDIR_DECL.
	* stdlib/bits/stdlib-ldbl.h (strtold, strtold_l, __strtold_internal,
	qecvt, qfcvt, qgcvt, qecvt_r, qfcvt_r): Use __LDBL_REDIR1_DECL
	instead of __LDBL_REDIR_DECL.
	* wcsmbs/bits/wchar-ldbl.h: Remove stale #if.
	(__LDBL_REDIR_WCHAR): Remove.
	(fwprintf, wprintf, swprintf, vfwprintf, vwprintf, vswprintf,
	fwscanf, wscanf, swscanf, vfwscanf, vwscanf, vswscanf): Use
	__LDBL_REDIR_DECL instead of __LDBL_REDIR_WCHAR.
	(wcstold, wcstold_l, __wcstold_internal): Add __LDBL_REDIR1_DECL.
	* wcsmbs/wchar.h: Include bits/wchar-ldbl.h after bits/wchar2.h
	instead of before it.
	(wcstold inline): Move #ifndef __LDBL_COMPAT before
	extern keyword.
	* libio/bits/stdio-ldbl.h (__snprintf_chk, __vsnprintf_chk): Add
	__LDBL_REDIR_DECL.
	* misc/bits/syslog-ldbl.h (vsyslog): Protect with #ifdef __USE_BSD.
	(__syslog_chk, __vsyslog_chk): Add __LDBL_REDIR_DECL.

2006-01-14  Roland McGrath  <roland@redhat.com>

	* sysdeps/ieee754/ldbl-opt/nldbl-compat.h (NLDBL_DECL): Fix typo.
	(NLDBL_HIDDEN): New macro.
	(NLDBL_DECL): Use it in place of attribute_hidden.

	* misc/efgcvt.c: Include <math_ldbl_opt.h> instead of <shlib-compat.h>.
	* misc/efgcvt_r.c: Likewise.

	* sysdeps/unix/sysv/linux/sparc/sparc32/nldbl-abi.h: New file.
	* sysdeps/ieee754/ldbl-opt/math_ldbl_opt.h: #include <nldbl-abi.h>
	to define LONG_DOUBLE_COMPAT_VERSION.  Use that in place of
	NLDBL_VERSION.
	* sysdeps/ieee754/ldbl-opt/Versions: Include <nldbl-abi.h>.
	* sysdeps/unix/sysv/linux/sparc/sparc32/Versions: Revert last change.

2006-01-14  Jakub Jelinek  <jakub@redhat.com>

	* math/math.h [__NO_LONG_DOUBLE_MATH] (__nldbl_nexttowardf): New
	prototype.
	(nexttowardf): Redirect to __nldbl_nexttowardf.
	(nexttoward): Redirect to nextafter.
	(__MATHDECL_2, __MATHDECL_1): Redirect *l functions to
	non-*l versions if __LONG_DOUBLE_MATH_OPTIONAL and
	__NO_LONG_DOUBLE_MATH.
	* math/complex.h (__MATHDECL_1): Likewise.
	* math/bits/mathcalls.h (nexttoward): Don't prototype if
	__LDBL_COMPAT.
	* misc/sys/cdefs.h: Include <bits/wordsize.h>.
	(__LDBL_COMPAT, __LDBL_REDIR1, __LDBL_REDIR, __LDBL_REDIR1_NTH,
	__LDBL_REDIR_NTH, __LDBL_REDIR_DECL): New macros.

	* libio/bits/stdio-ldbl.h: New file.
	* libio/Makefile (headers): Add it.
	* libio/stdio.h [__LDBL_COMPAT]: #include it.
	* libio/bits/libio-ldbl.h: New file.
	* libio/Makefile (headers): Add it.
	* libio/libio.h [__LDBL_COMPAT]: #include it.
	* libio/libioP.h: Include <math_ldbl_opt.h>.
	* include/wchar.h (__fwprintf, __vfwprintf): Fix commented out
	attribute.
	(__vfwprintf_chk): New prototype.  Add libc_hidden_proto.
	* wcsmbs/bits/wchar-ldbl.h: New file.
	* wcsmbs/Makefile (headers): Add it.
	* wcsmbs/wchar.h [__LDBL_COMPAT]: #include it.
	* wcsmbs/bits/wchar2.h (__vswprintf_alias): Removed.
	(vswprintf): Define as a macro rather than inline function.
	* stdio-common/bits/printf-ldbl.h: New file.
	* stdio-common/Makefile (headers): Add it.
	* stdio-common/printf.h [__LDBL_COMPAT]: #include it.
	* libio/fwprintf.c: Include libioP.h.
	(fwprintf): Use ldbl_weak_alias instead of weak_alias.
	* libio/fwscanf.c: Include libioP.h.
	(fwscanf): Rename to __fwscanf and add ldbl_strong_alias.
	* libio/iovdprintf.c (vdprintf): Use ldbl_weak_alias instead of
	weak_alias.
	* libio/iovsprintf.c (_IO_vsprintf): Rename to __IO_vsprintf,
	add ldbl_strong_alias and use INTDEF2 instead of INTDEF.
	(vsprintf): Use ldbl_weak_alias instead of weak_alias.
	* libio/iovsscanf.c (__vsscanf, vsscanf): Use ldbl_weak_alias
	instead of weak_alias.
	* libio/iovswscanf.c (vswscanf): Rename to __vswscanf,
	add ldbl_strong_alias and use ldbl_hidden_def instead of
	libc_hidden_def.
	* libio/obprintf.c (obstack_printf, obstack_vprintf): Use
	ldbl_weak_alias instead of weak_alias.
	* libio/swprintf.c: Include libioP.h.
	(swprintf): Rename to __swprintf and add ldbl_strong_alias.
	* libio/swscanf.c: Include libioP.h.
	(swscanf): Rename to __swscanf and add ldbl_strong_alias.
	* libio/vasprintf.c (vasprintf): Use ldbl_weak_alias instead of
	weak_alias.
	* libio/vscanf.c (vscanf): Use ldbl_weak_alias instead of
	weak_alias.
	* libio/vsnprintf.c (__vsnprintf, vsnprintf): Use ldbl_weak_alias
	instead of weak_alias.
	* libio/vswprintf.c (__vswprintf): Remove alias.
	(vswprintf): Use ldbl_weak_alias instead of weak_alias.
	* libio/vwprintf.c: Include libioP.h.
	(vwprintf): Rename to __vwprintf and add ldbl_strong_alias.
	* libio/vwscanf.c (vwscanf): Rename to __vwscanf and add
	ldbl_strong_alias.
	* libio/wprintf.c: Include libioP.h.
	(wprintf): Rename to __wprintf and add ldbl_strong_alias.
	* libio/wscanf.c: Include libioP.h.
	(wscanf): Rename to __wscanf and add ldbl_strong_alias.
	* stdio-common/asprintf.c (__asprintf): Rename to ___asprintf, add
	ldbl_strong_alias and use INTDEF2 instead of INTDEF.
	(asprintf): Use ldbl_weak_alias instead of weak_alias.
	* stdio-common/dprintf.c (dprintf): Rename to __dprintf, add
	ldbl_strong_alias and use ldbl_hidden_def instead of
	libc_hidden_def.
	* stdio-common/fprintf.c: Include libioP.h.
	(fprintf): Rename to __fprintf, add ldbl_strong_alias and
	use ldbl_hidden_def instead of libc_hidden_def.
	(_IO_fprintf): Use ldbl_weak_alias instead of weak_alias.
	* stdio-common/fscanf.c: Include libioP.h.
	(fscanf): Rename to __fscanf and add ldbl_strong_alias.
	* stdio-common/printf.c: Include libioP.h.
	(printf): Rename to __printf and add ldbl_strong_alias.
	(_IO_printf): Use ldbl_strong_alias instead of strong_alias.
	* stdio-common/printf_fp.c (__printf_fp): Rename to __printf_fp, add
	ldbl_strong_alias and use ldbl_hidden_def instead of
	libc_hidden_def.
	* stdio-common/printf_size.c (printf_size): Rename to __printf_size
	and add ldbl_strong_alias.
	* stdio-common/scanf.c (scanf): Rename to __scanf and add
	ldbl_strong_alias.
	* stdio-common/snprintf.c (snprintf): Use ldbl_weak_alias instead of
	weak_alias.
	* stdio-common/sprintf.c (sprintf): Rename to __sprintf, add
	ldbl_strong_alias and use ldbl_hidden_def instead of
	libc_hidden_def.
	(_IO_sprintf): Use ldbl_strong_alias instead of strong_alias.
	* stdio-common/sscanf.c: Include libioP.h instead of iolibio.h.
	(sscanf): Rename to __sscanf and add ldbl_strong_alias.
	* stdio-common/vfprintf.c (vfprintf): Define to
	_IO_vfprintf_internal.  Use ldbl_strong_alias instead.  Use
	ldbl_hidden_def instead of libc_hidden_def.
	(_IO_vfprintf_internal): Clear is_long_double if __ldbl_is_dbl,
	handle the argument as double if it is non-zero.
	(vfwprintf): Use ldbl_weak_alias instead of weak_alias.
	(_IO_vfprintf): Add ldbl_strong_alias.
	* stdio-common/vfscanf.c (_IO_vfscanf): Rename to
	_IO_vfscanf_internal, don't use strtold if __ldbl_is_dbl, add
	ldbl_strong_alias.
	(vfwscanf): Use ldbl_weak_alias instead of weak_alias.
	(__vfscanf): Rename to ___vfscanf, add ldbl_strong_alias and
	use ldbl_hidden_def instead of libc_hidden_def.
	(vfscanf): Use ldbl_weak_alias instead of weak_alias.
	* stdio-common/vprintf.c: Include libioP.h.
	(vprintf): Rename to __vprintf and add ldbl_strong_alias.
	* debug/fprintf_chk.c (__fprintf_chk): Rename to ___fprintf_chk
	and add ldbl_strong_alias.
	* debug/printf_chk.c (__printf_chk): Rename to ___printf_chk
	and add ldbl_strong_alias.
	* debug/snprintf_chk.c: Include libioP.h.
	(__snprintf_chk): Rename to ___snprintf_chk and add ldbl_strong_alias.
	* debug/sprintf_chk.c: Include libioP.h.
	(__sprintf_chk): Rename to ___sprintf_chk and add ldbl_strong_alias.
	* debug/vfprintf_chk.c (__vfprintf_chk): Rename to ___vfprintf_chk,
	add ldbl_strong_alias and use ldbl_hidden_def instead of
	libc_hidden_def.
	* debug/vfwprintf_chk.c (__vfwprintf_chk): Add libc_hidden_def.
	* debug/vprintf_chk.c (__vprintf_chk): Rename to ___vprintf_chk
	and add ldbl_strong_alias.
	* debug/vsnprintf_chk.c (__vsnprintf_chk): Rename to ___vsnprintf_chk,
	add ldbl_strong_alias and use ldbl_hidden_def instead of
	libc_hidden_def.
	* debug/vsprintf_chk.c (__vsprintf_chk): Rename to ___vsprintf_chk,
	add ldbl_strong_alias and use ldbl_hidden_def instead of
	libc_hidden_def.

	* stdlib/stdlib.h (strtold): Don't define inline if [!__LDBL_COMPAT].
	* wcsmbs/wchar.h (wcstold): Likewise.
	* stdlib/strtod_l.c: Include math_ldbl_opt.h.
	(____STRTOF_INTERNAL): Define.
	(INTERNAL (__STRTOF)): Rename to ____STRTOF_INTERNAL.
	(__STRTOF): Call ____STRTOF_INTERNAL instead.
	[LONG_DOUBLE_COMPAT] (strtold_l, wcstold_l, __strtold_l, __wcstold_l):
	Add compatibility symbols.
	* stdlib/strtod.c: Include math_ldbl_opt.h.
	[LONG_DOUBLE_COMPAT] (strtold, wcstold, __strtold_internal,
	__wcstold_internal): Add compatibility symbols.
	* stdlib/strtold.c: Include bits/wordsize.h, wchar.h.
	(NEW, NEW1): Define.
	(__new_strtold, __new_wcstold): New prototypes.
	(____new_strtold_internal, ____new_wcstold_internal): Likewise.
	Add libc_hidden_proto.
	(STRTOF): Define to NEW (*told).
	[__LONG_DOUBLE_MATH_OPTIONAL] (wcstold, strtold): Add
	long_double_symbol.
	[__LONG_DOUBLE_MATH_OPTIONAL] (__wcstold_internal,
	__strtold_internal): Likewise. Add libc_hidden_ver.

	* stdlib/bits/stdlib-ldbl.h: New file.
	* stdlib/Makefile (headers): Add it.
	* stdlib/stdlib.h [__LDBL_COMPAT]: #include it.
	* include/stdlib.h (ecvt_r, fcvt_r, qecvt_r, qfcvt_r): Remove
	libc_hidden_proto.
	(__ecvt, __fcvt, __gcvt, __ecvt_r, __fcvt_r, __qecvt, __qfcvt,
	__qgcvt, __qecvt_r, __qfcvt_r): New prototypes.
	* misc/efgcvt_r.c: Include shlib-compat.h.
	(LONG_DOUBLE_CVT): Define.
	(__APPEND, __APPEND2): Define.
	(*fcvt_r): Use __APPEND instead of APPEND.  Remove libc_hidden_def.
	(*ecvt_r): Likewise.
	(cvt_symbol): Define.  Use it on fcvt_r and ecvt_r.
	* misc/efgcvt.c: Include shlib-compat.h.
	(LONG_DOUBLE_CVT): Define.
	(__APPEND, __APPEND2): Define.
	(fcvt): Use __APPEND instead of APPEND.  Remove libc_hidden_def.
	(ecvt, gcvt): Likewise.
	(cvt_symbol): Define.  Use it on fcvt, ecvt and gcvt.

	* stdlib/bits/monetary-ldbl.h: New file.
	* stdlib/Makefile (headers): Add it.
	* stdlib/monetary.h [__LDBL_COMPAT]: #include it.
	* stdlib/strfmon.c: Include math_ldbl_opt.h.
	(strfmon): Rename to __strfmon and add ldbl_strong_alias.
	* stdlib/strfmon_l.c: Remove all traces of [!USE_IN_LIBIO].
	(__vstrfmon_l): Don't set is_long_double if __ldbl_is_dbl.
	(__strfmon_l): Rename to ___strfmon_l and add ldbl_strong_alias.
	(strfmon_l): Use ldbl_weak_alias instead of weak_alias.

	* misc/bits/syslog-ldbl.h: New file.
	* misc/Makefile (headers): Add it.
	* misc/sys/syslog.h [__LDBL_COMPAT]: #include it.
	* misc/syslog.c: Include math_ldbl_opt.h.
	(syslog): Rename to __syslog and add ldbl_strong_alias,
	use ldbl_hidden_def instead of libc_hidden_def.
	(vsyslog): Rename to __vsyslog and add ldbl_strong_alias,
	use ldbl_hidden_def instead of libc_hidden_def.

	* sysdeps/generic/math_ldbl_opt.h: New file.
	* math/w_j1l.c (j1l, y1l): Rename to __ prefixed variants.
	Add weak_alias.
	* math/w_j0l.c (j0l, y0l): Likewise.
	* math/w_jnl.c (jnl, ynl): Likewise.
	* sysdeps/ieee754/ldbl-96/s_nexttoward.c
	(__nexttowardl): Remove strong_alias.
	(nexttowardl): Remove weak_alias.
	* sysdeps/ieee754/ldbl-96/s_erfl.c
	(__erfl, __erfcl): Remove strong_alias.
	(erfl, erfcl): Remove weak_alias.

	* sysdeps/ieee754/ldbl-64-128/s_asinhl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_atanl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_cbrtl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_ceill.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_copysignl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_cosl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_erfl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_expm1l.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_fabsl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_finitel.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_floorl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_fpclassifyl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_frexpl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_ilogbl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_isinfl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_isnanl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_llrintl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_llroundl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_log1pl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_logbl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_lrintl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_lroundl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_modfl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_nearbyintl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_nextafterl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_nexttoward.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_nexttowardf.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_nexttowardfd.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_remquol.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_rintl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_roundl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_scalblnl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_scalbnl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_signbitl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_sincosl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_sinl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_tanhl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_tanl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/s_truncl.c: New file.
	* sysdeps/ieee754/ldbl-64-128/strtold_l.c: New file.
	* sysdeps/ieee754/ldbl-64-128/w_expl.c: New file.
	* sysdeps/ieee754/ldbl-opt/configure.in: New file.
	* sysdeps/ieee754/ldbl-opt/configure: New file.
	* sysdeps/ieee754/ldbl-opt/Makefile: New file.
	* sysdeps/ieee754/ldbl-opt/Versions: New file.
	* sysdeps/ieee754/ldbl-opt/cabs.c: New file.
	* sysdeps/ieee754/ldbl-opt/cabsl.c: New file.
	* sysdeps/ieee754/ldbl-opt/carg.c: New file.
	* sysdeps/ieee754/ldbl-opt/cargl.c: New file.
	* sysdeps/ieee754/ldbl-opt/cimag.c: New file.
	* sysdeps/ieee754/ldbl-opt/cimagl.c: New file.
	* sysdeps/ieee754/ldbl-opt/conj.c: New file.
	* sysdeps/ieee754/ldbl-opt/conjl.c: New file.
	* sysdeps/ieee754/ldbl-opt/creal.c: New file.
	* sysdeps/ieee754/ldbl-opt/creall.c: New file.
	* sysdeps/ieee754/ldbl-opt/math_ldbl_opt.c: New file.
	* sysdeps/ieee754/ldbl-opt/math_ldbl_opt.h: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-acos.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-acosh.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-asin.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-asinh.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-asprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-atan.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-atan2.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-atanh.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-cabs.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-cacos.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-cacosh.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-carg.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-casin.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-casinh.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-catan.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-catanh.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-cbrt.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-ccos.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-ccosh.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-ceil.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-cexp.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-cimag.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-clog.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-clog10.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-compat.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-compat.h: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-conj.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-copysign.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-cos.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-cosh.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-cpow.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-cproj.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-creal.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-csin.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-csinh.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-csqrt.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-ctan.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-ctanh.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-dprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-drem.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-erf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-erfc.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-exp.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-exp10.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-exp2.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-expm1.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-fabs.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-fdim.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-finite.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-floor.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-fma.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-fmax.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-fmin.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-fmod.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-fprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-fprintf_chk.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-frexp.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-fscanf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-fwprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-fwprintf_chk.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-fwscanf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-gamma.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-hypot.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-ilogb.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-iovfscanf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-isinf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-isnan.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-j0.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-j1.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-jn.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-ldexp.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-lgamma.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-lgamma_r.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-llrint.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-llround.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-log.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-log10.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-log1p.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-log2.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-logb.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-lrint.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-lround.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-modf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-nan.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-nearbyint.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-nextafter.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-nexttoward.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-nexttowardf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-obstack_printf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-obstack_vprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-pow.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-pow10.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-printf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-printf_chk.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-printf_fp.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-printf_size.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-qecvt.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-qecvt_r.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-qfcvt.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-qfcvt_r.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-qgcvt.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-remainder.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-remquo.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-rint.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-round.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-scalb.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-scalbln.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-scalbn.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-scanf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-signbit.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-significand.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-sin.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-sincos.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-sinh.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-snprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-snprintf_chk.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-sprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-sprintf_chk.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-sqrt.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-sscanf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-strfmon.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-strfmon_l.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-strtold.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-strtold_l.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-strtoldint.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-swprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-swprintf_chk.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-swscanf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-syslog.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-syslog_chk.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-tan.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-tanh.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-tgamma.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-trunc.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vasprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vdprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vfprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vfprintf_chk.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vfscanf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vfwprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vfwprintf_chk.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vfwscanf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vprintf_chk.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vscanf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vsnprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vsnprintf_chk.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vsprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vsprintf_chk.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vsscanf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vswprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vswprintf_chk.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vswscanf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vsyslog.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vsyslog_chk.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vwprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vwprintf_chk.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-vwscanf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-wcstold.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-wcstold_l.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-wcstoldint.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-wprintf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-wprintf_chk.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-wscanf.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-y0.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-y1.c: New file.
	* sysdeps/ieee754/ldbl-opt/nldbl-yn.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_asinh.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_atan.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_cacos.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_cacosh.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_cacoshl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_cacosl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_casin.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_casinh.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_casinhl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_casinl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_catan.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_catanh.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_catanhl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_catanl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_cbrt.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_ccos.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_ccosh.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_ccoshl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_ccosl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_ceil.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_cexp.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_cexpl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_clog.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_clog10.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_clog10l.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_clogl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_copysign.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_cpow.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_cpowl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_cproj.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_cprojl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_csin.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_csinh.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_csinhl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_csinl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_csqrt.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_csqrtl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_ctan.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_ctanh.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_ctanhl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_ctanl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_erf.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_expm1.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_fabs.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_fdim.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_fdiml.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_finite.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_floor.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_fma.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_fmal.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_fmax.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_fmaxl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_fmin.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_fminl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_frexp.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_ilogb.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_isinf.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_isnan.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_ldexp.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_ldexpl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_llrint.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_llround.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_log1p.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_logb.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_lrint.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_lround.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_modf.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_nan.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_nanl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_nearbyint.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_nextafter.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_remquo.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_rint.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_round.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_scalbln.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_scalbn.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_significand.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_significandl.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_sin.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_sincos.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_tan.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_tanh.c: New file.
	* sysdeps/ieee754/ldbl-opt/s_trunc.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_acos.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_acosh.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_acoshl.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_acosl.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_asin.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_asinl.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_atan2.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_atan2l.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_atanh.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_atanhl.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_cosh.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_coshl.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_drem.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_dreml.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_exp.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_exp10.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_exp10l.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_fmod.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_fmodl.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_hypot.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_hypotl.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_j0.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_j0l.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_j1.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_j1l.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_jn.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_jnl.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_lgamma.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_lgamma_r.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_lgammal.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_lgammal_r.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_log.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_log10.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_log10l.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_log2.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_log2l.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_logl.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_pow.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_powl.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_remainder.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_remainderl.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_scalb.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_scalbl.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_sinh.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_sinhl.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_sqrt.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_sqrtl.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_tgamma.c: New file.
	* sysdeps/ieee754/ldbl-opt/w_tgammal.c: New file.

	* sysdeps/unix/sysv/linux/sparc/bits/wordsize.h: New file.
	* sysdeps/unix/sysv/linux/sparc/sparc32/Implies: New file.
	* sysdeps/sparc/sparc32/Implies: Move ldbl-128 first and flt-32
	after dbl-64.
	* sysdeps/unix/sysv/linux/sparc/sparc32/Versions (NLDBL_VERSION):
	%define this to to GLIBC_2.4.
	* sysdeps/sparc/sparc32/fpu/e_sqrtl.c: New file.
	* sysdeps/sparc/sparc32/fpu/s_fabs.c: New file.
	* sysdeps/sparc/sparc32/fpu/s_fabsf.S: New file.
	* sysdeps/sparc/sparc32/fpu/s_fabsl.c: New file.
	* sysdeps/sparc/sparc32/soft-fp/q_qtoui.c: Removed.
	* sysdeps/sparc/sparc32/soft-fp/q_qtoux.c: Removed.
	* sysdeps/sparc/sparc32/soft-fp/q_qtox.c: Removed.
	* sysdeps/sparc/sparc32/soft-fp/q_uitoq.c: Removed.
	* sysdeps/sparc/sparc32/soft-fp/q_uxtoq.c: Removed.
	* sysdeps/sparc/sparc32/soft-fp/q_xtoq.c: Removed.
	* sysdeps/sparc/sparc32/soft-fp/q_lltoq.c: New file.
	* sysdeps/sparc/sparc32/soft-fp/q_qtoll.c: New file.
	* sysdeps/sparc/sparc32/soft-fp/q_qtou.c: New file.
	* sysdeps/sparc/sparc32/soft-fp/q_qtoull.c: New file.
	* sysdeps/sparc/sparc32/soft-fp/q_ulltoq.c: New file.
	* sysdeps/sparc/sparc32/soft-fp/q_utoq.c: New file.
	* sysdeps/sparc/sparc32/soft-fp/Versions: New file.
	* sysdeps/sparc/fpu/bits/mathinline.h (__unordered_cmp,
	__unordered_v9cmp): Define differently depending on
	-m32 -mlong-double-{64,128}.
	(__signbitl, sqrtl, __ieee754_sqrtl): New inlines.
	* sysdeps/sparc/fpu/bits/mathdef.h (__NO_LONG_DOUBLE_MATH): Remove.
	* sysdeps/sparc/sparc32/soft-fp/Makefile (sparc32-quad-routines):
	Set.
	(sysdep-routines): Add sparc32-quad-routines.
	* sysdeps/sparc/sparc32/soft-fp/sfp-machine.h: Include stdlib.h.
	(FP_HANDLE_EXCEPTIONS): Call ___Q_simulate_exceptions as a normal
	function.
	* sysdeps/sparc/sparc32/soft-fp/q_sqrt.c (__ieee754_sqrtl): New
	alias to _Q_sqrt.
	* sysdeps/sparc/sparc32/soft-fp/q_div.c (_Q_div): Fix a typo.
	* sysdeps/sparc/sparc64/soft-fp/sfp-machine.h: Include stdlib.h.
	* sysdeps/sparc/sparc32/fpu/libm-test-ulps: Update.

	* libio/libio.h (_IO_vfscanf, _IO_vfprintf): Remove __THROW.
	(_IO_vfwscanf, _IO_vfwprintf): Likewise.
	* libio/libioP.h (_IO_vdprintf): Likewise.

2006-01-13  Richard Henderson  <rth@redhat.com>

	* sysdeps/unix/sysv/linux/alpha/sysdep.h (PTR_MANGLE, PTR_MANGLE2,
	PTR_DEMANGLE, PTR_DEMANGLE2): Move ...
	* sysdeps/unix/alpha/sysdep.h: ... here.
	* sysdeps/unix/sysv/linux/alpha/fxstatat.c: Define __GI___fxstatat64.

2006-01-13  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/powerpc/sys/procfs.h (ELF_NVRREG): Fix
	value for PowerPC64.

2006-01-12  Roland McGrath  <roland@redhat.com>

	* sysdeps/s390/jmpbuf-offsets.h: New file.
	* sysdeps/s390/jmpbuf-unwind.h: Include it.

	* sysdeps/alpha/__longjmp.S: Include <jmpbuf-offsets.h>
	instead of <bits/setjmp.h>.
	* sysdeps/alpha/setjmp.S: Likewise.
	* sysdeps/i386/__longjmp.S: Likewise.
	* sysdeps/i386/bsd-_setjmp.S: Likewise.
	* sysdeps/i386/bsd-setjmp.S: Likewise.
	* sysdeps/i386/setjmp.S: Likewise.
	* sysdeps/powerpc/powerpc32/__longjmp-common.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/__longjmp-common.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/setjmp-common.S:
	* sysdeps/powerpc/powerpc32/setjmp-common.S: Likewise.
	* sysdeps/powerpc/powerpc64/__longjmp-common.S: Likewise.
	* sysdeps/powerpc/powerpc64/setjmp-common.S: Likewise.
	* sysdeps/sh/sh3/setjmp.S: Likewise.
	* sysdeps/sh/sh4/setjmp.S: Likewise.
	* sysdeps/sparc/sparc32/__longjmp.S: Likewise.
	* sysdeps/sparc/sparc32/setjmp.S: Likewise.
	* sysdeps/x86_64/__longjmp.S: Likewise.
	* sysdeps/x86_64/setjmp.S: Likewise.
	* sysdeps/mach/hurd/i386/longjmp-ts.c: Include <jmpbuf-offsets.h>.
	* sysdeps/mach/hurd/powerpc/longjmp-ts.c: Likewise.
	* sysdeps/mach/hurd/alpha/longjmp-ts.c: Likewise.
	* sysdeps/alpha/jmpbuf-unwind.h: Likewise.
	* sysdeps/hppa/jmpbuf-unwind.h: Likewise.
	* sysdeps/i386/jmpbuf-unwind.h: Likewise.
	* sysdeps/powerpc/jmpbuf-unwind.h: Likewise.
	* sysdeps/sparc/sparc32/jmpbuf-unwind.h: Likewise.
	* sysdeps/sparc/sparc64/jmpbuf-unwind.h: Likewise.
	* sysdeps/x86_64/jmpbuf-unwind.h: Likewise.
	* setjmp/jmpbuf-offsets.h: File removed.
	* include/bits/setjmp.h: File removed.

2006-01-11  Ulrich Drepper  <drepper@redhat.com>

	* libio/wmemstream.c: New file.
	* libio/stdio.h: Declare open_wmemstream.
	* libio/Versions: Export open_wmemstream for GLIBC_2.4.
	* libio/Makefile (routines): Add wmemstream.
	(tests): Add tst-memstream1, tst-memstream2, tst-wmemstream2, and
	tst-wmemstream2.
	* libio/tst-memstream1.c: New file.
	* libio/tst-memstream2.c: New file.
	* libio/tst-wmemstream1.c: New file.
	* libio/tst-wmemstream2.c: New file.

	* libio/memstream.c (_IO_mem_sync): Remove useless call to
	_IO_default_sync.

	* elf/check-textrel.c: Add missing argument.

	* Makerules: Define build-module-asneeded.
	* iconvdata/extra-module.mk: Use build-module-asneeded.
	needed.

2006-01-09  Richard Henderson  <rth@redhat.com>

	* iconvdata/extra-module.mk ($(objpfx)$(mod).so): Depend on ld.so.
	* sysdeps/alpha/__longjmp.S: Use PTR_DEMANGLE.
	* sysdeps/alpha/setjmp.S: Likewise.  Avoid __sigjmp_save for rtld;
	tailcall in libc.so.
	* sysdeps/unix/sysv/linux/alpha/sysdep.h (PTR_MANGLE): Define.
	(PTR_MANGLE2): Define.

2006-01-11  Ulrich Drepper  <drepper@redhat.com>

	* elf/check-localplt.c: New file.
	* elf/Makefile: Add rules to build and run check-localplt.
	* scripts/data/localplt-x86_64-linux-gnu.data: New file.
	* scripts/data/localplt-i386-linux-gnu.data: New file.

	* include/sys/stat.h: Add libc_hidden_proto for __fxstatat64.
	* sysdeps/unix/sysv/linux/fxstatat64.c: Add libc_hidden_def for
	__fxstatat64.
	* sysdeps/unix/sysv/linux/wordsize-64/fxstatat.c: Add
	__GI___fxstatat64 alias.

	* libio/memstream.c (_IO_mem_finish): Fix potential memory leak if
	realloc fails.

	* include/sched.h: Add libc_hidden_proto for __sched_yield.

	* libio/genops.c (_IO_unbuffer_write): Give concurrently running
	threads the chance to work correctly by trying to lock the stream.
	If this does not work, proceed without locking.

2006-01-10  Ulrich Drepper  <drepper@redhat.com>

	* libio/genops.c (_IO_unbuffer_write): Don't always free the
	buffer.  This is not necessary except in debug mode.  If we don't
	free the buffer but the FILE structure to a list.
	(buffer_free): New function.  Free buffers or tell _IO_unbuffer_write
	to do so.
	* libio/libio.h (struct _IO_FILE): Add new members to keep track
	of which buffers have to be freed.

	* iconv/gconv_cache.c (free_mem): Don't call munmap if gconv_cache
	is NULL.

2005-10-14  Paul Eggert  <eggert@cs.ucla.edu>

	* malloc/obstack.c: Fix old comments.  Update FSF snail mail address.
	* malloc/obstack.h: Likewise.

	[BZ #321]
	Fix portability bugs encountered when porting to Itanium.
	* malloc/obstack.h (obstack_empty_p, obstack_finish): Do not
	assume that the "contents" member is suitably aligned.  It is
	not, for some hosts and alignments: e.g., Itanium, long-double.
	* malloc/obstack.c (_obstack_begin, _obstack_begin_1,
	_obstack_newchunk): Likewise.
	* malloc/obstack.c: Include <stddef.h>, for size_t.
	Include <inttypes.h>, <stdint.h> if needed and available.
	(DEFAULT_ALIGNMENT): Now an enum constant, not a macro.
	Use C89 offsetof rather than K&R trick.
	Use the maximum alignment of uintmax_t, long double, void *
	rather than the alignment of double.
	(union fooround): Use uintmax_t, long double, void * members
	rather than just long and double.

	[BZ #321]
	Fix portability bugs encountered when porting to the IBM iSeries,
	where pointers are 256 bits wide and no integers are that wide.
	* malloc/obstack.h (__PTR_TO_INT, __INT_TO_PTR): Remove.
	All uses changed to:
	(__BPTR_ALIGN, __PTR_ALIGN): New macros.
	(struct _obstack_chunk.temp): Change from int to a union
	of pointer and int.  All uses changed.

	[BZ #321]
	* malloc/obstack.c (print_and_abort) [!_LIBC]:
	Call fprintf (stderr, ...), not __fxprintf (NULL, ...).
	[_LIBC && USE_IN_LIBIO]: Don't include <wchar.h>; no longer needed.

2006-01-10  Derek Price  <derek@ximbiot.com>
	    Paul Eggert  <eggert@cs.ucla.edu>

	[BZ #1060]
	* posix/glob.c: Assume freestanding C89 compiler.  Simplify cruft that
	may be replaced with GNULIB modules.  Make no attempt to find 64-bit
	versions of file access functions directly when [!_LIBC].
	Don't define GLOB_* macros here.
	(DIRENT_MUST_BE, DIRENT_MIGHT_BE_SYMLINK, DIRENT_MIGHT_BE_DIR): New
	macros to abstract dirent->d_type access.
	(GETPW_R_SIZE_MAX, GET_LOGIN_NAME_MAX): New macros to abstract sysconf
	access.

2006-01-10  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/sysv/linux/powerpc/powerpc64/sysdep.h
	(PTR_MANGLE): Fix cast.

	* timezone/test-tz.c: Revert last change, updating to match
	tzdata2005r definition of "MST".

2006-01-10  Ulrich Drepper  <drepper@redhat.com>

	* include/bits/setjmp.h: Don't include jmpbuf-offsets.h if _ISOMAC is
	defined.

2006-01-10  Andreas Jaeger  <aj@suse.de>

	* include/time.h: Use normal comments.

2006-01-10  Thomas Schwinge  <tschwinge@gnu.org>

	* hurd/sigunwind.c: Include <jmpbuf-unwind.h> instead of <setjmp.h>.
	* sysdeps/mach/hurd/jmp-unwind.c: Likewise.

2006-01-10  Jakub Jelinek  <jakub@redhat.com>

	* wcsmbs/bits/wchar2.h (vswprintf): Call __vswprintf_alias rather than
	vswprintf recursively.

2006-01-10  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/x86_64/bits/setjmp.h: Add back accidently removed #endif.

2006-01-10  Roland McGrath  <roland@redhat.com>

	* include/bits/setjmp.h: New file.
	* setjmp/jmpbuf-offsets.h: New file.
	* sysdeps/alpha/bits/setjmp.h: Move JB_* macros ...
	* sysdeps/alpha/jmpbuf-offsets.h: ... here, new file.
	* sysdeps/hppa/bits/setjmp.h (JB_SP): Macro moved ...
	* sysdeps/hppa/jmpbuf-offsets.h: ... here, new file.
	* sysdeps/i386/bits/setjmp.h: Move JB_* macros ...
	* sysdeps/i386/jmpbuf-offsets.h: ... here, new file.
	* sysdeps/mips/bits/setjmp.h (JB_PC): Macro removed.
	* sysdeps/powerpc/bits/setjmp.h: Move JB_* macros ...
	* sysdeps/powerpc/jmpbuf-offsets.h: ... here, new file.
	* sysdeps/s390/bits/setjmp.h: Remove __JB_* macros.
	* sysdeps/sh/bits/setjmp.h (JB_SIZE): Macro moved ...
	* sysdeps/sh/jmpbuf-offsets.h: ... here, new file.
	* sysdeps/sparc/sparc32/bits/setjmp.h: Move JB_* macros ...
	* sysdeps/sparc/sparc32/jmpbuf-offsets.h: ... here, new file.
	* sysdeps/unix/sysv/linux/sparc/bits/setjmp.h: Remove JB_* macros.
	* sysdeps/x86_64/bits/setjmp.h: Move JB_* macros ...
	* sysdeps/x86_64/jmpbuf-offsets.h: ... here, new file.

	* sysdeps/powerpc/bits/setjmp.h (_JMPBUF_UNWINDS): Move macro ...
	* sysdeps/powerpc/jmpbuf-unwind.h: ... here.
	* sysdeps/alpha/bits/setjmp.h (_JMPBUF_UNWINDS): Move macro ...
	* sysdeps/alpha/jmpbuf-unwind.h: ... here.
	* sysdeps/sparc/sparc32/bits/setjmp.h (_JMPBUF_UNWINDS): Move macro ...
	* sysdeps/sparc/sparc32/jmpbuf-unwind.h: ... here.
	* sysdeps/i386/bits/setjmp.h (_JMPBUF_UNWINDS): Move macro ...
	* sysdeps/i386/jmpbuf-unwind.h: ... here.
	* sysdeps/x86_64/bits/setjmp.h (_JMPBUF_UNWINDS): Move macro ...
	* sysdeps/x86_64/jmpbuf-unwind.h: ... here.
	* sysdeps/sh/bits/setjmp.h (_JMPBUF_UNWINDS): Move macro ...
	* sysdeps/sh/jmpbuf-unwind.h: ... here.
	* sysdeps/hppa/bits/setjmp.h (_JMPBUF_UNWINDS): Move macro ...
	* sysdeps/hppa/jmpbuf-unwind.h: ... here, new file.
	* sysdeps/mips/bits/setjmp.h (_JMPBUF_UNWINDS): Move macro ...
	* sysdeps/mips/jmpbuf-unwind.h: ... here.
	* sysdeps/m68k/bits/setjmp.h (_JMPBUF_UNWINDS): Move macro ...
	* sysdeps/m68k/jmpbuf-unwind.h: ... here, new file.
	* sysdeps/s390/bits/setjmp.h (_JMPBUF_UNWINDS): Move macro ...
	* sysdeps/s390/jmpbuf-unwind.h: ... here.
	* sysdeps/unix/sysv/linux/ia64/bits/setjmp.h (_JMPBUF_UNWINDS):
	Move macro ...
	* sysdeps/ia64/jmpbuf-unwind.h: ... here.
	* sysdeps/unix/sysv/linux/sparc/bits/setjmp.h (_JMPBUF_UNWINDS):
	Move macro ...
	* sysdeps/sparc/sparc64/jmpbuf-unwind.h: ... here.

	* sysdeps/alpha/jmpbuf-unwind.h: New file, moved from nptl/.
	* sysdeps/i386/jmpbuf-unwind.h: New file, moved from nptl/.
	* sysdeps/ia64/jmpbuf-unwind.h: New file, moved from nptl/.
	* sysdeps/mips/jmpbuf-unwind.h: New file, moved from nptl/.
	* sysdeps/powerpc/jmpbuf-unwind.h: New file, moved from nptl/.
	* sysdeps/s390/jmpbuf-unwind.h: New file, moved from nptl/.
	* sysdeps/sh/jmpbuf-unwind.h: New file, moved from nptl/.
	* sysdeps/sparc/sparc32/jmpbuf-unwind.h: New file, moved from nptl/.
	* sysdeps/sparc/sparc64/jmpbuf-unwind.h: New file, moved from nptl/.
	* sysdeps/x86_64/jmpbuf-unwind.h: New file, moved from nptl/.

	* sysdeps/linkmap.h: File removed.

2006-01-07  Carlos O'Donell  <carlos@systemhalted.org>

	* sysdeps/hppa/elf/start.S (_start): Use PLABEL32 relocations
	by using LR and RR. Add %sr0 to iitlbp.

2006-01-09  Roland McGrath  <roland@redhat.com>

	* timezone/private.h: Update from tzcode2005r.
	* timezone/tzfile.h: Likewise.
	* timezone/zdump.c: Likewise.
	* timezone/zic.c: Likewise.
	* timezone/africa: Update from tzdata2005r.
	* timezone/antarctica: Likewise.
	* timezone/asia: Likewise.
	* timezone/australasia: Likewise.
	* timezone/backward: Likewise.
	* timezone/europe: Likewise.
	* timezone/northamerica: Likewise.
	* timezone/southamerica: Likewise.
	* timezone/systemv: Likewise.

	* elf/Makefile ($(objpfx)reldep5.out): Fix dependency typo,
	so we depend on $(objpfx)reldepmod6.so as intended.

2006-01-09  Ulrich Drepper  <drepper@redhat.com>

	[BZ #2126]
	* sysdeps/i386/i686/strtok.S: Store pointer to NUL byte if NULL is
	returned.
	* sysdeps/i386/strtok.S: Likewise.
	* sysdeps/x86_64/strtok.S: Likewise.
	* string/Makefile (tests): Add bug-strtok1.
	* string/bug-strtok1.c: New file.

	* elf/check-textrel.c (AB): Also check for writable and executable
	segments.

	* sysdeps/ieee754/dbl-64/e_exp2.c: Remove section attribute from
	const variables, gas produces garbage.
	* sysdeps/ieee754/flt-32/e_exp2f.c: Likewise.
	* sysdeps/ieee754/flt-32/e_expf.c: Likewise.
	* sysdeps/ieee754/flt-32/s_expm1f.c: Likewise.

2006-01-09  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/sparc/bits/setjmp.h (_JMPBUF_UNWINDS): Add
	stack bias to mc_fp field.

	* sysdeps/unix/sysv/linux/sparc/sparc64/kernel_stat.h
	(struct kernel_stat): Rename st_[amc]time fields to st_[amc]time_sec.
	(struct kernel_stat64): New type.
	(_HAVE___UNUSED1, _HAVE___UNUSED2, _HAVE_STAT___UNUSED1,
	_HAVE_STAT___UNUSED2, _HAVE_STAT___UNUSED3, _HAVE_STAT___UNUSED4,
	_HAVE_STAT___UNUSED5, _HAVE_STAT___PAD1, _HAVE_STAT___PAD2,
	_HAVE_STAT64___UNUSED1, _HAVE_STAT64___UNUSED2,
	_HAVE_STAT64___UNUSED3, _HAVE_STAT64___UNUSED4,
	_HAVE_STAT64___UNUSED5, _HAVE_STAT64___PAD1, _HAVE_STAT64___PAD2):
	Remove.
	* sysdeps/unix/sysv/linux/sparc/sparc64/xstat.c: Use i386/xstat.c.
	* sysdeps/unix/sysv/linux/sparc/sparc64/fxstatat.c:
	Use i386/fxstatat.c.
	* sysdeps/unix/sysv/linux/sparc/sparc64/lxstat.c: Use i386/lxstat.c.
	* sysdeps/unix/sysv/linux/sparc/sparc64/xstatconv.c: New file.
	* sysdeps/unix/sysv/linux/sparc/bits/stat.h (struct stat,
	struct stat64): Add nsec resolution for 64-bit code like already done
	for 32-bit code.
	* sysdeps/unix/sysv/linux/kernel-features.h
	(__ASSUME_TRUNCATE64_SYSCALL, __ASSUME_MMAP2_SYSCALL): Don't define
	for sparc64.
	(__ASSUME_STAT64_SYSCALL): Only define for sparc64 for >= 2.6.12
	kernels.

	* scripts/data/c++-types-sparc-linux-gnu.data: New file.
	* scripts/data/c++-types-sparc64-linux-gnu.data: New file.
	* scripts/data/c++-types-alpha-linux-gnu.data: Adjust.

2006-01-08  Roland McGrath  <roland@redhat.com>

	[BZ #1535]
	* sysdeps/unix/get_child_max.c: New file.
	* posix/get_child_max.c: New file.
	* posix/Makefile (routines): Add it.
	* include/sys/sysinfo.h (__get_child_max): Declare it.
	* sysdeps/posix/sysconf.c (__sysconf) [! CHILD_MAX]: Use it.

	* sysdeps/unix/sysv/linux/futimes.c [!__NR_fcntl && __NR_fcntl64]: Use
	fcntl64 syscall instead.

	* stdio-common/tst-fmemopen2.c (do_test): Add a cast.
	* stdio-common/printf-parsemb.c (__find_specmb): Likewise.

	* sysdeps/unix/sysv/linux/alpha/adjtime.c: Use <> instead of "" in
	#include for kernel-features.h.
	* sysdeps/unix/sysv/linux/alpha/dl-sysdep.c: Likewise.
	* sysdeps/unix/sysv/linux/alpha/fraiseexcpt.c: Likewise.
	* sysdeps/unix/sysv/linux/alpha/getitimer.S: Likewise.
	* sysdeps/unix/sysv/linux/alpha/getrusage.S: Likewise.
	* sysdeps/unix/sysv/linux/alpha/gettimeofday.S: Likewise.
	* sysdeps/unix/sysv/linux/alpha/msgctl.c: Likewise.
	* sysdeps/unix/sysv/linux/alpha/select.S: Likewise.
	* sysdeps/unix/sysv/linux/alpha/semctl.c: Likewise.
	* sysdeps/unix/sysv/linux/alpha/setitimer.S: Likewise.
	* sysdeps/unix/sysv/linux/alpha/settimeofday.S: Likewise.
	* sysdeps/unix/sysv/linux/alpha/shmctl.c: Likewise.
	* sysdeps/unix/sysv/linux/alpha/utimes.S: Likewise.
	* sysdeps/unix/sysv/linux/alpha/wait4.S: Likewise.
	* sysdeps/unix/sysv/linux/alpha/xstatconv.h: Likewise.
	* sysdeps/unix/sysv/linux/check_pf.c: Likewise.
	* sysdeps/unix/sysv/linux/clock_getcpuclockid.c: Likewise.
	* sysdeps/unix/sysv/linux/clock_getres.c: Likewise.
	* sysdeps/unix/sysv/linux/clock_gettime.c: Likewise.
	* sysdeps/unix/sysv/linux/clock_nanosleep.c: Likewise.
	* sysdeps/unix/sysv/linux/clock_settime.c: Likewise.
	* sysdeps/unix/sysv/linux/dl-execstack.c: Likewise.
	* sysdeps/unix/sysv/linux/dl-osinfo.h: Likewise.
	* sysdeps/unix/sysv/linux/dl-sysdep.c: Likewise.
	* sysdeps/unix/sysv/linux/fstatvfs64.c: Likewise.
	* sysdeps/unix/sysv/linux/ftruncate64.c: Likewise.
	* sysdeps/unix/sysv/linux/futimes.c: Likewise.
	* sysdeps/unix/sysv/linux/futimesat.c: Likewise.
	* sysdeps/unix/sysv/linux/fxstat64.c: Likewise.
	* sysdeps/unix/sysv/linux/fxstatat64.c: Likewise.
	* sysdeps/unix/sysv/linux/getcwd.c: Likewise.
	* sysdeps/unix/sysv/linux/getdents.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/chown.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/fchown.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/fchownat.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/fcntl.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/fxstat.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/fxstatat.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/getegid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/geteuid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/getgid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/getresgid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/getresuid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/getrlimit.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/getuid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/lchown.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/lockf64.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/lxstat.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/mmap.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/mmap64.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/msgctl.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/posix_fadvise64.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/semctl.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/setegid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/seteuid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/setfsgid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/setfsuid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/setgid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/setgroups.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/setregid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/setresgid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/setresuid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/setreuid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/setrlimit.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/setuid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/shmctl.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/xstat.c: Likewise.
	* sysdeps/unix/sysv/linux/ifreq.c: Likewise.
	* sysdeps/unix/sysv/linux/ldsodefs.h: Likewise.
	* sysdeps/unix/sysv/linux/lxstat64.c: Likewise.
	* sysdeps/unix/sysv/linux/m68k/chown.c: Likewise.
	* sysdeps/unix/sysv/linux/m68k/fchownat.c: Likewise.
	* sysdeps/unix/sysv/linux/mips/ftruncate64.c: Likewise.
	* sysdeps/unix/sysv/linux/mips/sigaction.c: Likewise.
	* sysdeps/unix/sysv/linux/mips/truncate64.c: Likewise.
	* sysdeps/unix/sysv/linux/mmap64.c: Likewise.
	* sysdeps/unix/sysv/linux/msgctl.c: Likewise.
	* sysdeps/unix/sysv/linux/netlinkaccess.h: Likewise.
	* sysdeps/unix/sysv/linux/opendir.c: Likewise.
	* sysdeps/unix/sysv/linux/poll.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/dl-sysdep.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/fe_nomask.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/ftruncate64.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/pread.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/pread64.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/pwrite.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/pwrite64.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/truncate64.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/fe_nomask.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/getcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/makecontext.S: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/pread.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/pread64.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/pwrite.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/pwrite64.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/setcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/swapcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/pread.c: Likewise.
	* sysdeps/unix/sysv/linux/pread64.c: Likewise.
	* sysdeps/unix/sysv/linux/prof-freq.c: Likewise.
	* sysdeps/unix/sysv/linux/pwrite.c: Likewise.
	* sysdeps/unix/sysv/linux/pwrite64.c: Likewise.
	* sysdeps/unix/sysv/linux/s390/s390-32/chown.c: Likewise.
	* sysdeps/unix/sysv/linux/s390/s390-32/fchownat.c: Likewise.
	* sysdeps/unix/sysv/linux/s390/s390-32/lchown.c: Likewise.
	* sysdeps/unix/sysv/linux/semctl.c: Likewise.
	* sysdeps/unix/sysv/linux/setegid.c: Likewise.
	* sysdeps/unix/sysv/linux/seteuid.c: Likewise.
	* sysdeps/unix/sysv/linux/shmctl.c: Likewise.
	* sysdeps/unix/sysv/linux/sigaction.c: Likewise.
	* sysdeps/unix/sysv/linux/sigpending.c: Likewise.
	* sysdeps/unix/sysv/linux/sigprocmask.c: Likewise.
	* sysdeps/unix/sysv/linux/sigsuspend.c: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc32/semctl.c: Likewise.
	* sysdeps/unix/sysv/linux/statvfs64.c: Likewise.
	* sysdeps/unix/sysv/linux/syslog.c: Likewise.
	* sysdeps/unix/sysv/linux/testrtsig.h: Likewise.
	* sysdeps/unix/sysv/linux/truncate64.c: Likewise.
	* sysdeps/unix/sysv/linux/utimes.c: Likewise.
	* sysdeps/unix/sysv/linux/xstat64.c: Likewise.
	* sysdeps/unix/sysv/linux/xstatconv.h: Likewise.

2006-01-07  Roland McGrath  <roland@redhat.com>

	* po/libc.pot: Regenerated.

	* po/.cvsignore: List libc.pot.files, and not any .pot names.

	* manual/maint.texi (Porting): Don't mention Dist files.
	* sysdeps/alpha/soft-fp/Dist: File removed.
	* sysdeps/alpha/Dist: File removed.
	* sysdeps/i386/i686/Dist: File removed.
	* sysdeps/i386/soft-fp/Dist: File removed.
	* sysdeps/i386/Dist: File removed.
	* sysdeps/mips/soft-fp/Dist: File removed.
	* sysdeps/mips/mips64/soft-fp/Dist: File removed.
	* sysdeps/mips/mips64/Dist: File removed.
	* sysdeps/mips/Dist: File removed.
	* sysdeps/wordsize-32/Dist: File removed.
	* sysdeps/m68k/fpu/switch/Dist: File removed.
	* sysdeps/m68k/fpu/Dist: File removed.
	* sysdeps/powerpc/powerpc64/Dist: File removed.
	* sysdeps/powerpc/soft-fp/Dist: File removed.
	* sysdeps/powerpc/powerpc32/fpu/Dist: File removed.
	* sysdeps/powerpc/powerpc32/Dist: File removed.
	* sysdeps/powerpc/fpu/Dist: File removed.
	* sysdeps/powerpc/Dist: File removed.
	* sysdeps/unix/common/Dist: File removed.
	* sysdeps/unix/bsd/bsd4.4/Dist: File removed.
	* sysdeps/unix/bsd/Dist: File removed.
	* sysdeps/unix/sysv/linux/alpha/Dist: File removed.
	* sysdeps/unix/sysv/linux/i386/Dist: File removed.
	* sysdeps/unix/sysv/linux/mips/mips64/Dist: File removed.
	* sysdeps/unix/sysv/linux/mips/Dist: File removed.
	* sysdeps/unix/sysv/linux/m68k/Dist: File removed.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/Dist: File removed.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/Dist: File removed.
	* sysdeps/unix/sysv/linux/powerpc/aix/Dist: File removed.
	* sysdeps/unix/sysv/linux/powerpc/Dist: File removed.
	* sysdeps/unix/sysv/linux/sparc/sparc32/Dist: File removed.
	* sysdeps/unix/sysv/linux/sparc/sparc64/Dist: File removed.
	* sysdeps/unix/sysv/linux/sparc/Dist: File removed.
	* sysdeps/unix/sysv/linux/ia64/Dist: File removed.
	* sysdeps/unix/sysv/linux/s390/s390-64/Dist: File removed.
	* sysdeps/unix/sysv/linux/s390/Dist: File removed.
	* sysdeps/unix/sysv/linux/s390/s390-32/Dist: File removed.
	* sysdeps/unix/sysv/linux/sh/Dist: File removed.
	* sysdeps/unix/sysv/linux/x86_64/Dist: File removed.
	* sysdeps/unix/sysv/linux/hppa/Dist: File removed.
	* sysdeps/unix/sysv/linux/Dist: File removed.
	* sysdeps/unix/sysv/Dist: File removed.
	* sysdeps/unix/Dist: File removed.
	* sysdeps/generic/Dist: File removed.
	* sysdeps/sparc/sparc32/soft-fp/Dist: File removed.
	* sysdeps/sparc/sparc32/sparcv9/Dist: File removed.
	* sysdeps/sparc/sparc32/sparcv8/Dist: File removed.
	* sysdeps/sparc/sparc32/Dist: File removed.
	* sysdeps/sparc/sparc64/soft-fp/Dist: File removed.
	* sysdeps/sparc/sparc64/Dist: File removed.
	* sysdeps/sparc/Dist: File removed.
	* sysdeps/gnu/Dist: File removed.
	* sysdeps/ia64/fpu/Dist: File removed.
	* sysdeps/ia64/Dist: File removed.
	* sysdeps/mach/mips/Dist: File removed.
	* sysdeps/mach/hurd/alpha/Dist: File removed.
	* sysdeps/mach/hurd/i386/Dist: File removed.
	* sysdeps/mach/hurd/mips/Dist: File removed.
	* sysdeps/mach/hurd/powerpc/Dist: File removed.
	* sysdeps/mach/hurd/Dist: File removed.
	* sysdeps/s390/s390-64/Dist: File removed.
	* sysdeps/s390/Dist: File removed.
	* sysdeps/s390/s390-32/Dist: File removed.
	* sysdeps/sh/Dist: File removed.
	* sysdeps/posix/Dist: File removed.
	* sysdeps/ieee754/dbl-64/Dist: File removed.
	* sysdeps/ieee754/ldbl-128/Dist: File removed.
	* sysdeps/ieee754/flt-32/Dist: File removed.
	* sysdeps/ieee754/Dist: File removed.
	* sysdeps/x86_64/soft-fp/Dist: File removed.
	* sysdeps/x86_64/Dist: File removed.
	* sysdeps/hppa/Dist: File removed.

	* Makerules (common-clean): Don't remove distinfo file.
	($(objpfx)distinfo): Target removed.
	* manual/Makefile (mostlyclean): Don't remove distinfo file.
	(glibc-targets): Remove echo-distinfo.

	* scripts/list-sources.sh: New file.
	* Makefile (TAGS): New target.
	* po/Makefile (libc.pot, libc.pot.files): New targets.
	* Makeconfig (XGETTEXT): New variable.
	* Makerules ($(..)po/%.pot): Rule removed.
	(TAGS): Target removed.
	* Rules (subdir_TAGS): Target removed.
	* MakeTAGS: File removed.

	* Makefile (iconvdata/% localedata/% po/% manual/%): Depend on FORCE.
	* Makeconfig ($(all-Depend-files)): New targets with no-op commands.

2004-08-03  Marco Gerards  <marco@gnu.org>

	[BZ #2119]
	* sysdeps/mach/hurd/bits/ioctls.h (SIOCGIFHWADDR): New macro.

2006-01-07  Ulrich Drepper  <drepper@redhat.com>

	* stdio-common/tstdiomisc.c (F): Use NAN to get NaN value.

2006-01-06  Ulrich Drepper  <drepper@redhat.com>

	* elf/tst-tls8.c (do_test): Use $ORIGIN in module names.

2006-01-03  Steven Munroe  <sjmunroe@us.ibm.com>

	* sysdeps/generic/sysdep.h (cfi_same_value): Define macro.

	* sysdeps/powerpc/powerpc32/dl-trampoline.S (_dl_runtime_resolve,
	_dl_profile_resolve): Add CFI directives for stack and LR save.
	Save LR in LRSAVE of previous frame per ABI.
	* sysdeps/powerpc/powerpc32/fpu/__longjmp-common.S: Add CFI directives
	for LR save.
	* sysdeps/powerpc/powerpc32/lshift.S: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/makecontext.S
	(__makecontext, __novec_makecontext): Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_ceil.S: Add CFI directive
	for LR save to register.
	* sysdeps/powerpc/powerpc32/fpu/s_ceilf.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_floor.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_floorf.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_rint.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_rintf.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_round.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_roundf.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_trunc.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_truncf.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/setjmp-common.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_copysign.S: Add CFI directive
	for stack.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/clone.S: Likewise.
	* sysdeps/powerpc/powerpc32/ppc-mcount.S: Add CFI directives for stack
	and LR save.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/brk.S: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/getcontext-common.S:
	Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/setcontext-common.S:
	Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/swapcontext-common.S:
	Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_lround.S:  Likewise.  Don't use
	negative stack addressing.

	* sysdeps/powerpc/powerpc64/dl-trampoline.S (_dl_runtime_resolve,
	_dl_profile_resolve): Add CFI directives for stack and LR save.
	* sysdeps/powerpc/powerpc64/fpu/s_copysign.S: Add CFI directives
	for stack.
	* sysdeps/powerpc/powerpc64/ppc-mcount.S (_mcount): Add CFI
	directives for stack and LR save.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/brk.S (__brk): Add CFI
	directives for stack.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/clone.S (__clone): Add CFI
	directives for stack.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/getcontext.S
	(__getcontext, __novec_getcontext): Add CFI directives for stack
	and LR save.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/makecontext.S
	(__makecontext): Add CFI directives for stack and LR save.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/setcontext.S
	(__setcontext, __novec_setcontext): Add CFI directives for stack
	and LR save.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/swapcontext.S
	(__swapcontext, __novec_swapcontext):  Add CFI directives for stack
	and LR save.

2006-01-06  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/sparc/sparc64/sysdep.h: Include tls.h.
	(SYSCALL_ERROR_HANDLER_ENTRY): Use %g4 instead of %g2, to avoid
	the need of .register directive for it.
	* configure.in (libc_cv_asm_cfi_directives): Use CFI rel offset
	2047 instead of 0 in the test on sparc64.

2006-01-06  Ulrich Drepper  <drepper@redhat.com>

	* scripts/check-c++-types.sh: Add more pthread types.
	* scripts/data//c++-types-i386-linux-gnu.data: Adjust.
	* scripts/data//c++-types-ia64-linux-gnu.data: Likewise.
	* scripts/data//c++-types-powerpc-linux-gnu.data: Likewise.
	* scripts/data//c++-types-powerpc64-linux-gnu.data: Likewise.
	* scripts/data//c++-types-s390-linux-gnu.data: Likewise.
	* scripts/data//c++-types-s390x-linux-gnu.data: Likewise.
	* scripts/data//c++-types-x86_64-linux-gnu.data: Likewise.

	* sysdeps/unix/sysv/linux/ia64/sysdep.h (DO_INLINE_SYSCALL_NCS):
	Adjust for private->__private rename in tcbhead_t.

	[BZ #2114]
	* ncsd/aicache.c: Don't use sendfile for records on the stack.
	* nscd/grpcache.c: Likewise.
	* nscd/hstcache.c: Likewise.
	* nscd/initgrcache.c: Likewise.
	* nscd/pwdcache.c: Likewise.
	Patch by dmueller@suse.com.

	* sysdeps/unix/sysv/linux/alpha/bits/mman.h: Define MADV_REMOVE.
	* sysdeps/unix/sysv/linux/i386/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/ia64/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/s390/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/sh/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/sparc/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/bits/mman.h: Likewise.

2006-01-06  Roland McGrath  <roland@redhat.com>

	* Makeconfig (+gnu-stabs): Remove ancient cruft.

	[BZ #2103]
	* sysdeps/unix/sysv/linux/net/if_arp.h (ARPHRD_HWX25): Corrected macro
	name (was typo ARPHDR_HWX25).
	(ARPHRD_IEEE80211_PRISM, ARPHRD_IEEE80211_RADIOTAP): New macros.
	(ARPHRD_VOID, ARPHRD_NONE): New macros.

	* sysdeps/wordsize-32/divdi3.c (__moddi3): Add a cast.

	* io/fcntl.h [__USE_ATFILE] (AT_EACCESS): New macro.
	* posix/unistd.h [__USE_ATFILE]: Declare faccessat.
	* io/faccessat.c: New file.
	* sysdeps/unix/sysv/linux/faccessat.c: New file.
	* io/Makefile (routines): Add faccessat.
	* io/Versions (libc: GLIBC_2.4): Likewise.
	* io/tst-faccessat.c: New file.
	* io/Makefile (tests): Add it.

	* scripts/check-local-headers.sh: Revert last change.

	* io/euidaccess.c: Add eaccess as an alias.
	* sysdeps/mach/hurd/euidaccess.c: Likewise.
	* sysdeps/posix/euidaccess.c: Likewise.
	* posix/unistd.h [__USE_GNU]: Declare eaccess.
	* io/Versions (libc: GLIBC_2.4): Add eaccess.

2005-12-04  Joseph S. Myers  <joseph@codesourcery.com>

	* soft-fp/Makefile (gcc-single-routines): Add unordsf2,
	floatunsisf, floatundisf.
	(gcc-double-routines): Add unorddf2, floatunsidf, floatundidf.
	(gcc-quad-routines): Add unordtf2, floatunsitf, floatunditf.
	* soft-fp/op-common.h (_FP_CMP_UNORD): Define.
	* soft-fp/single.h (FP_CMP_UNORD_S): Define.
	* soft-fp/double.h (FP_CMP_UNORD_D): Define.
	* soft-fp/quad.h (FP_CMP_UNORD_Q): Define.
	* soft-fp/extended.h (FP_CMP_UNORD_E): Define.
	* soft-fp/unordsf2.c: New file.
	* soft-fp/unorddf2.c: New file.
	* soft-fp/unordtf2.c: New file.
	* soft-fp/floatunsisf.c: New file.
	* soft-fp/floatundisf.c: New file.
	* soft-fp/floatunsidf.c: New file.
	* soft-fp/floatundidf.c: New file.
	* soft-fp/floatunsitf.c: New file.
	* soft-fp/floatunditf.c: New file.

	* soft-fp/op-common.h (__FP_CLZ): Define using __builtin_clz,
	__builtin_clzl and __builtin_clzll.

2006-01-05  Mike Frysinger  <vapier@gentoo.org>

	* include/alloca.h (extend_alloca): Fix typoed name 'extern_alloca'.

2006-01-05  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/kernel-features.h (__ASSUME_WAITID_SYSCALL):
	Only define for 2.6.12+ on s390{,x}.
	(__ASSUME_GETDENTS32_D_TYPE): Only define for 2.6.8+ on most arches
	and only for 2.6.11+ on s390{,x}.

2006-01-05  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/pthread/aio_misc.h [!DONT_USE_BOOTSTRAP_MAP]
	(struct waitlist): Don't add cond.
	* sysdeps/pthread/aio_notify.c [!DONT_USE_BOOTSTRAP_MAP]
	(__aio_notify): Use AIO_MISC_NOTIFY instead of pthread_cond_signal.
	* sysdeps/pthread/aio_suspend.c [!DONT_USE_BOOTSTRAP_MAP]: Don't
	use condvar, use AIO_MISC_WAIT.
	* sysdeps/pthread/lio_listio.c: Likewise.
	* rt/Makefile (tests): Add tst-aio9 and tst-aio10.
	* rt/tst-aio9.c: New file.
	* rt/tst-aio10.c: New file.

	* rt/tst-aio3.c: The thread is now supposed to be created.

2006-01-05  Roland McGrath  <roland@redhat.com>

	* include/features.h: Grok _ATFILE_SOURCE and define __USE_ATFILE when
	it or _GNU_SOURCE is defined.
	* io/fcntl.h: Protect *at and AT_* with [__USE_ATFILE] instead of
	[__USE_GNU].
	* libio/stdio.h: Likewise.
	* posix/unistd.h: Likewise.
	* time/sys/time.h: Likewise.
	* io/sys/stat.h: Likewise.

	* io/sys/stat.h [__USE_GNU]: Declare fchmodat.
	* io/fchmodat.c: New file.
	* io/Makefile (routines): Add fchmodat.
	* io/Versions (libc: GLIBC_2.4): Likewise.
	* sysdeps/unix/sysv/linux/fchmodat.c: New file.
	* io/tst-fchmodat.c: New file.
	* io/Makefile (tests): Add it.

2006-01-03  Steven Munroe  <sjmunroe@us.ibm.com>

	* sysdeps/powerpc/powerpc32/sysdep.h (ENTRY, EALIGN): Add cfi_startproc
	directive to ENTRY macros.
	(END): Add cfi_endproc directive to END macro.
	* sysdeps/powerpc/powerpc64/sysdep.h (ENTRY, EALIGN): Add cfi_startproc
	directive to ENTRY macros.
	(END, END_GEN_TB): Add cfi_endproc directive to END macros.
	* sysdeps/powerpc/powerpc32/dl-start.S: Remove ENTRY()s for
	_dl_start_user and _dl_main_dispatch.
	* sysdeps/powerpc/powerpc32/fpu/fprrest.S: Use END macro.
	* sysdeps/powerpc/powerpc32/fpu/fprsave.S: Use Likewise.
	* sysdeps/powerpc/powerpc32/gprrest0.S: Likewise.
	* sysdeps/powerpc/powerpc32/gprrest1.S: Likewise.
	* sysdeps/powerpc/powerpc32/gprsave0.S: Likewise.
	* sysdeps/powerpc/powerpc32/gprsave1.S: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/socket.S: Remove redundant
	cfi_startproc and cfi_endproc.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/socket.S: Likewise.

2006-01-04  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/pthread/aio_misc.h (struct waitlist): Add result member.
	* sysdeps/pthread/aio_notify.c (__aio_notify): For synchronous waiters,
	failed I/O, and a result pointer, set value to -1.
	* sysdeps/pthread/aio_suspend.c: Initialize result pointer to NULL.
	* sysdeps/pthread/lio_listio.c: For LIO_WAIT, point result pointer in
	wait list to local variable result.  If nonzero afterwards, set errno
	to EIO.  For LIO_NOWAIT set result to NULL.
	* rt/Makefile (tests): Add tst-aio8.
	* rt/tst-aio8.c: New file.

2005-12-25  Kristian Van Der Vliet  <vanders@liqwyd.com>

	* abi-tags (*-.*-syllable.*): New match, with ABI value 5.
	* elf/cache.c (print_entry): Match the Syllable ABI tag.

2006-01-04  Ulrich Drepper  <drepper@redhat.com>

	* include/stdlib.h: Make even more C++ compliant.

2006-01-04  Joseph S. Myers  <joseph@codesourcery.com>

	* sysdeps/unix/sysv/linux/mips/brk.c (__brk): Use
	__SYSCALL_CLOBBERS.

2006-01-03  H.J. Lu  <hongjiu.lu@intel.com>

	* configure.in (HAVE_LIBAUDIT): Check
	audit_log_user_avc_message instead of audit_log_avc.

2006-01-04  Joseph S. Myers  <joseph@codesourcery.com>

	* sysdeps/ieee754/bits/nan.h: Fix typo.

2006-01-03  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/m68k/fchownat.c: Include string.h.

	* sysdeps/sparc/sparc32/dl-machine.h (LD_SO_PRELOAD): Remove unused
	define.

	* sysdeps/sparc/sparc32/bits/atomic.h: Include stdint.h, add
	{,u}atomic*_t typedefs.
	(__sparc32_atomic_do_lock): Add __volatile and memory clobber.
	(__sparc32_atomic_do_unlock): Add memory barrier.
	(__sparc32_atomic_do_lock24, __sparc32_atomic_do_unlock24): Define.
	[!SHARED] (__v9_compare_and_exchange_val_32_acq): Define.
	(__v7_compare_and_exchange_val_acq, __v7_compare_and_exchange_bool_acq,
	__v7_exchange_acq, __v7_exchange_and_add, __v7_exchange_24_rel,
	__v7_compare_and_exchange_val_24_acq, __atomic_is_v9,
	atomic_exchange_acq, atomic_compare_and_exchange_val_24_acq,
	atomic_exchange_24_rel): Define.
	[SHARED] (atomic_exchange_and_add): Define.
	[!SHARED] (__ATOMIC_HWCAP_SPARC_V9): Define.
	[!SHARED] (_dl_hwcap): New weak decl.
	* sysdeps/sparc/sparc32/sparcv9/bits/atomic.h (atomic_exchange_24_rel,
	atomic_compare_and_exchange_val_24_acq): Define.
	* sysdeps/sparc/sparc64/bits/atomic.h (atomic_exchange_24_rel,
	atomic_compare_and_exchange_val_24_acq): Define.

2006-01-03  Ulrich Drepper  <drepper@redhat.com>

	lio_listio should emit an event for each individual request in
	addition to the global event.
	* sysdeps/pthread/lio_listio.c (lio_listio): Renamed to
	lio_listio_internal.  Remove mode parameter check.  Only set sigevent
	type to SIGEV_NONE if LIO_NO_INDIVIDUAL_EVENT is set.
	(__lio_listio_21): New function.  Compatiblity version which sets
	LIO_NO_INDIVIDUAL_EVENT before calling lio_listio_internal.
	(__lio_listio_item_notify): New function.
	* sysdeps/pthread/lio_listio64.c: Define __lio_listio_21 and
	__lio_listio_item_notify macros.
	* sysdeps/pthread/Versions: New file.
	* rt/tst-aio2.c: Adjust test for new semantics of lio_listio.
	* include/aio.h: Define LIO_NO_INDIVIDUAL_EVENT.
	* Versions.def: Add GLIBC_2.4 for librt.

	* rt/Versions: Whitespace fix.
	* sysdeps/pthread/aio_misc.c: Likewise.

	* nscd/connections.c (nscd_init): Remove if block which should
	have been removed as part of the -S option removal.

2006-01-03  Andreas Jaeger  <aj@suse.de>

	* scripts/check-local-headers.sh: Allow $includedir/c++.

2006-01-03  Jakub Jelinek  <jakub@redhat.com>

	* posix/unistd.h (ctermid): Remove __nonnull attribute.

2006-01-02  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/sparc/sparc32/sysdep.h (PTR_MANGLE,
	PTR_MANGLE2, PTR_DEMANGLE, PTR_DEMANGLE2): Define.
	* sysdeps/unix/sysv/linux/sparc/sparc64/sysdep.h (PTR_MANGLE,
	PTR_MANGLE2, PTR_DEMANGLE, PTR_DEMANGLE2): Define.
	* sysdeps/unix/sysv/linux/sparc/bits/setjmp.h [__WORDSIZE == 64]
	(_JMPBUF_UNWINDS): Don't demangle uc_mcontext.mc_fp.
	* sysdeps/sparc/sparc32/setjmp.S (__sigsetjmp): Mangle %fp, %sp
	and %o7.
	* sysdeps/sparc/sparc32/__longjmp.S (__longjmp): Demangle %fp, %sp
	and %o7.

2006-01-02  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/s390/s390-32/sysdep.h (PTR_MANGLE2):
	Define.
	* sysdeps/unix/sysv/linux/s390/s390-64/sysdep.h (PTR_MANGLE2):
	Likewise.
	* sysdeps/s390/s390-32/__longjmp.c (__longjmp): Demangle also %r15.
	* sysdeps/s390/s390-64/__longjmp.c (__longjmp): Likewise.
	* sysdeps/s390/s390-32/setjmp.S (__sigsetjmp): Mangle also %r15.
	* sysdeps/s390/s390-32/elf/setjmp.S (__sigsetjmp): Likewise.
	* sysdeps/s390/s390-64/setjmp.S (__sigsetjmp): Likewise.
	* sysdeps/s390/s390-64/elf/setjmp.S (__sigsetjmp): Likewise.

	* sysdeps/s390/bits/setjmp.h (__jmp_buf): Add __s390_jmp_buf
	struct tag to make C++ happy.

2006-01-02  Ulrich Drepper  <drepper@redhat.com>

	* posix/Makefile ($(objpfx)annexc.out): Move -I.. to the end of
	the include list.

2006-01-01  Ulrich Drepper  <drepper@redhat.com>

	* posix/getconf.c: Update copyright year.
	* nss/getent.c: Likewise.
	* iconv/iconvconfig.c: Likewise.
	* iconv/iconv_prog.c: Likewise.
	* elf/ldconfig.c: Likewise.
	* catgets/gencat.c: Likewise.
	* csu/version.c: Likewise.
	* elf/ldd.bash.in: Likewise.
	* elf/sprof.c (print_version): Likewise.
	* locale/programs/locale.c: Likewise.
	* locale/programs/localedef.c: Likewise.
	* nscd/nscd.c (print_version): Likewise.
	* debug/xtrace.sh: Likewise.
	* malloc/memusage.sh: Likewise.
	* malloc/mtrace.pl: Likewise.
	* debug/catchsegv.sh: Likewise.

2005-12-31  Andreas Jaeger  <aj@suse.de>

	[BZ #1395]
	* manual/filesys.texi (Symbolic Links): Fix description of
	canonicalize_file_name based on patch by Oskar Liljeblad
	<oskar@osk.mine.nu>.

2005-12-29  Andreas Jaeger  <aj@suse.de>

	* resolv/res_debug.c (latlon2ul): Use ISO C function definition.
	(precsize_aton): Likewise.
	(precsize_ntoa): Likewise.

	* resolv/gethnamaddr.c (_gethtbyname): Remove extra prototype.
	(gethostbyname2): Likewise.
	(gethostbyaddr): Likewise.
	(getanswer): Use ISO C function definition.

2005-12-29  Kaz Kojima  <kkojima@rr.iij4u.or.jp>

	* sysdeps/sh/sysdep.h: Add cfi instrumentation to asm fragments.
	* sysdeps/unix/sysv/linux/sh/sysdep.h: Likewise.
	* sysdeps/sh/_mcount.S: Add cfi instrumentation.
	* sysdeps/unix/sh/sysdep.S: Likewise.
	* sysdeps/unix/sysv/linux/sh/makecontext.S: Adjust cfi_startproc.
	* sysdeps/unix/sysv/linux/sh/sh4/getcontext.S: Remove now duplicate
	cfi_startproc and cfi_endproc.
	* sysdeps/unix/sysv/linux/sh/sh4/setcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/sh/sh4/swapcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/sh/sh3/getcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/sh/sh3/setcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/sh/sh3/swapcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/sh/socket.S: Likewise.
	* sysdeps/unix/sysv/linux/sh/sysdep.S: Add cfi_endproc.

2005-12-30  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/powerpc/powerpc64/setjmp-common.S: Make sure pointer guard
	value doesn't survive in a registers when the function returns.
	* sysdeps/powerpc/powerpc32/fpu/setjmp-common.S: Likewise.
	* sysdeps/powerpc/powerpc32/setjmp-common.S: Likewise.

2005-12-30  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/powerpc/powerpc32/sysdep.h: Define
	PTR_MANGLE2.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/sysdep.h: Define
	PTR_MANGLE2 and PTR_DEMANGLE2.
	* sysdeps/powerpc/powerpc64/__longjmp-common.S: Use PTR_DEMANGLE2.
	* sysdeps/powerpc/powerpc64/setjmp-common.S: Use PTR_MANGLE2.
	* sysdeps/powerpc/powerpc32/fpu/setjmp-common.S: Likewise.
	* sysdeps/powerpc/powerpc32/setjmp-common.S: Likewise.

2005-12-30  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/ia64/bits/setjmp.h (_JMPBUF_UNWINDS):
	Don't use _demangle parameter for now.

	[BZ #2080]
	* libio/iogetwline.c (_IO_getwline_info): Move return to correct
	location.

	* nscd/connections.c: Remove last remnants of -S option support.
	* nscd/nscd.c: Likewise.
	* nscd/nscd.h: Likewise.

2005-12-30  Andreas Jaeger  <aj@suse.de>

	[BZ #1067]
	* sysdeps/unix/sysv/linux/mips/bits/socket.h: Fix struct msghdr
	for 64-bit mips kernel.

2005-12-08  Steven Munroe  <sjmunroe@us.ibm.com>
            Tom Gall <tom_gall@vnet.ibm.com>

	* elf/rtld.c (dl_main): Initialize l_local_scope for sysinfo_map.
	* sysdeps/powerpc/elf/libc-start.c: Move this...
	* sysdeps/unix/sysv/linux/powerpc/libc-start.c: ...to here.
	* sysdeps/powerpc/powerpc32/dl-start.S: Add _dl_main_dispatch label.
	* sysdeps/powerpc/powerpc32/hp-timing.h: New file.
	* sysdeps/unix/sysv/linux/powerpc/Versions: New file.
	* sysdeps/unix/sysv/linux/clock_getres.c: If HAVE_CLOCK_GETRES_VSYSCALL
	is not defined, redefine INTERNAL_VSYSCALL and INLINE_VSYSCALL to
	INTERNAL_SYSCALL and INLINE_SYSCALL respectively.  Otherwise include
	<bits/libc-vdso.h>.  Use INLINE_VSYSCALL and INTERNAL_SYSCALL instead
	of the normal versions throughout the code.
	* sysdeps/unix/sysv/linux/clock_gettime.c: Likewise if
	HAVE_CLOCK_GETTIME_VSYSCALL is defined.
	* sysdeps/unix/sysv/linux/powerpc/bits/libc-vdso.h: New file.
	* sysdeps/unix/sysv/linux/powerpc/dl-vdso.c: New file.
	* sysdeps/unix/sysv/linux/powerpc/dl-vdso.h: New file.
	* sysdeps/unix/sysv/linux/powerpc/get_clockfreq.c: Use vDSO.
	* sysdeps/unix/sysv/linux/powerpc/gettimeofday.c: New file.
	* sysdeps/unix/sysv/linux/powerpc/Makefile: Add dl-vdso to routines.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/sysdep.h: Define
	INLINE_VSYSCALL, INTERNAL_VSYSCALL, INTERNAL_SYSCALL_NCS,
	INTERNAL_VSYSCALL_NO_SYSCALL_FALLBACK, HAVE_CLOCK_GETRES_VSYSCALL,
	and HAVE_CLOCK_GETTIME_VSYSCALL.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/sysdep.h: Likewise.

2005-12-29  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/powerpc/powerpc32/sysdep.h [ASSEMBLER]:
	Define PTR_DEMANGLE2.
	* sysdeps/powerpc/powerpc32/setjmp-common.S [PTR_MANGLE]: Also
	mangle r1.
	* sysdeps/powerpc/powerpc32/__longjmp-common.S [PTR_DEMANGLE]: Also
	demangle r1.
	* sysdeps/powerpc/powerpc32/fpu/setjmp-common.S [PTR_MANGLE]: Mangle
	r0 and r1.
	* sysdeps/powerpc/powerpc32/fpu/__longjmp-common.S [PTR_DEMANGLE]:
	Demangle r0 and r1.

	* sysdeps/powerpc/powerpc64/setjmp-common.S [PTR_MANGLE]: Also
	mangle r1.
	* sysdeps/powerpc/powerpc64/__longjmp-common.S [PTR_DEMANGLE]: Also
	demangle  r1.

2005-12-26  Steven Munroe  <sjmunroe@us.ibm.com>

	* sysdeps/unix/sysv/linux/powerpc/powerpc32/getcontext.S:
	Move common function to...
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/getcontext-common.S:
	New file.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/setcontext.S:
	Move common function to...
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/setcontext-common.S:
	New file.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/swapcontext.S:
	Move common function to...
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/swapcontext-common.S:
	New file.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/ucontext_i.sym
	(_FRAME_BACKCHAIN, _FRAME_LR_SAVE, _FRAME_PARM_SAVE1,
	_FRAME_PARM_SAVE2, _FRAME_PARM_SAVE3, _FRAME_PARM_SAVE4):
	Remove unrelated stack frame defines.

2005-12-29  Ulrich Drepper  <drepper@redhat.com>

	* stdio-common/tstdiomisc.c [FLT_EVAL_METHOD!=2] (dbl_max):
	Defining as macro as before the last change.

	* sysdeps/unix/sysv/linux/sigaction.c: If WRAPPER_INCLUDE is defined,
	include the named file.
	* sysdeps/unix/sysv/linux/sparc/sparc32/sigaction.c: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc64/sigaction.c: Likewise.
	* sysdeps/unix/sysv/linux/ia64/sigaction.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/sigaction.c: Likewise.
	* sysdeps/unix/sysv/linux/s390/s390-64/sigaction.c: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/sigaction.c: Likewise.

2005-12-29  Roland McGrath  <roland@frob.com>

	* sysdeps/mach/hurd/errno.c: New file.

	* sysdeps/mach/hurd/ioctl.c (__ioctl): Use a union to avoid a cast.

	* sysdeps/posix/libc_fatal.c (__libc_message): Add a const, a cast.

	* hurd/lookup-retry.c (__hurd_file_name_lookup_retry): Fix cast.
	* hurd/report-wait.c (_S_msg_report_wait): Likewise.

	* include/sys/xattr.h: New file.

2005-12-28  Roland McGrath  <roland@redhat.com>

	* hurd/sigunwind.c: Include <stdint.h>.
	* sysdeps/mach/hurd/jmp-unwind.c: Likewise.

2005-12-28  Ulrich Drepper  <drepper@redhat.com>

	* nscd/selinux.c (log_callback): Use audit_log_user_avc_message.
	Don't do anything if audit_fd is invalid.
	(audit_init): Don't complain if kernel support is missing.
	Patch by Steve Grubb <sgrubb@redhat.com>.

	* sysdeps/i386/__longjmp.S [PTR_DEMANGLE]: Also demangle stack
	pointer.  Add CFI.
	* sysdeps/i386/bsd-_setjmp.S [PTR_MANGLE]: Also mangle stack pointer.
	* sysdeps/i386/bsd-setjmp.S: Likewise.
	* sysdeps/i386/setjmp.S: Likewise.

	* sysdeps/x86_64/__longjmp.S: No need to make sure return value is
	!= 0, the caller did that.

2005-12-27  Roland McGrath  <roland@redhat.com>

	* sysdeps/x86_64/__longjmp.S: Don't confuse unwinder by loading
	mangled values in %rbp and %rsp registers and by wrong cfi.

	* config.make.in (c++-sysincludes): New substituted variable.
	* configure.in (CXX_SYSINCLUDES): New substituted variable.
	* configure: Regenerated.
	* Makeconfig (CXXFLAGS): Prepend $(c++-sysincludes) here.

	* sysdeps/unix/sysv/linux/powerpc/powerpc32/sysdep.h
	(PTR_MANGLE): Fix cast.

	* sysdeps/alpha/bits/setjmp.h (_JMPBUF_UNWINDS): Take third argument
	DEMANGLE, and pass SP value through it.
	* sysdeps/hppa/bits/setjmp.h (_JMPBUF_UNWINDS): Likewise.
	* sysdeps/i386/bits/setjmp.h (_JMPBUF_UNWINDS): Likewise.
	* sysdeps/m68k/bits/setjmp.h (_JMPBUF_UNWINDS): Likewise.
	* sysdeps/mips/bits/setjmp.h (_JMPBUF_UNWINDS): Likewise.
	* sysdeps/powerpc/bits/setjmp.h (_JMPBUF_UNWINDS): Likewise.
	* sysdeps/s390/bits/setjmp.h (_JMPBUF_UNWINDS): Likewise.
	* sysdeps/sh/bits/setjmp.h (_JMPBUF_UNWINDS): Likewise.
	* sysdeps/sparc/sparc32/bits/setjmp.h (_JMPBUF_UNWINDS): Likewise.
	* sysdeps/unix/sysv/linux/ia64/bits/setjmp.h: Likewise.
	* sysdeps/unix/sysv/linux/sparc/bits/setjmp.h: Likewise.
	* sysdeps/x86_64/bits/setjmp.h (_JMPBUF_UNWINDS): Likewise.
	* hurd/sigunwind.c (_hurdsig_longjmp_from_handler): Pass inline
	demangler function to _JMPBUF_UNWINDS.
	* sysdeps/mach/hurd/jmp-unwind.c (demangle_ptr): New function.
	(_longjmp_unwind): Pass it to _JMPBUF_UNWINDS.

	* posix/tst-execle1.c (do_test): Add a const.
	* posix/tst-execle2.c (do_test): Likewise.

	* posix/transbug.c (run_test): Add some casts.
	* posix/bug-regex22.c (main): Likewise.
	* posix/bug-regex5.c (main): Likewise.
	* wcsmbs/tst-mbsrtowcs.c (main): Likewise.
	* string/test-strspn.c (do_test, do_random_tests): Likewise.
	* string/test-strrchr.c (do_test, do_random_tests): Likewise.
	* string/test-strlen.c (do_random_tests): Likewise.
	* string/test-strpbrk.c (do_test, do_random_tests): Likewise.
	* string/test-strcmp.c (do_random_tests): Likewise.
	* string/test-strchr.c (do_test, do_random_tests): Likewise.
	* string/test-strcat.c (do_test, do_random_tests): Likewise.
	* string/test-strncpy.c (do_random_tests): Likewise.
	* string/test-strcpy.c (do_test, do_random_tests): Likewise.
	* string/test-memccpy.c (do_test): Likewise.
	* string/test-memmove.c (do_test, do_random_tests): Likewise.
	* string/test-memcpy.c (do_test, do_random_tests): Likewise.
	* string/test-memcmp.c (do_test, do_random_tests): Likewise.
	* string/test-memchr.c (do_test, do_random_tests): Likewise.
	* dlfcn/bug-atexit1.c (do_test): Fix up prototype in cast.
	* stdio-common/tst-fgets.c (do_test): Add a cast.
	* iconvdata/bug-iconv4.c (xiconv): Add a cast.

	* locale/programs/simple-hash.c (insert_entry_2): Remove useless casts.

	* resolv/herror.c (herror): Remove unused extern decl.

	* libio/obprintf.c: Include "strfile.h".

	* elf/order2mod2.c (init): Cast ignored value to void.

2005-12-27  Ulrich Drepper  <drepper@redhat.com>

	* elf/tst-tls13.c (do_test): Avoid using the library path when
	looking for tst-tlsmod13a.so.

	* stdio-common/tstdiomisc.c: If FLT_EVAL_METHOD is 2, use long
	double math to generate NaN results.

	* sysdeps/unix/sysv/linux/sparc/bits/errno.h: Define EOWNERDEAD
	and ENOTRECOVERABLE if not already defined.
	* sysdeps/unix/sysv/linux/alpha/bits/errno.h: Likewise.

2005-12-27  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/alpha/Versions: Add new errlist-compat
	entry for up to 138 errnos.

2005-12-27  Jakub Jelinek  <jakub@redhat.com>

	* iconv/gconv_trans.c (__gconv_transliterate): Demangle step __fct
	before calling it.

2005-12-27  David S. Miller  <davem@sunset.davemloft.net>

	* sysdeps/unix/sysv/linux/sparc/Versions: Add new errlist-compat
	entry for up to 134 errnos.

2005-12-26  Ulrich Drepper  <drepper@redhat.com>

	* Versions.def: Add GLIBC_2.4 for libpthread.

2005-12-25  Ulrich Drepper  <drepper@redhat.com>

	* stdlib/Makefile ($(objpfx)isomac.out): Move -I.. to the end so
	that $(..)/bits is not found early.

2005-12-24  Ulrich Drepper  <drepper@redhat.com>

	* manual/errno.texi: Add new Linux errno codes.
	* sysdeps/unix/sysv/linux/Versions: Add new errlist-compat entry
	for up to 132 errnos.
	* sysdeps/unix/sysv/linux/bits/errno.h: Define EOWNERDEAD and
	ENOTRECOVERABLE if not already defined.

2005-12-23  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1566]
	* sysdeps/i386/i586/memusage.h: New file.
	* sysdeps/i386/memusage.h: Don't define GETTIME.

2005-12-22  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1499]
	* misc/syslog.c (SyslogAddr): Use sockaddr_un instead of sockaddr.
	(openlog_internal): Adjust for this change.

	* Makeconfig: Define CXXFLAGS.  Split out warnings from +gccwarn which
	are not understood by the C++ compiler.
	* Makerules: Add rules to build C++ code for test cases.
	* include/stdlib.h: Protect for inclusion in C++ code.
	* include/time.h: Likewise.

2005-12-22  Roland McGrath  <roland@redhat.com>

	* Makerules [gen-as-const-headers] (tests): Add one test per .sym
	file, not just one.
	($(objpfx)test-as-const.c): Target replaced with ...
	($(objpfx)test-as-const-%.c): ... this pattern rule.
	(generated): Add those files.

2005-12-22  Ulrich Drepper  <drepper@redhat.com>

	* test-skeleton.c (timeout_handler): Rewrite ts initialization for
	C++ compatibility.

	* sysdeps/x86_64/__longjmp.S: Also protect SP and BP.
	* sysdeps/x86_64/setjmp.S: Likewise.

2005-12-21  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/sysv/linux/i386/ucontext_i.h: File removed.
	* sysdeps/unix/sysv/linux/i386/ucontext_i.sym: New file.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/ucontext_i.h: File removed.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/ucontext_i.sym: New file.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/ucontext_i.h: File removed.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/ucontext_i.sym: New file.
	* sysdeps/unix/sysv/linux/s390/s390-32/ucontext_i.h: File removed.
	* sysdeps/unix/sysv/linux/s390/s390-64/ucontext_i.h: File removed.
	* sysdeps/unix/sysv/linux/s390/ucontext_i.sym: New file.
	* sysdeps/unix/sysv/linux/sh/sh3/ucontext_i.h: File removed.
	* sysdeps/unix/sysv/linux/sh/sh3/ucontext_i.sym: New file.
	* sysdeps/unix/sysv/linux/sh/sh4/ucontext_i.h: File removed.
	* sysdeps/unix/sysv/linux/sh/sh4/ucontext_i.sym: New file.
	* sysdeps/unix/sysv/linux/x86_64/ucontext_i.h: File removed.
	* sysdeps/unix/sysv/linux/x86_64/ucontext_i.sym: New file.
	* sysdeps/unix/sysv/linux/i386/Makefile [$(subdir) = stdlib]:
	(gen-as-const-headers): Add it.
	* sysdeps/unix/sysv/linux/powerpc/Makefile: Likewise.
	* sysdeps/unix/sysv/linux/sh/Makefile: Likewise.
	* sysdeps/unix/sysv/linux/s390/Makefile: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/Makefile: Likewise.
	* stdlib/tst-ucontext-off.c: File removed.
	* stdlib/Makefile (tests): Remove it.

	* scripts/gen-as-const.awk: Support generating a test program.
	* Makerules [gen-as-const-headers] (tests): Add test-as-const.
	[gen-as-const-headers] ($(objpfx)test-as-const.c): New target.

	* sysdeps/generic/bits: Subdirectory and all files moved to ...
	* bits: ... here, new subdirectory.
	* Makeconfig (+includes): Reordered includes to put build and sysdeps
	dirs first after $(..)include, $(sysincludes) last.

	[BZ #2066]
	* intl/l10nflist.c (_nl_make_l10nflist): Free ABS_FILENAME when later
	malloc fails.

2005-12-21  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/powerpc/fpu/libm-test-ulps: Update for GCC 4.1 prerelease.

2005-12-21  Roland McGrath  <roland@redhat.com>

	* sysdeps/mach/hurd/ifreq.c: Add missing #includes.

	* elf/cache.c: Use <> rather than "" #includes.
	* elf/chroot_canon.c: Likewise.
	* elf/dl-lookup.c: Likewise.
	* elf/ldconfig.c: Likewise.
	* elf/readlib.c: Likewise.
	* elf/rtld.c: Likewise.
	* gmon/mcount.c: Likewise.
	* hurd/hurdfault.c: Likewise.
	* hurd/hurdsig.c: Likewise.
	* hurd/report-wait.c: Likewise.
	* hurd/sigunwind.c: Likewise.
	* mach/setup-thread.c: Likewise.
	* rt/aio_read64.c: Likewise.
	* rt/aio_sigqueue.c: Likewise.
	* rt/aio_write64.c: Likewise.
	* soft-fp/soft-fp.h: Likewise.
	* stdio-common/tmpfile64.c: Likewise.
	* sysdeps/mach/hurd/fork.c: Likewise.
	* sysdeps/mach/hurd/hppa/trampoline.c: Likewise.
	* sysdeps/mach/hurd/i386/trampoline.c: Likewise.
	* sysdeps/mach/hurd/mips/trampoline.c: Likewise.
	* sysdeps/mach/hurd/powerpc/trampoline.c: Likewise.
	* sysdeps/posix/sprofil.c: Likewise.
	* sysdeps/pthread/aio_cancel.c: Likewise.
	* sysdeps/pthread/aio_fsync.c: Likewise.
	* sysdeps/pthread/aio_read64.c: Likewise.
	* sysdeps/pthread/aio_read.c: Likewise.
	* sysdeps/pthread/aio_suspend.c: Likewise.
	* sysdeps/pthread/aio_write64.c: Likewise.
	* sysdeps/pthread/aio_write.c: Likewise.
	* sysdeps/pthread/lio_listio64.c: Likewise.
	* sysdeps/pthread/lio_listio.c: Likewise.
	* sysdeps/unix/sysv/linux/aio_sigqueue.c: Likewise.
	* sysdeps/unix/sysv/tcflow.c: Likewise.

	* sysdeps/generic/unwind-dw2.c (extract_cie_info): Add a cast.

	* elf/dl-error.c (_dl_signal_error): Use .__jmpbuf in __longjmp call.

	* csu/dso_handle.c (__dso_handle): Add const to pointer type too.

2005-12-21  Ulrich Drepper  <drepper@redhat.com>

	* iconv/gconv_conf.c: Initialize empty_path_elem.

	* sysdeps/ieee754/dbl-64/halfulp.c: Mark tab54 as static and const.
	* sysdeps/i386/fpu/e_expl.c: Mark c0 and c1 as const.
	* sysdeps/ieee754/flt-32/s_expm1f.c: Make sure huge and tiny end
	up in .rodata.
	* sysdeps/ieee754/flt-32/e_exp2f.c: Make sure TWO127 and TWOM100
	end up in .rodata.
	* sysdeps/ieee754/flt-32/e_expf.c: Likewise.
	* sysdeps/ieee754/dbl-64/e_exp2.c: Make sure TWO1023 and TWOM1000
	end up in .rodata.

2005-12-21  Thorsten Kukuk  <kukuk@suse.de>

	* elf/readlib.c: Fix include of readelflib.c.

2005-12-21  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1962]
	* io/fts.c (fts_open): Change type of len to size_t.
	(fts_build): Remove cast in call to fts_alloc.
	(fts_alloc): Change third parameter's type to size_t.

	[BZ #1960]
	* io/fts.c (fts_open): Avoid function call in MAX macro use.

2005-12-20  Ulrich Drepper  <drepper@redhat.com>

	* locale/xlocale.c (_nl_C_locobj): Mark as const.
	* include/locale.h: Define _nl_C_locobj_ptr.
	* iconv/gconv_charset.h: Use _nl_C_locobj_ptr instead of using pointer
	to _nl_C_locobj because we also need a cast.
	* iconv/gconv_conf.c: Likewise.
	* iconv/gconv_int.h: Likewise.
	* iconv/gconv_open.c: Likewise.
	* locale/duplocale.c: Likewise.
	* locale/freelocale.c: Likewise.
	* locale/newlocale.c: Likewise.
	* misc/syslog.c: Likewise.
	* stdlib/strtod_l.c: Likewise.
	* sysdeps/unix/sysv/linux/getloadavg.c: Likewise.

	* csu/dso_handle.c (__dso_handle): Mark as const.

	* intl/plural-exp.c (GERMANIC_PLURAL): Mark as const.
	* intl/plural-exp.h: Adjust declaration of
	__gettext_germanic_plural.

	* resolv/herror.c (h_errlist): Mark as const.
	(h_nerr): Likewise.

2005-12-15  Thomas Schwinge  <tschwinge@gnu.org>

	[BZ #2061]
	* sysdeps/mach/hurd/xmknod.c (__xmknod): Handle S_IFREG.

2005-12-20  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/sysv/linux/ifreq.h: File removed.
	* sysdeps/unix/sysv/linux/ifreq.c: #include "kernel-features.h" here.

	* sysdeps/mach/hurd/ifreq.h: File removed.
	(__ifreq): Function moved to ...
	* sysdeps/mach/hurd/ifreq.c: ... here, new file.

2005-12-20  Ulrich Drepper  <drepper@redhat.com>

	* sunrpc/clnt_unix.c (unix_ops): Mark as const.
	* sunrpc/auth_des.c (authdes_ops): Likewise.
	* sunrpc/svc_raw.c (server_ops): Likewise.
	* sunrpc/clnt_udp.c (udp_ops): Likewise.
	* sunrpc/clnt_tcp.c (tcp_ops): Likewise.
	* sunrpc/clnt_raw.c (client_ops): Likewise.
	* sunrpc/auth_unix.c (auth_unix_ops): Likewise.
	* sunrpc/auth_none.c (ops): Likewise.

	* nss/nsswitch.c (databases): Mark as const.  Change name field
	into array.
	* nss/databases.def: Add warning.

	* resolv/res_hconf.c (arg_service_list): Reduce size of svcs and
	mark const.
	(cmd): Mark as const.
	(parse_line): Mark c as pointer to const.

	* misc/getusershell.c (initshells): Remove unnecessary tests.
	(endusershell): Likewise.
	(okshells): Mark as const.

	* sysdeps/posix/gai_strerror.c: Complete rewrite. Avoid relocations.
	* sysdeps/posix/gai_strerror-strs.h: New file.
	* sysdeps/posix/Dist: New file.

	* sysdeps/posix/getaddrinfo.c (gaih): Mark as const.
	* locale/loadlocale.c (_nl_value_types): Likewise.
	* iconv/gconv_conf.c (builtin_aliases): Likewise.
	* iconv/gconv_open.c (internal_trans_names): Likewise.

2005-12-19  Kaz Kojima  <kkojima@rr.iij4u.or.jp>

	* sysdeps/unix/sysv/linux/sh/sysdep.h: Include tls.h.
	(PTR_MANGLE, PTR_DEMANGLE): Define.
	(SYSCALL_ERROR_HANDLER): Fix typo.
	* sysdeps/sh/sh4/__longjmp.S: Use PTR_DEMANGLE if defined.
	* sysdeps/sh/sh3/__longjmp.S: Likewise.
	* sysdeps/sh/sh4/setjmp.S: Use PTR_MANGLE if defined.
	* sysdeps/sh/sh3/setjmp.S: Likewise.

2005-12-20  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/ia64/fpu/libm-test-ulps: Update for GCC 4.1 prerelease.

	* sysdeps/unix/sysv/linux/time.c: If __NR_time is not defined,
	use sysdeps/unix/time.c implementation.

2005-12-19  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1955]
	* timezone/zic.c (tofile;): Fix typo in symlink creation.
	Patch by Phil Estes <pestes@us.ibm.com>.

	[BZ #1952]
	* sysdeps/unix/sysv/linux/time.c: New file.
	* sysdeps/unix/sysv/linux/i386/syscalls.list: Remove time entry.

2005-12-15  Thomas Schwinge  <tschwinge@gnu.org>

	* io/xmknodat.c: Include <stddef.h>.
	* misc/futimesat.c: Remove weak_alias and correct stub_warning.
	* stdio-common/renameat.c (renameat): Fix typo.

2005-12-16  Thorsten Kukuk  <kukuk@suse.de>

	[BZ #1978]
	* sysdeps/unix/sysv/linux/internal_statvfs.c (__statvfs_getflags):
	Map more filesystem types to a string.
	* sysdeps/unix/sysv/linux/linux_fsinfo.h: Add SYSFS_MAGIC.

2005-12-19  Jakub Jelinek  <jakub@redhat.com>

	* locale/Makefile (programs/%-kw.h): Run $(GPERF) inside of the
	programs subdirectory.

	* sysdeps/powerpc/powerpc32/__longjmp-common.S (__longjmp): Use
	PTR_DEMANGLE for PC if defined.
	* sysdeps/powerpc/powerpc64/__longjmp-common.S (__longjmp):
	Likewise.
	* sysdeps/unix/sysv/linux/ia64/__longjmp.S (__longjmp): Likewise.
	* sysdeps/s390/s390-32/__longjmp.c (__longjmp): Xor %r14 with
	THREAD_GET_POINTER_GUARD () if PTR_DEMANGLE is defined.
	* sysdeps/s390/s390-64/__longjmp.c (__longjmp): Likewise.
	* sysdeps/powerpc/powerpc32/setjmp-common.S (__sigsetjmp): Use
	PTR_MANGLE for PC if defined.
	* sysdeps/powerpc/powerpc64/setjmp-common.S (__sigsetjmp): Likewise.
	* sysdeps/s390/s390-32/setjmp.S (__sigsetjmp): Likewise.
	Avoid call to __sigjmp_save if IS_IN_rtld.
	* sysdeps/s390/s390-32/elf/setjmp.S (__sigsetjmp): Likewise.
	* sysdeps/s390/s390-64/setjmp.S (__sigsetjmp): Likewise.
	* sysdeps/s390/s390-64/elf/setjmp.S (__sigsetjmp): Likewise.
	* sysdeps/unix/sysv/linux/ia64/setjmp.S (__sigsetjmp): Likewise.
	* sysdeps/unix/sysv/linux/ia64/sysdep.h (PTR_MANGLE, PTR_DEMANGLE):
	Define.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/sysdep.h: Include tls.h.
	(PTR_MANGLE, PTR_DEMANGLE): Define.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/sysdep.h: Include tls.h
	(PTR_MANGLE, PTR_DEMANGLE): Define.
	* sysdeps/unix/sysv/linux/s390/s390-32/sysdep.h: Include tls.h.
	(PTR_MANGLE, PTR_DEMANGLE): Define.
	(SYSCALL_ERROR_HANDLER): Add missing semicolons.
	* sysdeps/unix/sysv/linux/s390/s390-64/sysdep.h: Include tls.h.
	(PTR_MANGLE, PTR_DEMANGLE): Define.
	* sysdeps/unix/sysv/linux/s390/s390-64/socket.S (__socket): Add
	SYSCALL_ERROR_HANDLER.

2005-12-19  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/sparc/sparc32/socket.S: Handle NO_WEAK_ALIAS.
	* sysdeps/unix/sysv/linux/sparc/sparc64/socket.S: Likewise.
	Patch by Clint Adams.

2005-12-16  Martin Schwidefsky  <schwidefsky@de.ibm.com>

	* sysdeps/unix/sysv/linux/s390/sys/user.h: Copy struct user and
	dependent definitions from the kernel header to sys/user.h and
	remove the #include of asm/user.h.

2005-12-19  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/gnu/Makefile: Make sure the correct errlist.c file is
	used when generating errlist-compat.c.

2005-12-18  Ulrich Drepper  <drepper@redhat.com>

	* iconv/gconv.c: Demangle pointers before use if necessary.
	* iconv/gconv_cache.c: Likewise.
	* iconv/skeleton.c: Likewise.
	* libio/iofwide.c: Likewise.
	* wcsmbs/btowc.c: Likewise.
	* wcsmbs/mbrtowc.c: Likewise.
	* wcsmbs/mbsnrtowcs.c: Likewise.
	* wcsmbs/mbsrtowcs_l.c: Likewise.
	* wcsmbs/wcrtomb.c: Likewise.
	* wcsmbs/wcsnrtombs.c: Likewise.
	* wcsmbs/wcsrtombs.c: Likewise.
	* wcsmbs/wctob.c: Likewise.
	* iconv_gconv_db.c: Likewise.  After init functions returns mangle
	btowc pointer if necessary.
	* iconv/gconv_dl.c: Mangle function pointers retrieved from dlsym.

	* iconv/gconv_builtin.c (builtin_map): Change type of size
	information fields to int8_t.

	* libio/iofwide.c (__libio_codecvt): Mark as const.
	(__libio_translit): Likewise.
	* libio/libioP.h (__libio_codecvt): Adjust declaraction.

	* wcsmbs/wcsmbsload.c (to_wc): Mark as const.
	(to_mb): Likewise.

2005-12-18  Richard Henderson  <rth@redhat.com>

	* sysdeps/alpha/libc-tls.c: Fix directory on include of base file.

2005-12-18  Ulrich Drepper  <drepper@redhat.com>

	* iconv/gconv_builtin.c: Mark map with attribute_relro.

	* sysdeps/unix/sysv/linux/x86_64/sysdep.h (PTR_MANGLE): Define C
	version for inside ld.so.

	* elf/rtld.c (dl_main): Don't use hp timing code unless it's available.

	* sysdeps/powerpc/powerpc32/setjmp-common.S [IS_IN_rtld]: Avoid
	call to __sigjmp_save.
	* sysdeps/powerpc/powerpc64/setjmp-common.S: Likewise.

	* stdlib/cxa_atexit.c: Use PTR_MANGLE on function pointer.  Fill in
	flavor field last and protect with memory barrier.
	* stdlib/on_exit.c: Likewise.
	* stdlib/cxa_finalize.c: Use PTR_DEMANGLE on function pointer before
	using it.
	* stdlib/exit.c: Likewise.

	* sysdeps/unix/sysv/linux/i386/sysdep.h: Define PTR_MANGLE and
	PTR_DEMANGLE for C code in libc.
	* sysdeps/unix/sysv/linux/x86_64/sysdep.h: Likewise.

2005-12-17  Ulrich Drepper  <drepper@redhat.com>

	* elf/Versions [GLIBC_PRIVATE]: Export __pointer_chk_guard if defined.
	* elf/rtld.c: Define __pointer_chk_guard_local and if necessary
	__pointer_chk_guard.
	(_rtld_global_ro): Initialize _dl_pointer_guard.
	(dl_main): Initialize __pointer_chk_guard_local and either
	__pointer_chk_guard or TLS value if necessary.
	(process_envvars): Recognize and handle LD_POINTER_GUARD.
	* sysdeps/generic/ldsodefs.h (rtld_global_ro): Add _dl_pointer_guard.
	* sysdeps/i386/__longjmp.S: Use PTR_DEMANGLE for PC if defined.
	* sysdeps/x86_64/__longjmp.S: Likewise.
	* sysdeps/i386/bsd-_setjmp.S: Use PTR_MANGLE for PC if defined.
	* sysdeps/i386/bsd-_setjmp.S: Likewise.
	* sysdeps/i386/setjmp.S: Likewise.
	[IS_IN_rtld]: Avoid call to __sigjmp_save.
	* sysdeps/i386/setjmp.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/sysdep.h: Define PTR_MANGLE and
	PTR_DEMANGLE.
	* sysdeps/unix/sysv/linux/x86_64/sysdep.h: Likewise.

	* sysdeps/i386/elf/setjmp.S: Removed.
	* sysdeps/i386/elf/bsd-setjmp.S: Removed.

	* elf/dl-error.c (_dl_catch_error): Use __sigsetgjmp instead of
	setjmp.
	* elf/dl-error.c (_dl_signal_error): Use __longjmp instead of longjmp.
	* elf/dl-minimal.c (longjmp): Remove definition.

	* sysdeps/x86_64/bsd-setjmp.S [PIC] (setjmp): Add missing jmp.

2005-12-14  Thorsten Kukuk  <kukuk@suse.de>

	* nscd/Makefile: Don't build nscd_nischeck.
	* nscd/nscd_nischeck.c: Removed.

2005-12-15  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/renameat.c: Move errno setting code in
	separate function __atfct_seterrno_2.
	* include/fcntl.h: Declare __atfct_seterrno_2.
	* posix/unistd.h: Declare linkat, symlinkat, readlinkat.
	* io/Makefile (routines): Add linkat, symlinkat, readlinkat.
	* io/Versions [GLIBC_2.4]: Export linkat, symlinkat, readlinkat.
	* io/linkat.c: New file.
	* io/readlinkat.c: New file.
	* io/symlinkat.c: New file.
	* sysdeps/unix/sysv/linux/linkat.c: New file.
	* sysdeps/unix/sysv/linux/readlinkat.c: New file.
	* sysdeps/unix/sysv/linux/symlinkat.c: New file.

2005-12-15  Roland McGrath  <roland@redhat.com>

	[BZ #1997]
	* manual/stdio.texi (String Streams): For open_memstream, elaborate a
	little on malloc reference.

	* sysdeps/alpha/fpu/s_cacosf.c: Don't use sysdeps/generic/.
	* sysdeps/alpha/fpu/s_cacoshf.c: Likewise.
	* sysdeps/alpha/fpu/s_casinf.c: Likewise.
	* sysdeps/alpha/fpu/s_casinhf.c: Likewise.
	* sysdeps/alpha/fpu/s_catanf.c: Likewise.
	* sysdeps/alpha/fpu/s_catanhf.c: Likewise.
	* sysdeps/alpha/fpu/s_ccosf.c: Likewise.
	* sysdeps/alpha/fpu/s_ccoshf.c: Likewise.
	* sysdeps/alpha/fpu/s_cexpf.c: Likewise.
	* sysdeps/alpha/fpu/s_clog10f.c: Likewise.
	* sysdeps/alpha/fpu/s_clogf.c: Likewise.
	* sysdeps/alpha/fpu/s_cpowf.c: Likewise.
	* sysdeps/alpha/fpu/s_cprojf.c: Likewise.
	* sysdeps/alpha/fpu/s_csinf.c: Likewise.
	* sysdeps/alpha/fpu/s_csinhf.c: Likewise.
	* sysdeps/alpha/fpu/s_csqrtf.c: Likewise.
	* sysdeps/alpha/fpu/s_ctanf.c: Likewise.
	* sysdeps/alpha/fpu/s_ctanhf.c: Likewise.
	* sysdeps/alpha/libc-tls.c: Likewise.
	* sysdeps/gnu/glob64.c: Likewise.
	* sysdeps/gnu/updwtmp.c: Likewise.
	* sysdeps/gnu/utmp_file.c: Likewise.
	* sysdeps/i386/bzero.c: Likewise.
	* sysdeps/i386/ffs.c: Likewise.
	* sysdeps/i386/i686/ffs.c: Likewise.
	* sysdeps/i386/memset.c: Likewise.
	* sysdeps/ia64/fpu/printf_fphex.c: Likewise.
	* sysdeps/ia64/libc-tls.c: Likewise.
	* sysdeps/ieee754/ldbl-128/printf_fphex.c: Likewise.
	* sysdeps/m68k/ffs.c: Likewise.
	* sysdeps/mach/hurd/getdents.c: Likewise.
	* sysdeps/mach/hurd/init-posix.c: Likewise.
	* sysdeps/mach/msync.c: Likewise.
	* sysdeps/mips/libc-tls.c: Likewise.
	* sysdeps/posix/profil.c: Likewise.
	* sysdeps/posix/shm_open.c: Likewise.
	* sysdeps/posix/shm_unlink.c: Likewise.
	* sysdeps/posix/sprofil.c: Likewise.
	* sysdeps/powerpc/ffs.c: Likewise.
	* sysdeps/rs6000/ffs.c: Likewise.
	* sysdeps/s390/libc-tls.c: Likewise.
	* sysdeps/unix/sysv/linux/aio_sigqueue.c: Likewise.
	* sysdeps/unix/sysv/linux/alpha/glob.c: Likewise.
	* sysdeps/unix/sysv/linux/alpha/wordexp.c: Likewise.
	* sysdeps/unix/sysv/linux/ftruncate64.c: Likewise.
	* sysdeps/unix/sysv/linux/gai_sigqueue.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/getmsg.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/getresgid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/getresuid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/lchown.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/putmsg.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/readelflib.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/setresgid.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/setresuid.c: Likewise.
	* sysdeps/unix/sysv/linux/ia64/readelflib.c: Likewise.
	* sysdeps/unix/sysv/linux/mips/ftruncate64.c: Likewise.
	* sysdeps/unix/sysv/linux/mips/readelflib.c: Likewise.
	* sysdeps/unix/sysv/linux/mips/truncate64.c: Likewise.
	* sysdeps/unix/sysv/linux/mq_close.c: Likewise.
	* sysdeps/unix/sysv/linux/mq_getattr.c: Likewise.
	* sysdeps/unix/sysv/linux/mq_notify.c: Likewise.
	* sysdeps/unix/sysv/linux/mq_open.c: Likewise.
	* sysdeps/unix/sysv/linux/mq_receive.c: Likewise.
	* sysdeps/unix/sysv/linux/mq_send.c: Likewise.
	* sysdeps/unix/sysv/linux/mq_unlink.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/ftruncate64.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/truncate64.c: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/readelflib.c: Likewise.
	* sysdeps/unix/sysv/linux/s390/readelflib.c: Likewise.
	* sysdeps/unix/sysv/linux/sched_getaffinity.c: Likewise.
	* sysdeps/unix/sysv/linux/sched_setaffinity.c: Likewise.
	* sysdeps/unix/sysv/linux/sigqueue.c: Likewise.
	* sysdeps/unix/sysv/linux/sigstack.c: Likewise.
	* sysdeps/unix/sysv/linux/sigtimedwait.c: Likewise.
	* sysdeps/unix/sysv/linux/sigwaitinfo.c: Likewise.
	* sysdeps/unix/sysv/linux/sparc/readelflib.c: Likewise.
	* sysdeps/unix/sysv/linux/truncate64.c: Likewise.
	* sysdeps/unix/sysv/linux/vfork.c: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/readelflib.c: Likewise.

	* sysdeps/unix/sysv/linux/Makefile (inhibit-siglist): Removed.

2005-12-13  Ulrich Drepper  <drepper@redhat.com>

	* locale/programs/charmap-kw.h: Regenerated with new gperf.
	* locale/programs/locfile-kw.h: Likewise.

	* Makeconfig (+includes): Look in current directory late.
	* Makerules: Add rules from rules before the rules for the current
	directory.
	* sysdeps/generic/__longjmp.c: Moved to...
	* setjmp/__longjmp.c: ...here.
	* sysdeps/generic/_exit.c: Moved to...
	* posix/_exit.c: ...here.
	* sysdeps/generic/_strerror.c: Moved to...
	* string/_strerror.c: ...here.
	* sysdeps/generic/abort.c: Moved to...
	* stdlib/abort.c: ...here.
	* sysdeps/generic/accept.c: Moved to...
	* socket/accept.c: ...here.
	* sysdeps/generic/access.c: Moved to...
	* io/access.c: ...here.
	* sysdeps/generic/acct.c: Moved to...
	* misc/acct.c: ...here.
	* sysdeps/generic/add_n.c: Moved to...
	* stdlib/add_n.c: ...here.
	* sysdeps/generic/addmul_1.c: Moved to...
	* stdlib/addmul_1.c: ...here.
	* sysdeps/generic/adjtime.c: Moved to...
	* time/adjtime.c: ...here.
	* sysdeps/generic/aio_cancel.c: Moved to...
	* rt/aio_cancel.c: ...here.
	* sysdeps/generic/aio_fsync.c: Moved to...
	* rt/aio_fsync.c: ...here.
	* sysdeps/generic/aio_misc.c: Moved to...
	* rt/aio_misc.c: ...here.
	* sysdeps/generic/aio_notify.c: Moved to...
	* rt/aio_notify.c: ...here.
	* sysdeps/generic/aio_read.c: Moved to...
	* rt/aio_read.c: ...here.
	* sysdeps/generic/aio_read64.c: Moved to...
	* rt/aio_read64.c: ...here.
	* sysdeps/generic/aio_sigqueue.c: Moved to...
	* rt/aio_sigqueue.c: ...here.
	* sysdeps/generic/aio_suspend.c: Moved to...
	* rt/aio_suspend.c: ...here.
	* sysdeps/generic/aio_write.c: Moved to...
	* rt/aio_write.c: ...here.
	* sysdeps/generic/aio_write64.c: Moved to...
	* rt/aio_write64.c: ...here.
	* sysdeps/generic/alarm.c: Moved to...
	* posix/alarm.c: ...here.
	* sysdeps/generic/allocrtsig.c: Moved to...
	* signal/allocrtsig.c: ...here.
	* sysdeps/generic/alphasort64.c: Moved to...
	* dirent/alphasort64.c: ...here.
	* sysdeps/generic/backtrace.c: Moved to...
	* debug/backtrace.c: ...here.
	* sysdeps/generic/backtracesyms.c: Moved to...
	* debug/backtracesyms.c: ...here.
	* sysdeps/generic/backtracesymsfd.c: Moved to...
	* debug/backtracesymsfd.c: ...here.
	* sysdeps/generic/bb_init_func.c: Moved to...
	* gmon/bb_init_func.c: ...here.
	* sysdeps/generic/bcopy.c: Moved to...
	* string/bcopy.c: ...here.
	* sysdeps/generic/bind.c: Moved to...
	* socket/bind.c: ...here.
	* sysdeps/generic/brdinit.c: Moved to...
	* bare/brdinit.c: ...here.
	* sysdeps/generic/brk.c: Moved to...
	* misc/brk.c: ...here.
	* sysdeps/generic/bsd-_setjmp.c: Moved to...
	* setjmp/bsd-_setjmp.c: ...here.
	* sysdeps/generic/bsd-setjmp.c: Moved to...
	* setjmp/bsd-setjmp.c: ...here.
	* sysdeps/generic/bzero.c: Moved to...
	* string/bzero.c: ...here.
	* sysdeps/generic/cabsf.c: Moved to...
	* math/cabsf.c: ...here.
	* sysdeps/generic/cargf.c: Moved to...
	* math/cargf.c: ...here.
	* sysdeps/generic/chdir.c: Moved to...
	* io/chdir.c: ...here.
	* sysdeps/generic/check_fds.c: Moved to...
	* csu/check_fds.c: ...here.
	* sysdeps/generic/check_pf.c: Moved to...
	* inet/check_pf.c: ...here.
	* sysdeps/generic/chflags.c: Moved to...
	* misc/chflags.c: ...here.
	* sysdeps/generic/chmod.c: Moved to...
	* io/chmod.c: ...here.
	* sysdeps/generic/chown.c: Moved to...
	* io/chown.c: ...here.
	* sysdeps/generic/chroot.c: Moved to...
	* misc/chroot.c: ...here.
	* sysdeps/generic/cimagf.c: Moved to...
	* math/cimagf.c: ...here.
	* sysdeps/generic/clock.c: Moved to...
	* time/clock.c: ...here.
	* sysdeps/generic/clock_getcpuclockid.c: Moved to...
	* rt/clock_getcpuclockid.c: ...here.
	* sysdeps/generic/clock_getres.c: Moved to...
	* rt/clock_getres.c: ...here.
	* sysdeps/generic/clock_gettime.c: Moved to...
	* rt/clock_gettime.c: ...here.
	* sysdeps/generic/clock_nanosleep.c: Moved to...
	* rt/clock_nanosleep.c: ...here.
	* sysdeps/generic/clock_settime.c: Moved to...
	* rt/clock_settime.c: ...here.
	* sysdeps/generic/close.c: Moved to...
	* io/close.c: ...here.
	* sysdeps/generic/closedir.c: Moved to...
	* dirent/closedir.c: ...here.
	* sysdeps/generic/cmp.c: Moved to...
	* stdlib/cmp.c: ...here.
	* sysdeps/generic/conjf.c: Moved to...
	* math/conjf.c: ...here.
	* sysdeps/generic/connect.c: Moved to...
	* socket/connect.c: ...here.
	* sysdeps/generic/console.c: Moved to...
	* bare/console.c: ...here.
	* sysdeps/generic/crealf.c: Moved to...
	* math/crealf.c: ...here.
	* sysdeps/generic/creat.c: Moved to...
	* io/creat.c: ...here.
	* sysdeps/generic/creat64.c: Moved to...
	* io/creat64.c: ...here.
	* sysdeps/generic/ctermid.c: Moved to...
	* stdio-common/ctermid.c: ...here.
	* sysdeps/generic/cuserid.c: Moved to...
	* stdio-common/cuserid.c: ...here.
	* sysdeps/generic/dbl2mpn.c: Moved to...
	* stdlib/dbl2mpn.c: ...here.
	* sysdeps/generic/dirfd.c: Moved to...
	* dirent/dirfd.c: ...here.
	* sysdeps/generic/div.c: Moved to...
	* stdlib/div.c: ...here.
	* sysdeps/generic/divmod_1.c: Moved to...
	* stdlib/divmod_1.c: ...here.
	* sysdeps/generic/divrem.c: Moved to...
	* stdlib/divrem.c: ...here.
	* sysdeps/generic/dl-brk.c: Moved to...
	* elf/dl-brk.c: ...here.
	* sysdeps/generic/dl-cache.c: Moved to...
	* elf/dl-cache.c: ...here.
	* sysdeps/generic/dl-environ.c: Moved to...
	* elf/dl-environ.c: ...here.
	* sysdeps/generic/dl-execstack.c: Moved to...
	* elf/dl-execstack.c: ...here.
	* sysdeps/generic/dl-fptr.c: Moved to...
	* elf/dl-fptr.c: ...here.
	* sysdeps/generic/dl-origin.c: Moved to...
	* elf/dl-origin.c: ...here.
	* sysdeps/generic/dl-sbrk.c: Moved to...
	* elf/dl-sbrk.c: ...here.
	* sysdeps/generic/dl-symaddr.c: Moved to...
	* elf/dl-symaddr.c: ...here.
	* sysdeps/generic/dl-sysdep.c: Moved to...
	* elf/dl-sysdep.c: ...here.
	* sysdeps/generic/dl-tls.c: Moved to...
	* elf/dl-tls.c: ...here.
	* sysdeps/generic/dl-trampoline.c: Moved to...
	* elf/dl-trampoline.c: ...here.
	* sysdeps/generic/dup.c: Moved to...
	* io/dup.c: ...here.
	* sysdeps/generic/dup2.c: Moved to...
	* io/dup2.c: ...here.
	* sysdeps/generic/e_acoshl.c: Moved to...
	* math/e_acoshl.c: ...here.
	* sysdeps/generic/e_acosl.c: Moved to...
	* math/e_acosl.c: ...here.
	* sysdeps/generic/e_asinl.c: Moved to...
	* math/e_asinl.c: ...here.
	* sysdeps/generic/e_atan2l.c: Moved to...
	* math/e_atan2l.c: ...here.
	* sysdeps/generic/e_atanhl.c: Moved to...
	* math/e_atanhl.c: ...here.
	* sysdeps/generic/e_coshl.c: Moved to...
	* math/e_coshl.c: ...here.
	* sysdeps/generic/e_exp10.c: Moved to...
	* math/e_exp10.c: ...here.
	* sysdeps/generic/e_exp10f.c: Moved to...
	* math/e_exp10f.c: ...here.
	* sysdeps/generic/e_exp10l.c: Moved to...
	* math/e_exp10l.c: ...here.
	* sysdeps/generic/e_exp2l.c: Moved to...
	* math/e_exp2l.c: ...here.
	* sysdeps/generic/e_expl.c: Moved to...
	* math/e_expl.c: ...here.
	* sysdeps/generic/e_fmodl.c: Moved to...
	* math/e_fmodl.c: ...here.
	* sysdeps/generic/e_gammal_r.c: Moved to...
	* math/e_gammal_r.c: ...here.
	* sysdeps/generic/e_hypotl.c: Moved to...
	* math/e_hypotl.c: ...here.
	* sysdeps/generic/e_j0l.c: Moved to...
	* math/e_j0l.c: ...here.
	* sysdeps/generic/e_j1l.c: Moved to...
	* math/e_j1l.c: ...here.
	* sysdeps/generic/e_jnl.c: Moved to...
	* math/e_jnl.c: ...here.
	* sysdeps/generic/e_lgammal_r.c: Moved to...
	* math/e_lgammal_r.c: ...here.
	* sysdeps/generic/e_log10l.c: Moved to...
	* math/e_log10l.c: ...here.
	* sysdeps/generic/e_log2l.c: Moved to...
	* math/e_log2l.c: ...here.
	* sysdeps/generic/e_logl.c: Moved to...
	* math/e_logl.c: ...here.
	* sysdeps/generic/e_powl.c: Moved to...
	* math/e_powl.c: ...here.
	* sysdeps/generic/e_rem_pio2l.c: Moved to...
	* math/e_rem_pio2l.c: ...here.
	* sysdeps/generic/e_scalb.c: Moved to...
	* math/e_scalb.c: ...here.
	* sysdeps/generic/e_scalbf.c: Moved to...
	* math/e_scalbf.c: ...here.
	* sysdeps/generic/e_scalbl.c: Moved to...
	* math/e_scalbl.c: ...here.
	* sysdeps/generic/e_sinhl.c: Moved to...
	* math/e_sinhl.c: ...here.
	* sysdeps/generic/e_sqrtl.c: Moved to...
	* math/e_sqrtl.c: ...here.
	* sysdeps/generic/enbl-secure.c: Moved to...
	* elf/enbl-secure.c: ...here.
	* sysdeps/generic/endutxent.c: Moved to...
	* login/endutxent.c: ...here.
	* sysdeps/generic/environ.c: Moved to...
	* posix/environ.c: ...here.
	* sysdeps/generic/errlist.c: Moved to...
	* stdio-common/errlist.c: ...here.
	* sysdeps/generic/errno-loc.c: Moved to...
	* csu/errno-loc.c: ...here.
	* sysdeps/generic/errno-loc.c: Moved to...
	* csu/errno-loc.c: ...here.
	* sysdeps/generic/errno.c: Moved to...
	* csu/errno.c: ...here.
	* sysdeps/generic/euidaccess.c: Moved to...
	* io/euidaccess.c: ...here.
	* sysdeps/generic/exc2signal.c: Moved to...
	* hurd/exc2signal.c: ...here.
	* sysdeps/generic/execve.c: Moved to...
	* posix/execve.c: ...here.
	* sysdeps/generic/fattach.c: Moved to...
	* streams/fattach.c: ...here.
	* sysdeps/generic/fchdir.c: Moved to...
	* io/fchdir.c: ...here.
	* sysdeps/generic/fchflags.c: Moved to...
	* misc/fchflags.c: ...here.
	* sysdeps/generic/fchmod.c: Moved to...
	* io/fchmod.c: ...here.
	* sysdeps/generic/fchown.c: Moved to...
	* io/fchown.c: ...here.
	* sysdeps/generic/fchownat.c: Moved to...
	* io/fchownat.c: ...here.
	* sysdeps/generic/fclrexcpt.c: Moved to...
	* math/fclrexcpt.c: ...here.
	* sysdeps/generic/fcntl.c: Moved to...
	* io/fcntl.c: ...here.
	* sysdeps/generic/fdatasync.c: Moved to...
	* misc/fdatasync.c: ...here.
	* sysdeps/generic/fdetach.c: Moved to...
	* streams/fdetach.c: ...here.
	* sysdeps/generic/fdopendir.c: Moved to...
	* dirent/fdopendir.c: ...here.
	* sysdeps/generic/fedisblxcpt.c: Moved to...
	* math/fedisblxcpt.c: ...here.
	* sysdeps/generic/feenablxcpt.c: Moved to...
	* math/feenablxcpt.c: ...here.
	* sysdeps/generic/fegetenv.c: Moved to...
	* math/fegetenv.c: ...here.
	* sysdeps/generic/fegetexcept.c: Moved to...
	* math/fegetexcept.c: ...here.
	* sysdeps/generic/fegetround.c: Moved to...
	* math/fegetround.c: ...here.
	* sysdeps/generic/feholdexcpt.c: Moved to...
	* math/feholdexcpt.c: ...here.
	* sysdeps/generic/fesetenv.c: Moved to...
	* math/fesetenv.c: ...here.
	* sysdeps/generic/fesetround.c: Moved to...
	* math/fesetround.c: ...here.
	* sysdeps/generic/feupdateenv.c: Moved to...
	* math/feupdateenv.c: ...here.
	* sysdeps/generic/fexecve.c: Moved to...
	* posix/fexecve.c: ...here.
	* sysdeps/generic/ffs.c: Moved to...
	* string/ffs.c: ...here.
	* sysdeps/generic/ffsll.c: Moved to...
	* string/ffsll.c: ...here.
	* sysdeps/generic/fgetexcptflg.c: Moved to...
	* math/fgetexcptflg.c: ...here.
	* sysdeps/generic/fgetxattr.c: Moved to...
	* misc/fgetxattr.c: ...here.
	* sysdeps/generic/flistxattr.c: Moved to...
	* misc/flistxattr.c: ...here.
	* sysdeps/generic/flock.c: Moved to...
	* io/flock.c: ...here.
	* sysdeps/generic/flockfile.c: Moved to...
	* stdio-common/flockfile.c: ...here.
	* sysdeps/generic/fork.c: Moved to...
	* posix/fork.c: ...here.
	* sysdeps/generic/fpathconf.c: Moved to...
	* posix/fpathconf.c: ...here.
	* sysdeps/generic/fpu_control.c: Moved to...
	* math/fpu_control.c: ...here.
	* sysdeps/generic/fraiseexcpt.c: Moved to...
	* math/fraiseexcpt.c: ...here.
	* sysdeps/generic/fremovexattr.c: Moved to...
	* misc/fremovexattr.c: ...here.
	* sysdeps/generic/fsetexcptflg.c: Moved to...
	* math/fsetexcptflg.c: ...here.
	* sysdeps/generic/fsetxattr.c: Moved to...
	* misc/fsetxattr.c: ...here.
	* sysdeps/generic/fstatfs.c: Moved to...
	* io/fstatfs.c: ...here.
	* sysdeps/generic/fstatfs64.c: Moved to...
	* io/fstatfs64.c: ...here.
	* sysdeps/generic/fstatvfs.c: Moved to...
	* io/fstatvfs.c: ...here.
	* sysdeps/generic/fstatvfs64.c: Moved to...
	* io/fstatvfs64.c: ...here.
	* sysdeps/generic/fsync.c: Moved to...
	* misc/fsync.c: ...here.
	* sysdeps/generic/ftestexcept.c: Moved to...
	* math/ftestexcept.c: ...here.
	* sysdeps/generic/ftime.c: Moved to...
	* time/ftime.c: ...here.
	* sysdeps/generic/ftruncate.c: Moved to...
	* misc/ftruncate.c: ...here.
	* sysdeps/generic/ftruncate64.c: Moved to...
	* misc/ftruncate64.c: ...here.
	* sysdeps/generic/ftrylockfile.c: Moved to...
	* stdio-common/ftrylockfile.c: ...here.
	* sysdeps/generic/funlockfile.c: Moved to...
	* stdio-common/funlockfile.c: ...here.
	* sysdeps/generic/futimes.c: Moved to...
	* misc/futimes.c: ...here.
	* sysdeps/generic/futimesat.c: Moved to...
	* misc/futimesat.c: ...here.
	* sysdeps/generic/fxstat.c: Moved to...
	* io/fxstat.c: ...here.
	* sysdeps/generic/fxstat64.c: Moved to...
	* io/fxstat64.c: ...here.
	* sysdeps/generic/fxstatat.c: Moved to...
	* io/fxstatat.c: ...here.
	* sysdeps/generic/fxstatat64.c: Moved to...
	* io/fxstatat64.c: ...here.
	* sysdeps/generic/gai_sigqueue.c: Moved to...
	* resolv/gai_sigqueue.c: ...here.
	* sysdeps/generic/gai_strerror.c: Moved to...
	* posix/gai_strerror.c: ...here.
	* sysdeps/generic/get_clockfreq.c: Moved to...
	* rt/get_clockfreq.c: ...here.
	* sysdeps/generic/getaddrinfo.c: Moved to...
	* posix/getaddrinfo.c: ...here.
	* sysdeps/generic/getclktck.c: Moved to...
	* misc/getclktck.c: ...here.
	* sysdeps/generic/getcontext.c: Moved to...
	* stdlib/getcontext.c: ...here.
	* sysdeps/generic/getcwd.c: Moved to...
	* io/getcwd.c: ...here.
	* sysdeps/generic/getdents.c: Moved to...
	* dirent/getdents.c: ...here.
	* sysdeps/generic/getdents64.c: Moved to...
	* dirent/getdents64.c: ...here.
	* sysdeps/generic/getdomain.c: Moved to...
	* misc/getdomain.c: ...here.
	* sysdeps/generic/getdtsz.c: Moved to...
	* misc/getdtsz.c: ...here.
	* sysdeps/generic/getegid.c: Moved to...
	* posix/getegid.c: ...here.
	* sysdeps/generic/getenv.c: Moved to...
	* stdlib/getenv.c: ...here.
	* sysdeps/generic/geteuid.c: Moved to...
	* posix/geteuid.c: ...here.
	* sysdeps/generic/getgid.c: Moved to...
	* posix/getgid.c: ...here.
	* sysdeps/generic/getgroups.c: Moved to...
	* posix/getgroups.c: ...here.
	* sysdeps/generic/gethostid.c: Moved to...
	* misc/gethostid.c: ...here.
	* sysdeps/generic/gethostname.c: Moved to...
	* misc/gethostname.c: ...here.
	* sysdeps/generic/getipv4sourcefilter.c: Moved to...
	* inet/getipv4sourcefilter.c: ...here.
	* sysdeps/generic/getitimer.c: Moved to...
	* time/getitimer.c: ...here.
	* sysdeps/generic/getloadavg.c: Moved to...
	* misc/getloadavg.c: ...here.
	* sysdeps/generic/getlogin.c: Moved to...
	* posix/getlogin.c: ...here.
	* sysdeps/generic/getlogin_r.c: Moved to...
	* posix/getlogin_r.c: ...here.
	* sysdeps/generic/getmsg.c: Moved to...
	* streams/getmsg.c: ...here.
	* sysdeps/generic/getpagesize.c: Moved to...
	* misc/getpagesize.c: ...here.
	* sysdeps/generic/getpeername.c: Moved to...
	* socket/getpeername.c: ...here.
	* sysdeps/generic/getpgid.c: Moved to...
	* posix/getpgid.c: ...here.
	* sysdeps/generic/getpgrp.c: Moved to...
	* posix/getpgrp.c: ...here.
	* sysdeps/generic/getpid.c: Moved to...
	* posix/getpid.c: ...here.
	* sysdeps/generic/getpmsg.c: Moved to...
	* streams/getpmsg.c: ...here.
	* sysdeps/generic/getppid.c: Moved to...
	* posix/getppid.c: ...here.
	* sysdeps/generic/getpriority.c: Moved to...
	* resource/getpriority.c: ...here.
	* sysdeps/generic/getpt.c: Moved to...
	* login/getpt.c: ...here.
	* sysdeps/generic/getresgid.c: Moved to...
	* posix/getresgid.c: ...here.
	* sysdeps/generic/getresuid.c: Moved to...
	* posix/getresuid.c: ...here.
	* sysdeps/generic/getrlimit.c: Moved to...
	* resource/getrlimit.c: ...here.
	* sysdeps/generic/getrlimit64.c: Moved to...
	* resource/getrlimit64.c: ...here.
	* sysdeps/generic/getrusage.c: Moved to...
	* resource/getrusage.c: ...here.
	* sysdeps/generic/getsid.c: Moved to...
	* posix/getsid.c: ...here.
	* sysdeps/generic/getsockname.c: Moved to...
	* socket/getsockname.c: ...here.
	* sysdeps/generic/getsockopt.c: Moved to...
	* socket/getsockopt.c: ...here.
	* sysdeps/generic/getsourcefilter.c: Moved to...
	* inet/getsourcefilter.c: ...here.
	* sysdeps/generic/getsysstats.c: Moved to...
	* misc/getsysstats.c: ...here.
	* sysdeps/generic/gettimeofday.c: Moved to...
	* time/gettimeofday.c: ...here.
	* sysdeps/generic/getuid.c: Moved to...
	* posix/getuid.c: ...here.
	* sysdeps/generic/getutmp.c: Moved to...
	* login/getutmp.c: ...here.
	* sysdeps/generic/getutmpx.c: Moved to...
	* login/getutmpx.c: ...here.
	* sysdeps/generic/getutxent.c: Moved to...
	* login/getutxent.c: ...here.
	* sysdeps/generic/getutxid.c: Moved to...
	* login/getutxid.c: ...here.
	* sysdeps/generic/getutxline.c: Moved to...
	* login/getutxline.c: ...here.
	* sysdeps/generic/getxattr.c: Moved to...
	* misc/getxattr.c: ...here.
	* sysdeps/generic/glob.c: Moved to...
	* posix/glob.c: ...here.
	* sysdeps/generic/glob64.c: Moved to...
	* posix/glob64.c: ...here.
	* sysdeps/generic/grantpt.c: Moved to...
	* login/grantpt.c: ...here.
	* sysdeps/generic/group_member.c: Moved to...
	* posix/group_member.c: ...here.
	* sysdeps/generic/gtty.c: Moved to...
	* misc/gtty.c: ...here.
	* sysdeps/generic/herrno-loc.c: Moved to...
	* inet/herrno-loc.c: ...here.
	* sysdeps/generic/htonl.c: Moved to...
	* inet/htonl.c: ...here.
	* sysdeps/generic/htons.c: Moved to...
	* inet/htons.c: ...here.
	* sysdeps/generic/if_index.c: Moved to...
	* inet/if_index.c: ...here.
	* sysdeps/generic/ifaddrs.c: Moved to...
	* inet/ifaddrs.c: ...here.
	* sysdeps/generic/ifreq.c: Moved to...
	* inet/ifreq.c: ...here.
	* sysdeps/generic/init-first.c: Moved to...
	* csu/init-first.c: ...here.
	* sysdeps/generic/init-posix.c: Moved to...
	* posix/init-posix.c: ...here.
	* sysdeps/generic/inlines.c: Moved to...
	* stdlib/inlines.c: ...here.
	* sysdeps/generic/ioctl.c: Moved to...
	* misc/ioctl.c: ...here.
	* sysdeps/generic/isastream.c: Moved to...
	* streams/isastream.c: ...here.
	* sysdeps/generic/isatty.c: Moved to...
	* io/isatty.c: ...here.
	* sysdeps/generic/isfdtype.c: Moved to...
	* socket/isfdtype.c: ...here.
	* sysdeps/generic/jmp-unwind.c: Moved to...
	* setjmp/jmp-unwind.c: ...here.
	* sysdeps/generic/k_cosl.c: Moved to...
	* math/k_cosl.c: ...here.
	* sysdeps/generic/k_rem_pio2l.c: Moved to...
	* math/k_rem_pio2l.c: ...here.
	* sysdeps/generic/k_sincosl.c: Moved to...
	* math/k_sincosl.c: ...here.
	* sysdeps/generic/k_sinl.c: Moved to...
	* math/k_sinl.c: ...here.
	* sysdeps/generic/k_tanl.c: Moved to...
	* math/k_tanl.c: ...here.
	* sysdeps/generic/kill.c: Moved to...
	* signal/kill.c: ...here.
	* sysdeps/generic/killpg.c: Moved to...
	* signal/killpg.c: ...here.
	* sysdeps/generic/labs.c: Moved to...
	* stdlib/labs.c: ...here.
	* sysdeps/generic/lchmod.c: Moved to...
	* io/lchmod.c: ...here.
	* sysdeps/generic/lchown.c: Moved to...
	* io/lchown.c: ...here.
	* sysdeps/generic/ldbl2mpn.c: Moved to...
	* stdlib/ldbl2mpn.c: ...here.
	* sysdeps/generic/ldiv.c: Moved to...
	* stdlib/ldiv.c: ...here.
	* sysdeps/generic/lgetxattr.c: Moved to...
	* misc/lgetxattr.c: ...here.
	* sysdeps/generic/libc-start.c: Moved to...
	* csu/libc-start.c: ...here.
	* sysdeps/generic/libc-tls.c: Moved to...
	* csu/libc-tls.c: ...here.
	* sysdeps/generic/libc_fatal.c: Moved to...
	* libio/libc_fatal.c: ...here.
	* sysdeps/generic/link.c: Moved to...
	* io/link.c: ...here.
	* sysdeps/generic/lio_listio.c: Moved to...
	* rt/lio_listio.c: ...here.
	* sysdeps/generic/lio_listio64.c: Moved to...
	* rt/lio_listio64.c: ...here.
	* sysdeps/generic/listen.c: Moved to...
	* socket/listen.c: ...here.
	* sysdeps/generic/listxattr.c: Moved to...
	* misc/listxattr.c: ...here.
	* sysdeps/generic/llabs.c: Moved to...
	* stdlib/llabs.c: ...here.
	* sysdeps/generic/lldiv.c: Moved to...
	* stdlib/lldiv.c: ...here.
	* sysdeps/generic/llistxattr.c: Moved to...
	* misc/llistxattr.c: ...here.
	* sysdeps/generic/lockf.c: Moved to...
	* io/lockf.c: ...here.
	* sysdeps/generic/lockf64.c: Moved to...
	* io/lockf64.c: ...here.
	* sysdeps/generic/longjmp-ts.c: Moved to...
	* hurd/longjmp-ts.c: ...here.
	* sysdeps/generic/longjmp.c: Moved to...
	* setjmp/longjmp.c: ...here.
	* sysdeps/generic/lremovexattr.c: Moved to...
	* misc/lremovexattr.c: ...here.
	* sysdeps/generic/lseek.c: Moved to...
	* misc/lseek.c: ...here.
	* sysdeps/generic/lseek64.c: Moved to...
	* io/lseek64.c: ...here.
	* sysdeps/generic/lsetxattr.c: Moved to...
	* misc/lsetxattr.c: ...here.
	* sysdeps/generic/lshift.c: Moved to...
	* stdlib/lshift.c: ...here.
	* sysdeps/generic/lutimes.c: Moved to...
	* misc/lutimes.c: ...here.
	* sysdeps/generic/lxstat.c: Moved to...
	* io/lxstat.c: ...here.
	* sysdeps/generic/lxstat64.c: Moved to...
	* io/lxstat64.c: ...here.
	* sysdeps/generic/madvise.c: Moved to...
	* misc/madvise.c: ...here.
	* sysdeps/generic/makecontext.c: Moved to...
	* stdlib/makecontext.c: ...here.
	* sysdeps/generic/memccpy.c: Moved to...
	* string/memccpy.c: ...here.
	* sysdeps/generic/memchr.c: Moved to...
	* string/memchr.c: ...here.
	* sysdeps/generic/memcmp.c: Moved to...
	* string/memcmp.c: ...here.
	* sysdeps/generic/memcpy.c: Moved to...
	* string/memcpy.c: ...here.
	* sysdeps/generic/memcpy_chk.c: Moved to...
	* debug/memcpy_chk.c: ...here.
	* sysdeps/generic/memmem.c: Moved to...
	* string/memmem.c: ...here.
	* sysdeps/generic/memmove.c: Moved to...
	* string/memmove.c: ...here.
	* sysdeps/generic/memmove_chk.c: Moved to...
	* debug/memmove_chk.c: ...here.
	* sysdeps/generic/mempcpy.c: Moved to...
	* string/mempcpy.c: ...here.
	* sysdeps/generic/mempcpy_chk.c: Moved to...
	* debug/mempcpy_chk.c: ...here.
	* sysdeps/generic/memrchr.c: Moved to...
	* string/memrchr.c: ...here.
	* sysdeps/generic/memset.c: Moved to...
	* string/memset.c: ...here.
	* sysdeps/generic/memset_chk.c: Moved to...
	* debug/memset_chk.c: ...here.
	* sysdeps/generic/mig-reply.c: Moved to...
	* mach/mig-reply.c: ...here.
	* sysdeps/generic/mincore.c: Moved to...
	* misc/mincore.c: ...here.
	* sysdeps/generic/mkdir.c: Moved to...
	* io/mkdir.c: ...here.
	* sysdeps/generic/mkdirat.c: Moved to...
	* io/mkdirat.c: ...here.
	* sysdeps/generic/mkfifo.c: Moved to...
	* io/mkfifo.c: ...here.
	* sysdeps/generic/mkfifoat.c: Moved to...
	* io/mkfifoat.c: ...here.
	* sysdeps/generic/mknod.c: Moved to...
	* io/mknod.c: ...here.
	* sysdeps/generic/mknodat.c: Moved to...
	* io/mknodat.c: ...here.
	* sysdeps/generic/mlock.c: Moved to...
	* misc/mlock.c: ...here.
	* sysdeps/generic/mlockall.c: Moved to...
	* misc/mlockall.c: ...here.
	* sysdeps/generic/mmap.c: Moved to...
	* misc/mmap.c: ...here.
	* sysdeps/generic/mmap64.c: Moved to...
	* misc/mmap64.c: ...here.
	* sysdeps/generic/mod_1.c: Moved to...
	* stdlib/mod_1.c: ...here.
	* sysdeps/generic/morecore.c: Moved to...
	* malloc/morecore.c: ...here.
	* sysdeps/generic/mp_clz_tab.c: Moved to...
	* stdlib/mp_clz_tab.c: ...here.
	* sysdeps/generic/mpn2dbl.c: Moved to...
	* stdlib/mpn2dbl.c: ...here.
	* sysdeps/generic/mpn2flt.c: Moved to...
	* stdlib/mpn2flt.c: ...here.
	* sysdeps/generic/mpn2ldbl.c: Moved to...
	* stdlib/mpn2ldbl.c: ...here.
	* sysdeps/generic/mprotect.c: Moved to...
	* misc/mprotect.c: ...here.
	* sysdeps/generic/mq_close.c: Moved to...
	* rt/mq_close.c: ...here.
	* sysdeps/generic/mq_getattr.c: Moved to...
	* rt/mq_getattr.c: ...here.
	* sysdeps/generic/mq_notify.c: Moved to...
	* rt/mq_notify.c: ...here.
	* sysdeps/generic/mq_open.c: Moved to...
	* rt/mq_open.c: ...here.
	* sysdeps/generic/mq_receive.c: Moved to...
	* rt/mq_receive.c: ...here.
	* sysdeps/generic/mq_send.c: Moved to...
	* rt/mq_send.c: ...here.
	* sysdeps/generic/mq_setattr.c: Moved to...
	* rt/mq_setattr.c: ...here.
	* sysdeps/generic/mq_timedreceive.c: Moved to...
	* rt/mq_timedreceive.c: ...here.
	* sysdeps/generic/mq_timedsend.c: Moved to...
	* rt/mq_timedsend.c: ...here.
	* sysdeps/generic/mq_unlink.c: Moved to...
	* rt/mq_unlink.c: ...here.
	* sysdeps/generic/msgctl.c: Moved to...
	* sysvipc/msgctl.c: ...here.
	* sysdeps/generic/msgget.c: Moved to...
	* sysvipc/msgget.c: ...here.
	* sysdeps/generic/msgrcv.c: Moved to...
	* sysvipc/msgrcv.c: ...here.
	* sysdeps/generic/msgsnd.c: Moved to...
	* sysvipc/msgsnd.c: ...here.
	* sysdeps/generic/msync.c: Moved to...
	* misc/msync.c: ...here.
	* sysdeps/generic/mul.c: Moved to...
	* stdlib/mul.c: ...here.
	* sysdeps/generic/mul_1.c: Moved to...
	* stdlib/mul_1.c: ...here.
	* sysdeps/generic/mul_n.c: Moved to...
	* stdlib/mul_n.c: ...here.
	* sysdeps/generic/munlock.c: Moved to...
	* misc/munlock.c: ...here.
	* sysdeps/generic/munlockall.c: Moved to...
	* misc/munlockall.c: ...here.
	* sysdeps/generic/munmap.c: Moved to...
	* misc/munmap.c: ...here.
	* sysdeps/generic/nanosleep.c: Moved to...
	* posix/nanosleep.c: ...here.
	* sysdeps/generic/nice.c: Moved to...
	* resource/nice.c: ...here.
	* sysdeps/generic/nscd_setup_thread.c: Moved to...
	* nscd/nscd_setup_thread.c: ...here.
	* sysdeps/generic/open.c: Moved to...
	* io/open.c: ...here.
	* sysdeps/generic/open64.c: Moved to...
	* io/open64.c: ...here.
	* sysdeps/generic/openat.c: Moved to...
	* io/openat.c: ...here.
	* sysdeps/generic/openat64.c: Moved to...
	* io/openat64.c: ...here.
	* sysdeps/generic/opendir.c: Moved to...
	* dirent/opendir.c: ...here.
	* sysdeps/generic/opensock.c: Moved to...
	* socket/opensock.c: ...here.
	* sysdeps/generic/pathconf.c: Moved to...
	* posix/pathconf.c: ...here.
	* sysdeps/generic/pause.c: Moved to...
	* posix/pause.c: ...here.
	* sysdeps/generic/pipe.c: Moved to...
	* io/pipe.c: ...here.
	* sysdeps/generic/poll.c: Moved to...
	* io/poll.c: ...here.
	* sysdeps/generic/posix_fadvise.c: Moved to...
	* io/posix_fadvise.c: ...here.
	* sysdeps/generic/posix_fadvise64.c: Moved to...
	* io/posix_fadvise64.c: ...here.
	* sysdeps/generic/posix_fallocate.c: Moved to...
	* io/posix_fallocate.c: ...here.
	* sysdeps/generic/posix_fallocate64.c: Moved to...
	* io/posix_fallocate64.c: ...here.
	* sysdeps/generic/posix_madvise.c: Moved to...
	* posix/posix_madvise.c: ...here.
	* sysdeps/generic/pread.c: Moved to...
	* posix/pread.c: ...here.
	* sysdeps/generic/pread64.c: Moved to...
	* posix/pread64.c: ...here.
	* sysdeps/generic/printf_fphex.c: Moved to...
	* stdio-common/printf_fphex.c: ...here.
	* sysdeps/generic/prof-freq.c: Moved to...
	* gmon/prof-freq.c: ...here.
	* sysdeps/generic/profil.c: Moved to...
	* gmon/profil.c: ...here.
	* sysdeps/generic/pselect.c: Moved to...
	* misc/pselect.c: ...here.
	* sysdeps/generic/ptrace.c: Moved to...
	* misc/ptrace.c: ...here.
	* sysdeps/generic/ptsname.c: Moved to...
	* login/ptsname.c: ...here.
	* sysdeps/generic/putenv.c: Moved to...
	* stdlib/putenv.c: ...here.
	* sysdeps/generic/putmsg.c: Moved to...
	* streams/putmsg.c: ...here.
	* sysdeps/generic/putpmsg.c: Moved to...
	* streams/putpmsg.c: ...here.
	* sysdeps/generic/pututxline.c: Moved to...
	* login/pututxline.c: ...here.
	* sysdeps/generic/pwrite.c: Moved to...
	* posix/pwrite.c: ...here.
	* sysdeps/generic/pwrite64.c: Moved to...
	* posix/pwrite64.c: ...here.
	* sysdeps/generic/raise.c: Moved to...
	* signal/raise.c: ...here.
	* sysdeps/generic/rawmemchr.c: Moved to...
	* string/rawmemchr.c: ...here.
	* sysdeps/generic/read.c: Moved to...
	* io/read.c: ...here.
	* sysdeps/generic/readdir.c: Moved to...
	* dirent/readdir.c: ...here.
	* sysdeps/generic/readdir64.c: Moved to...
	* dirent/readdir64.c: ...here.
	* sysdeps/generic/readdir64_r.c: Moved to...
	* dirent/readdir64_r.c: ...here.
	* sysdeps/generic/readdir_r.c: Moved to...
	* dirent/readdir_r.c: ...here.
	* sysdeps/generic/readelflib.c: Moved to...
	* elf/readelflib.c: ...here.
	* sysdeps/generic/readlink.c: Moved to...
	* io/readlink.c: ...here.
	* sysdeps/generic/readonly-area.c: Moved to...
	* debug/readonly-area.c: ...here.
	* sysdeps/generic/readv.c: Moved to...
	* misc/readv.c: ...here.
	* sysdeps/generic/reboot.c: Moved to...
	* misc/reboot.c: ...here.
	* sysdeps/generic/recv.c: Moved to...
	* socket/recv.c: ...here.
	* sysdeps/generic/recvfrom.c: Moved to...
	* socket/recvfrom.c: ...here.
	* sysdeps/generic/recvmsg.c: Moved to...
	* socket/recvmsg.c: ...here.
	* sysdeps/generic/remap_file_pages.c: Moved to...
	* misc/remap_file_pages.c: ...here.
	* sysdeps/generic/remove.c: Moved to...
	* stdio-common/remove.c: ...here.
	* sysdeps/generic/removexattr.c: Moved to...
	* misc/removexattr.c: ...here.
	* sysdeps/generic/rename.c: Moved to...
	* stdio-common/rename.c: ...here.
	* sysdeps/generic/renameat.c: Moved to...
	* stdio-common/renameat.c: ...here.
	* sysdeps/generic/res-state.c: Moved to...
	* resolv/res-state.c: ...here.
	* sysdeps/generic/revoke.c: Moved to...
	* misc/revoke.c: ...here.
	* sysdeps/generic/rewinddir.c: Moved to...
	* dirent/rewinddir.c: ...here.
	* sysdeps/generic/rmdir.c: Moved to...
	* io/rmdir.c: ...here.
	* sysdeps/generic/rshift.c: Moved to...
	* stdlib/rshift.c: ...here.
	* sysdeps/generic/s_asinhl.c: Moved to...
	* math/s_asinhl.c: ...here.
	* sysdeps/generic/s_atanl.c: Moved to...
	* math/s_atanl.c: ...here.
	* sysdeps/generic/s_cacos.c: Moved to...
	* math/s_cacos.c: ...here.
	* sysdeps/generic/s_cacosf.c: Moved to...
	* math/s_cacosf.c: ...here.
	* sysdeps/generic/s_cacosh.c: Moved to...
	* math/s_cacosh.c: ...here.
	* sysdeps/generic/s_cacoshf.c: Moved to...
	* math/s_cacoshf.c: ...here.
	* sysdeps/generic/s_cacoshl.c: Moved to...
	* math/s_cacoshl.c: ...here.
	* sysdeps/generic/s_cacosl.c: Moved to...
	* math/s_cacosl.c: ...here.
	* sysdeps/generic/s_casin.c: Moved to...
	* math/s_casin.c: ...here.
	* sysdeps/generic/s_casinf.c: Moved to...
	* math/s_casinf.c: ...here.
	* sysdeps/generic/s_casinh.c: Moved to...
	* math/s_casinh.c: ...here.
	* sysdeps/generic/s_casinhf.c: Moved to...
	* math/s_casinhf.c: ...here.
	* sysdeps/generic/s_casinhl.c: Moved to...
	* math/s_casinhl.c: ...here.
	* sysdeps/generic/s_casinl.c: Moved to...
	* math/s_casinl.c: ...here.
	* sysdeps/generic/s_catan.c: Moved to...
	* math/s_catan.c: ...here.
	* sysdeps/generic/s_catanf.c: Moved to...
	* math/s_catanf.c: ...here.
	* sysdeps/generic/s_catanh.c: Moved to...
	* math/s_catanh.c: ...here.
	* sysdeps/generic/s_catanhf.c: Moved to...
	* math/s_catanhf.c: ...here.
	* sysdeps/generic/s_catanhl.c: Moved to...
	* math/s_catanhl.c: ...here.
	* sysdeps/generic/s_catanl.c: Moved to...
	* math/s_catanl.c: ...here.
	* sysdeps/generic/s_cbrtl.c: Moved to...
	* math/s_cbrtl.c: ...here.
	* sysdeps/generic/s_ccos.c: Moved to...
	* math/s_ccos.c: ...here.
	* sysdeps/generic/s_ccosf.c: Moved to...
	* math/s_ccosf.c: ...here.
	* sysdeps/generic/s_ccosh.c: Moved to...
	* math/s_ccosh.c: ...here.
	* sysdeps/generic/s_ccoshf.c: Moved to...
	* math/s_ccoshf.c: ...here.
	* sysdeps/generic/s_ccoshl.c: Moved to...
	* math/s_ccoshl.c: ...here.
	* sysdeps/generic/s_ccosl.c: Moved to...
	* math/s_ccosl.c: ...here.
	* sysdeps/generic/s_cexp.c: Moved to...
	* math/s_cexp.c: ...here.
	* sysdeps/generic/s_cexpf.c: Moved to...
	* math/s_cexpf.c: ...here.
	* sysdeps/generic/s_cexpl.c: Moved to...
	* math/s_cexpl.c: ...here.
	* sysdeps/generic/s_clog.c: Moved to...
	* math/s_clog.c: ...here.
	* sysdeps/generic/s_clog10.c: Moved to...
	* math/s_clog10.c: ...here.
	* sysdeps/generic/s_clog10f.c: Moved to...
	* math/s_clog10f.c: ...here.
	* sysdeps/generic/s_clog10l.c: Moved to...
	* math/s_clog10l.c: ...here.
	* sysdeps/generic/s_clogf.c: Moved to...
	* math/s_clogf.c: ...here.
	* sysdeps/generic/s_clogl.c: Moved to...
	* math/s_clogl.c: ...here.
	* sysdeps/generic/s_cpow.c: Moved to...
	* math/s_cpow.c: ...here.
	* sysdeps/generic/s_cpowf.c: Moved to...
	* math/s_cpowf.c: ...here.
	* sysdeps/generic/s_cpowl.c: Moved to...
	* math/s_cpowl.c: ...here.
	* sysdeps/generic/s_cproj.c: Moved to...
	* math/s_cproj.c: ...here.
	* sysdeps/generic/s_cprojf.c: Moved to...
	* math/s_cprojf.c: ...here.
	* sysdeps/generic/s_cprojl.c: Moved to...
	* math/s_cprojl.c: ...here.
	* sysdeps/generic/s_csin.c: Moved to...
	* math/s_csin.c: ...here.
	* sysdeps/generic/s_csinf.c: Moved to...
	* math/s_csinf.c: ...here.
	* sysdeps/generic/s_csinh.c: Moved to...
	* math/s_csinh.c: ...here.
	* sysdeps/generic/s_csinhf.c: Moved to...
	* math/s_csinhf.c: ...here.
	* sysdeps/generic/s_csinhl.c: Moved to...
	* math/s_csinhl.c: ...here.
	* sysdeps/generic/s_csinl.c: Moved to...
	* math/s_csinl.c: ...here.
	* sysdeps/generic/s_csqrt.c: Moved to...
	* math/s_csqrt.c: ...here.
	* sysdeps/generic/s_csqrtf.c: Moved to...
	* math/s_csqrtf.c: ...here.
	* sysdeps/generic/s_csqrtl.c: Moved to...
	* math/s_csqrtl.c: ...here.
	* sysdeps/generic/s_ctan.c: Moved to...
	* math/s_ctan.c: ...here.
	* sysdeps/generic/s_ctanf.c: Moved to...
	* math/s_ctanf.c: ...here.
	* sysdeps/generic/s_ctanh.c: Moved to...
	* math/s_ctanh.c: ...here.
	* sysdeps/generic/s_ctanhf.c: Moved to...
	* math/s_ctanhf.c: ...here.
	* sysdeps/generic/s_ctanhl.c: Moved to...
	* math/s_ctanhl.c: ...here.
	* sysdeps/generic/s_ctanl.c: Moved to...
	* math/s_ctanl.c: ...here.
	* sysdeps/generic/s_erfl.c: Moved to...
	* math/s_erfl.c: ...here.
	* sysdeps/generic/s_expm1l.c: Moved to...
	* math/s_expm1l.c: ...here.
	* sysdeps/generic/s_fdim.c: Moved to...
	* math/s_fdim.c: ...here.
	* sysdeps/generic/s_fdimf.c: Moved to...
	* math/s_fdimf.c: ...here.
	* sysdeps/generic/s_fdiml.c: Moved to...
	* math/s_fdiml.c: ...here.
	* sysdeps/generic/s_fma.c: Moved to...
	* math/s_fma.c: ...here.
	* sysdeps/generic/s_fmaf.c: Moved to...
	* math/s_fmaf.c: ...here.
	* sysdeps/generic/s_fmal.c: Moved to...
	* math/s_fmal.c: ...here.
	* sysdeps/generic/s_fmax.c: Moved to...
	* math/s_fmax.c: ...here.
	* sysdeps/generic/s_fmaxf.c: Moved to...
	* math/s_fmaxf.c: ...here.
	* sysdeps/generic/s_fmaxl.c: Moved to...
	* math/s_fmaxl.c: ...here.
	* sysdeps/generic/s_fmin.c: Moved to...
	* math/s_fmin.c: ...here.
	* sysdeps/generic/s_fminf.c: Moved to...
	* math/s_fminf.c: ...here.
	* sysdeps/generic/s_fminl.c: Moved to...
	* math/s_fminl.c: ...here.
	* sysdeps/generic/s_ldexp.c: Moved to...
	* math/s_ldexp.c: ...here.
	* sysdeps/generic/s_ldexpf.c: Moved to...
	* math/s_ldexpf.c: ...here.
	* sysdeps/generic/s_ldexpl.c: Moved to...
	* math/s_ldexpl.c: ...here.
	* sysdeps/generic/s_log1pl.c: Moved to...
	* math/s_log1pl.c: ...here.
	* sysdeps/generic/s_nan.c: Moved to...
	* math/s_nan.c: ...here.
	* sysdeps/generic/s_nanf.c: Moved to...
	* math/s_nanf.c: ...here.
	* sysdeps/generic/s_nanl.c: Moved to...
	* math/s_nanl.c: ...here.
	* sysdeps/generic/s_nextafter.c: Moved to...
	* math/s_nextafter.c: ...here.
	* sysdeps/generic/s_nexttowardf.c: Moved to...
	* math/s_nexttowardf.c: ...here.
	* sysdeps/generic/s_nexttowardl.c: Moved to...
	* math/s_nexttowardl.c: ...here.
	* sysdeps/generic/s_significand.c: Moved to...
	* math/s_significand.c: ...here.
	* sysdeps/generic/s_significandf.c: Moved to...
	* math/s_significandf.c: ...here.
	* sysdeps/generic/s_significandl.c: Moved to...
	* math/s_significandl.c: ...here.
	* sysdeps/generic/s_tanhl.c: Moved to...
	* math/s_tanhl.c: ...here.
	* sysdeps/generic/sbrk.c: Moved to...
	* misc/sbrk.c: ...here.
	* sysdeps/generic/scandir64.c: Moved to...
	* dirent/scandir64.c: ...here.
	* sysdeps/generic/sched_getaffinity.c: Moved to...
	* posix/sched_getaffinity.c: ...here.
	* sysdeps/generic/sched_getp.c: Moved to...
	* posix/sched_getp.c: ...here.
	* sysdeps/generic/sched_gets.c: Moved to...
	* posix/sched_gets.c: ...here.
	* sysdeps/generic/sched_primax.c: Moved to...
	* posix/sched_primax.c: ...here.
	* sysdeps/generic/sched_primin.c: Moved to...
	* posix/sched_primin.c: ...here.
	* sysdeps/generic/sched_rr_gi.c: Moved to...
	* posix/sched_rr_gi.c: ...here.
	* sysdeps/generic/sched_setaffinity.c: Moved to...
	* posix/sched_setaffinity.c: ...here.
	* sysdeps/generic/sched_setp.c: Moved to...
	* posix/sched_setp.c: ...here.
	* sysdeps/generic/sched_sets.c: Moved to...
	* posix/sched_sets.c: ...here.
	* sysdeps/generic/sched_yield.c: Moved to...
	* posix/sched_yield.c: ...here.
	* sysdeps/generic/seekdir.c: Moved to...
	* dirent/seekdir.c: ...here.
	* sysdeps/generic/segfault.c: Moved to...
	* debug/segfault.c: ...here.
	* sysdeps/generic/select.c: Moved to...
	* misc/select.c: ...here.
	* sysdeps/generic/semctl.c: Moved to...
	* sysvipc/semctl.c: ...here.
	* sysdeps/generic/semget.c: Moved to...
	* sysvipc/semget.c: ...here.
	* sysdeps/generic/semop.c: Moved to...
	* sysvipc/semop.c: ...here.
	* sysdeps/generic/semtimedop.c: Moved to...
	* sysvipc/semtimedop.c: ...here.
	* sysdeps/generic/send.c: Moved to...
	* socket/send.c: ...here.
	* sysdeps/generic/sendfile.c: Moved to...
	* io/sendfile.c: ...here.
	* sysdeps/generic/sendfile64.c: Moved to...
	* io/sendfile64.c: ...here.
	* sysdeps/generic/sendmsg.c: Moved to...
	* socket/sendmsg.c: ...here.
	* sysdeps/generic/sendto.c: Moved to...
	* socket/sendto.c: ...here.
	* sysdeps/generic/setcontext.c: Moved to...
	* stdlib/setcontext.c: ...here.
	* sysdeps/generic/setdomain.c: Moved to...
	* misc/setdomain.c: ...here.
	* sysdeps/generic/setegid.c: Moved to...
	* misc/setegid.c: ...here.
	* sysdeps/generic/setenv.c: Moved to...
	* stdlib/setenv.c: ...here.
	* sysdeps/generic/seteuid.c: Moved to...
	* misc/seteuid.c: ...here.
	* sysdeps/generic/setfpucw.c: Moved to...
	* math/setfpucw.c: ...here.
	* sysdeps/generic/setgid.c: Moved to...
	* posix/setgid.c: ...here.
	* sysdeps/generic/setgroups.c: Moved to...
	* grp/setgroups.c: ...here.
	* sysdeps/generic/sethostid.c: Moved to...
	* misc/sethostid.c: ...here.
	* sysdeps/generic/sethostname.c: Moved to...
	* misc/sethostname.c: ...here.
	* sysdeps/generic/setipv4sourcefilter.c: Moved to...
	* inet/setipv4sourcefilter.c: ...here.
	* sysdeps/generic/setitimer.c: Moved to...
	* time/setitimer.c: ...here.
	* sysdeps/generic/setjmp.c: Moved to...
	* setjmp/setjmp.c: ...here.
	* sysdeps/generic/setlogin.c: Moved to...
	* posix/setlogin.c: ...here.
	* sysdeps/generic/setpgid.c: Moved to...
	* posix/setpgid.c: ...here.
	* sysdeps/generic/setpgrp.c: Moved to...
	* posix/setpgrp.c: ...here.
	* sysdeps/generic/setpriority.c: Moved to...
	* resource/setpriority.c: ...here.
	* sysdeps/generic/setregid.c: Moved to...
	* misc/setregid.c: ...here.
	* sysdeps/generic/setresgid.c: Moved to...
	* posix/setresgid.c: ...here.
	* sysdeps/generic/setresuid.c: Moved to...
	* posix/setresuid.c: ...here.
	* sysdeps/generic/setreuid.c: Moved to...
	* misc/setreuid.c: ...here.
	* sysdeps/generic/setrlimit.c: Moved to...
	* resource/setrlimit.c: ...here.
	* sysdeps/generic/setrlimit64.c: Moved to...
	* resource/setrlimit64.c: ...here.
	* sysdeps/generic/setsid.c: Moved to...
	* posix/setsid.c: ...here.
	* sysdeps/generic/setsockopt.c: Moved to...
	* socket/setsockopt.c: ...here.
	* sysdeps/generic/setsourcefilter.c: Moved to...
	* inet/setsourcefilter.c: ...here.
	* sysdeps/generic/settimeofday.c: Moved to...
	* time/settimeofday.c: ...here.
	* sysdeps/generic/setuid.c: Moved to...
	* posix/setuid.c: ...here.
	* sysdeps/generic/setutxent.c: Moved to...
	* login/setutxent.c: ...here.
	* sysdeps/generic/setxattr.c: Moved to...
	* misc/setxattr.c: ...here.
	* sysdeps/generic/shm_open.c: Moved to...
	* rt/shm_open.c: ...here.
	* sysdeps/generic/shm_unlink.c: Moved to...
	* rt/shm_unlink.c: ...here.
	* sysdeps/generic/shmat.c: Moved to...
	* sysvipc/shmat.c: ...here.
	* sysdeps/generic/shmctl.c: Moved to...
	* sysvipc/shmctl.c: ...here.
	* sysdeps/generic/shmdt.c: Moved to...
	* sysvipc/shmdt.c: ...here.
	* sysdeps/generic/shmget.c: Moved to...
	* sysvipc/shmget.c: ...here.
	* sysdeps/generic/shutdown.c: Moved to...
	* socket/shutdown.c: ...here.
	* sysdeps/generic/sigaction.c: Moved to...
	* signal/sigaction.c: ...here.
	* sysdeps/generic/sigaltstack.c: Moved to...
	* signal/sigaltstack.c: ...here.
	* sysdeps/generic/sigblock.c: Moved to...
	* signal/sigblock.c: ...here.
	* sysdeps/generic/sigfillset.c: Moved to...
	* signal/sigfillset.c: ...here.
	* sysdeps/generic/sigignore.c: Moved to...
	* signal/sigignore.c: ...here.
	* sysdeps/generic/sigintr.c: Moved to...
	* signal/sigintr.c: ...here.
	* sysdeps/generic/sigjmp.c: Moved to...
	* setjmp/sigjmp.c: ...here.
	* sysdeps/generic/siglist.c: Moved to...
	* stdio-common/siglist.c: ...here.
	* sysdeps/generic/signal.c: Moved to...
	* signal/signal.c: ...here.
	* sysdeps/generic/sigpause.c: Moved to...
	* signal/sigpause.c: ...here.
	* sysdeps/generic/sigpending.c: Moved to...
	* signal/sigpending.c: ...here.
	* sysdeps/generic/sigprocmask.c: Moved to...
	* signal/sigprocmask.c: ...here.
	* sysdeps/generic/sigqueue.c: Moved to...
	* signal/sigqueue.c: ...here.
	* sysdeps/generic/sigreturn.c: Moved to...
	* signal/sigreturn.c: ...here.
	* sysdeps/generic/sigset.c: Moved to...
	* signal/sigset.c: ...here.
	* sysdeps/generic/sigsetmask.c: Moved to...
	* signal/sigsetmask.c: ...here.
	* sysdeps/generic/sigstack.c: Moved to...
	* signal/sigstack.c: ...here.
	* sysdeps/generic/sigsuspend.c: Moved to...
	* signal/sigsuspend.c: ...here.
	* sysdeps/generic/sigtimedwait.c: Moved to...
	* signal/sigtimedwait.c: ...here.
	* sysdeps/generic/sigvec.c: Moved to...
	* signal/sigvec.c: ...here.
	* sysdeps/generic/sigwait.c: Moved to...
	* signal/sigwait.c: ...here.
	* sysdeps/generic/sigwaitinfo.c: Moved to...
	* signal/sigwaitinfo.c: ...here.
	* sysdeps/generic/sleep.c: Moved to...
	* posix/sleep.c: ...here.
	* sysdeps/generic/sockatmark.c: Moved to...
	* socket/sockatmark.c: ...here.
	* sysdeps/generic/socket.c: Moved to...
	* socket/socket.c: ...here.
	* sysdeps/generic/socketpair.c: Moved to...
	* socket/socketpair.c: ...here.
	* sysdeps/generic/spawni.c: Moved to...
	* posix/spawni.c: ...here.
	* sysdeps/generic/speed.c: Moved to...
	* termios/speed.c: ...here.
	* sysdeps/generic/sprofil.c: Moved to...
	* gmon/sprofil.c: ...here.
	* sysdeps/generic/sstk.c: Moved to...
	* misc/sstk.c: ...here.
	* sysdeps/generic/start.c: Moved to...
	* csu/start.c: ...here.
	* sysdeps/generic/statfs.c: Moved to...
	* io/statfs.c: ...here.
	* sysdeps/generic/statfs64.c: Moved to...
	* io/statfs64.c: ...here.
	* sysdeps/generic/statvfs.c: Moved to...
	* io/statvfs.c: ...here.
	* sysdeps/generic/statvfs64.c: Moved to...
	* io/statvfs64.c: ...here.
	* sysdeps/generic/stime.c: Moved to...
	* time/stime.c: ...here.
	* sysdeps/generic/stpcpy.c: Moved to...
	* string/stpcpy.c: ...here.
	* sysdeps/generic/stpcpy_chk.c: Moved to...
	* debug/stpcpy_chk.c: ...here.
	* sysdeps/generic/stpncpy.c: Moved to...
	* string/stpncpy.c: ...here.
	* sysdeps/generic/stpncpy_chk.c: Moved to...
	* debug/stpncpy_chk.c: ...here.
	* sysdeps/generic/strcasecmp.c: Moved to...
	* string/strcasecmp.c: ...here.
	* sysdeps/generic/strcasecmp_l.c: Moved to...
	* string/strcasecmp_l.c: ...here.
	* sysdeps/generic/strcasestr.c: Moved to...
	* string/strcasestr.c: ...here.
	* sysdeps/generic/strcat.c: Moved to...
	* string/strcat.c: ...here.
	* sysdeps/generic/strcat_chk.c: Moved to...
	* debug/strcat_chk.c: ...here.
	* sysdeps/generic/strchr.c: Moved to...
	* string/strchr.c: ...here.
	* sysdeps/generic/strchrnul.c: Moved to...
	* string/strchrnul.c: ...here.
	* sysdeps/generic/strcmp.c: Moved to...
	* string/strcmp.c: ...here.
	* sysdeps/generic/strcpy.c: Moved to...
	* string/strcpy.c: ...here.
	* sysdeps/generic/strcpy_chk.c: Moved to...
	* debug/strcpy_chk.c: ...here.
	* sysdeps/generic/strcspn.c: Moved to...
	* string/strcspn.c: ...here.
	* sysdeps/generic/string-inlines.c: Moved to...
	* string/string-inlines.c: ...here.
	* sysdeps/generic/strlen.c: Moved to...
	* string/strlen.c: ...here.
	* sysdeps/generic/strncase.c: Moved to...
	* string/strncase.c: ...here.
	* sysdeps/generic/strncase_l.c: Moved to...
	* string/strncase_l.c: ...here.
	* sysdeps/generic/strncat.c: Moved to...
	* string/strncat.c: ...here.
	* sysdeps/generic/strncat_chk.c: Moved to...
	* debug/strncat_chk.c: ...here.
	* sysdeps/generic/strncmp.c: Moved to...
	* string/strncmp.c: ...here.
	* sysdeps/generic/strncpy.c: Moved to...
	* string/strncpy.c: ...here.
	* sysdeps/generic/strncpy_chk.c: Moved to...
	* debug/strncpy_chk.c: ...here.
	* sysdeps/generic/strnlen.c: Moved to...
	* string/strnlen.c: ...here.
	* sysdeps/generic/strpbrk.c: Moved to...
	* string/strpbrk.c: ...here.
	* sysdeps/generic/strrchr.c: Moved to...
	* string/strrchr.c: ...here.
	* sysdeps/generic/strsep.c: Moved to...
	* string/strsep.c: ...here.
	* sysdeps/generic/strspn.c: Moved to...
	* string/strspn.c: ...here.
	* sysdeps/generic/strstr.c: Moved to...
	* string/strstr.c: ...here.
	* sysdeps/generic/strtoimax.c: Moved to...
	* stdlib/strtoimax.c: ...here.
	* sysdeps/generic/strtok.c: Moved to...
	* string/strtok.c: ...here.
	* sysdeps/generic/strtok_r.c: Moved to...
	* string/strtok_r.c: ...here.
	* sysdeps/generic/strtol.c: Moved to...
	* stdlib/strtol.c: ...here.
	* sysdeps/generic/strtol_l.c: Moved to...
	* stdlib/strtol_l.c: ...here.
	* sysdeps/generic/strtold_l.c: Moved to...
	* stdlib/strtold_l.c: ...here.
	* sysdeps/generic/strtoll.c: Moved to...
	* stdlib/strtoll.c: ...here.
	* sysdeps/generic/strtoll_l.c: Moved to...
	* stdlib/strtoll_l.c: ...here.
	* sysdeps/generic/strtoul.c: Moved to...
	* stdlib/strtoul.c: ...here.
	* sysdeps/generic/strtoul_l.c: Moved to...
	* stdlib/strtoul_l.c: ...here.
	* sysdeps/generic/strtoull.c: Moved to...
	* stdlib/strtoull.c: ...here.
	* sysdeps/generic/strtoull_l.c: Moved to...
	* stdlib/strtoull_l.c: ...here.
	* sysdeps/generic/strtoumax.c: Moved to...
	* stdlib/strtoumax.c: ...here.
	* sysdeps/generic/strtsupp.c: Moved to...
	* bare/strtsupp.c: ...here.
	* sysdeps/generic/stty.c: Moved to...
	* misc/stty.c: ...here.
	* sysdeps/generic/sub_n.c: Moved to...
	* stdlib/sub_n.c: ...here.
	* sysdeps/generic/submul_1.c: Moved to...
	* stdlib/submul_1.c: ...here.
	* sysdeps/generic/swapcontext.c: Moved to...
	* stdlib/swapcontext.c: ...here.
	* sysdeps/generic/swapoff.c: Moved to...
	* misc/swapoff.c: ...here.
	* sysdeps/generic/swapon.c: Moved to...
	* misc/swapon.c: ...here.
	* sysdeps/generic/symlink.c: Moved to...
	* io/symlink.c: ...here.
	* sysdeps/generic/sync.c: Moved to...
	* misc/sync.c: ...here.
	* sysdeps/generic/syscall.c: Moved to...
	* misc/syscall.c: ...here.
	* sysdeps/generic/sysconf.c: Moved to...
	* posix/sysconf.c: ...here.
	* sysdeps/generic/sysdep.c: Moved to...
	* csu/sysdep.c: ...here.
	* sysdeps/generic/syslog.c: Moved to...
	* misc/syslog.c: ...here.
	* sysdeps/generic/system.c: Moved to...
	* stdlib/system.c: ...here.
	* sysdeps/generic/sysv_signal.c: Moved to...
	* signal/sysv_signal.c: ...here.
	* sysdeps/generic/t_sincosl.c: Moved to...
	* math/t_sincosl.c: ...here.
	* sysdeps/generic/tcdrain.c: Moved to...
	* termios/tcdrain.c: ...here.
	* sysdeps/generic/tcflow.c: Moved to...
	* termios/tcflow.c: ...here.
	* sysdeps/generic/tcflush.c: Moved to...
	* termios/tcflush.c: ...here.
	* sysdeps/generic/tcgetattr.c: Moved to...
	* termios/tcgetattr.c: ...here.
	* sysdeps/generic/tcgetpgrp.c: Moved to...
	* termios/tcgetpgrp.c: ...here.
	* sysdeps/generic/tcsendbrk.c: Moved to...
	* termios/tcsendbrk.c: ...here.
	* sysdeps/generic/tcsetattr.c: Moved to...
	* termios/tcsetattr.c: ...here.
	* sysdeps/generic/tcsetpgrp.c: Moved to...
	* termios/tcsetpgrp.c: ...here.
	* sysdeps/generic/telldir.c: Moved to...
	* dirent/telldir.c: ...here.
	* sysdeps/generic/tempname.c: Moved to...
	* stdio-common/tempname.c: ...here.
	* sysdeps/generic/time.c: Moved to...
	* time/time.c: ...here.
	* sysdeps/generic/timer_create.c: Moved to...
	* rt/timer_create.c: ...here.
	* sysdeps/generic/timer_delete.c: Moved to...
	* rt/timer_delete.c: ...here.
	* sysdeps/generic/timer_getoverr.c: Moved to...
	* rt/timer_getoverr.c: ...here.
	* sysdeps/generic/timer_gettime.c: Moved to...
	* rt/timer_gettime.c: ...here.
	* sysdeps/generic/timer_settime.c: Moved to...
	* rt/timer_settime.c: ...here.
	* sysdeps/generic/times.c: Moved to...
	* posix/times.c: ...here.
	* sysdeps/generic/tmpfile.c: Moved to...
	* stdio-common/tmpfile.c: ...here.
	* sysdeps/generic/tmpfile64.c: Moved to...
	* stdio-common/tmpfile64.c: ...here.
	* sysdeps/generic/trampoline.c: Moved to...
	* hurd/trampoline.c: ...here.
	* sysdeps/generic/truncate.c: Moved to...
	* misc/truncate.c: ...here.
	* sysdeps/generic/truncate64.c: Moved to...
	* misc/truncate64.c: ...here.
	* sysdeps/generic/tst-timer.c: Moved to...
	* rt/tst-timer.c: ...here.
	* sysdeps/generic/ttyname.c: Moved to...
	* io/ttyname.c: ...here.
	* sysdeps/generic/ttyname_r.c: Moved to...
	* io/ttyname_r.c: ...here.
	* sysdeps/generic/ualarm.c: Moved to...
	* misc/ualarm.c: ...here.
	* sysdeps/generic/udiv_qrnnd.c: Moved to...
	* stdlib/udiv_qrnnd.c: ...here.
	* sysdeps/generic/ulimit.c: Moved to...
	* resource/ulimit.c: ...here.
	* sysdeps/generic/umask.c: Moved to...
	* io/umask.c: ...here.
	* sysdeps/generic/uname.c: Moved to...
	* posix/uname.c: ...here.
	* sysdeps/generic/unlink.c: Moved to...
	* io/unlink.c: ...here.
	* sysdeps/generic/unlinkat.c: Moved to...
	* io/unlinkat.c: ...here.
	* sysdeps/generic/unlockpt.c: Moved to...
	* login/unlockpt.c: ...here.
	* sysdeps/generic/updwtmp.c: Moved to...
	* login/updwtmp.c: ...here.
	* sysdeps/generic/updwtmpx.c: Moved to...
	* login/updwtmpx.c: ...here.
	* sysdeps/generic/usleep.c: Moved to...
	* misc/usleep.c: ...here.
	* sysdeps/generic/ustat.c: Moved to...
	* misc/ustat.c: ...here.
	* sysdeps/generic/utime.c: Moved to...
	* io/utime.c: ...here.
	* sysdeps/generic/utimes.c: Moved to...
	* misc/utimes.c: ...here.
	* sysdeps/generic/utmp_file.c: Moved to...
	* login/utmp_file.c: ...here.
	* sysdeps/generic/utmpxname.c: Moved to...
	* login/utmpxname.c: ...here.
	* sysdeps/generic/versionsort64.c: Moved to...
	* dirent/versionsort64.c: ...here.
	* sysdeps/generic/vfork.c: Moved to...
	* posix/vfork.c: ...here.
	* sysdeps/generic/vhangup.c: Moved to...
	* misc/vhangup.c: ...here.
	* sysdeps/generic/vlimit.c: Moved to...
	* resource/vlimit.c: ...here.
	* sysdeps/generic/vtimes.c: Moved to...
	* resource/vtimes.c: ...here.
	* sysdeps/generic/w_acos.c: Moved to...
	* math/w_acos.c: ...here.
	* sysdeps/generic/w_acosf.c: Moved to...
	* math/w_acosf.c: ...here.
	* sysdeps/generic/w_acosh.c: Moved to...
	* math/w_acosh.c: ...here.
	* sysdeps/generic/w_acoshf.c: Moved to...
	* math/w_acoshf.c: ...here.
	* sysdeps/generic/w_acoshl.c: Moved to...
	* math/w_acoshl.c: ...here.
	* sysdeps/generic/w_acosl.c: Moved to...
	* math/w_acosl.c: ...here.
	* sysdeps/generic/w_asin.c: Moved to...
	* math/w_asin.c: ...here.
	* sysdeps/generic/w_asinf.c: Moved to...
	* math/w_asinf.c: ...here.
	* sysdeps/generic/w_asinl.c: Moved to...
	* math/w_asinl.c: ...here.
	* sysdeps/generic/w_atan2.c: Moved to...
	* math/w_atan2.c: ...here.
	* sysdeps/generic/w_atan2f.c: Moved to...
	* math/w_atan2f.c: ...here.
	* sysdeps/generic/w_atan2l.c: Moved to...
	* math/w_atan2l.c: ...here.
	* sysdeps/generic/w_atanh.c: Moved to...
	* math/w_atanh.c: ...here.
	* sysdeps/generic/w_atanhf.c: Moved to...
	* math/w_atanhf.c: ...here.
	* sysdeps/generic/w_atanhl.c: Moved to...
	* math/w_atanhl.c: ...here.
	* sysdeps/generic/w_cosh.c: Moved to...
	* math/w_cosh.c: ...here.
	* sysdeps/generic/w_coshf.c: Moved to...
	* math/w_coshf.c: ...here.
	* sysdeps/generic/w_coshl.c: Moved to...
	* math/w_coshl.c: ...here.
	* sysdeps/generic/w_drem.c: Moved to...
	* math/w_drem.c: ...here.
	* sysdeps/generic/w_dremf.c: Moved to...
	* math/w_dremf.c: ...here.
	* sysdeps/generic/w_dreml.c: Moved to...
	* math/w_dreml.c: ...here.
	* sysdeps/generic/w_exp10.c: Moved to...
	* math/w_exp10.c: ...here.
	* sysdeps/generic/w_exp10f.c: Moved to...
	* math/w_exp10f.c: ...here.
	* sysdeps/generic/w_exp10l.c: Moved to...
	* math/w_exp10l.c: ...here.
	* sysdeps/generic/w_exp2.c: Moved to...
	* math/w_exp2.c: ...here.
	* sysdeps/generic/w_exp2f.c: Moved to...
	* math/w_exp2f.c: ...here.
	* sysdeps/generic/w_exp2l.c: Moved to...
	* math/w_exp2l.c: ...here.
	* sysdeps/generic/w_expl.c: Moved to...
	* math/w_expl.c: ...here.
	* sysdeps/generic/w_fmod.c: Moved to...
	* math/w_fmod.c: ...here.
	* sysdeps/generic/w_fmodf.c: Moved to...
	* math/w_fmodf.c: ...here.
	* sysdeps/generic/w_fmodl.c: Moved to...
	* math/w_fmodl.c: ...here.
	* sysdeps/generic/w_hypot.c: Moved to...
	* math/w_hypot.c: ...here.
	* sysdeps/generic/w_hypotf.c: Moved to...
	* math/w_hypotf.c: ...here.
	* sysdeps/generic/w_hypotl.c: Moved to...
	* math/w_hypotl.c: ...here.
	* sysdeps/generic/w_j0.c: Moved to...
	* math/w_j0.c: ...here.
	* sysdeps/generic/w_j0f.c: Moved to...
	* math/w_j0f.c: ...here.
	* sysdeps/generic/w_j0l.c: Moved to...
	* math/w_j0l.c: ...here.
	* sysdeps/generic/w_j1.c: Moved to...
	* math/w_j1.c: ...here.
	* sysdeps/generic/w_j1f.c: Moved to...
	* math/w_j1f.c: ...here.
	* sysdeps/generic/w_j1l.c: Moved to...
	* math/w_j1l.c: ...here.
	* sysdeps/generic/w_jn.c: Moved to...
	* math/w_jn.c: ...here.
	* sysdeps/generic/w_jnf.c: Moved to...
	* math/w_jnf.c: ...here.
	* sysdeps/generic/w_jnl.c: Moved to...
	* math/w_jnl.c: ...here.
	* sysdeps/generic/w_lgamma.c: Moved to...
	* math/w_lgamma.c: ...here.
	* sysdeps/generic/w_lgamma_r.c: Moved to...
	* math/w_lgamma_r.c: ...here.
	* sysdeps/generic/w_lgammaf.c: Moved to...
	* math/w_lgammaf.c: ...here.
	* sysdeps/generic/w_lgammaf_r.c: Moved to...
	* math/w_lgammaf_r.c: ...here.
	* sysdeps/generic/w_lgammal.c: Moved to...
	* math/w_lgammal.c: ...here.
	* sysdeps/generic/w_lgammal_r.c: Moved to...
	* math/w_lgammal_r.c: ...here.
	* sysdeps/generic/w_log.c: Moved to...
	* math/w_log.c: ...here.
	* sysdeps/generic/w_log10.c: Moved to...
	* math/w_log10.c: ...here.
	* sysdeps/generic/w_log10f.c: Moved to...
	* math/w_log10f.c: ...here.
	* sysdeps/generic/w_log10l.c: Moved to...
	* math/w_log10l.c: ...here.
	* sysdeps/generic/w_log2.c: Moved to...
	* math/w_log2.c: ...here.
	* sysdeps/generic/w_log2f.c: Moved to...
	* math/w_log2f.c: ...here.
	* sysdeps/generic/w_log2l.c: Moved to...
	* math/w_log2l.c: ...here.
	* sysdeps/generic/w_logf.c: Moved to...
	* math/w_logf.c: ...here.
	* sysdeps/generic/w_logl.c: Moved to...
	* math/w_logl.c: ...here.
	* sysdeps/generic/w_pow.c: Moved to...
	* math/w_pow.c: ...here.
	* sysdeps/generic/w_powf.c: Moved to...
	* math/w_powf.c: ...here.
	* sysdeps/generic/w_powl.c: Moved to...
	* math/w_powl.c: ...here.
	* sysdeps/generic/w_remainder.c: Moved to...
	* math/w_remainder.c: ...here.
	* sysdeps/generic/w_remainderf.c: Moved to...
	* math/w_remainderf.c: ...here.
	* sysdeps/generic/w_remainderl.c: Moved to...
	* math/w_remainderl.c: ...here.
	* sysdeps/generic/w_scalb.c: Moved to...
	* math/w_scalb.c: ...here.
	* sysdeps/generic/w_scalbf.c: Moved to...
	* math/w_scalbf.c: ...here.
	* sysdeps/generic/w_scalbl.c: Moved to...
	* math/w_scalbl.c: ...here.
	* sysdeps/generic/w_sinh.c: Moved to...
	* math/w_sinh.c: ...here.
	* sysdeps/generic/w_sinhf.c: Moved to...
	* math/w_sinhf.c: ...here.
	* sysdeps/generic/w_sinhl.c: Moved to...
	* math/w_sinhl.c: ...here.
	* sysdeps/generic/w_sqrt.c: Moved to...
	* math/w_sqrt.c: ...here.
	* sysdeps/generic/w_sqrtf.c: Moved to...
	* math/w_sqrtf.c: ...here.
	* sysdeps/generic/w_sqrtl.c: Moved to...
	* math/w_sqrtl.c: ...here.
	* sysdeps/generic/w_tgamma.c: Moved to...
	* math/w_tgamma.c: ...here.
	* sysdeps/generic/w_tgammaf.c: Moved to...
	* math/w_tgammaf.c: ...here.
	* sysdeps/generic/w_tgammal.c: Moved to...
	* math/w_tgammal.c: ...here.
	* sysdeps/generic/wait.c: Moved to...
	* posix/wait.c: ...here.
	* sysdeps/generic/wait3.c: Moved to...
	* posix/wait3.c: ...here.
	* sysdeps/generic/wait4.c: Moved to...
	* posix/wait4.c: ...here.
	* sysdeps/generic/waitid.c: Moved to...
	* posix/waitid.c: ...here.
	* sysdeps/generic/waitpid.c: Moved to...
	* posix/waitpid.c: ...here.
	* sysdeps/generic/wcstoimax.c: Moved to...
	* stdlib/wcstoimax.c: ...here.
	* sysdeps/generic/wcstol.c: Moved to...
	* wcsmbs/wcstol.c: ...here.
	* sysdeps/generic/wcstol_l.c: Moved to...
	* wcsmbs/wcstol_l.c: ...here.
	* sysdeps/generic/wcstoll.c: Moved to...
	* wcsmbs/wcstoll.c: ...here.
	* sysdeps/generic/wcstoll_l.c: Moved to...
	* wcsmbs/wcstoll_l.c: ...here.
	* sysdeps/generic/wcstoul.c: Moved to...
	* wcsmbs/wcstoul.c: ...here.
	* sysdeps/generic/wcstoul_l.c: Moved to...
	* wcsmbs/wcstoul_l.c: ...here.
	* sysdeps/generic/wcstoull.c: Moved to...
	* wcsmbs/wcstoull.c: ...here.
	* sysdeps/generic/wcstoull_l.c: Moved to...
	* wcsmbs/wcstoull_l.c: ...here.
	* sysdeps/generic/wcstoumax.c: Moved to...
	* stdlib/wcstoumax.c: ...here.
	* sysdeps/generic/wordcopy.c: Moved to...
	* string/wordcopy.c: ...here.
	* sysdeps/generic/wordexp.c: Moved to...
	* posix/wordexp.c: ...here.
	* sysdeps/generic/write.c: Moved to...
	* io/write.c: ...here.
	* sysdeps/generic/writev.c: Moved to...
	* misc/writev.c: ...here.
	* sysdeps/generic/xmknod.c: Moved to...
	* io/xmknod.c: ...here.
	* sysdeps/generic/xmknodat.c: Moved to...
	* io/xmknodat.c: ...here.
	* sysdeps/generic/xpg-strerror.c: Moved to...
	* string/xpg-strerror.c: ...here.
	* sysdeps/generic/xstat.c: Moved to...
	* io/xstat.c: ...here.
	* sysdeps/generic/xstat64.c: Moved to...
	* io/xstat64.c: ...here.
	* catgets/gencat.c: Use "config.h" to refer to the local config.h file.
	* stdlib/stdtod_l.c: Use "..." for gmp-impl.h and longlong.h headers.
	* sysdeps/ieee754/ldbl-96/printf_fphex.c: Adjust for files moving
	out of sysdeps/generic.
	* sysdeps/ieee754/ldbl-96/strtold_l.c: Likewise.
	* sysdeps/powerpc/elf/libc-start.c: Likewise.
	* sysdeps/unix/sysv/linux/dl-sbrk.c: Likewise.
	* sysdeps/unix/sysv/linux/dl-sysdep.c: Likewise.
	* sysdeps/unix/sysv/linux/segfault.c: Likewise.
	* sysdeps/unix/sysv/linux/sigreturn.c: Likewise.
	* sysdeps/unix/sysv/linux/syslog.c: Likewise.
	* sysdeps/unix/sysv/linux/updwtmp.c: Likewise.
	* sysdeps/unix/sysv/linux/utmp_file.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/getrlimit64.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/glob64.c: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/dl-procinfo.c: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/dl-procinfo.h: Likewise.
	* sysdeps/wordsize-32/llabs.c: Likewise.
	* sysdeps/wordsize-32/lldiv.c: Likewise.
	* sysdeps/wordsize-64/glob.c: Likewise.
	* sysdeps/wordsize-64/labs.c: Likewise.
	* sysdeps/wordsize-64/ldiv.c: Likewise.
	* sysdeps/wordsize-64/strtol.c: Likewise.
	* sysdeps/wordsize-64/strtol_l.c: Likewise.
	* sysdeps/wordsize-64/strtoul.c: Likewise.
	* sysdeps/wordsize-64/strtoul_l.c: Likewise.
	* sysdeps/wordsize-64/wcstol.c: Likewise.
	* sysdeps/wordsize-64/wcstol_l.c: Likewise.
	* sysdeps/wordsize-64/wcstoul.c: Likewise.
	* sysdeps/wordsize-64/wcstoul_l.c: Likewise.
	* sysdeps/x86_64/fpu/printf_fphex.c: Likewise.
	* wcsmbs/Makefile (strtox-CFLAGS): remove -I../stdlib.
	(CPPFLAGS-wcstold_l.c): Add -I../stdlib.

2005-12-13  Roland McGrath  <roland@redhat.com>

	* sysdeps/generic/Makefile: Remove remaining bits/endian.h cruft.

2005-12-13  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/generic/signame.c: Removed.
	* sysdeps/generic/signame.h: Removed.
	* sysdeps/generic/configure.in: Removed.
	* sysdeps/generic/Dist: Remove these files.

	* sysdeps/generic/det_endian.c: Removed.
	* sysdeps/generic/Makefile: Remove rule to build it.
	* sysdeps/generic/Dist: Don't distribute it.

2005-12-13  Roland McGrath  <roland@redhat.com>

	* sysdeps/powerpc/dl-procinfo.c: New file.
	* sysdeps/powerpc/dl-procinfo.h: New file.

2005-12-12  Ulrich Drepper  <drepper@redhat.com>

	* io/sys/stat.h: Add restrict to fstatat declarations.

2005-12-10  Ulrich Drepper  <drepper@redhat.com>

	* posix/regex_internal.h: Include <stdint.h> if available.

2005-12-06  Paolo Bonzini  <bonzini@gnu.org>

	* posix/regex_internal.h (SIZE_MAX): Provide a default definition.

2005-12-08  Ulrich Drepper  <drepper@redhat.com>

	* nis/nis_call.c (inetstr2int): Optimize.

2005-12-08  Jakub Jelinek  <jakub@redhat.com>

	* nis/nis_call.c (__nisbind_create): Remove __nisbind_destroy,
	->clnt cannot be != NULL.
	(__do_niscall): No need to use __nisbind_destroy, __nisbind_next
	did it.
	(__nisbind_connect): use_auth is already TRUE, otherwise we would
	not be here.

	* nis/nis_lookup.c (nis_lookup): Remove unnecessary
	__nisbind_destroy calls.  __nisbind_next does all that.

	* nis/ypclnt.c (yp_update): Before trying default authentication,
	free DES descriptor.

2005-12-07  Jakub Jelinek  <jakub@redhat.com>

	* nis/nis_table.c (nis_list): Fix memory handling in error case.

2005-12-07  Ulrich Drepper  <drepper@redhat.com>

	* nis/nis_table.c (nis_list): Remove have_tablepath, just use the
	pointer value itself.

2005-12-06  Ulrich Drepper  <drepper@redhat.com>

	* catgets/gencat.c: Use GPL, not LGPL.
	* elf/cache.c: Likewise.
	* elf/chroot_canon.c: Likewise.
	* elf/ldconfig.c: Likewise.
	* elf/readlib.c: Likewise.
	* iconv/dummy-repertoire.c: Likewise.
	* iconv/iconv_charmap.c: Likewise.
	* iconv/iconv_prog.c: Likewise.
	* iconv/iconvconfig.c: Likewise.
	* locale/programs/3level.h: Likewise.
	* locale/programs/charmap-dir.c: Likewise.
	* locale/programs/charmap-dir.h: Likewise.
	* locale/programs/charmap-kw.gperf: Likewise.
	* locale/programs/charmap.c: Likewise.
	* locale/programs/charmap.h: Likewise.
	* locale/programs/config.h: Likewise.
	* locale/programs/ld-address.c: Likewise.
	* locale/programs/ld-collate.c: Likewise.
	* locale/programs/ld-ctype.c: Likewise.
	* locale/programs/ld-identification.c: Likewise.
	* locale/programs/ld-measurement.c: Likewise.
	* locale/programs/ld-messages.c: Likewise.
	* locale/programs/ld-monetary.c: Likewise.
	* locale/programs/ld-name.c: Likewise.
	* locale/programs/ld-numeric.c: Likewise.
	* locale/programs/ld-paper.c: Likewise.
	* locale/programs/ld-telephone.c: Likewise.
	* locale/programs/ld-time.c: Likewise.
	* locale/programs/linereader.c: Likewise.
	* locale/programs/linereader.h: Likewise.
	* locale/programs/locale-spec.c: Likewise.
	* locale/programs/locale.c: Likewise.
	* locale/programs/localedef.c: Likewise.
	* locale/programs/localedef.h: Likewise.
	* locale/programs/locarchive.c: Likewise.
	* locale/programs/locfile-kw.gperf: Likewise.
	* locale/programs/locfile-token.h: Likewise.
	* locale/programs/locfile.c: Likewise.
	* locale/programs/locfile.h: Likewise.
	* locale/programs/repertoire.c: Likewise.
	* locale/programs/repertoire.h: Likewise.
	* locale/programs/simple-hash.c: Likewise.
	* locale/programs/simple-hash.h: Likewise.
	* locale/programs/xmalloc.c: Likewise.
	* locale/programs/xstrdup.c: Likewise.
	* malloc/memusagestat.c: Likewise.
	* nscd/aicache.c: Likewise.
	* nscd/cache.c: Likewise.
	* nscd/connections.c: Likewise.
	* nscd/dbg_log.c: Likewise.
	* nscd/gai.c: Likewise.
	* nscd/getgrgid_r.c: Likewise.
	* nscd/getgrnam_r.c: Likewise.
	* nscd/gethstbyad_r.c: Likewise.
	* nscd/gethstbynm2_r.c: Likewise.
	* nscd/getpwnam_r.c: Likewise.
	* nscd/getpwuid_r.c: Likewise.
	* nscd/grpcache.c: Likewise.
	* nscd/hstcache.c: Likewise.
	* nscd/initgrcache.c: Likewise.
	* nscd/mem.c: Likewise.
	* nscd/nscd.c: Likewise.
	* nscd/nscd_conf.c: Likewise.
	* nscd/pwdcache.c: Likewise.
	* posix/getconf.c: Likewise.
	* sysdeps/generic/nscd_setup_thread.c: Likewise.
	* sysdeps/unix/sysv/linux/nscd_setup_thread.c: Likewise.

	* sunrpc/auth_des.c (authdes_pk_create): If conversation key
	cannot be created, free memory.
	Reported by rprasad@vmware.com.

2005-11-15  Mike Frysinger  <vapier@gentoo.org>

	* sysdeps/hppa/bits/setjmp.h: Add _BITS_SETJMP_H preprocessor
	protection and allow pthread.h to include bits/setjmp.h as well as
	setjmp.h.
	* sysdeps/m68k/bits/setjmp.h: Likewise.
	* sysdeps/s390/bits/setjmp.h: Make sure only setjmp.h or pthread.h
	are allow to include bits/setjmp.h.
	* sysdeps/mips/bits/setjmp.h (_JMPBUF_UNWINDS): Cast rhs to match lhs
	cast of address.
	* sysdeps/sh/bits/setjmp.h: Likewise.

2005-11-12  Jim Meyering  <jim@meyering.net>

	* sysdeps/unix/opendir.c (__alloc_dir): Declare STATP parameter
	to be pointer to const.
	* include/dirent.h: Update decl.

2005-12-05  Roland McGrath  <roland@redhat.com>

	* hurd/hurdmalloc.c: Remove $ tag $ magic.
	* mach/err_kern.sub: Likewise.
	* mach/err_server.sub: Likewise.
	* mach/err_us.sub: Likewise.
	* mach/error_compat.c: Likewise.
	* mach/errorlib.h: Likewise.
	* mach/errstring.c: Likewise.
	* mach/mach/error.h: Likewise.
	* mach/mach_error.c: Likewise.
	* mach/mach_error.h: Likewise.
	* mach/msg-destroy.c: Likewise.
	* mach/msgserver.c: Likewise.
	* sysdeps/mach/sys/reboot.h: Likewise.

	* sysdeps/generic/dwarf2.h: Replace license text with glibc LGPL.

2005-11-28  Jakub Jelinek  <jakub@redhat.com>

	* malloc/tst-mallocfork.c (do_test): Make sure sa_flags is
	initialized.  Reported by John Reiser <jreiser@BitWagon.com>.

2005-12-05  Daniel Jacobowitz  <dan@codesourcery.com>

	* stdlib/longlong.h: Update from GCC.

2005-12-04  Joseph S. Myers  <joseph@codesourcery.com>

	* soft-fp/soft-fp.h: Include <stdlib.h>.

	* soft-fp/floatdisf.c (__floatdisf): Return float.

2005-12-05  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/sysv/linux/kernel-features.h
	(__ASSUME_POSIX_CPU_TIMERS): New macro, for 2.6.12 and later.

2005-12-03  Ulrich Drepper  <drepper@redhat.com>

	* nis/nis_table.c (nis_list): Optimize freeing and reallocation of
	result record.

	* nis/nss_nisplus/nisplus-network.c (_nss_nisplus_getnetbyaddr_r):
	Better sized buffers.  Correct error case handling.
	* nis/nis_error.c (nis_sperror_r): Let snprintf determine whether
	there is an overflow.
	* nis/nss_nisplus/nisplus-service.c: Fix locking to use
	_nss_create_tablename.  Avoid unnecessary copying, remove
	unnecessary variables, general cleanup.
	* nis/nss_nisplus/nisplus-rpc.c: Likewise.
	* nis/nss_nisplus/nisplus-proto.c: Likewise..
	* nis/nss_nisplus/nisplus-network.c: Fix locking to use
	_nss_create_tablename.  Avoid unnecessary copying, general cleanup.
	* nis/nss_nisplus/nisplus-hosts.c (_nss_nisplus_getipnodebyname_r):
	Removed.
	Fix locking to use _nss_create_tablename.  Avoid unnecessary copying,
	general cleanup.
	* nis/nss_nisplus/nisplus-ethers.c (_nss_nisplus_getntohost_r):
	Correctly construct request.
	Fix locking to use _nss_create_tablename.  Avoid unnecessary copying,
	general cleanup.
	* nis/nss_nisplus/nisplus-alias.c: Fix locking to use
	_nss_create_tablename.  Avoid unnecessary copying, general cleanup.
	* nis/nss_nisplus/nisplus-netgrp.c (_nss_nisplus_setnetgrent):
	Rewrite to use snprintf.
	* nis/nss_nisplus/nisplus-publickey.c (_nss_nisplus_netname2user):
	Likewise.

2005-12-02  Ulrich Drepper  <drepper@redhat.com>

	* nis/nss_nisplus/nisplus-pwd.c (_nss_pwd_create_tablename):
	Renamed from _nss_create_tablename.  Export from file (but not DSO).
	(pwd_tablename_val): Renamed from tablename_val, mark hidden.
	(pwd_tablename_len): Renamed from tablename_len, mark hidden.
	Change all users.
	* nis/nss_nisplus/nisplus-spwd.c (_nss_create_tablename): Removed.
	Use _nss_pwd_create_tablename now.  Use pwd_tablename_val and
	pwd_tablename_len.  Remove unnecessary variables, general cleanup.

	* nis/nss_nisplus/nisplus-pwd.c: Fix locking to use
	_nss_create_tablename.  Avoid unnecessary copying, remove
	unnecessary variables, general cleanup.
	* nis/nss_nisplus/nisplus-grp.c: Likewise.

	* io/Makefile (routines): Add mknodat, xmknodat, mkdirat, mkfifoat.
	(static-only-routines): Add mknodat.
	* io/Versions [GLIBC_2.4]: Add mkdirat, mkfifoat, __xmknodat.
	* io/sys/stat.h: Declare mkditat, mknodat, mkfifoat, __xmknodat.
	Define mknodat inline function.
	* include/sys/stat.h: Add hidden proto for __xmknodat.
	* sysdeps/generic/mkdirat.c: New file.
	* sysdeps/generic/mkfifoat.c: New file.
	* sysdeps/generic/mknodat.c: New file.
	* sysdeps/generic/xmknodat.c: New file.
	* sysdeps/unix/mkfifoat.c: New file.
	* sysdeps/unix/sysv/linux/mkdirat.c: New file.
	* sysdeps/unix/sysv/linux/xmknodat.c: New file.

	* sysdeps/generic/xmknod.c: Add one more parameter check.

2005-11-28  Andreas Jaeger  <aj@suse.de>

	* sysdeps/unix/sysv/linux/mips/bits/mman.h (MREMAP_FIXED): Added,
	Patch by René Rebe <rene@exactcode.de>.

2005-11-27  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/posix/getaddrinfo.c: Avoid RFC 3484 sorting if there are
	multiple return records but only one address.

	* sysdeps/posix/getaddrinfo.c (gaih_inet): Avoid some code duplication.

2005-11-27  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/sysv/linux/fchownat.c: Include alloca.h, sysdep.h.
	Reported by René Rebe <rene@exactcode.de>.

2005-11-27  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/posix/euidaccess.c [_LIBC] (euidaccess): Don't cache
	euid and egid.

	* nis/nis_table.c (nis_list): Add more free calls in error cases.

2005-11-26  Richard Henderson  <rth@redhat.com>

	* sysdeps/alpha/strncmp.S: Don't read too much data when pointers
	are co-aligned, and count is aligned with the end of the word.

2005-11-26  Ulrich Drepper  <drepper@redhat.com>

	* nis/nis_lookup.c (nis_lookup): Mark RPCTIMEOUT as const.  Pretty
	printing.

	* nis/nis_table.c (__create_ib_request): Use strdupa instead of
	variable size array.
	(RPCTIMEOUT): Mark as const.

	* nis/ypclnt.c (yp_bind_ypbindprog): Initialize clnt_saddr by hand.
	(ypdomainname): Renamed from __ypdomainname.  No need for initializer.
	(ypbindlist): Renamed from __ypbindlist.
	(do_ypcall): Check memory allocation suceeded before calling
	yp_bind_ypbindprog.
	(yperr_string): Reduce size of function by using only one gettext call.
	(ypbinderr_string): Likewise.
	(yp_match): Free response in case memory for return value cannot be
	allocated.
	(yp_first): Likewise.
	(yp_next): Likewise.
	(do_ypcall_tr): New function which translates error codes as well.
	(yp_match, yp_next, yp_master, yp_order, yp_maplist): Use it.
	(yp_all): Correct test for invalid parameter.
	Pretty printing.
	(RPCTIMEOUT, UDPTIMEOUT): Mark as const.

2005-11-25  Richard Henderson  <rth@redhat.com>

	* sysdeps/unix/sysv/linux/alpha/fxstatat.c (__fxstatat): Fix typo.
	(__fxstatat64): Alias from __fxstatat; remove other cnp errors.
	* sysdeps/unix/sysv/linux/alpha/sigaction.c: Include sys/cdefs.h
	and stddef.h.
	* sysdeps/unix/sysv/linux/alpha/bits/mman.h (MREMAP_FIXED): Define.

2005-11-25  Ulrich Drepper  <drepper@redhat.com>

	* Makeconfig (+cflags): Add -fmerge-all-constants by default.

	[BZ #1912]
	* nss/function.def: Add entry to use gethostbyname2 for files.

2005-11-25  Thorsten Kukuk  <kukuk@suse.de>

	* sysdeps/unix/sysv/linux/fxstatat64.c: Include string.h.

2005-11-25  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1926]
	* nss/nss_files/files-netgrp.c (_nss_files_endnetgrent): Change
	return value type to match expected type.

	[BZ #1925]
	* nis/ypclnt.c (yp_order): Correct test for invalid parameter.

2005-11-24  Ulrich Drepper  <drepper@redhat.com>

	* scripts/check-c++-types.sh: Improve comments.

	* scripts/check-local-headers.sh: New file.
	* Makefile (tests): Run check-local-headers.sh.

2005-11-23  Thorsten Kukuk  <kukuk@suse.de>

	* include/sys/sendfile.h: New file.

2005-11-24  Andreas Schwab  <schwab@suse.de>

	* time/sys/time.h: Remove nonnull attribute from futimesat.

2005-11-22  Ulrich Drepper  <drepper@redhat.com>

	* nscd/connections.c (sendfileall): Define.
	(handle_request): Use it instead of sendfile call.
	* nscd/nscd-client.h: Declare sendfileall.
	* nscd/aicache.c: Use sendfileall instead of sendfile.
	* nscd/grpcache.c: Likewise.
	* nscd/hstcache.c: Likewise.
	* nscd/initgrcache.c: Likewise.
	* nscd/pwdcache.c: Likewise.

	[BZ #1908]
	* manual/install.texi (Tools for Compilation): Require gawk.

2005-11-22  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/generic/ldsodefs.h (struct rtld_global): Remove
	unused is_static field from slotinfo array.

2005-11-21  Jakub Jelinek  <jakub@redhat.com>

	* sunrpc/bindrsvprt.c (bindresvport): Wrap around to startport
	in the loop if port is bigger than endport, initially set to
	ENDPORT.  When changing startport, set endport and port
	appropriately.

2005-11-21  Ulrich Drepper  <drepper@redhat.com>

	* Makefile.in: Remove RCS ID line.
	* config-name.in: Likewise.
	* config.make.in: Likewise.
	* malloc/arena.c: Likewise.
	* malloc/hooks.c: Likewise.
	* malloc/malloc.c: Likewise.
	* manual/dir: Likewise.
	* math/math_private.h: Likewise.
	* resolv/gethnamaddr.c: Likewise.
	* scripts/mkinstalldirs: Likewise.
	* sunrpc/rpc_clntout.c: Likewise.
	* sunrpc/rpc_cout.c: Likewise.
	* sunrpc/rpc_hout.c: Likewise.
	* sunrpc/rpc_main.c: Likewise.
	* sunrpc/rpc_parse.c: Likewise.
	* sunrpc/rpc_sample.c: Likewise.
	* sunrpc/rpc_scan.c: Likewise.
	* sunrpc/rpc_svcout.c: Likewise.
	* sunrpc/rpc_tblout.c: Likewise.
	* sunrpc/rpc_util.c: Likewise.
	* sysdeps/unix/sysv/linux/sys/quote.h: Likewise.

	* nscd/nscd_helper.c: Pretty printing.

2005-11-19  Roland McGrath  <roland@redhat.com>

	* elf/elf.h: Revert last change.

2005-11-19  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/ia64/bits/shm.h (shmatt_t): New type.
	(struct shmid_ds): Use it for shm_nattch field.

2005-11-18  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/futimesat.c (futimesat): If FILE is NULL,
	set access and modification times of the file referenced by FD.
	* sysdeps/generic/futimesat.c (futimesat): Don't return EINVAL if
	FILE is NULL.  Don't check FD if FILE is absolute path.

2005-11-19  Ulrich Drepper  <drepper@redhat.com>

	* nscd/nscd_gethst_r.c (nscd_gethst_r): Avoid unnecesary read call
	if there are no aliases.

	* sysdeps/unix/sysv/linux/Makefile (CFLAGS-connections.c,
	CFLAGS-pwdcache.c, CFLAGS-grpcache.c, CFLAGS-hstcache.c,
	CFLAGS-aicache.c, CFLAGS-initgrcache.c): Add -DHAVE_SENDFILE.
	* sysdeps/unix/sysv/linux/kernel-features.h (__ASSUME_SENDFILE):
	Define.
	* nscd/pwdcache.c [HAVE_SENDFILE]: Include <sys/sendfile.h> and
	<kernel-features.h>.
	[HAVE_SENDFILE] (cache_addpw): Use sendfile to transmit positive
	result.
	* nscd/grpcache.c: Likewise.
	* nscd/hstcache.c: Likewise.
	* nscd/aicache.c: Likewise.
	* nscd/initgrcache.c: Likewise.
	* nscd/connectionc.c: Likewise.

2005-11-18  Andreas Schwab  <schwab@suse.de>

	* sysdeps/powerpc/powerpc32/fpu/s_lround.S: Remove useless alias.

	* sysdeps/unix/sysv/linux/powerpc/powerpc32/socket.S: Handle
	NO_WEAK_ALIAS.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/socket.S: Likewise.

2005-11-18  Paul Brook  <paul@codesourcery.com>

	* sysdeps/unix/sysv/linux/m68k/bits/mman.h (MREMAP_FIXED): New macro.

	* nscd/grpcache.c: Include <sys/socket.h>.
	* nscd/nscd_stat.c: Likewise.
	* nscd/pwdcache.c: Likewise.
	* sysdeps/unix/sysv/linux/unlinkat.c: Include <stdlib.h>, <sysdep.h>.

2005-11-17  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/sparc/bits/shm.h: Define SHM_NORESERVE.
	* sysdeps/unix/sysv/linux/ia64/bits/shm.h: Likewise.
	* sysdeps/unix/sysv/linux/s390/bits/shm.h: Likewise.
	* sysdeps/unix/sysv/linux/hppa/bits/shm.h: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/bits/shm.h: Likewise.
	* sysdeps/unix/sysv/linux/alpha/bits/shm.h: Likewise.
	* sysdeps/unix/sysv/linux/bits/shm.h: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/bits/shm.h: Likewise.

2005-11-17  Steven Munroe  <sjmunroe@us.ibm.com>

	[BZ #1877]
	* string/test-strncmp.c (do_test_limit): Handle zero length and
	non-zero align values.
	(test_main): Correct do_test_limit tests for 64-bit.

2005-11-15  Steven Munroe  <sjmunroe@us.ibm.com>

	* sysdeps/powerpc/sysdep.h (PPC_FEATURE_HAS_SPE,
	PPC_FEATURE_HAS_EFP_SINGLE, PPC_FEATURE_HAS_EFP_DOUBLE,
	PPC_FEATURE_NO_TB, PPC_FEATURE_POWER4, PPC_FEATURE_POWER5,
	PPC_FEATURE_POWER5_PLUS, PPC_FEATURE_CELL, PPC_FEATURE_970):
	Define to match 2.6.15 kernel.

	* sysdeps/powerpc/fpu/e_sqrt.c: Remove dl-procinfo.h include.
	* sysdeps/powerpc/fpu/e_sqrtf.c: Likewise.
	* sysdeps/powerpc/fpu/w_sqrtf.c: Likewise.

2005-11-17  Roland McGrath  <roland@redhat.com>

	* elf/elf.h (R_PPC64_ADDR30): Renamed to R_PPC64_REL30.

2005-11-17  Jakub Jelinek  <jakub@redhat.com>

	* io/sys/stat.h (fstatat): If __REDIRECT_NTH isn't defined,
	define fstatat to fstatat64.

2005-11-17  Steven Munroe  <sjmunroe@us.ibm.com>

	[BZ #1877]
	* string/test-strncmp.c (do_test_limit): New function.
	(do_test) Add cast to eliminate compiler warnings.
	(do_random_tests) Add cast to eliminate compiler warnings.
	(test_main) Add do_test_limit tests.
	* sysdeps/powerpc/powerpc32/strncmp.S: Test length before unaligned
	load.
	* sysdeps/powerpc/powerpc64/strncmp.S: Likewise.

2005-11-17  Ulrich Drepper  <drepper@redhat.com>

	* include/resolv.h: Include <stdbool.h>.
	Patch by Paul Brook.

	* io/sys/stat.h: Use __const not const in fstatat prototypes.

2005-11-08  H.J. Lu  <hongjiu.lu@intel.com>

	* sysdeps/wordsize-32/Makefile (CPPFLAGS-divdi3.c): Set to
	-Din_divdi3_c.
	* sysdeps/wordsize-32/symbol-hacks.h: Skip if in_divdi3_c is defined.

2005-11-16  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/fchownat.c: Include string.h.
	* sysdeps/unix/sysv/linux/futimesat.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/fchownat.c: Likewise.
	* sysdeps/unix/sysv/linux/i386/fxstatat.c: Likewise.
	* sysdeps/unix/sysv/linux/renameat.c: Likewise.
	* sysdeps/unix/sysv/linux/s390/s390-32/fchownat.c: Likewise.
	* sysdeps/unix/sysv/linux/unlinkat.c: Likewise.
	* sysdeps/unix/sysv/linux/wordsize-64/fxstatat.c: Likewise.

2005-11-16  Ulrich Drepper  <drepper@redhat.com>

	* iconvdata/Makefile (modules): Add ISO_11548-1.
	(distribute): Add iso_11548-1.c.
	* iconvdata/gconv-modules: Add entries for ISO 11548-1.
	* iconvdata/TESTS: Add entry for ISO 11548-1.

	[BZ 1872]
	* iconvdata/iso_11548-1.c: New file.
	* iconvdata/testdata/ISO_11548-1: New file.
	* iconvdata/testdata/ISO_11548-1..UTF8: New file.
	Patch by Samuel Thibault <samuel.thibault@ens-lyon.org>.

2005-11-16  Kaz Kojima  <kkojima@rr.iij4u.or.jp>

	* sysdeps/sh/bits/setjmp.h (_JMPBUF_UNWINDS): Remove incorrect &.

2005-11-15  Ulrich Drepper  <drepper@redhat.com>

	[BZ 1865]
	* inet/netinet/icmp6.h: More updates for RFC3542.
	* inet/netinet/ip6.h: Likewise.
	* sysdeps/unix/sysv/linux/bits/in.h: Adjust for current kernel sources.
	Patch by David L Stevens <dlstevens@us.ibm.com>.

	* sysdeps/unix/sysv/linux/wordsize-64/fxstatat.c (__fxstatat):
	Return -1 on failure.
	* sysdeps/unix/sysv/linux/fchownat.c (fchownat): Likewise.
	* sysdeps/unix/sysv/linux/i386/fxstatat.c (__fxstatat): Likewise..
	* sysdeps/unix/sysv/linux/fxstatat64.c [__ASSUME_STAT64_SYSCALL]
	(__fxstatat64): Handle errors.

	* io/sys/poll.h: Add comment explaining poll is a cancellation	point.

	* sysdeps/unix/sysv/linux/syscalls.list (epoll_wait): Align with
	poll, make cancelable.
	* sysdeps/unix/sysv/linux/sys/epoll.h: Add comment explaining
	epoll_wait is a cancellation point.

2005-11-15  Jakub Jelinek  <jakub@redhat.com>

	* io/sys/stat.h (fstatat): Don't use __THROW together with
	__REDIRECT_NTH.

2005-11-14  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-open.c [!SHARED]: Remove _dl_tls_static_size definition.
	* sysdeps/generic/libc-tls.c: Initialize _dl_tls_static_size here.

2005-11-11  Ulrich Drepper  <drepper@redhat.com>

	* io/Makefile (routines): Add fstatat, fstatat64, fxstatat, fxstatat64,
	fchownat, and unlinkat.
	(static-only-routines): Add fstatat and fstatat64.
	(tests): Add tst-unlinkat, tst-fstatat, tst-futimesat, tst-renameat,
	and tst-fchownat.
	* io/Versions [GLIBC_2.4]: Add fchownat, __fxstatat, __fxstatat64,
	and unlinkat.
	* io/fcntl.h: Define AT_FDCWD, AT_SYMLINK_NOFOLLOW, and AT_REMOVEDIR.
	* io/fstatat.c: New file.
	* io/fstatat64.c: New file.
	* io/sys/stat.h: Declare fstatat, fstatat64, __fxstatat, __fxstatat64
	and define fstatat and fstatat64 inline functions.
	* libio/stdio.h: Declare renameat.
	* misc/Makefile (routines): Add futimesat.
	* misc/Versions [GLIBC_2.4]: Add futimesat.
	* posix/unistd.h: Declare fchownat and unlinkat.
	* stdio-common/Makefile (routines): Add renameat.
	* stdio-common/Versions [GLIBC_2.4]: Add renameat.
	* sysdeps/generic/fchownat.c: New file.
	* sysdeps/generic/futimesat.c: New file.
	* sysdeps/generic/fxstatat.c: New file.
	* sysdeps/generic/fxstatat64.c: New file.
	* sysdeps/generic/renameat.c: New file.
	* sysdeps/generic/unlinkat.c: New file.
	* sysdeps/unix/sysv/linux/fchownat.c: New file.
	* sysdeps/unix/sysv/linux/futimesat.c: New file.
	* sysdeps/unix/sysv/linux/fxstatat.c: New file.
	* sysdeps/unix/sysv/linux/fxstatat64.c: New file.
	* sysdeps/unix/sysv/linux/renameat.c: New file.
	* sysdeps/unix/sysv/linux/unlinkat.c: New file.
	* sysdeps/unix/sysv/linux/alpha/fxstatat.c: New file.
	* sysdeps/unix/sysv/linux/i386/fchownat.c: New file.
	* sysdeps/unix/sysv/linux/i386/fxstatat.c: New file.
	* sysdeps/unix/sysv/linux/m68k/fchownat.c: New file.
	* sysdeps/unix/sysv/linux/m68k/fxstatat.c: New file.
	* sysdeps/unix/sysv/linux/powerpc/fchownat.c: New file.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/fxstatat.c: New file.
	* sysdeps/unix/sysv/linux/s390/s390-32/fchownat.c: New file.
	* sysdeps/unix/sysv/linux/s390/s390-32/fxstatat.c: New file.
	* sysdeps/unix/sysv/linux/sh/fchownat.c: New file.
	* sysdeps/unix/sysv/linux/sh/fxstatat.c: New file.
	* sysdeps/unix/sysv/linux/sparc/sparc32/fchownat.c: New file.
	* sysdeps/unix/sysv/linux/sparc/sparc32/fxstatat.c: New file.
	* sysdeps/unix/sysv/linux/sparc/sparc64/fxstatat.c: New file.
	* sysdeps/unix/sysv/linux/wordsize-64/fxstatat.c: New file.
	* sysdeps/unix/sysv/linux/wordsize-64/fxstatat64.c: New file.
	* time/sys/time.h: Declare futimesat.
	* include/fcntl.h: Declare __atfct_seterrno.
	* sysdeps/unix/sysv/linux/openat.c (__atfct_seterrno): New function.
	Split out from openat code and called.
	(do_test): Allow openat to fail with ENOSYS.  Handle AT_FDCWD.
	* sysdeps/generic/openat.c: Handle AT_FDCWD.
	* sysdeps/generic/openat64.c: Likewise.
	* io/tst-unlinkat.c: New file.
	* io/tst-fstatat.c: New file.
	* io/tst-futimesat.c: New file.
	* io/tst-renameat.c: New file.
	* io/tst-fchownat.c: New file.
	* io/tst-openat.c: Don't fail if openat is not implemented.

	* sysdeps/unix/sysv/linux/powerpc/chown.c: Don't provide backward
	compatibility code if new kernel is guaranteed.

	* time/sys/time.h: Add a few nonnull attributes.

2005-11-09  Ulrich Drepper  <drepper@redhat.com>

	* io/fcntl.h: Declare openat and openat64.
	* io/Makefile (routines): Add openat and openat64.
	(tests): Add tst-openat.
	* io/Versions: Add openat and openat64 for GLIBC_2.4.
	* sysdeps/generic/openat.c: New file.
	* sysdeps/generic/openat64.c: New file.
	* sysdeps/unix/sysv/linux/openat.c: New file.
	* sysdeps/unix/sysv/linux/openat64.c: New file.
	* io/tst-openat.c: New file.

	* sysdeps/generic/check_fds.c (check_one_fd): For writable
	descriptors, use /dev/full.
	(__libc_check_standard_fds): Reverse modes so that common operations on
	the descriptors fail.
	* sysdeps/unix/sysv/linux/device-nrs.h: Add info for /dev/full.

2005-11-07  Kazuhiro Inaoka  <inaoka.kazuhiro@renesas.com>

	* elf/elf.h (R_M32R_REL32): New macro.

2005-11-05  Marcus Brinkmann  <marcus@gnu.org>

	* sysdeps/mach/hurd/bits/stat.h (S_IMMAP0): New macro.
	(S_ISPARE): Unset the S_IMMAP0 flag.

2005-11-07  Roland McGrath  <roland@redhat.com>

	* configure.in: Grok --with-cpu=CPU option.  If given, search for
	sysdeps/.../machine/CPU subdirs, and give error if none are found.
	* configure: Regenerated.
	* config.make.in (with-cpu): New substituted variable.
	* Makeconfig (+cflags): Add -mcpu=$(with-cpu) if set.

	* malloc/malloc.c (munmap_chunk): Suppress warnings from last change.

	* sysdeps/unix/bsd/sun: Directory and all subdirectories removed,
	saved in ports repository.
	* sysdeps/unix/sysv/linux/tcflush.c: Rewritten.
	* sysdeps/unix/sysv/linux/tcflow.c: Rewritten.

2005-11-06  Ulrich Drepper  <drepper@redhat.com>

	* malloc/malloc.c (munmap_chunk): Add sanity checks.

	* sysdeps/pthread/configure: Fix comment.

2005-11-05  Ulrich Drepper  <drepper@redhat.com>

	* configure.in: Remove gnu_as definition and everything using it.
	* config.make.in: Remove gnu-as.
	* config.h.in: Remove HAVE_GNU_AS.

	* configure.in: Remove gnu_ld definition and everything using it.
	* config.h.in: Remove HAVE_GNU_LD.
	* config.make.in: Remove gnu-ld.
	* csu/Makefile: Remove use of gnu-ld.
	* csu/munch.awk: Removed.
	* csu/munch-tmpl.c: Removed.
	* include/libc-symbols.h: Remove use of HAVE_GNU_LD.
	* posix/execl.c: Likewise.
	* posix/execv.c: Likewise.
	* stdio-common/psignal.c: Likewise.
	* stdlib/exit.c: Likewise.
	* string/strsignal.c: Likewise.
	* string/tester.c: Likewise.
	* sysdeps/generic/errlist.c: Likewise.
	* sysdeps/generic/getenv.c: Likewise.
	* sysdeps/generic/getgroups.c: Likewise.
	* sysdeps/generic/init-posix.c: Likewise.
	* sysdeps/posix/gettimeofday.c: Likewise.
	* sysdeps/posix/system.c: Likewise.
	* sysdeps/unix/bsd/init-posix.c: Likewise.
	* sysdeps/unix/bsd/ulimit.c: Likewise.
	* sysdeps/unix/bsd/sun/m68k/brk.S: Likewise.
	* sysdeps/unix/bsd/sun/m68k/sethostid.S: Likewise.
	* sysdeps/unix/bsd/sun/sparc/sethostid.S: Likewise.
	* sysdeps/unix/i386/brk.S: Likewise.
	* sysdeps/unix/sparc/brk.S: Likewise.

	* configure.in: Remove test for support for subtracting local labels.
	* config.h.in: Remove HAVE_SUBTRACT_LOCAL_LABELS.
	* stdio-common/vfprintf.c: Remove test of
	HAVE_SUBTRACT_LOCAL_LABELS.

	* configure.in: If init_array/fini_array support is not available,
	bail out.
	* config.h.in: Remove trace of optional init_array/fini_array support.
	* config.make.in: Likewise.
	* csu/elf-init.c: Likewise.
	* dlfcn/dlfcn.c: Likewise.
	* elf/soinit.c: Likewise.
	* sysdeps/ia64/elf/initfinit.c: Likewise.

2005-11-04  Roland McGrath  <roland@redhat.com>

	* sysdeps/i386/configure.in (libc_mtune_example): Variable removed.
	* sysdeps/i386/configure: Regenerated.

	[BZ #1089]
	* configure.in: Change order of add-on sysdeps directories,
	so they are interleaved with main sysdeps directories.
	* configure: Regenerated.

2005-11-03  Roland McGrath  <roland@redhat.com>

	* NEWS: Synch with 2.3 branch updates.

2005-11-03  Ulrich Drepper  <drepper@redhat.com>

	* sunrpc/svc.c (svc_getreq_poll): Fix inefficient loop test.

2005-11-03  Roland McGrath  <roland@redhat.com>

	[BZ #1548]
	* sunrpc/svc.c (svc_getreqset): Use ffsl instead of ffs on fd_mask,
	make sure constant is long.
	From Jay Lan <jlan@engr.sgi.com>.

2005-11-03  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1774]
	* sysdeps/posix/getaddrinfo.c (gaih_inet): Don't use simple
	gethostbyname2 lookup if AI_V4MAPPED|AI_ALL is set.

	* sysdeps/posix/getaddrinfo.c (gaih_inet): Avoid alloca when possible
	while looking for scope delimiter.
	Some pretty printing.

2005-10-31  Steven Munroe  <sjmunroe@us.ibm.com>

	* sysdeps/powerpc/powerpc64/Makefile
	(sysdep_routines, elide-routines.os): Add hp-timing.
	* sysdeps/powerpc/powerpc64/hp-timing.c: New file.
	* sysdeps/powerpc/powerpc64/hp-timing.h: New file.
	* sysdeps/unix/sysv/linux/powerpc/get_clockfreq.c: New file.

2005-10-31  Ulrich Drepper  <drepper@redhat.com>

	* resolv/res_init.c (__res_iclose): New function.  Broken out of
	res_nclose.  Take addition parameter which determines whether
	addresses should be freed.
	(res_nclose): Call __res_iclose.
	(res_thread_freeres): Likewise.
	* resolv/res_data.c (res_close): Call __res_iclose.
	* resolv/res_libc.c (res_init): No need to separately free the
	addresses.
	(__res_maybe_init): Likewise.
	* resolv/res_send.c: Use __res_iclose instead of res_nclose.
	* resolv/Versions [GLIBC_PRIVATE]: Add __res_iclose.
	* include/resolv.h: Declare __res_iclose.
	Add libc_hidden_proto for __res_iclose.
	* hesiod/hesiod.c (__hesiod_res_set): No need to free name server
	addresses here again.

	[BZ #1579]
	* debug/execinfo.h: Change backtrace_symbols_fd comment.

2005-10-24  H.J. Lu  <hongjiu.lu@intel.com>

	* sysdeps/ia64/fpu/libm-symbols.h (WEAK_LIBM_ENTRY): Add "__"
	prefix to LOCAL_LIBM_ENTRY.
	(WEAK_LIBM_END): Add "__" prefix to LOCAL_LIBM_END.

2005-10-26  Jakub Jelinek  <jakub@redhat.com>

	* elf/dl-conflict.c (_dl_resolve_conflicts): Use _dl_debug_printf
	instead of _dl_printf to print conflict processing debug message.
	Reported by John Reiser <jreiser@BitWagon.com>.

2005-10-30  Ulrich Drepper  <drepper@redhat.com>

	* misc/hsearch_r.c (hsearch_r): Remove duplicate test.
	Patch by Chris Caputo <ccaputo@alt.net>.

2005-10-28  Kaz Kojima  <kkojima@rr.iij4u.or.jp>

	* sysdeps/unix/sh/sysdep.S: Remove unnecessary weak_alias.
	* sysdeps/unix/sysv/linux/sh/socket.S: Honor NO_WEAK_ALIAS.

2005-10-28  Thorsten Kukuk  <kukuk@suse.de>

	* nis/nss_nis/nis-publickey.c (_nss_nis_getpublickey): Fix off
	by one error.

2005-10-24  Roland McGrath  <roland@redhat.com>

	[BZ #1534]
	* include/string.h: Use libc_hidden_proto for strnlen,
	not libc_hidden_builtin_proto.

2005-10-23  Ulrich Drepper  <drepper@redhat.com>

	* rt/mqueue.h: Cleanups.

2005-10-22  Roland McGrath  <roland@redhat.com>

	[BZ #1254]
	* sysdeps/mach/hurd/getpeername.c (__getpeername): Fix last change.
	From Samuel Thibault <samuel.thibault@ens-lyon.org>.

2005-10-17  Thomas Schwinge  <tschwinge@gnu.org>

	[BZ #1252]
	* hurd/intr-msg.c (_hurd_intr_rpc_mach_msg): Don't use ?: as lvalue.
	* sysdeps/mach/hurd/ioctl.c (__ioctl): Likewise.

2005-10-20  Ulrich Drepper  <drepper@redhat.com>

	* iconvdata/ibm1364.h (__ucs4_to_ibm1364sb): Fix one mapping.
	* iconvdata/ibm1388.h (__ucs4_to_ibm1388sb): Likewise.
	* iconvdata/testdata/IBM1364: Add missing valid input.
	* iconvdata/testdata/IBM1388: Likewise.
	* iconvdata/testdata/IBM1364..UTF8: Adjust appropriately.
	* iconvdata/testdata/IBM1388..UTF8: Likewise.
	Patch by Masahide Washizawa <washi@jp.ibm.com>.

2005-08-23  GOTO Masanori  <gotom@debian.or.jp>

	[BZ #1498]
	* sysdeps/alpha/remqu.S: Return the correct result when the same
	dividend and divisor are provided, and they're negative numbers.
	* sysdeps/alpha/divqu.S: Likewise.

2005-10-18  Steven Munroe  <sjmunroe@us.ibm.com>

	* sysdeps/unix/sysv/linux/powerpc/powerpc32/ucontext_i.h (TESTS):
	Define.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/ucontext_i.h (TESTS):
	Likewise.

2005-10-19  Ulrich Drepper  <drepper@redhat.com>

	* iconvdata/Makefile (modules): Add IBM1364, IBM1371, IBM1388, IBM1390,
	and IBM1399.
	(distribute): Add ibm1364.c, ibm1364.h, ibm1371.c, ibm1371.h,
	ibm1388.c, ibm1388.h, ibm1390.c, ibm1390.h, ibm1399.c, and ibm1399.h.
	* iconvdata/TESTS: Add entries for IBM1364, IBM1371, IBM1388, IBM1390,
	and IBM1399.
	* iconvdata/gconv-modules: Likewise.
	* iconvdata/ibm1364.c: New file.
	* iconvdata/ibm1364.h: New file.
	* iconvdata/ibm1371.c: New file.
	* iconvdata/ibm1371.h: New file.
	* iconvdata/ibm1388.c: New file.
	* iconvdata/ibm1388.h: New file.
	* iconvdata/ibm1390.c: New file.
	* iconvdata/ibm1390.h: New file.
	* iconvdata/ibm1399.c: New file.
	* iconvdata/ibm1399.h: New file.
	* iconvdata/testdata/IBM1364: New file.
	* iconvdata/testdata/IBM1364..UTF8: New file.
	* iconvdata/testdata/IBM1371: New file.
	* iconvdata/testdata/IBM1371..UTF8: New file.
	* iconvdata/testdata/IBM1388: New file.
	* iconvdata/testdata/IBM1388..UTF8: New file
	* iconvdata/testdata/IBM1390: New file.
	* iconvdata/testdata/IBM1390..UTF8: New file.
	* iconvdata/testdata/IBM1399: New file.
	* iconvdata/testdata/IBM1399..UTF8: New file.
	Original patch by Masahide Washizawa <washi@jp.ibm.com>.

2005-10-17  Roland McGrath  <roland@redhat.com>

	* elf/dl-load.c (MAP_COPY): When undefined, define to
	MAP_PRIVATE|MAP_DENYWRITE instead of just MAP_PRIVATE.
	(_dl_map_object_from_fd): Don't use MAP_DENYWRITE explicitly.

2005-10-17  Martin Schwidefsky  <schwidefsky@de.ibm.com>

	* sysdeps/unix/sysv/linux/s390/s390-32/ucontext_i.h (SC_STSZ, TESTS):
	Define.
	* sysdeps/unix/sysv/linux/s390/s390-64/ucontext_i.h (SC_STSZ, TESTS):
	Likewise.

2005-10-17  Ulrich Drepper  <drepper@redhat.com>

	* libio/oldfileops.c (_IO_old_file_xsputn): Fix last patch.
	Return EOF not 0.

	* sysdeps/unix/sysv/linux/readonly-area.c (__readonly_area): Also
	allow EACCES errors when opening /proc for now.

	* wctype/wcfuncs.c: Don't use expensive wide char lookups in isw*
	functions if character is in ASCII range.
	* wctype/wcfuncs_l.c: Likewise.

2005-05-03  Robert Millan  <robertmh@gnu.org>

	* abi-tags (.*-.*-knetbsd.*-gnu.*): New match, with ABI value 4.
	* elf/cache.c (print_entry): Match the kNetBSD ABI tag.

2005-10-16  Alfred M. Szmidt  <ams@gnu.org>

	* sysdeps/generic/bits/mman.h
	[__USE_GNU] (MREMAP_MAYMOVE, REMAP_FIXED): New macros.

2005-10-16  Kaz Kojima  <kkojima@rr.iij4u.or.jp>

	* sysdeps/unix/sysv/linux/sh/makecontext.S: New file.
	* sysdeps/unix/sysv/linux/sh/sh3/getcontext.S: New file.
	* sysdeps/unix/sysv/linux/sh/sh4/getcontext.S: New file.
	* sysdeps/unix/sysv/linux/sh/sh3/setcontext.S: New file.
	* sysdeps/unix/sysv/linux/sh/sh4/setcontext.S: New file.
	* sysdeps/unix/sysv/linux/sh/sh3/swapcontext.S: New file.
	* sysdeps/unix/sysv/linux/sh/sh4/swapcontext.S: New file.
	* sysdeps/unix/sysv/linux/sh/sh3/ucontext_i.h: New file.
	* sysdeps/unix/sysv/linux/sh/sh4/ucontext_i.h: New file.
	* sysdeps/unix/sysv/linux/sh/sys/ucontext.h: Removed.
	* sysdeps/unix/sysv/linux/sh/sh3/sys/ucontext.h: New file.
	* sysdeps/unix/sysv/linux/sh/sh4/sys/ucontext.h: New file.

2005-09-13  Jakub Jelinek  <jakub@redhat.com>

	[BZ #1228]
	* include/limits.h (LLONG_MIN, LLONG_MAX, ULLONG_MAX): Make sure these
	are defined for -D_GNU_SOURCE or -D_ISOC99_SOURCE even when not
	-std=c99.

2005-10-16  Kaz Kojima  <kkojima@rr.iij4u.or.jp>

	* sysdeps/unix/sysv/linux/sh/bits/mman.h: Define MREMAP_FIXED.

2005-08-05  Alfred M. Szmidt  <ams@gnu.org>

	[BZ #1252]
	* sysdeps/mach/hurd/setitimer.c (restart_itimer): Move static fn
	forward decl out of function body.
	* sysdeps/mach/hurd/profil.c: Likewise.

2005-10-16  Roland McGrath  <roland@frob.com>

	[BZ #1254]
	* sysdeps/mach/hurd/getpeername.c (__getpeername): Respect *LEN
	byte limit when setting ADDR->sa_family.
	Reported by Samuel Thibault <samuel.thibault@ens-lyon.org>.

	[BZ #1253]
	* sysdeps/mach/hurd/dl-sysdep.h
	[SHARED] (DL_ARGV_NOT_RELRO): New macro.

	[BZ #1253]
	* sysdeps/mach/hurd/i386/init-first.c (init): Make cast kosher.
	(_hurd_stack_setup): Don't declare with arguments and ellipsis.
	Use __builtin_frame_address and __builtin_return_address.
	(_dl_init_first): Likewise.

	[BZ #1249]
	* sysdeps/mach/hurd/i386/init-first.c (_cthread_init_routine): Declare
	as weak extern.
	(init): Check for it being undefined.

2005-10-16  Daniel Jacobowitz  <dan@codesourcery.com>
	    Roland McGrath  <roland@redhat.com>

	* Makerules [module-names] (extra-modules-build): New variable.
	($(extra-modules-build:%=$(objpfx)%.so)): New static pattern rule.
	Depend on libc.so and libc_nonshared.a.
	* dlfcn/Makefile ($(test-modules)): Remove static pattern rule.
	* elf/Makefile (modules-names-nobuild): New variable, add filtmod1.
	($(test-modules)): Remove static pattern rule.

2005-10-15  Thomas Schwinge  <tschwinge@gnu.org>

	* include/dirent.h: Include <stdbool.h>.
	* sysdeps/mach/hurd/fdopendir.c: Include <fcntl.h>.
	(fdopendir): Correct argument to _hurd_fd_get().
	* sysdeps/mach/hurd/opendir.c (__opendir): Remove stray `}'.

2005-08-20  Paul Eggert  <eggert@cs.ucla.edu>

	[BZ #1224]
	* posix/regcomp.c (init_word_char, duplicate_node_closure,
	fetch_token, peek_token_bracket, build_range_exp,
	build_collating_symbol): Remove forward decls; no longer needed
	now that we use prototypes.

2005-10-15  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1221]
	* posix/regex_internal.h: Remove last traces of
	RE_NO_INTERNAL_PROTOTYPES.

	[BZ #968]
	* string/strxfrm_l.c (STRXFRM): Fix exit conditions of two loops.

	* sysdeps/unix/fdopendir.c (fdopendir): Make sure descriptor
	allows reading.

	* wcsmbs/tst-mbrtowc2.c: Use de_DE.UTF-8 instead of en_US.UTF-8.
	* wcsmbs/Makefile: Define tst-mbrtowc2-ENV.

	* posix/regexec.c: Finish prototyping of static functions.
	* posix/regex_internal.c: Likewise.

2005-10-14  Roland McGrath  <roland@frob.com>

	* sysdeps/mach/hurd/opendir.c (_hurd_fd_opendir): New function, broken
	out of ...
	(__opendir): ... here.  Call it.
	* sysdeps/mach/hurd/fdopendir.c: New file.

2005-10-14  Ulrich Drepper  <drepper@redhat.com>

	[BZ #865]
	* math/tgmath.h: Correctly determine result type for
	__TGMATH_BINARY_REAL_ONLY,
	__TGMATH_TERNARY_FIRST_SECOND_REAL_ONLY,
	__TGMATH_TERNARY_REAL_ONLY, and __TGMATH_BINARY_REAL_IMAG.

2005-09-17  Andreas Jaeger  <aj@suse.de>

	[BZ #865]
	* math/test-tgmath-int.c: New file.
	* math/Makefile (tests): Add test-tgmath-int.

2005-10-14  Ulrich Drepper  <drepper@redhat.com>

	[BZ #804]
	* malloc/tst-mtrace.sh: Work around for bootstraping.

	* locale/programs/ld-collate.c (collate_output): Fix counting of
	elements.  Don't limit table size.  Use correct secondary hash
	function.
	* locale/localeinfo.h (LIMAGIC): Change value returned for LC_COLLATE.
	* posix/fnmatch_loop.c: Adjust for changed secondary hash function.
	* posix/regcomp.c: Likewise.

	* time/asctime.c (asctime_internal): Use __snprintf instead of
	snprintf to avoid PLT entry.

	* sysdeps/unix/opendir.c (__opendir): Pass extra argument to
	__alloc_dir.
	(__alloc_dir): Only close descriptor on error if new parameter is true.
	* sysdeps/unix/fdopendir.c (fdopendir): Pass extra argument to
	__alloc_dir.  Don't close fd on error.
	* include/dirent.h (__alloc_dir): Adjust prototype.

	* stdlib/Makefile (tests): Add tst-ucontext-off.
	* stdlib/tst-ucontext-off.c: New file.
	* sysdeps/unix/sysv/linux/x86_64/ucontext_i.h (TESTS): Define.
	* sysdeps/unix/sysv/linux/i386/ucontext_i.h (TESTS): Likewise.

	[BZ #1468]
	* sysdeps/unix/sysv/linux/x86_64/ucontext_i.h: Fix values for
	oFPREGS, oSIGMASK, oFPREGSMEM, and oMXCSR.
	Patch by Nicholas Miell <nmiell@comcast.net>.

	[BZ #1460]
	* time/asctime.c (asctime_internal): New function, derived from
	asctime_r.  Takes additional parameter which is the buffer length.
	Use snprintf instead sprintf, if it overflows, fail.
	(asctime_r): Call asctime_internal with 26 as buffer length.
	(asctime): Call asctime_internal with length of internal buffer.
	* time/Makefile (tests): Add bug-asctime_r.
	* time/bug-asctime_r.c: New file.

	[BZ #1459]
	* time/asctime.c (__asctime_r): Check for tm_year computation to
	overflow and fail in this case.
	* time/Makefile (tests): Add bug-asctime.
	* time/bug-asctime.c: New file.

	[BZ #1458]
	* sysdeps/unix/sysv/linux/i386/bits/mman.h: Define MREMAP_FIXED.
	* sysdeps/unix/sysv/linux/ia64/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/s390/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/sparc/bits/mman.h: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/bits/mman.h: Likewise.
	* misc/sys/mman.h: Add ellipsis after last parameter of mremap and
	adjust leading comment.
	* sysdeps/unix/sysv/linux/syscalls.list: Add pointer parameter to
	mremap syscall.
	* include/sys/mman.h (__mremap): Add ellipsis.
	* malloc/memusage.c: Adjust mremap wrapper for optional additional
	parameter.

2005-10-13  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1405]
	* libio/iogetdelim.c (_IO_getdelim): Fix truncation of return
	value.  Avoid overflow in computation.

	[BZ #1373]
	* argp/argp.h: Remove __NTH for __argp_usage inline function.

2005-08-26  Paul Eggert  <eggert@cs.ucla.edu>

	[BZ #1248]
	* posix/regex_internal.h (bitset_not, bitset_merge, bitset_not_merge,
	bitset_mask, re_string_allocate, re_string_construct,
	re_string_reconstruct, re_string_destruct, re_string_elem_size_at,
	re_string_char_size_at, re_string_wchar_at, re_string_peek_byte_case,
	re_string_fetch_byte_case, re_node_set_alloc, re_node_set_init_1,
	re_node_set_init_2, re_node_set_init_copy, re_node_set_add_intersect,
	re_node_set_init_union, re_node_set_merge, re_node_set_insert,
	re_node_set_insert_last, re_node_set_compare, re_node_set_contains,
	re_node_set_remove_at, re_dfa_add_node, re_acquire_state,
	re_acquire_state_context): Remove unnecessary forward decls.
	(re_string_char_size_at, re_string_wchar_at, re_string_elem_size_at):
	Put __attribute at function definition, now that the function decl
	has been removed.
	* posix/regex_internal.c (re_string_peek_byte_case,
	re_string_fetch_byte_case, re_node_set_compare, re_node_set_contains):
	Likewise.

2005-08-23  Paul Eggert  <eggert@cs.ucla.edu>

	[BZ #1231]
	* posix/regex_internal.c (re_string_skip_chars, register_state,
	calc_state_hash): Remove forward decls.
	* posix/regexec.c (acquire_init_state_context, check_halt_node_context,
	proceed_next_node, pop_fail_stack, sub_epsilon_src_nodes,
	clean_state_log_if_needed): Likewise.

2005-10-13  Ulrich Drepper  <drepper@redhat.com>

	* posix/regex.c: No need to use K&R definitions for static functions.
	* posix/regex_internal.c: Likewise.
	* posix/regcomp.c: Likewise.

	[BZ #1466]
	* sysdeps/generic/s_csqrt.c (__csqrt): For zero real part, return
	principal square root.
	* sysdeps/generic/s_csqrtf.c (__csqrtf): Likewise.
	* sysdeps/generic/s_csqrtl.c (__csqrtl): Likewise.
	* math/libm-test.inc (csqrt_test): Add test for returning
	principal value.

	* include/features.h: Define _POSIX_C_SOURCE to 200112 for
	_XOPEN_SOURCE == 600.

2005-10-12  Ulrich Drepper  <drepper@redhat.com>

	* malloc/malloc.c (_int_free): Fail if block size is obviously wrong.

	* include/malloc.h: Remove _int_new_arena prototype.
	* malloc/arena.c (_int_new_arena): Move definition ahead of
	arena_get2 and make static.

	Correctly implement M_MXFAST.
	* malloc/malloc.c (struct malloc_state): Replace max_fast with flags
	fields.
	(global_max_fast): New variable.
	(set_max_fast): Change to not require arena parameter and to modify
	global_max_fast.  Change all callers.
	(get_max_fast): New macro.  Use this instead of directly accessing
	now removed max_fast arena member.
	(have_fastchunks): Use flags instead of max_fast.
	(clear_fastchunks): Likewise.
	(set_fastchunks): Likewise.
	(contiguous): Likewise.
	(noncontiguous): Likewise.
	(set_noncontiguous): Likewise.
	(set_contiguous): Likewise.
	(malloc_init_state): Explicitly set FASTCHUNKS_BIT.  Call set_max_fast
	only for main arena.
	* malloc/hooks.c (public_sET_STATe): Adjust set_max_fast use.

2005-10-10  Daniel Jacobowitz  <dan@codesourcery.com>

	* sysdeps/generic/bits/byteswap.h (__bswap_constant_16): New macro.
	(__bswap_16): Use it.
	(__bswap_constant_32): New macro.
	(__bswap_32): Use it.

2005-10-10  Ulrich Drepper  <drepper@redhat.com>

	* malloc/arena.c (ptmalloc_unlock_all2): Reset atfork_recursive_cntr.

2005-10-08  Jakub Jelinek  <jakub@redhat.com>

	* nss/getent.c (hosts_keys): Pass INADDRSZ as size rather
	than IN6ADDRSZ to AF_INET gethostbyaddr.

2005-10-07  Roland McGrath  <roland@redhat.com>

	[BZ #1438]
	* include/features.h: Make tests on _FORTIFY_SOURCE and __OPTIMIZE__
	friendly to -Wundef.
	(__USE_FORTIFY_LEVEL): Always define it, to 0 if nothing else.

2005-10-06  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/readonly-area.c: Allow fopen to fail because
	the file does not exist.

2005-10-05  Simon Josefsson  <jas@extundo.com>

	[BZ #1423]
	* crypt/md5.h (MD5_DIGEST_SIZE, MD5_BLOCK_SIZE): New macros.

2005-10-05  Roland McGrath  <roland@redhat.com>

	* crypt/Makefile (distribute): Remove duplicate defn.

	* sysdeps/generic/ldsodefs.h (struct audit_ifaces):
	Use ARCH_PLTENTER_MEMBERS and ARCH_PLTEXIT_MEMBERS macros if defined.
	* elf/tst-auditmod1.c: Include <tst-audit.h> to define more
	architecture-specific code.
	* sysdeps/generic/tst-audit.h: New file.
	* elf/Makefile (distribute): Add it.

2005-10-05  Daniel Jacobowitz  <dan@codesourcery.com>

	* elf/elf.h (R_ARM_TLS_DTPMOD32, R_ARM_TLS_DTPOFF32,
	R_ARM_TLS_TPOFF32, R_ARM_TLS_GD32, R_ARM_TLS_LDM32,
	R_ARM_TLS_LDO32, R_ARM_TLS_IE32, R_ARM_TLS_LE32): New macros.

2005-10-03  Roland McGrath  <roland@redhat.com>

	* sysdeps/powerpc/nofpu: Directory removed, saved in ports repository.

2005-09-30  Ulrich Drepper  <drepper@redhat.com>

	* posix/regex.h: Pretty printing.
	Clean up namespace a bit.

2005-09-30  Jakub Jelinek  <jakub@redhat.com>

	* posix/regexec.c (update_cur_sifted_state, check_arrival,
	check_arrival_add_next_nodes): Avoid using uninitialized variable.

	* malloc/memusage.c (dest): Fix a bunch of warnings on 32-bit arches.

	* sysdeps/i386/fpu/libm-test-ulps: Update for GCC 4.0.x.

2005-09-29  Ulrich Drepper  <drepper@redhat.com>

	* iconvdata/Makefile (modules): Add IBM803, IBM901, IBM902, IBM921,
	IBM1008, IBM1008_420, IBM1097, IBM1112, IBM1123, IBM1130, IBM1140,
	IBM1141, IBM1142, IBM1143, IBM1144, IBM1145, IBM1146, IBM1147, IBM1148,
	IBM1149, IBM1166, IBM1167, IBM4517, IBM4899, IBM4909, IBM4971,
	IBM5347, IBM9030, IBM9066, IBM9448, IBM12712, IBM16804.
	(distribute): Add ibm803.c, ibm803.h, ibm901.c, ibm901.h, ibm902.c,
	ibm902.h, ibm921.c, ibm921.h, ibm1008.c, ibm1008.h, ibm1008_420.c,
	ibm1097.c, ibm1097.h, ibm1112.c, ibm1112.h, ibm1123.c, ibm1123.h,
	ibm1130.c, ibm1130.h, ibm1140.c, ibm1140.h, ibm1141.c, ibm1141.h,
	ibm1142.c, ibm1142.h, ibm1143.c, ibm1143.h, ibm1144.c, ibm1144.h,
	ibm1145.c, ibm1145.h, ibm1146.c, ibm1146.h, ibm1147.c, ibm1147.h,
	ibm1148.c, ibm1148.h, ibm1149.c, ibm1149.h, ibm1166.c, ibm1166.h,
	ibm1167.c, ibm1167.h, ibm4517.c, ibm4517.h, ibm4899.c, ibm4899.h,
	ibm4909.c, ibm4909.h, ibm4971.c, ibm4971.h, ibm5347.c, ibm5347.h,
	ibm9030.c, ibm9030.h, ibm9066.c, ibm9066.h, ibm9448.c, ibm9448.h,
	ibm12712.c, ibm12712.h, ibm16804.c, ibm16804.h.
	* iconvdata/TESTS: Add entries for new modules.
	* iconvdata/gconv-modules: Likewise.
	* iconvdata/ibm803.c: New file.
	* iconvdata/ibm803.h: New file.
	* iconvdata/ibm901.c: New file.
	* iconvdata/ibm901.h: New file.
	* iconvdata/ibm902.c: New file.
	* iconvdata/ibm902.h: New file.
	* iconvdata/ibm921.c: New file.
	* iconvdata/ibm921.h: New file.
	* iconvdata/ibm1008.c: New file.
	* iconvdata/ibm1008.h: New file.
	* iconvdata/ibm1008_420.c: New file.
	* iconvdata/ibm1097.c: New file.
	* iconvdata/ibm1097.h: New file.
	* iconvdata/ibm1112.c: New file.
	* iconvdata/ibm1112.h: New file.
	* iconvdata/ibm1123.c: New file.
	* iconvdata/ibm1123.h: New file.
	* iconvdata/ibm1130.c: New file.
	* iconvdata/ibm1130.h: New file.
	* iconvdata/ibm1140.c: New file.
	* iconvdata/ibm1140.h: New file.
	* iconvdata/ibm1141.c: New file.
	* iconvdata/ibm1141.h: New file.
	* iconvdata/ibm1142.c: New file.
	* iconvdata/ibm1142.h: New file.
	* iconvdata/ibm1143.c: New file.
	* iconvdata/ibm1143.h: New file.
	* iconvdata/ibm1144.c: New file.
	* iconvdata/ibm1144.h: New file.
	* iconvdata/ibm1145.c: New file.
	* iconvdata/ibm1145.h: New file.
	* iconvdata/ibm1146.c: New file.
	* iconvdata/ibm1146.h: New file.
	* iconvdata/ibm1147.c: New file.
	* iconvdata/ibm1147.h: New file.
	* iconvdata/ibm1148.c: New file.
	* iconvdata/ibm1148.h: New file.
	* iconvdata/ibm1149.c: New file.
	* iconvdata/ibm1149.h: New file.
	* iconvdata/ibm1166.c: New file.
	* iconvdata/ibm1166.h: New file.
	* iconvdata/ibm1167.c: New file.
	* iconvdata/ibm1167.h: New file.
	* iconvdata/ibm4517.c: New file.
	* iconvdata/ibm4517.h: New file.
	* iconvdata/ibm4899.c: New file.
	* iconvdata/ibm4899.h: New file.
	* iconvdata/ibm4909.c: New file.
	* iconvdata/ibm4909.h: New file.
	* iconvdata/ibm4971.c: New file.
	* iconvdata/ibm4971.h: New file.
	* iconvdata/ibm5347.c: New file.
	* iconvdata/ibm5347.h: New file.
	* iconvdata/ibm9030.c: New file.
	* iconvdata/ibm9030.h: New file.
	* iconvdata/ibm9066.c: New file.
	* iconvdata/ibm9066.h: New file.
	* iconvdata/ibm9448.c: New file.
	* iconvdata/ibm9448.h: New file.
	* iconvdata/ibm12712.c: New file.
	* iconvdata/ibm12712.h: New file.
	* iconvdata/ibm16804.c: New file.
	* iconvdata/ibm16804.h: New file.
	* iconvdata/testdata/IBM803: New file.
	* iconvdata/testdata/IBM803..UTF8: New file.
	* iconvdata/testdata/IBM901: New file.
	* iconvdata/testdata/IBM901..UTF8: New file.
	* iconvdata/testdata/IBM902: New file.
	* iconvdata/testdata/IBM902..UTF8: New file.
	* iconvdata/testdata/IBM921: New file.
	* iconvdata/testdata/IBM921..UTF8: New file.
	* iconvdata/testdata/IBM1008: New file.
	* iconvdata/testdata/IBM1008..UTF8: New file.
	* iconvdata/testdata/IBM1097: New file.
	* iconvdata/testdata/IBM1097..UTF8: New file.
	* iconvdata/testdata/IBM1112: New file.
	* iconvdata/testdata/IBM1112..UTF8: New file.
	* iconvdata/testdata/IBM1123: New file.
	* iconvdata/testdata/IBM1123..UTF8: New file.
	* iconvdata/testdata/IBM1130: New file.
	* iconvdata/testdata/IBM1130..UTF8: New file.
	* iconvdata/testdata/IBM1140: New file.
	* iconvdata/testdata/IBM1140..UTF8: New file.
	* iconvdata/testdata/IBM1141: New file.
	* iconvdata/testdata/IBM1141..UTF8: New file.
	* iconvdata/testdata/IBM1142: New file.
	* iconvdata/testdata/IBM1142..UTF8: New file.
	* iconvdata/testdata/IBM1143: New file.
	* iconvdata/testdata/IBM1143..UTF8: New file.
	* iconvdata/testdata/IBM1144: New file.
	* iconvdata/testdata/IBM1144..UTF8: New file.
	* iconvdata/testdata/IBM1145: New file.
	* iconvdata/testdata/IBM1145..UTF8: New file.
	* iconvdata/testdata/IBM1146: New file.
	* iconvdata/testdata/IBM1146..UTF8: New file.
	* iconvdata/testdata/IBM1147: New file.
	* iconvdata/testdata/IBM1147..UTF8: New file.
	* iconvdata/testdata/IBM1148: New file.
	* iconvdata/testdata/IBM1148..UTF8: New file.
	* iconvdata/testdata/IBM1149: New file.
	* iconvdata/testdata/IBM1149..UTF8: New file.
	* iconvdata/testdata/IBM1166: New file.
	* iconvdata/testdata/IBM1166..UTF8: New file.
	* iconvdata/testdata/IBM1167: New file.
	* iconvdata/testdata/IBM1167..UTF8: New file.
	* iconvdata/testdata/IBM4517: New file.
	* iconvdata/testdata/IBM4517..UTF8: New file.
	* iconvdata/testdata/IBM4899: New file.
	* iconvdata/testdata/IBM4899..UTF8: New file.
	* iconvdata/testdata/IBM4909: New file.
	* iconvdata/testdata/IBM4909..UTF8: New file.
	* iconvdata/testdata/IBM4971: New file.
	* iconvdata/testdata/IBM4971..UTF8: New file.
	* iconvdata/testdata/IBM5347: New file.
	* iconvdata/testdata/IBM5347..UTF8: New file.
	* iconvdata/testdata/IBM9030: New file.
	* iconvdata/testdata/IBM9030..UTF8: New file.
	* iconvdata/testdata/IBM9066: New file.
	* iconvdata/testdata/IBM9066..UTF8: New file.
	* iconvdata/testdata/IBM9448: New file.
	* iconvdata/testdata/IBM9448..UTF8: New file.
	* iconvdata/testdata/IBM12712: New file.
	* iconvdata/testdata/IBM12712..UTF8: New file.
	* iconvdata/testdata/IBM16804: New file.
	* iconvdata/testdata/IBM16804..UTF8: New file.
	Patch by Masahide WASHIZAWA <washi@jp.ibm.com>.

	* iconvdata/run-iconv-test.sh: Run ASCII->encoding->ASCII suntzus
	test only if $subset is N.

2005-09-29  Roland McGrath  <roland@redhat.com>

	[BZ #1392]
	* posix/sys/wait.h [!__GNUC__ || __cplusplus] (__WAIT_INT): Use const.

2005-09-29  Alfred M. Szmidt  <ams@gnu.org>

	* elf/rtld.c [DL_ARGV_NOT_RELRO] (_dl_argc, _dl_skip_args):
	Don't use attribute_relro.

2005-09-29  Roland McGrath  <roland@redhat.com>

	[BZ #1392]
	* posix/sys/wait.h (__WAIT_INT): Rewrite using an initializer,
	in case __typeof yields a const-qualified type.

2005-09-28  Ulrich Drepper  <drepper@redhat.com>

	* dirent/dirent.h: Declare fdopendir.
	* dirent/Versions: Export fdopendir for GLIBC_2.4.
	* dirent/Makefile (routines): Add fdopendir.
	(tests): Add tst-fdopendir.
	* dirent/tst-fdopendir.c: New file.
	* include/dirent.h: Declare __alloc_dir.
	* sysdeps/generic/fdopendir.c: New file.
	* sysdeps/unix/fdopendir.c: New file.
	* sysdeps/unix/opendir.c: Split off back part of opendir into new
	function __alloc_dir.

2005-09-26  Steven Munroe  <sjmunroe@us.ibm.com>

	[BZ #1384]
	* sysdeps/powerpc/fpu/libm-test-ulps: Adjust expected y1, y1f, yn,
	ynf results.

2005-09-06  Paul Eggert  <eggert@cs.ucla.edu>
            Ulrich Drepper  <drepper@redhat.com>

	[BZ #1302]
	Change bitset word type from unsigned int to unsigned long int,
	as this has better performance on typical 64-bit hosts.  Change
	bitset type name to bitset_t.
	* posix/regcomp.c (build_equiv_class, build_charclass):
	(build_range_exp, build_collating_symbol):
	Prefer bitset_t to re_bitset_ptr_t in prototypes, when the actual
	argument is a bitset.  This is merely a style issue, but it makes
	it clearer that an entire array is expected.
	(re_compile_fastmap_iter, init_dfa, init_word_char, optimize_subexps,
	lower_subexp): Adjust for new bitset_t definition.
	(lower_subexp, parse_bracket_exp, built_charclass_op): Likewise.
	* posix/regex_internal.h (bitset_set, bitset_clear, bitset_contain,
	bitset_not, bitset_merge, bitset_set_all, bitset_mask): Likewise.
	* posix/regexec.c (check_dst_limits_calc_pos_1,
	check_subexp_matching_top, build_trtable, group_nodes_into_DFAstates):
	Likewise.
	* posix/regcomp.c (utf8_sb_map): Don't assume initializer
	== 0xffffffff.
	* posix/regex_internal.h (BITSET_WORD_BITS): Renamed from UINT_BITS.
	All uses changed.
	(BITSET_WORDS): Renamed from BITSET_UINTS.  All uses changed.
	(bitset_word_t): New type, replacing 'unsigned int' for bitset uses.
	All uses changed.
	(BITSET_WORD_MAX): New macro.
	(bitset_set, bitset_clear, bitset_contain, bitset_empty,
	(bitset_set_all, bitset_copy):  Adjust for bitset_t change.
	(bitset_empty, bitset_copy):
	Prefer sizeof (bitset_t) to multiplying it out ourselves.
	(bitset_not_merge): Remove; unused.
	(bitset_contain): Return bool, not unsigned int with one bit on.
	All callers changed.
	* posix/regexec.c (build_trtable): Don't assume bitset_t has no
	stricter alignment than re_node_set; do this by defining a new
	internal type struct dests_alloc and using it to allocate memory.

2005-09-27  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1230]
	* stdlib/strtod_l.c (STRNCASECMP): Always use C locale object.
	(TOLOWER_C): Define.  Use it when recognizing inf and nan.
	* stdlib/Makefile (tests): Add bug-strtod2.
	* stdlib/bug-strtod2.c: New file.

2005-09-21  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>

	[BZ #1361]
	* argp/argp-fmtstream.h [HAVE_CONFIG_H]: Do not #include <config.h>.
	* argp/argp-eexst.c, argp/argp-fmtstream.c, argp/argp-fs-xinl.c,
	argp/argp-xinl.c: Fix up whitespace.

2005-09-27  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1158]
	* stdlib/cxa_atexit.c (__new_exitfn): Rewrite to preserve order in
	which the functions were registered.
	* dlfcn/Makefile: Add rules to build and run bug-atexit1 and
	bug-atexit2.
	* dlfcn/bug-atexit1.c: New file.
	* dlfcn/bug-atexit1-lib.c: New file.
	* dlfcn/bug-atexit2.c: New file.
	* dlfcn/bug-atexit2-lib.c: New file.

	[BZ #1078]
	* libio/fileops.c (_IO_new_file_xsputn): Determine amount of
	available space in non-line-buffered buffer correctly.
	* libio/oldfileops.c (_IO_old_file_xsputn): Likewise.
	* stdio-common/Makefile (tests): Add tst-fwrite.
	* stdio-common/tst-fwrite.c: New file.

2005-09-26  Ulrich Drepper  <drepper@redhat.com>

	[BZ #838]
	* malloc/arena.c (ptmalloc_lock_all): If global lock already taken
	by the same thread, just bump the counter.
	(ptmalloc_unlock_all): If counter for recursive locks hasn't reached
	zero, don't do anything else.
	* malloc/Makefile (tests): Add tst-mallocfork.
	* malloc/tst-mallocfork.c: New file.

	[BZ #808]
	* malloc/malloc.c (_int_realloc): Make error message clearer.

	[BZ #713]
	* libio/iofgets.c: Treat N==1 correctly.
	* libio/iofgets_u.c: Likewise.
	* libio/iofgetws.c: Likewise.
	* libio/iofgetws_u.c: Likewise.
	* stdio-common/Makefile (tests): Add tst-fgets.
	* stdio-common/tst-fgets.c: New file.

2005-01-11  Thorsten Kukuk  <kukuk@suse.de>

	[BZ #652]
	* posix/getconf.c: Add new option -a to print the names of
	the current system configuration variables to stdout.
	Based on patch from Josh Aas <josha@sgi.com>.

2005-09-26  Ulrich Drepper  <drepper@redhat.com>

	[BZ #644]
	* sysdeps/posix/getaddrinfo.c (fls): New function.
	(gaih_inet): Don't use ffs, use fls.  Convert address to native byte
	order first.
	* posix/Makefile (tests): Add tst-rfc3484.
	* posix/tst-rfc3484.c: New file.

	[BZ #627]
	* libio/iofclose.c (_IO_new_fclose): Unlock the internal lock
	before destroying it as part of the _IO_FINISH call.
	* libio/oldiofclose.c (_IO_old_fclose): Likewise.

	[BZ #524]
	* sysdeps/posix/getaddrinfo.c (match_prefix): Fix matching loop if
	number of bits is multiple of 8.
	Patch by Fredrik Tolf <fredrik@dolda2000.com>.

	[BZ #516]
	* elf/dl-load.c: Report failed loading due to ELF class mismatch
	with better words.

	[BZ #162]
	* manual/llio.texi (Waiting for I/O): Correct description of read
	conditions reported by select.

2005-09-24  Jakub Jelinek  <jakub@redhat.com>

	* inet/getnetgrent_r.c (innetgr): Call endfct even if result != 0.
	Return 1 only if result == 1.  Patch by Benoit Capelle.

2005-09-25  Ulrich Drepper  <drepper@redhat.com>

	[BZ #278]
	* manual/stdio.texi (Hook Functions): Correct type of position
	parameter of seeker and fix fallout of the change in the text.

	[BZ #714]
	* iconv/loop.c [!STORE_REST] (SINGLE): Correctly record number of
	left-over bytes and store them correctly.
	* wcsmbs/tst-mbrtowc2.c: New file.
	* wcsmbs/Makefile (tests): Add tst-mbrtowc2.

2005-09-24  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/sysv/i386/signal.S: Removed, saved in ports repository.
	* sysdeps/unix/sysv/i386/sigreturn.S: Likewise.

2005-09-24  Ulrich Drepper  <drepper@redhat.com>

	[BZ #545]
	* locale/iso-639.def: More updates from the current spec.

	* locale/programs/ld-address.c (address_finish): Produce better
	error messages for invalid lang_ab use.

	* locale/iso-639.def: Add a few updates from current spec.

2005-09-23  Ulrich Drepper  <drepper@redhat.com>

	[BZ #704]
	* locale/iso-4217.def: Replace MGF with MGA.

	* iconvdata/jis0208.c (__jisx0208_from_ucs4_lat1): Reduce size of
	array.
	* iconvdata/jis0208.h (ucs4_to_jisx0208): Adjust access.

2004-08-13  GOTO Masanori  <gotom@debian.or.jp>

	[BZ #395]
	* iconvdata/jis0208.c: Remove 0x005C mapping from
	__jisx0208_from_ucs4_lat1.
	Reported by Fumitoshi UKAI <ukai@debian.or.jp>

2005-09-23  Ulrich Drepper  <drepper@redhat.com>

	[BZ #394]
	* libio/fmemopen.c (fmemopen_write): Return 0 instead of -1 if
	nothing can be written.
	* libio/iofopncook.c (_IO_cookie_write): If something went wrong,
	set error bit.

2005-09-22  Ulrich Drepper  <drepper@redhat.com>

	[BZ #281]
	* posix/regex.h: Define RE_TRANSLATE_TYPE as unsigned char *.
	* posix/regcomp.c: Remove unnecessary uses of
	unsigned RE_TRANSLATE_TYPE.
	* posix/regex_internal.h: Likewise.
	* posix/regex_internal.c: Likewise.
	* posix/regexexec.c: Likewise.
	Based on a patch by Stepan Kasal <kasal@ucw.cz>.

	[BZ #1035]
	* locale/iso-4217.def: Replace TRL entry with TRY for new Turkish Lira.

	[BZ #1363]
	* nscd/nscd_getpw_r.c (nscd_getpw_r): Remove incorrectly C&Ped
	free call in code handling detection of GC runs.

2005-09-22  Roland McGrath  <roland@redhat.com>

	* elf/dl-tsd.c (__libc_dl_error_tsd): Use attribute_tls_model_ie for
	static __thread variable.
	From Alexandre Oliva <aoliva@redhat.com>

	* Makefile ($(objpfx)c++-types-check.out): Use $<, not $^, in command.
	Reported by Alexandre Oliva <aoliva@redhat.com>.

2005-09-20  Jakub Jelinek  <jakub@redhat.com>

	* nscd/dbg_log.c (init_logfile): Use fopen64 rather than fopen.

2005-09-20  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/sysv/linux/lddlibc4.c (main): Use execv, not execl.

	[BZ #1346]
	* elf/dl-load.c (_dl_map_object_from_fd) [HAVE_Z_RELRO]: Do relro
	magic on __stack_prot only if [SHARED].  Skip mprotect if __stack_prot
	lies outside the page-rounded-down relro region.

2005-09-19  Richard Henderson  <rth@redhat.com>

	[BZ #1358]
	* sysdeps/unix/alpha/sysdep.h (inline_syscall1): Copy argument(s)
	to a temporary first.
	(inline_syscall2, inline_syscall3, inline_syscall4): Likewise.
	(inline_syscall5, inline_syscall6): Likewise.

	* sysdeps/alpha/ldiv.S (lldiv): Add alias.

2005-09-17  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1010]
	* sysdeps/unix/sockatmark.c (sockatmark): Use SIOCATMARK correctly.

	[BZ #1053]
	* debug/xtrace.sh: Add missing escape character in -? match.
	Patch by Peter Breitenlohner <peb@mppmu.mpg.de>.

	[BZ #1051]
	* wctype/wctype.h: Remove stray __END_NAMESPACE_C99.
	* stdlib/stdlib.h: Use __END_NAMESPACE_STD instead of
	__END_NAMESPACE_C99 in one place.
	* scripts/begin-end-check.pl: New file.
	Patch by Ralph Loader <suckfish@ihug.co.nz>.
	* Makefile: Add rules to run scripts/begin-end-check.pl.

2005-09-17  Andreas Jaeger  <aj@suse.de>

	* timezone/zdump.c: Include ctype.h.

2005-09-16  Andreas Jaeger  <aj@suse.de>

	[BZ #1047]
	* sysdeps/unix/sysv/linux/mips/getpagesize.c: New file.

2005-09-16  Maciej W. Rozycki  <macro@linux-mips.org>

	[BZ #933]
	* sysdeps/unix/sysv/linux/mips/brk.c (__brk): Load the number of
	the syscall immediately before invocation.
	* sysdeps/unix/sysv/linux/mips/mips64/n64/ioctl.S (__ioctl): Likewise.
	* sysdeps/unix/sysv/linux/mips/mips64/syscall.S (syscall): Likewise.

	* sysdeps/unix/sysv/linux/mips/mips64/n64/ioctl.S (__ioctl): Use
	macros to handle GP.
	* sysdeps/unix/sysv/linux/mips/mips64/syscall.S (syscall):
	Likewise.  Update inaccurate comments.

2005-09-13  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/posix/spawni.c (__spawni): Automatically recognize some
	more cases when we can use vfork.

2005-08-29  Thomas Schwinge  <schwinge@nic-nac-project.de>

	[BZ #1261]
	* manual/memory.texi (Hooks for Malloc): Correct prototype of
	my_init_hook and definition of my_free_hook.

2005-09-12  Roland McGrath  <roland@redhat.com>

	[BZ #1331]
	* malloc/obstack.h [!__STDC__] (obstack_int_grow_fast): Fix misnamed
	macro argument.
	Reported by Matej Vela <vela@debian.org>.

2005-09-12  Jakub Jelinek  <jakub@redhat.com>

	* malloc/malloc.c (struct malloc_chunk): Fix comment typo.
	(public_cALLOc): For mmapped chunks and perturb_byte != 0,
	don't clear SIZE_SZ bytes more than should be cleared.

2005-09-09  Jakub Jelinek  <jakub@redhat.com>

	* inet/getnetgrent_r.c: Include assert.
	(setup): Remove FUNC_NAME and ALL arguments, assume they are always
	"setnetgrent" and 1.
	(endnetgrent_hook): New function.
	(internal_endnetgrent): Use it.
	(__internal_setnetgrent_reuse): Use it.  Adjust setup caller.
	If status is NSS_STATUS_SUCCESS, yet action is continue, call
	endnetgrent hook.
	(internal_getnetgrent_r): Use __nss_lookup_function rather than
	setup.  Recompute getfct pointer after successful
	__internal_setnetgrent_reuse.  Don't use __nss_next.
	(innetgr): Use __nss_lookup_function instead of __nss_lookup.
	Adjust setup caller.
	* nss/nss_files/files-netgrp.c (_nss_files_endnetgrent): Always clear
	data_size and cursor.  Add libnss_files_hidden_proto and
	libnss_files_hidden_def.
	(_nss_files_setnetgrent): Call _nss_files_endnetgrent on failure.
	* nis/nss_nis/nis-netgrp.c (internal_endnetgrent): Always clear
	data_size and cursor.
	(_nss_nis_setnetgrent): Don't call internal_endnetgrent.
	(_nss_nis_getnetgrent_r): Remove result->cursor == NULL handling.
	* nis/nss_nisplus/nisplus-netgrp.c (internal_endnetgrent): Always clear
	data_size and position.
	(_nss_nisplus_setnetgrent): Don't call internal_endnetgrent.

2005-09-09  Ulrich Drepper  <drepper@redhat.com>

	* nss/getent.c (netgroup_keys): Call endnetgrent.
	(main): Call mtrace.

	* nss/nss_files/files-netgrp.c (_nss_files_setnetgrent): We don't
	need locking for the stream.  Use feof_unlocked.

2005-09-09  Jakub Jelinek  <jakub@redhat.com>

	[BZ #1318]
	* locale/loadarchive.c (_nl_load_locale_from_archive): Free
	normalized_codeset even if p was already normalized.
	Reported by Jaroslav Snajdr <jsnajdr@kerio.com>.

2005-09-08  Roland McGrath  <roland@redhat.com>

	* sysdeps/generic/dl-sysdep.c (_dl_important_hwcaps): Decode DSOCAPS
	properly, first byte is bit number in mask.  Skip disabled caps.

2005-07-11  Derek R. Price  <derek@ximbiot.com>

	[BZ #1061]
	* sysdeps/generic/glob.c (glob): Only a 0 return from
	getlogin_r means success, according to POSIX 1003.2.

2005-06-23  Paul Eggert  <eggert@cs.ucla.edu>

	[BZ #1033]
	* time/mktime.c: Import from gnulib.
	The following macros are now consistent with other gnulib code.
	This does not change mktime's behavior.
	(TYPE_IS_INTEGER): New macro.
	(time_t_is_integer): Use it.
	(TYPE_TWOS_COMPLEMENT): New macro.
	(twos_complement_arithmetic): Use it.
	(TYPE_ONES_COMPLEMENT): New macro.
	(TYPE_MINIMUM, TYPE_MAXIMUM): Now supports signed-magnitude.
	mktime doesn't use this, but the code now matches other gnulib code.
	(ranged_convert): Pacify GCC 4.0 in a different way, which
	generates a few bytes less code.
	(ranged_convert, __mktime_internal): When calling a function via a
	pointer P, use P () rather than (*P) (), as we now assume C89 or
	better.

2005-09-07  Alexandre Oliva  <aoliva@redhat.com>

	* timezone/test-tz.c: Update to match tzdata2005m.
	* timezone/tst-timezone.c: Likewise.

2005-09-07  Ulrich Drepper  <drepper@redhat.com>

	* posix/regexec.c (find_recover_state): Remove unnecessary
	initialization.
	(transit_state_bkref): Make DFA a const pointer.
	(get_subexp): Likewise.
	(check_arrival): Likewise.
	(update_cur_sifted_state): Likewise.
	(re_search_internal): Likewise.
	(prune_impossible_nodes): Likewise.
	(acquire_init_state_context): Likewise.
	(proceed_next_node): Likewise.
	(set_regs): Likewise.
	(free_fail_stack_return): Likewise.
	(check_arrival_expand_ecl): Mark DFA parameter as const.
	(check_arrival_expand_ecl_sub): Likewise.
	(check_subexp_limits): Likewise.
	(sub_epsilon_src_nodes):  Likewise.
	(add_epsilon_src_nodes):  Likewise.
	(merge_state_array): Likewise.
	(update_regs): Likewise.
	(build_trtable): Likewise.
	(sift_states_backward): Mark MCTX parameter as const.
	(build_sifted_states): Likewise.
	(update_cur_sifted_state): Likewise.
	(sift_states_mkref): Likewise.
	(check_arrival_expand_ecl): Mark eclosure as const.
	(check_dst_limits_calc_pos_1): Likewise.
	* posix/regex_internal.h (re_match_context_t): Make dfa a const
	pointer.

2005-09-06  Ulrich Drepper  <drepper@redhat.com>

	* timezone/africa: Update from tzdata2005m.
	* timezone/asia: Likewise.
	* timezone/australasia: Likewise.
	* timezone/backward: Likewise.
	* timezone/europe: Likewise.
	* timezone/northamerica: Likewise.
	* timezone/southamerica: Likewise.
	* timezone/zone.tab: Likewise.
	* timezone/zdump.c: Update from tzcode2005m.

	* posix/regexec.c (merge_state_with_log): Define dfa as const pointer.
	(transit_state_sb): Likewise.
	(transit_state_mb): Likewise.
	(sift_states_iter_mb): Likewise.
	(check_arrival_add_next_nodes): Likewise.
	(check_node_accept_bytes): Change first parameter to pointer-to-const.
	[_LIBC] (re_search_2_stub): Use mempcpy.

	* posix/regex_internal.c (re_string_reconstruct): Avoid calling
	mbrtowc for very simple UTF-8 case.

2005-09-01  Paul Eggert  <eggert@cs.ucla.edu>

	* posix/regex_internal.c (build_wcs_upper_buffer): Fix portability
	bugs in int versus size_t comparisons.

2005-09-06  Ulrich Drepper  <drepper@redhat.com>

	* posix/regex_internal.c (re_acquire_state): Make DFA pointer arg
	a pointer-to-const.
	(re_acquire_state_context): Likewise.
	* posix/regex_internal.h: Adjust prototypes.

2005-08-31  Jim Meyering  <jim@meyering.net>

	* posix/regcomp.c (search_duplicated_node): Make first pointer arg
	a pointer-to-const.
	* posix/regex_internal.c (create_ci_newstate, create_cd_newstate,
	register_state): Likewise.
	* posix/regexec.c (search_cur_bkref_entry, check_dst_limits):
	(check_dst_limits_calc_pos_1, check_dst_limits_calc_pos):
	(group_nodes_into_DFAstates): Likewise.

2005-08-31  Paul Eggert  <eggert@cs.ucla.edu>

	* posix/regexec.c (re_search_internal): Simplify update of
	rm_so and rm_eo by replacing "if (A == B) A += C - B;"
	with the equivalent of "if (A == B) A = C;".

2005-09-06  Ulrich Drepper  <drepper@redhat.com>

	* posix/regcomp.c (re_compile_internal): Change third parameter type
	to size_t.
	(init_dfa): Likewise.  Make sure that arithmetic on pat_len doesn't
	overflow.
	* posix/regex_internal.h (struct re_dfa_t): Change type of nodes_alloc
	and nodes_len to size_t.
	* posix/regex_internal.c (re_dfa_add_node): Use size_t as type for
	new_nodes_alloc.  Check for overflow.

2005-08-31  Paul Eggert  <eggert@cs.ucla.edu>

	* posix/regcomp.c (re_compile_fastmap_iter, init_dfa, init_word_char):
	(optimize_subexps, lower_subexp):
	Don't assume 1<<31 has defined behavior on hosts with 32-bit int,
	since the signed shift might overflow.  Use 1u<<31 instead.
	* posix/regex_internal.h (bitset_set, bitset_clear, bitset_contain):
	Likewise.
	* posix/regexec.c (check_dst_limits_calc_pos_1): Likewise.
	(check_subexp_matching_top): Likewise.
	* posix/regcomp.c (optimize_subexps, lower_subexp):
	Use CHAR_BIT rather than 8, for clarity.
	* posix/regexec.c (check_dst_limits_calc_pos_1):
	(check_subexp_matching_top): Likewise.
	* posix/regcomp.c (init_dfa): Make table_size unsigned, so that we
	don't have to worry about portability issues when shifting it left.
	Remove no-longer-needed test for table_size > 0.
	* posix/regcomp.c (parse_sub_exp): Do not shift more bits than there
	are in a word, as the resulting behavior is undefined.
	* posix/regexec.c (check_dst_limits_calc_pos_1): Likewise;
	in one case, a <= should have been an <, and in another case the
	whole test was missing.
	* posix/regex_internal.h (BYTE_BITS): Remove.  All uses changed to
	the standard name CHAR_BIT.

	* posix/regex_internal.h (re_sub_match_top_t): Remove unused member
	next_last_offset.
	(struct re_dfa_t): Remove unused member states_alloc.
	* posix/regcomp.c (init_dfa): Don't initialize unused members.

2005-08-25  Paul Eggert  <eggert@cs.ucla.edu>

	* posix/regexec.c (set_regs): Don't alloca with an unbounded size.

	alloca modernization/simplification for regex.
	* posix/regex.c: Remove portability cruft for alloca.  This no longer
	needs to be at the start of the file, and can be moved into
	regex_internal.h and simplified.
	* posix/regex_internal.h: Include <alloca.h>.
	(__libc_use_alloca) [!defined _LIBC]: New macro.
	* posix/regexec.c (build_trtable): Remove "#ifdef _LIBC",
	since the code now works outside glibc.

2005-09-06  Ulrich Drepper  <drepper@redhat.com>

	* include/regex.h: Remove use of _RE_ARGS.

2005-08-25  Paul Eggert  <eggert@cs.ucla.edu>

	* posix/regexec.c (find_recover_state): Change "err" to "*err".

2005-08-24  Paul Eggert  <eggert@cs.ucla.edu>

	* posix/regcomp.c (regerror): Pointer args are 'restrict',
	as per POSIX.
	* posix/regex.h (regerror): Likewise.
	* manual/pattern.texi (POSIX Regexp Compilation): Likewise.
	Similarly for regcomp and regexec.  Also, first 2 args of regexec
	and 2nd arg of regerror are const.

	* posix/regex.c: Do not include <sys/types.h>, as POSIX no longer
	requires this.  (The code never needed it.)

2005-08-20  Paul Eggert  <eggert@cs.ucla.edu>

	* posix/regexec.c (sift_states_bkref): re_node_set_insert returns
	int, not reg_errcode_t.

	* posix/regex_internal.c (calc_state_hash): Put 'inline' before type,
	since some broken compilers warn about it otherwise.

	* posix/regcomp.c (create_initial_state): Remove duplicate decl.

2005-08-20  Paul Eggert  <eggert@cs.ucla.edu>

	* posix/regex.h (_RE_ARGS): Remove.  No longer needed, since we assume
	C89 or better.  All uses removed.

2005-09-06  Ulrich Drepper  <drepper@redhat.com>

	* posix/regex.c: Prevent using C++ compilers.

2005-08-19  Paul Eggert  <eggert@cs.ucla.edu>

	* posix/regcomp.c (duplicate_node): Return new index, not an error
	code, and let the caller return REG_ESPACE if out of space.  This
	removes an uninitialied-variable warning with GCC 4.0.1, and also
	avoids taking the address of a local variable.  All callers
	changed.

2005-09-06  Ulrich Drepper  <drepper@redhat.com>

	* include/time.h (__strptime_internal): Rename parameter to avoid
	bogus compiler warning.

2005-08-19  Jim Meyering  <jim@meyering.net>

	* posix/regexec.c (proceed_next_node): Redo local variables to
	avoid GCC shadowing warnings.

2005-09-06  Ulrich Drepper  <drepper@redhat.com>

	* posix/regex_internal.c (re_acquire_state): Minor code rearrangement.
	(re_acquire_state_context): Likewise.

2005-08-19  Paul Eggert  <eggert@cs.ucla.edu>

	* posix/regex_internal.c (re_string_realloc_buffers):
	(re_node_set_insert, re_node_set_insert_last, re_dfa_add_node):
	Rename local variables to avoid GCC shadowing warnings.

2005-07-08  Eric Blake  <ebb9@byu.net>
            Paul Eggert  <eggert@cs.ucla.edu>

	* posix/regcomp.c (init_dfa): Store __btowc value in wint_t, not
	wchar_t.  Remove now-unnecessary cast.
	(build_range_exp): Likewise.

2005-08-31  Bob Wilson  <bob.wilson@acm.org>

	* sysdeps/ieee754/flt-32/e_hypotf.c (__ieee754_hypotf):  Remove the
	exponent bias from the increment value for scaling by 2^60.

2005-09-05  Alexandre Oliva  <aoliva@redhat.com>

	* configure.in: Compile source test file with -fPIC for -shared.

2005-09-04  Ulrich Drepper  <drepper@redhat.com>

	* iconv/skeleton.c: Eliminate DEFINE_DIRECTION_OBJECTS macro use,
	it wasn't used.  Remove use of from_object and to_object variable,
	replace with some constants.  Adjust users.

	* sysdeps/i386/bits/string.h: Removed.

	* stdio-common/Makefile (tests): Add tst-put-error.
	* stdio-common/tst-put-error.c: New file.
	* libio/fileops.c (_IO_new_file_xsputn): If overflow fails and no more
	data would have to be written signal error.
	* libio/oldfileops.c (_IO_old_file_xsputn): Likewise.

	* libio/fileops.c (_IO_new_file_overflow): Use NULL not 0.

2005-09-02  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-load.c (_dl_map_object_from_fd): No need to change
	protection of memory used for the last segment.

2005-08-22  Robert Millan  <robertmh@gnu.org>

	* sysdeps/mach/hurd/nfs/nfs.h: Move to ...
	* sysdeps/generic/nfs/nfs.h: ... here.

2005-09-01  Ulrich Drepper  <drepper@redhat.com>

	* libio/stdio.h: Remove __wur from ungetc, sscanf, and vsscanf.
	Add __wur to feof{,_unlocked}, ferror{,_unlocked},
	fileno{,_unlocked}, and popen.

2005-08-30  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/ieee754/flt-32/e_hypotf.c [!__STDC__]: Fix function name.

2005-08-01  Bob Wilson  <bob.wilson@acm.org>
	    Richard Sandiford  <richard@codesourcery.com>

	* sysdeps/ieee754/flt-32/e_hypotf.c (__ieee754_hypotf): Add missing
	exponent bias to the value for 2^126.

2005-08-30  Jakub Jelinek  <jakub@redhat.com>
	    Alan Modra  <amodra@bigpond.net.au>

	* elf/dl-addr.c (_dl_addr): Use DL_ADDR_SYM_MATCH macro.
	* sysdeps/generic/ldsodefs.h (DL_ADDR_SYM_MATCH): Define.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/ldsodefs.h: New file.

2005-08-23  Ulrich Drepper  <drepper@redhat.com>

	* nscd/nscd.c (main): Use error while process isn't running in the
	background, not dbg_log.
	* nscd/nscd_conf.c (nscd_parse_file): Likewise.
	Mark messages with _().  Unify testing for database name.

	* nscd/connection.c (DEFAULT_DATASIZE_PER_BUCKET): Move to nscd.h.
	(dbs): Initialize max_db_size fields.
	(nscd_init): When mapping the database, use max_db_size as the
	mapping size even if it is bigger than the file size.
	* nscd/mem.c (mempool_alloc): When resizing the file make sure the
	limit in max_db_size is not exceeded.  Don't use mremap, just
	posix_fallocate is enough (according to Linus).  Use posix_fallocate
	correctly.
	* nscd/nscd.conf: Add max-db-size parameters.
	* nscd/nscd.h (struct database_dyn): Add max_db_size field.
	Define DEFAULT_MAX_DB_SIZE and DEFAULT_DATASIZE_PER_BUCKET.
	Temporarily define TEMP_FAILURE_RETRY_VAL here.
	* nscd/nscd_conf.c (nscd_parse_file): Parse max-db-size parameter
	and add sanity checks for it.

	* nscd/aicache.c (addhstaiX): Use send with MSG_NOSIGNAL not write to
	send reply.
	* nscd/connection.c (writeall): Likewise.
	(handle_request): Likewise.
	* nscd/grpcache.c (cache_addgr): Likewise.
	* nscd/hstcache.c (cache_addhst): Likewise.
	* nscd/initgrcache.c (addinitgroupsX): Likewise.
	* nscd/nscd.c (parse_opt): Likewise.
	* nscd/nscd_stat.c (send_stats): Likewise.
	(receive_print_stats): Likewise.
	* nscd/pwdcache.c (cache_addpw): Likewise.

	* sysdeps/unix/sysv/linux/Versions: Export inotify_* syscalls.

2005-08-22  Jakub Jelinek  <jakub@redhat.com>

	* stdlib/bits/stdlib.h (mbstowcs): Divide __bos (__dst) by
	sizeof (wchar_t) rather than multiplying __len by sizeof (wchar_t).
	Pass __bos (__dst) / sizeof (wchar_t) to the *_chk routine.
	* wcsmbs/bits/wchar2.h (mbsrtowcs, mbsnrtowcs): Likewise.
	* debug/mbsnrtowcs_chk.c (__mbsnrtowcs_chk): Don't multiply
	len by sizeof (wchar_t).
	* debug/mbsrtowcs_chk.c (__mbsrtowcs_chk): Likewise.
	* debug/mbstowcs_chk.c (__mbstowcs_chk): Likewise.
	Fix type of SRC argument.  Pass &SRC rather than SRC to
	__mbsrtowcs.
	* debug/wcstombs_chk.c (__wcstombs_chk): Pass &SRC rather than SRC
	to __wcsrtombs.
	* debug/tst-chk1.c: Include assert.h.
	(do_test): Change enough array from VLA into a fixed size array.
	Assert that MB_CUR_MAX is <= sizeof (enough).  Use FAIL () macro
	instead of print error details.  Add several new tests.
	Kill some unused variable warnings.

2005-08-21  Ulrich Drepper  <drepper@redhat.com>

	* resolv/res_send.c (Aerror): Fix printing IP address.

	* resolv/res_send.c (send_vc): Pass correct sockaddr size to connect.

2005-08-19  H.J. Lu  <hongjiu.lu@intel.com>

	* sysdeps/ia64/fpu/libm_error.c (__libm_error_support): Don't abort.

2005-08-17  Robert Love  <rml@novell.com>

	* sysdeps/unix/sysv/linux/sys/inotify.h: Add IN_MOVE_SELF event.

2005-08-19  Bruno Haible  <bruno@clisp.org>

	* intl/localealias.c (read_alias_file): In case of failure, close the
	file descriptor and sort the array before returning.

2005-08-19  Ulrich Drepper  <drepper@redhat.com>

	* malloc/Makefile: Link libmemusage.so with ld.so.
	* malloc/memusage.c: Use atomic operations for all counter and size
	 computations.  Handle thread stacks.
	* sysdeps/generic/memusage.h: Define memusage_cntr_t and
	memusage_size_t.
	* sysdeps/i386/i686/memusage.h: New file.
	* include/atomic.h: Define atomic_max and atomic_min.

	* debug/tst-chk1.c: Add tests for mbstowcs and wcstombs.

2005-08-17  Paul Eggert  <eggert@cs.ucla.edu>

	[BZ #1207]
	* posix/regex.h: Remove spurious space-before-tab.  From gnulib.

2005-08-16  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/Makefile (sysdep_headers): Add
	sys/inotify.h.
	* sysdeps/unix/sysv/linux/sys/inotify.h: New file.
	* sysdeps/unix/sysv/linux/syscalls.list: Add inotify syscalls.

	* nscd/cache.c (prune_cache): Add more debug output.  Only for
	debug level 3 and higher and very verbose.

	* nscd/cache.c (prune_cache): Use stat64 not stat.
	* nscd/connections.c (nscd_init): Likewise.

2005-08-10  Sergio Gelato  <Sergio.Gelato@astro.su.se>

	[BZ #1188]
	* nis/nss_nis/nis-netgrp.c (_nss_nis_setnetgrent): Change assert check
	from (len > 0) to (len >= 0).

2005-08-16  Ulrich Drepper  <drepper@redhat.com>

	* nis/nis_xdr.c (_xdr_nis_result): Fix type of res variable.
	Reported by Thomas Schwinge.

2005-08-15  Jakub Jelinek  <jakub@redhat.com>

	* nis/nis_subr.c (nis_leaf_of_r): Handle buflen == 0 correctly.

2005-08-16  Ulrich Drepper  <drepper@redhat.com>

	* nss/getent.c (more_help): Use open_memstream instead of handling
	memory allocation ourselves.

2005-08-16  Jay Fenlason  <fenlason@redhat.com>

	* nss/getent.c (parse_options): change the -s option to support
	{database}:{search} to override /etc/resolv.conf for only the
	specified database.

2005-08-08  Ulrich Drepper  <drepper@redhat.com>

	* nscd/connections.c (main_loop_epoll): Pass NULL as event
	argument for epoll_ctl(EPOLL_CTL_DEL) calls.

	* nscd/nscd_stat.c (receive_print_stats): Really print values of
	thread number, paranoia, and restart interval the server is using.

	* argp/argp-help.c: Use _IO_vasprintf instead of vasprintf.
	* include/stdio.h: Add libc_hidden_proto for __vfprintf_chk.
	* debug/vfprintf_chk.c: Add libc_hidden_def.

2005-08-08  Roland McGrath  <roland@redhat.com>

	* argp/argp-help.c (__argp_error): __asprintf -> vasprintf.
	(__argp_failure): Likewise.

2005-08-08  Ulrich Drepper  <drepper@redhat.com>

	* nscd/cache.c (cache_add): Commit hash table and header to disk.

	* nscd/mem.c (mempool_alloc): Use posix_fallocate instead of ftruncate.
	* nscd/connections.c (nscd_init): Likewise.

2005-08-08  Jakub Jelinek  <jakub@redhat.com>

	* stdio-common/fxprintf.c: Include libioP.h.

	* posix/bits/unistd.h (confstr, getgroups, ttyname_r, gethostname,
	getdomainname): Add __NTH.
	* stdlib/bits/stdlib.h (ptsname_r, wctomb, mbstowcs, wcstombs):
	Likewise.
	(realpath): Likewise.  Use __const instead of const.  Add __restrict
	keywords.
	* socket/bits/socket2.h (recvfrom): Add __restrict keyword to __buf.
	* wcsmbs/bits/wchar2.h (wmemcpy, wmemmove, wmempcpy, wmemset,
	wcscpy, wcpcpy, wcsncpy, wcpncpy, wcscat, wcsncat, vswprintf, wcrtomb,
	mbsrtowcs, wcsrtombs, mbsnrtowcs, wcsnrtombs): Add __NTH.
	* string/bits/string3.h (__memset_ichk): Likewise.
	(__memcpy_ichk, __memmove_ichk, __mempcpy_ichk, __strcpy_ichk,
	__stpcpy_ichk, __strncpy_ichk, stpncpy, __strcat_ichk,
	__strncat_ichk): Likewise.  Use __const instead of const.
	(__stpncpy_chk): Use __const instead of const.
	(__stpncpy_alias): Use __REDIRECT_NTH instead of __REDIRECT.

2005-08-08  Ulrich Drepper  <drepper@redhat.com>
	    Jakub Jelinek  <jakub@redhat.com>

	* nscd/mem.c (BLOCK_ALIGN_LOG, BLOCK_ALIGN, BLOCK_ALIGN_M1): Move
	definitions to...
	* nscd/nscd.h (BLOCK_ALIGN_LOG, BLOCK_ALIGN, BLOCK_ALIGN_M1): ...here.
	* nscd/connections.c (usekey): New enum.
	(check_use, verify_persistent_db): New functions.
	(nscd_init): If persistent database is corrupted, unlink it and
	recreate rather than falling back to non-persistent database.
	Call verify_persistent_db.  Avoid overflows in total computation.

2005-08-08  Ulrich Drepper  <drepper@redhat.com>

	* iconvdata/utf-16.c (PREPARE_LOOP): Minor cleanups to make code
	better readable.  Avoid passing var to loop function, it's not
	necessary at all.

2005-08-07  Ulrich Drepper  <drepper@redhat.com>

	* elf/elf.h (DT_ALPHA_PLTRO): Use symbolic name in DT_ALPHA_PLTRO
	definition.

2005-08-05  Ulrich Drepper  <drepper@redhat.com>

	* timezone/checktab.awk: Update from tzcode2005k.
	* timezone/private.h: Likewise.
	* timezone/scheck.c: Likewise.
	* timezone/tzselect.ksh: Likewise.
	* timezone/zdump.c: Likewise.
	* timezone/zic.c: Likewise.
	* timezone/africa: Update from tzdata2005k.
	* timezone/antarctica: Likewise.
	* timezone/asia: Likewise.
	* timezone/australasia: Likewise.
	* timezone/europe: Likewise.
	* timezone/iso3166.tab: Likewise.
	* timezone/leapseconds: Likewise.
	* timezone/northamerica: Likewise.
	* timezone/solar87: Likewise.
	* timezone/solar88: Likewise.
	* timezone/solar89: Likewise.
	* timezone/southamerica: Likewise.
	* timezone/zone.tab: Likewise.

2005-08-05  Roland McGrath  <roland@frob.com>

	[BZ #1251]
	* mach/shortcut.awk: Ignore `weak_alias' lines.
	Reported by Alfred M. Szmidt <ams@gnu.org>.

	[BZ #1250]
	* sysdeps/mach/hurd/mig-reply.c (reply_port): Don't use ?: as lvalue.
	Reported by Alfred M. Szmidt <ams@gnu.org>.

2005-08-03  Dwayne Grant McConnell  <dgm69@us.ibm.com>

	* sysdeps/powerpc/powerpc32/Makefile (CFLAGS-initfini.s):
	Use +=, not =, to append.  Remove duplicate flags.
	* sysdeps/powerpc/powerpc64/Makefile (CFLAGS-initfini.s):
	Likewise.  Fix comments.

2005-08-01  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/sigwait.c (do_sigwait): Restart system
	call if it returned EINTR.

2005-07-31  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/x86_64/dl-machine.h (elf_machine_load_address): Move
	helper variable into .data.rel.ro.  Simplify the code.  Extend
	comment to explain prelinking.

2005-07-31  Andreas Jaeger  <aj@suse.de>

	* include/bits/syslog.h: New file.

2005-07-30  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-load.c [__WORDSIZE==64] (FILEBUF_SIZE): Adjust the value
	up.  We have more program header entries now and the note section
	was normally not loaded.

	* nis/nis_subr.c: Some minor code cleanups.

2005-07-29  Ulrich Drepper  <drepper@redhat.com>

	* misc/bits/syslog.h: New file.
	* misc/sys/syslog.h: Include <bits/syslog.h> for fortification.
	* misc/Makefile (headers): Add bits/syslog.h.
	* include/sys/syslog.h: Add __vsyslog_chk prototype and hidden_proto.
	* sysdeps/generic/syslog.c: Change vsyslog function to __vsyslog_chk.
	Call __vfprintf_chk if necessary.  Make vsyslog a wrapper.  Add
	__syslog_chk.
	* misc/Versions: Export __syslog_chk and __vsyslog_chk.

2005-07-28  Thomas Schwinge  <schwinge@nic-nac-project.de>

	[BZ #1137]
	* misc/error.c [_LIBC]: Include <stdbool.h> and <stdint.h>.

2005-07-28  Ulrich Drepper  <drepper@redhat.com>

	* nis/nis_xdr.c: Help gcc to avoid generating unnecessary wrapper
	functions.

2005-07-28  Jakub Jelinek  <jakub@redhat.com>

	* stdio-common/fxprintf.c (__fxprintf): Add INTUSE to _IO_vfprintf
	call.
	* gmon/gmon.c (write_gmon): Use __snprintf rather than snprintf.

2005-07-28  Ulrich Drepper  <drepper@redhat.com>

	* nis/nis_file.c: Rewrite the two pairs of functions into wrappers
	around a pair of new, generalized functions.  22% size reduction.

2005-07-27  Ulrich Drepper  <drepper@redhat.com>

	* nis/nis_xdr.c: Remove unnecessary cast which might hide bugs.
	Rearrange code.  This reduces the code size 10%.

2005-07-26  Jakub Jelinek  <jakub@redhat.com>

	* misc/error.c (error_tail): Fix a comment typo.

2005-07-25  Ulrich Drepper  <drepper@redhat.com>

	* po/zh_TW.po: Update from translation team.

	* debug/mbstowcs_chk.c: New file.
	* debug/wcstombs_chk.c: New file.
	* debug/Makefile (routines): Add mbstowcs_chk and wcstombs_chk.
	* debug/Versions: Add __mbstowcs_chk and __wcstombs_chk.
	* stdlib/bits/stdlib.h: Add definitions for mbstowcs and wcstombs.

	* wcsmbs/bits/wchar2.h (mbsrtowcs): Pretty printing.

2005-07-24  Ulrich Drepper  <drepper@redhat.com>

	* string/test-memset.c (test_main): Use negative byte value in
	test.

	* string/test-memset.c (do_one_test): Compare effect of call, not
	only return value.
	Add a few casts to avoid warnings.

2005-07-24  SUGIOKA Toshinobu  <sugioka@itonet.co.jp>

	* sysdeps/sh/memset.S (memset): Correct 2nd argument handling.

2005-07-24  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1125]
	* posix/Makefile (tests): Add tst-execvp4.
	* posix/tst-execvp4.c: New file.

2005-07-24  Jakub Jelinek  <jakub@redhat.com>

	[BZ #1125]
	* posix/execvp.c (execvp): Change path_malloc to
	char *, free that pointer on failure.

2005-07-24  Ulrich Drepper  <drepper@redhat.com>

	* wcsmbs/bits/wchar2.h: Use __FILE not FILE.
	* wcsmbs/Makefile: Add rules to build and run tst-wchar-h.
	* wcsmbs/tst-wchar-h.c: New file.

2005-07-22  Ulrich Drepper  <drepper@redhat.com>

	* stdio-common/fxprintf.c (__fxprintf): Define variable more local.

2005-07-22  Jakub Jelinek  <jakub@redhat.com>

	* wcsmbs/bits/wchar2.h (__vfwprintf_chk, __vwprintf_chk): Use
	__gnuc_va_list rather than _G_va_list.

2005-07-22  Roland McGrath  <roland@redhat.com>

	[BZ #869]
	* Makerules ($(objpfx)stubs): Fix last change.

2005-07-21  Roland McGrath  <roland@redhat.com>

	* nscd/Makefile ($(objpfx)nscd): Pass $(nscd-cflags) to $(LINK.o).

	* stdlib/Makefile (headers): Move bits/wchar.h to ...
	* wcsmbs/Makefile (headers): ... here.  Add bits/wchar2.h too.

2005-07-21  Jakub Jelinek  <jakub@redhat.com>

	* wcsmbs/bits/wchar2.h (swprintf): Remove format argument.
	* debug/tst-chk1.c (do_test): Add test for swprintf with format
	being the last argument.

2005-07-21  Thorsten Kukuk  <kukuk@suse.de>

	* debug/getgroups_chk.c (__getgroups_chk): Fix return value.

	* stdio-common/fxprintf.c: Include string.h.

2005-07-20  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1138]
	* sysdeps/x86_64/fpu/libm-test-ulps: Adjust expected atan2f results.
	* sysdeps/powerpc/fpu/libm-test-ulps: Likewise.
	* sysdeps/s390/fpu/libm-test-ulps: Likewise.

2005-07-20  Bob Wilson  <bob.wilson@acm.org>
            Darin Petkov  <darin@tensilica.com>

	[BZ #1138]
	* sysdeps/ieee754/flt-32/e_atan2f.c (pi_lo): Correct exponent value.

2005-07-20  Jakub Jelinek  <jakub@redhat.com>

	* include/stdio.h (__fxprintf): Remove wfmt argument.
	* stdio-common/fxprintf.c: Include assert.h, ctype.h and wchar.h.
	(__fxprintf): Remove wfmt argument, create wfmt format string on
	the fly from fmt.
	* argp/argp-fmtstream.c: Adjust all __fxprintf callers.
	* argp/argp-help.c: Likewise.
	* assert/assert-perr.c: Likewise.
	* assert/assert.c: Likewise.
	* gmon/gmon.c: Likewise.
	* inet/rcmd.c: Likewise.
	* malloc/obstack.c: Likewise.
	* misc/error.c: Likewise.
	* misc/getpass.c: Likewise.
	* posix/getopt.c: Likewise.
	* resolv/res_hconf.c: Likewise.
	* stdio-common/perror.c: Likewise.
	* stdio-common/psignal.c: Likewise.
	* stdlib/fmtmsg.c: Likewise.
	* sunrpc/auth_unix.c: Likewise.
	* sunrpc/clnt_perr.c: Likewise.
	* sunrpc/clnt_tcp.c: Likewise.
	* sunrpc/clnt_udp.c: Likewise.
	* sunrpc/clnt_unix.c: Likewise.
	* sunrpc/svc_simple.c: Likewise.
	* sunrpc/svc_tcp.c: Likewise.
	* sunrpc/svc_udp.c: Likewise.
	* sunrpc/svc_unix.c: Likewise.
	* sunrpc/xdr.c: Likewise.
	* sunrpc/xdr_array.c: Likewise.
	* sunrpc/xdr_rec.c: Likewise.
	* sunrpc/xdr_ref.c: Likewise.
	* sysdeps/generic/wordexp.c: Likewise.

2005-07-20  Ulrich Drepper  <drepper@redhat.com>

	* wcsmbs/bits/wchar2.h: Add definitions for wcrtomb, mbsrtowcs,
	wcsrtombs, mbsnrtowcs, and wcsnrtombs.
	* debug/Makefile (routines): Add wcrtomb_chk, mbsrtowcs_chk,
	wcsrtombs_chk, mbsnrtowcs_chk, and wcsnrtombs_chk.
	* debug/Versions: Add __wcrtomb_chk, __mbsrtowcs_chk,
	__wcsrtombs_chk, __mbsnrtowcs_chk, and __wcsnrtombs_chk.
	* debug/tst-chk1.c: Add tests for new functions.
	* debug/mbsnrtowcs_chk.c: New file.
	* debug/mbsrtowcs_chk.c: New file.
	* debug/wcrtomb_chk.c: New file.
	* debug/wcsnrtombs_chk.c: New file.
	* debug/wcsrtombs_chk.c: New file.

2005-07-19  Ulrich Drepper  <drepper@redhat.com>

	* stdio-common/Makefile (aux): Add fxprintf.
	* stdio-common/fxprintf.c: New file.
	* include/stdio.h: Add declaration for __fxprintf.
	* argp/argp-fmtstream.c: Use __fxprintf instead of inline stream
	orientation test and two separate function calls.
	* argp/argp-help.c: Likewise.
	* assert/assert-perr.c: Likewise.
	* assert/assert.c: Likewise.
	* gmon/gmon.c: Likewise.
	* inet/rcmd.c: Likewise.
	* malloc/obstack.c: Likewise.
	* misc/error.c: Likewise.
	* misc/getpass.c: Likewise.
	* posix/getopt.c: Likewise.
	* resolv/res_hconf.c: Likewise.
	* stdio-common/perror.c: Likewise.
	* stdio-common/psignal.c: Likewise.
	* stdlib/fmtmsg.c: Likewise.
	* sunrpc/auth_unix.c: Likewise.
	* sunrpc/clnt_perr.c: Likewise.
	* sunrpc/clnt_tcp.c: Likewise.
	* sunrpc/clnt_udp.c: Likewise.
	* sunrpc/clnt_unix.c: Likewise.
	* sunrpc/svc_simple.c: Likewise.
	* sunrpc/svc_tcp.c: Likewise.
	* sunrpc/svc_udp.c: Likewise.
	* sunrpc/svc_unix.c: Likewise.
	* sunrpc/xdr.c: Likewise.
	* sunrpc/xdr_array.c: Likewise.
	* sunrpc/xdr_rec.c: Likewise.
	* sunrpc/xdr_ref.c: Likewise.
	* sysdeps/generic/wordexp.c: Likewise.

	[BZ #1137]
	* misc/Makefile: Add rules to build and run tst-error1.
	* misc/tst-error1.c: New file.
	* misc/error.c: Fix memory leak and possibly endless loop.

	* configure.in: Check for -fstack-protector gcc option.
	* config.make.in (have-ssp): Add template.
	* nscd/Makefile (nscd-cflags): Add -fstack-protector if supported.

	* nscd/nscd.c (main): Don't ignore result of chdir call.

2005-07-18  Roland McGrath  <roland@redhat.com>

	[BZ #869]
	* Makerules ($(objpfx)stubs): Do cd into $(objdir) to reduce size of
	objdump command line.

2005-07-18  Ulrich Drepper  <drepper@redhat.com>

	* nscd/Makefile (nscd-cflags): Add _FORTIFY_SOURCE.

	* nscd/connections.c: Fix a few wur warnings.

	[BZ #1113]
	* nscd/grpcache.c (cache_addgr): Use correct maximum for group ID
	length.  Patch by Ivan Gyurdiev <ivg2@cornell.edu>.

	* debug/confstr_chk.c: New file.
	* debug/getdomainname_chk.c: New file.
	* debug/getgroups_chk.c: New file.
	* debug/gethostname_chk.c: New file.
	* debug/getlogin_r_chk.c: New file.
	* debug/ttyname_r_chk.c: New file.
	* posix/bits/unistd.h: Add definitions for new debug versions.
	* debug/tst-chk1.c: Add tests for new functions.
	* debug/Versions: Export new functions.
	* debug/Makefile (routines): Add new files.

	* stdlib/bits/stdlib.h: Fix typo.

2005-07-13  Thorsten Kukuk  <kukuk@suse.de>

	* manual/Makefile (libc/index.html): Depend on dir-add.texi.

2005-07-15  Ulrich Drepper  <drepper@redhat.com>

	* stdlib/bits/stdlib.h: Use __REDIRECT_NTH instead of __REDIRECT
	where necessary.
	* wcsmbs/bits/wchar2.h: Likewise.

2005-07-15  Andreas Jaeger  <aj@suse.de>

	* debug/Makefile (tst-lfschk3-ENV): New, set locale.
	(tst-lfschk2-ENV): New.
	(tst-lfschk1-ENV): New.
	(tst-chk3-ENV): New.
	(tst-chk2-ENV): New.
	(tst-chk1-ENV): New.

	[BZ #1079]
	* include/stdlib.h: Remove malloc attribute from __posix_memalign.
	* stdlib/stdlib.h: Likewise.

2005-07-15  Ulrich Drepper  <drepper@redhat.com>

	* wcsmbs/bits/wchar2.h: New file.
	* include/bits/wchar2.h: New file.
	* wcsmbs/wchar.h: Include <bits/wchar2.h> if fortification is
	requested.
	* wcsmbs/wcsncpy.c: Add __wcsncpy alias.
	* string/bits/string3.h: Add fortified stpncpy definitions.
	* sysdeps/generic/stpncpy_chk.c: New file.
	* libio/vswprintf.c: Move _IO_wstrnfile definition to strfile.h.
	Export _IO_wstrn_jumps.
	* libio/strfile.h: Define _IO_wstrnfile and declare _IO_wstrn_jumps.
	* include/wchar.h: Declare __wcsncpy and __vswprintf_chk.
	* debug/fgetws_chk.c: New file.
	* debug/fgetws_u_chk.c: New file.
	* debug/fwprintf_chk.c: New file.
	* debug/swprintf_chk.c: New file.
	* debug/vfwprintf_chk.c: New file.
	* debug/vswprintf_chk.c: New file.
	* debug/vwprintf_chk.c: New file.
	* debug/wcpcpy_chk.c: New file.
	* debug/wcpncpy_chk.c: New file.
	* debug/wcscat_chk.c: New file.
	* debug/wcscpy_chk.c: New file.
	* debug/wcsncat_chk.c: New file.
	* debug/wcsncpy_chk.c: New file.
	* debug/wmemcpy_chk.c: New file.
	* debug/wmemmove_chk.c: New file.
	* debug/wmempcpy_chk.c: New file.
	* debug/wmemset_chk.c: New file.
	* debug/wprintf_chk.c: New file.
	* debug/tst-chk1.c: Add tests for new functions.
	* debug/Versions: Export new functions.
	* debug/Makefile (routines): Add new functions.

2005-07-13  Ulrich Drepper  <drepper@redhat.com>

	* nscd/nscd_helper.c: Add a few __builtin_expect.

	[BZ #1080]
	* nscd/connections.c (send_ro_fd): Make sure BUF is aligned correctly.
	* nscd/nscd_helper.c (wait_on_socket): New function.
	(get_mapping): Use wait_on_socket instead of poll.  The former handles
	EINTR of poll correctly.
	(__nscd_open_socket): Likewise.
	(get_mapping): Make sure BUF is aligned correctly.
	(get_mapping): Use munmap on correct pointer.

2005-07-12  Ulrich Drepper  <drepper@redhat.com>

	* include/libc-symbols.h: Define macros for librt hidden symbols.
	* include/time.h: Add librt_hidden_proto definition for clock_gettime.
	* sysdeps/generic/clock_gettime.c: Add librt_hidden_def.
	* sysdeps/unix/clock_gettime.c: Likewise.

	* stdlib/bits/stdlib.h: New file.
	* stdlib/stdlib.h: Include <bits/stdlib.h> if fortification is
	requested.
	* Makefile (headers): Add bits/stdlib.h.
	* include/bits/stdlib.h: New file.
	* debug/Depend: New file.
	* debug/ptsname_r_chk.c: New file.
	* debug/realpath_chk.c: New file.
	* debug/wctomb_chk.c: New file.
	* debug/Makefile (routines): Add ptsname_r_chk, realpath_chk, and
	wctomb_chk.
	* debug/Versions: Export __ptsname_r_chk, __realpath_chk, and
	__wctomb_chk.
	* debug/tst-chk1.c: Add tests for __ptsname_r_chk, __realpath_chk, and
	__wctomb_chk.

2005-07-12  Jakub Jelinek  <jakub@redhat.com>

	[BZ #1106]
	* sysdeps/unix/sysv/linux/ia64/has_cpuclock.c: Include not-cancel.h.
	(has_cpuclock): Use open_not_cancel_2 instead of open, read_not_cancel
	instead of read and close_not_cancel_no_status instead of close.

	[BZ #1106]
	* sysdeps/s390/s390-64/bcopy.S (__bcopy): Use
	HIDDEN_BUILTIN_JUMPTARGET to jump to memmove.

2005-06-27  Carlos O'Donell  <carlos@systemhalted.org>

	* posix/regcomp.c (re_compile_internal): Call __libc_lock_init
	after init_dfa.

2005-07-08  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/x86_64/fpu/s_sincosl.S: Use retq not ret.  Remove
	alignment.
	* sysdeps/x86_64/fpu/s_sincos.S: New file.

	* include/fenv.h: Add libm_hidden_proto for fesetround and
	feholdexcept.
	* sysdeps/alpha/fpu/feholdexcpt.c: Add libm_hidden_def.
	* sysdeps/alpha/fpu/fesetround.c: Likewise.
	* sysdeps/generic/feholdexcpt.c: Likewise.
	* sysdeps/generic/fesetround.c: Likewise.
	* sysdeps/i386/fpu/feholdexcpt.c: Likewise.
	* sysdeps/i386/fpu/fesetround.c: Likewise.
	* sysdeps/ia64/fpu/feholdexcpt.c: Likewise.
	* sysdeps/ia64/fpu/fesetround.c: Likewise.
	* sysdeps/powerpc/fpu/feholdexcpt.c: Likewise.
	* sysdeps/powerpc/fpu/fesetround.c: Likewise.
	* sysdeps/s390/fpu/feholdexcpt.c: Likewise.
	* sysdeps/s390/fpu/fesetround.c: Likewise.
	* sysdeps/sh/sh4/fpu/feholdexcpt.c: Likewise.
	* sysdeps/sh/sh4/fpu/fesetround.c: Likewise.
	* sysdeps/sparc/fpu/feholdexcpt.c: Likewise.
	* sysdeps/sparc/fpu/fesetround.c: Likewise.
	* sysdeps/x86_64/fpu/feholdexcpt.c: Likewise.
	* sysdeps/x86_64/fpu/fesetround.c: Likewise.
	* sysdeps/generic/s_significand.c (__significand): Use __ilogb not
	ilogb.
	* sysdeps/generic/s_significandf.c (__significandf): Use __ilogbf
	not ilogbf.
	* sysdeps/ieee754/dbl-64/s_sincos.c (__sincos): Use __sin and
	__cos, not sin and cos.

2005-07-07  Ulrich Drepper  <drepper@redhat.com>

	* resolv/res_send.c (send_dg): Recognize referral results and
	treat them as server errors.
	Based on a patch by Jason Vas Dias <jvdias@redhat.com>.

2005-07-08  Carlos O'Donell  <carlos@systemhalted.org>

	* sysdeps/hppa/setjmp.S (__sigsetjmp): Use %r1 not %r19.

	* sysdeps/hppa/add_n.s (__mpn_add_n): Use sr0 or r0, not 0.
	* sysdeps/hppa/lshift.s (__mpn_lshift): Likewise.
	* sysdeps/hppa/rshift.s (__mpn_rshift): Likewise.
	* sysdeps/hppa/sub_n.s (__mpn_sub_n): Likewise.
	* sysdeps/hppa/udiv_qrnnd.s (__udiv_qrnnd): Likewise.
	* sysdeps/hppa/hppa1.1/udiv_qrnnd.s (__udiv_qrnnd): Likewise.

2005-07-07  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/generic/s_ctanh.c (__ctanh): Handle case of zero den better.
	* sysdeps/generic/s_ctanhf.c (__ctanhf): Likewise.
	* sysdeps/generic/s_ctanhl.c (__ctanhl): Likewise.
	* sysdeps/generic/s_ctan.c (__ctan): Likewise.
	* sysdeps/generic/s_ctanf.c (__ctanf): Likewise.
	* sysdeps/generic/s_ctanl.c (__ctanl): Likewise.

2005-04-13  H.J. Lu  <hongjiu.lu@intel.com>

	[BZ #974]
	* csu/elf-init.c (__preinit_array_start): Take int, char **, char **.
	(__preinit_array_end): Likewise.
	(__init_array_start): Likewise.
	(__init_array_end): Likewise.
	(__libc_csu_init): Take int argc, char **argv, char **envp.
	Call preinit_array and init_array with argc, argv, envp.
	* sysdeps/generic/libc-start.c (LIBC_START_MAIN): Remove
	INIT_MAIN_ARGS.
	* sysdeps/powerpc/elf/libc-start.c (INIT_MAIN_ARGS): Removed.
	* elf/Makefile (distribute): Add tst-array5.c, tst-array5-static.c,
	tst-array5dep.c, and tst-array5.exp.
	(tests): Add tst-array5.
	(tests-static): Add tst-array5-static.
	($(objpfx)tst-array5): New target.
	($(objpfx)tst-array5.out): Likewise.
	($(objpfx)tst-array5-static.out): Likewise.
	* elf/tst-array5-static.c: New file.
	* elf/tst-array5-static.exp: Likewise.
	* elf/tst-array5.c: Likewise.
	* elf/tst-array5.exp: Likewise.
	* elf/tst-array5dep.c: Likewise.

2005-07-07  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/bits/sched.h: Adjust clone prototype.

2005-07-05  Jakub Jelinek  <jakub@redhat.com>

	* elf/stackguard-macros.h (STACK_CHK_GUARD): Fix s390/s390x definition.
	Reported by Ulrich Weigand <uweigand@de.ibm.com>.

	* elf/stackguard-macros.h (STACK_CHK_GUARD): Add ia64 definition.

2005-07-06  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-error.c (_dl_signal_error): When testing for executable
	being relocated, take into account that nothing might even be loaded.

	* elf/dl-reloc.c [PROF] (_dl_relocate_object): Define
	consider_profiling always to zero.  Don't count of compiler to
	remove unreached if block.
	* sysdeps/x86_64/dl-trampoline.S [PROF] (_dl_runtime_profile):
	Don't compile.
	* sysdeps/i386/dl-trampoline.S [PROF] (_dl_runtime_profile): Likewise.
	* sysdeps/ia64/dl-trampoline.S [PROF] (_dl_runtime_profile): Likewise.
	* sysdeps/s390/s390-64/dl-trampoline.S [PROF] (_dl_runtime_profile):
	Likewise.
	* sysdeps/s390/s390-32/dl-trampoline.S [PROF] (_dl_runtime_profile):
	Likewise.
	* sysdeps/powerpc/powerpc64/dl-trampoline.S [PROF]
	(_dl_profile_resolve): Likewise.
	* sysdeps/powerpc/powerpc32/dl-trampoline.S [PROF]
	(_dl_profile_resolve): Likewise.
	* gmon/Makefile: Add rules to build and run tst-profile-static.
	* gmon/tst-profile-static.c: New file.
	* Makeconfig (+link-static): Allow passing program-specific flags.

2005-07-05  Thorsten Kukuk  <kukuk@suse.de>

	[BZ #1111]
	* nis/nss_compat/compat-grp.c (internal_getgrgid_r): Check if NSS
	module provides getgrgid_r.
	(getgrnam_plusgroup): Preserve original return value.
	* nis/nss_compat/compat-pwd.c (getpwnam_plususer): Preserve
	original return value.
	* nis/nss_compat/compat-spwd.c (getspnam_plususer): Likewise.

2005-07-05  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1101]
	* posix/regex_internal.c (build_wcs_buffer): Use MB_LEN_MAX not
	MB_CUR_MAX.
	(build_wcs_upper_buffer): Likewise.

	* csu/elf-init.c (__libc_csu_fini): Pretty printing.

2005-07-02  Roland McGrath  <roland@redhat.com>

	* NEWS: Note LinuxThreads removal.
	* manual/install.texi (Installation): Don't mention linuxthreads.
	(Configuring and compiling): Don't use linuxthreads as example.

	* sysdeps/unix/sysv/linux/configure.in: Check for nptl add-on only,
	not linuxthreads.
	* sysdeps/unix/sysv/linux/configure: Regenerated.
	* resolv/Depend: Add nptl.
	* rt/Depend: Likewise.

	* linuxthreads, linuxthreads_db: Directories removed (preserved in
	ports repository).

2005-06-27  Jakub Jelinek  <jj@ultra.linux.cz>

	[BZ #1037]
	* sysdeps/unix/sysv/linux/sparc/sparc32/Makefile: -mv8 is deprecated,
	use -mcpu=v8.

2005-06-16  Jakub Jelinek  <jakub@redhat.com>

	[BZ #1016]
	* sysdeps/ia64/strlen.S (strlen): Change l2 into a local label.

2005-06-23  Thorsten Kukuk  <kukuk@suse.de>

	[BZ #1109]
	* nscd/nscd_stat.c (receive_print_stats): Replace YESSTR/NOSTR
	with own translation.

2005-06-25  Jakub Jelinek  <jakub@redhat.com>

	[BZ #1097]
	* sunrpc/xdr.c (xdr_hyper, xdr_u_hyper): When decoding, cast
	t2 to uint32_t instead of ulong.
	* sunrpc/Makefile (tests): Add tst-xdrmem.
	* sunrpc/tst-xdrmem.c: New test.

	* Versions.def (ld): Add GLIBC_2.4.
	* configure.in: Add --enable-stackguard-randomization option.
	(ENABLE_STACKGUARD_RANDOMIZE): New define.
	* config.h.in (ENABLE_STACKGUARD_RANDOMIZE): Add.
	* sysdeps/unix/sysv/linux/dl-osinfo.h: Include stdint.h.
	(_dl_setup_stack_chk_guard): New inline function.
	* sysdeps/generic/dl-osinfo.h: Include stdint.h.
	(_dl_setup_stack_chk_guard): New inline function.
	* elf/rtld.c (__stack_chk_guard): New variable.
	(dl_main): Remove all traces of TLS_INIT_TP_EXPENSIVE.
	Set __stack_chk_guard to _dl_setup_stack_chk_guard (),
	use THREAD_SET_STACK_GUARD if defined.
	* elf/Versions (ld): Export __stack_chk_guard@@GLIBC_2.4.
	* sysdeps/generic/libc-start.c (__stack_chk_guard): New variable.
	(__libc_start_main): Set __stack_chk_guard to
	_dl_setup_stack_chk_guard (), use THREAD_SET_STACK_GUARD if defined.
	* sysdeps/generic/libc-tls.c (__libc_setup_tls): Remove all
	traces of TLS_INIT_TP_EXPENSIVE.
	* debug/Versions (libc): Export __stack_chk_fail@@GLIBC_2.4.
	* debug/Makefile (routines): Add stack_chk_fail.
	(static-only-routines): Add stack_chk_fail_local.
	* debug/stack_chk_fail_local.c: New file.
	* debug/stack_chk_fail.c: New file.
	* elf/Makefile: Add rules to build and run tst-stackguard1{,-static}
	tests.
	* elf/tst-stackguard1.c: New file.
	* elf/tst-stackguard1-static.c: New file.
	* elf/stackguard-macros.h: New file.

2005-06-21  Ulrich Drepper  <drepper@redhat.com>

	* resource/Makefile (tests): Add tst-getrlimit.
	* resource/tst-getrlimit.c: New file.

	* sysdeps/unix/sysv/linux/bits/resource.h (RLIMIT_RTPRIO): Fix typo.
	* sysdeps/unix/sysv/linux/alpha/bits/resource.h: Likewise.
	* sysdeps/unix/sysv/linux/sparc/bits/resource.h: Likewise.

2005-06-20  Ulrich Drepper  <drepper@redhat.com>

	* nscd/nscd.init: Get more in line with lsb3.
	* nscd/nscd.c: Adjust some error codes to fit in better with lsb3.
	* nscd/connections.c: Likewise.

2005-06-20  Jakub Jelinek  <jakub@redhat.com>

	[BZ #653]
	* sysdeps/unix/sysv/linux/sys/quota.h: Add definitions and types for
	_LINUX_QUOTA_VERSION >= 2.
	(_LINUX_QUOTA_VERSION): Define if not yet defined.

	* sysdeps/unix/sysv/linux/bits/resource.h (RLIMIT_NICE,
	RLIMIT_RTPRIO): Add.
	(RLIMIT_NLIMITS): Adjust.
	* sysdeps/unix/sysv/linux/alpha/bits/resource.h (RLIMIT_NICE,
	RLIMIT_RTPRIO): Add.
	(RLIMIT_NLIMITS): Adjust.
	* sysdeps/unix/sysv/linux/mips/bits/resource.h (RLIMIT_NICE,
	RLIMIT_RTPRIO): Add.
	(RLIMIT_NLIMITS): Adjust.
	* sysdeps/unix/sysv/linux/sparc/bits/resource.h (RLIMIT_NICE,
	RLIMIT_RTPRIO): Add.
	(RLIMIT_NLIMITS): Adjust.

2005-06-17  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1106]
	* time/mktime.c: Always include <string.h> for prototype of
	implicitly used memcpy.

	[BZ #1104]
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/truncate64.c
	(truncate64): Use __truncate, not truncate.
	(__have_no_truncate64): Renamed from have_no_truncate64.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/ftruncate64.c
	(__have_no_truncate64): Renamed from have_no_truncate64.

	* sysdeps/powerpc/fpu/libm-test-ulps: Adjust ulps for complex
	float functions for gcc 4.

2005-06-10  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/powerpc/powerpc32/dl-machine.h (elf_machine_runtime_setup):
	Handle prelinked libraries and binaries with new style PLT.

2005-06-07  Jakub Jelinek  <jakub@redhat.com>

	* elf/elf.h (R_PPC_REL16, R_PPC_REL16_LO, R_PPC_REL16_HI,
	R_PPC_REL16_HA): Define.

2005-06-14  Alan Modra  <amodra@bigpond.net.au>

	* config.h.in (HAVE_ASM_PPC_REL16): Add.
	* elf/elf.h (DT_PPC_GOT, DT_PPC_NUM): Define.
	* elf/tls-macros.h (PowerPC32): Include config.h.  Add variants of
	TLS_IE, TLS_LD and TLS_GD for new PLT/GOT layout.
	* sysdeps/powerpc/powerpc32/configure.in: New file,
	* sysdeps/powerpc/powerpc32/dl-dtprocnum.h: New file.
	* sysdeps/powerpc/powerpc32/dl-machine.h (DT_PPC): Define.
	(ppc_got): New inline function.
	(elf_machine_dynamic): Use ppc_got.  Add attribute const.
	(elf_machine_load_address): Add attribute const.  Don't use int vars.
	Use bcl rather than bl to save trashing branch target stack.  Use
	elf_machine_dynamic rather than duplicating code here.
	(elf_machine_runtime_setup): New inline function replacing define.
	Handle new PLT.
	(elf_machine_fixup_plt): Handle new PLT.
	(elf_machine_rela): Likewise.
	* sysdeps/powerpc/powerpc32/sysdep.h: Include config.h.
	(CALL_MCOUNT): Don't set up counter vars.
	* sysdeps/powerpc/powerpc32/ppc-mcount.S: Correct comment.
	* sysdeps/powerpc/powerpc32/elf/start.S (start_addressesp): Don't
	define when HAVE_ASM_PPC_REL16.
	(_start): Add HAVE_ASM_PPC_REL16 code.
	* sysdeps/powerpc/powerpc32/dl-start.S (_dl_start_user): Don't bl
	into the GOT when HAVE_ASM_PPC_REL16.
	* sysdeps/powerpc/powerpc32/memset.S (memset): Likewise.
	* sysdeps/powerpc/powerpc32/fpu/__longjmp-common.S (__longjmp): Ditto.
	* sysdeps/powerpc/powerpc32/fpu/s_ceil.S (__ceil): Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_ceilf.S (__ceilf): Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_floor.S (__floor): Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_floorf.S (__floorf): Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_lround.S (__lround): Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_rint.S (__rint): Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_rintf.S (__rintf): Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_round.S (__round): Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_roundf.S (__roundf): Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_trunc.S (__trunc): Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_truncf.S (__truncf): Likewise.
	* sysdeps/powerpc/powerpc32/fpu/setjmp-common.S (__sigsetjmp):
	Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/brk.S (__brk): Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/getcontext.S
	(__getcontext): Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/setcontext.S
	(__setcontext): Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/swapcontext.S
	(__swapcontext): Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/socket.S (stackblock):
	Comment.
	(__socket): Bomb if NARGS >= 7.  Invoke CGOTSETUP and CGOTRESTORE.

2005-06-17  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1106]
	* sysdeps/posix/sigignore.c: Include <string.h> to tell the compiler
	to use __GI_memset.
	* sysdeps/posix/signal.c: Likewise.
	* sysdeps/posix/sigset.c: Likewise.
	* sysdeps/posix/sysv_signal.c: Likewise.
	* sysdeps/unix/sysv/linux/sleep.c: Likewise.
	* sysdeps/unix/sysv/linux/sysctl.c: Likewise.
	* sysdeps/unix/sysv/linux/system.c: Likewise.

2005-06-15  Jakub Jelinek  <jakub@redhat.com>

	[BZ #1088]
	* hesiod/hesiod.c (hesiod_init): Don't check for ctx->classes[0] == 0
	or both classes equal here.
	(parse_config_file): If both classes are equal, clear the second one.

2005-06-08  Karl Kelley  <kekelley@iastate.edu>

	[BZ #1088]
	* hesiod/hesiod_p.h (struct hesiod_p): Add classes array.
	* hesiod/hesiod.c (hesiod_init): Initialize classes.  Fail if no
	valid classes were given or if both are equal.
	(hesiod_resolve): Use ctx->classes instead of hardcoded C_IN
	and C_HS order.
	(parse_config_file): Handle classes keyword.
	* hesiod/README.hesiod: Mention addition of the classes keyword.

2005-06-14  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1085]
	* configure.in: Add test for availability of libaudit.
	* config.h.in: Define HAVE_LIBAUDIT.
	* config.make.in: Define have-libaudit.
	* nscd/Makefile: If libaudit is available, link nscd with it.
	* nscd/selinux.c: If HAVE_LIBAUDIT is defined, log using libaudit.
	Patch by Steve Grubb <sgrubb@redhat.com>.

	* debug/pread64_chk.c: Use __libc_pread64 instead of __pread64.
	* sysdeps/posix/posix_fallocate64.c: Likewise.
	* include/string.h: Use libc_hidden_proto for strnlen.
	* sysdeps/generic/strnlen.c: Add libc_hidden_def.
	* include/libintl.h: Use libc_hidden_proto for __dcgettext.
	* intl/dcgettext.c: Add libc_hidden_def.
	* include/execinfo.h: Add libc_hidden_proto for __backtrace and
	__backtrace_symbols_fd.
	* sysdeps/generic/backtrace.c: Add libc_hidden_def.
	* sysdeps/generic/backtracesymsfd.c: Likewise.
	* sysdeps/generic/elf/backtracesymsfd.c: Likewise.
	* sysdeps/i386/backtrace.c: Likewise.
	* sysdeps/ia64/backtrace.c: Likewise.
	* sysdeps/powerpc/powerpc32/backtrace.c: Likewise.
	* sysdeps/powerpc/powerpc64/backtrace.c: Likewise.
	* sysdeps/s390/s390-32/backtrace.c: Likewise.
	* sysdeps/s390/s390-64/backtrace.c: Likewise.

2005-06-13  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/clock_gettime.c (clock_gettime): Implement case
	where HANDLED_REALTIME is not defined.  [BZ #966]

2005-06-13  Jakub Jelinek  <jakub@redhat.com>

	[BZ #1096]
	* sysdeps/unix/sysv/linux/netlinkaccess.h (__netlink_sendreq,
	__netlink_receive): Remove prototypes.
	(__netlink_request): New prototype.
	* sysdeps/unix/sysv/linux/ifaddrs.c: Include <alloca.h> and
	<stdint.h>.
	(__netlink_sendreq): Make static.
	(__netlink_receive): Rename to...
	(__netlink_request): ... this.  Add type argument, call
	__netlink_sendreq.  If MSG_TRUNC is set after recvmsg, retry
	with a bigger buffer.  Don't record buffers that contain no
	messages we are expecting.
	(getifaddrs): Use __netlink_request instead of __netlink_sendreq
	and __netlink_receive pairs.  Formatting.
	* sysdeps/unix/sysv/linux/if_index.c (if_nameindex_netlink): Use
	__netlink_request instead of __netlink_sendreq and __netlink_receive
	pair.

2005-06-13  Thorsten Kukuk  <kukuk@suse.de>

	* sysdeps/unix/sysv/linux/netinet/if_tr.h: Don't include kernel
	headers, instead copy important structs/defines.

2005-06-13  Jakub Jelinek  <jakub@redhat.com>

	* elf/rtld.c (dl_main): Move DT_DEBUG setup before first
	_dl_debug_state call.

2005-06-12  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-error.c (_dl_signal_error): Store information about use of
	real malloc in the catch object.
	(_dl_catch_error): Forward information about malloc use to caller
	in new parameter.
	(_dl_out_of_memory): Make static.
	* elf/dl-deps.c: Adjust callers of _dl_catch_error.
	* elf/dl-libc.c: Likewise.
	* elf/dl-open.c: Likewise.
	* elf/rtld.c: Likewise.
	Add new --audit option.
	* sysdeps/generic/ldsodefs.h: Remove _dl_out_of_memory declaration.
	(rtld_global_ro._dl_signal_error): Add new parameter.
	* include/dlfcn.h (_dl_catch_error): Add new parameter.
	* dlfcn/dlfcn.c (_dlerror_run): Pass additional parameter to
	_dl_catch_error.  Only free if the returned newly value says so.

2005-06-01  Roland McGrath  <roland@redhat.com>

	[BZ #959]
	* posix/tst-mmap.c (main): Fill the test file with enough data for the
	page size.

2005-05-30  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/dl-osinfo.h (DL_SYSDEP_OSCHECK): If
	GLRO(dl_osversion) has been already set to a value smaller than
	_dl_discover_osversion (), don't overwrite it here.

2005-05-24  Thomas Schwinge  <schwinge@nic-nac-project.de>

	* sysdeps/mach/i386/syscall.S (syscall): Call END.

2005-05-28  Richard Henderson  <rth@redhat.com>

	* elf/elf.h (DT_ALPHA_PLTRO, DT_ALPHA_NUM): New.
	* sysdeps/alpha/dl-dtprocnum.h: New file.
	* sysdeps/alpha/dl-machine.h (DT_ALPHA): New.
	(elf_machine_load_address): Simplify to rely on gprel relocations.
	(elf_machine_runtime_setup): Handle DT_ALPHA_PLTRO plt format.
	Remove thread safety workaround for binutils 2.6.
	(elf_machine_fixup_plt): Handle DT_ALPHA_PLTRO plt format.
	* sysdeps/alpha/dl-trampoline.S (_dl_runtime_resolve_new): New.
	(_dl_runtime_profile_new): New.
	(_dl_runtime_resolve_old): Rename from _dl_runtime_resolve.
	(_dl_runtime_profile_old): Rename from _dl_runtime_profile.  Fix
	typo in _dl_call_pltexit argument loading.

	* sysdeps/alpha/div_libc.h (funcnoplt): New.
	* sysdeps/alpha/divl.S: Use it.
	* sysdeps/alpha/divq.S: Likewise
	* sysdeps/alpha/divqu.S: Likewise.
	* sysdeps/alpha/reml.S: Likewise.
	* sysdeps/alpha/remq.S: Likewise.
	* sysdeps/alpha/remqu.S: Likewise.

2005-05-26  Andreas Schwab  <schwab@suse.de>

	* locale/Makefile (CFLAGS-loadlocale.c): Don't define.

2005-05-26  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/alpha/bits/fcntl.h (O_DIRECT): Fix value.
	Reported by Colin Gibbs <colin@gibbsonline.net>.  [BZ #954]

2005-05-17  Alan Modra  <amodra@bigpond.net.au>

	* sysdeps/powerpc/powerpc32/fpu/__longjmp-common.S (__longjmp): Corrent
	_dl_hwcap access in PIC && !SHARED case.
	* sysdeps/powerpc/powerpc32/fpu/setjmp-common.S: Likewise.

2005-05-25  Dwayne Grant McConnell  <dgm69@us.ibm.com>

	* gmon/gmon.c: Add space in weak_alias use.
	* linuxthreads/sysdeps/unix/sysv/linux/mips/vfork.S: Likewise.
	* sysdeps/alpha/htonl.S: Likewise.
	* sysdeps/alpha/htons.S: Likewise.
	* sysdeps/alpha/elf/start.S: Likewise.
	* sysdeps/i386/i386-mcount.S: Likewise.
	* sysdeps/ia64/strchr.S: Likewise.
	* sysdeps/ia64/fpu/e_lgamma_r.c: Likewise.
	* sysdeps/ia64/fpu/e_lgamma_r.c: Likewise.
	* sysdeps/ia64/fpu/e_lgammaf_r.c: Likewise.
	* sysdeps/ia64/fpu/e_lgammaf_r.c: Likewise.
	* sysdeps/ia64/fpu/e_lgammal_r.c: Likewise.
	* sysdeps/ia64/fpu/e_lgammal_r.c: Likewise.
	* sysdeps/ia64/fpu/w_lgamma.c: Likewise.
	* sysdeps/ia64/fpu/w_lgamma.c: Likewise.
	* sysdeps/ia64/fpu/w_lgammaf.c: Likewise.
	* sysdeps/ia64/fpu/w_lgammaf.c: Likewise.
	* sysdeps/ia64/fpu/w_lgammal.c: Likewise.
	* sysdeps/ia64/fpu/w_lgammal.c: Likewise.
	* sysdeps/mach/hurd/readdir64_r.c: Likewise.
	* sysdeps/mach/hurd/sigaltstack.c: Likewise.
	* sysdeps/powerpc/fpu/s_fabs.S: Likewise.
	* sysdeps/powerpc/fpu/s_fabs.S: Likewise.
	* sysdeps/powerpc/fpu/s_fabs.S: Likewise.
	* sysdeps/powerpc/fpu/s_fabs.S: Likewise.
	* sysdeps/powerpc/fpu/s_fmax.S: Likewise.
	* sysdeps/powerpc/fpu/s_fmax.S: Likewise.
	* sysdeps/powerpc/fpu/s_fmax.S: Likewise.
	* sysdeps/powerpc/fpu/s_fmax.S: Likewise.
	* sysdeps/powerpc/fpu/s_fmin.S: Likewise.
	* sysdeps/powerpc/fpu/s_fmin.S: Likewise.
	* sysdeps/powerpc/fpu/s_fmin.S: Likewise.
	* sysdeps/powerpc/fpu/s_fmin.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_copysign.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_copysign.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_copysign.S: Likewise.
	* sysdeps/powerpc/powerpc64/fpu/s_copysign.S: Likewise.
	* sysdeps/powerpc/powerpc64/fpu/s_copysign.S: Likewise.
	* sysdeps/powerpc/powerpc64/fpu/s_copysign.S: Likewise.
	* sysdeps/s390/s390-32/s390-mcount.S: Likewise.
	* sysdeps/s390/s390-64/s390x-mcount.S: Likewise.
	* sysdeps/sparc/sparc32/memset.S: Likewise.
	* sysdeps/sparc/sparc32/stpcpy.S: Likewise.
	* sysdeps/sparc/sparc32/strchr.S: Likewise.
	* sysdeps/sparc/sparc32/strchr.S: Likewise.
	* sysdeps/sparc/sparc64/memcmp.S: Likewise.
	* sysdeps/sparc/sparc64/memcpy.S: Likewise.
	* sysdeps/sparc/sparc64/memcpy.S: Likewise.
	* sysdeps/sparc/sparc64/memset.S: Likewise.
	* sysdeps/sparc/sparc64/sparcv9b/memcpy.S: Likewise.
	* sysdeps/sparc/sparc64/sparcv9b/memcpy.S: Likewise.
	* sysdeps/sparc/sparc64/sparcv9b/memcpy.S: Likewise.
	* sysdeps/sparc/sparc64/sparcv9b/memcpy.S: Likewise.
	* sysdeps/sparc/sparc64/sparcv9b/memcpy.S: Likewise.
	* sysdeps/unix/sysv/linux/alpha/clone.S: Likewise.
	* sysdeps/unix/sysv/linux/alpha/getcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/alpha/getrusage.S: Likewise.
	* sysdeps/unix/sysv/linux/alpha/setcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/alpha/sigsuspend.S: Likewise.
	* sysdeps/unix/sysv/linux/alpha/swapcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/alpha/syscall.S: Likewise.
	* sysdeps/unix/sysv/linux/readdir64.c: Likewise.
	* sysdeps/unix/sysv/linux/readdir64_r.c: Likewise.
	* sysdeps/unix/sysv/linux/hppa/clone.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/getcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/makecontext.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/setcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/swapcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/ia64/getcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/ia64/setcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/mips/clone.S: Likewise.
	* sysdeps/unix/sysv/linux/mips/vfork.S: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/makecontext.S: Likewise.
	* sysdeps/unix/sysv/linux/s390/s390-32/getcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/s390/s390-32/setcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/s390/s390-32/swapcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/s390/s390-64/getcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/s390/s390-64/setcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/s390/s390-64/swapcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc32/clone.S: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc64/clone.S: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc64/getcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc64/longjmp.S: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc64/longjmp.S: Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc64/longjmp.S: Likewise.
	* sysdeps/unix/sysv/linux/wordsize-64/getdents.c: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/getcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/makecontext.c: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/setcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/swapcontext.S: Likewise.
	* sysdeps/x86_64/_mcount.S: Likewise.

2005-05-24  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/sysv/linux/i386/sysdep.h
	(SETUP_PIC_REG, LOAD_PIC_REG): Move these macros ...
	* sysdeps/i386/sysdep.h [PIC]: ... to here.

2005-05-23  Roland McGrath  <roland@redhat.com>

	* sysdeps/arm, sysdeps/unix/arm, sysdeps/unix/sysv/linux/arm:
	Subdirectories moved to ports repository.
	* configure.in (base_machine): Remove arm* and thumb* patterns.
	* shlib-versions (arm.*-.*-linux.*): Remove this pattern.

2005-05-23  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1086]
	* sunrpc/bindrsvprt.c (LOWPORT): Apparently some mountd
	implementations are broken and don't accept ports < 512.

2005-05-22  Dmitry V. Levin  <ldv@altlinux.org>

	[BZ #961]
	* io/sys/sendfile.h: Remove __nonnull from sendfile and sendfile64
	declarations.

2005-05-23  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1086]
	* sunrpc/pm_getport.c (__get_socket): New function.
	(pmap_getport): Use it to open a non-reserved socket to the portmapper
	for TCP.
	* include/rpc/pmap_clnt.h (__get_socket): Declare.
	* sunrpc/pm_getmaps.c (pmap_getmaps): Use __get_socket to get an
	non-reserved socket for the portmapper.
	Based on a patch by Steve Dickson <steved@redhat.com>.

	[BZ #1086]
	* sunrpc/bindrsvprt.c (bindresvport): Try harder to find a port.
	If we tried looking at the usual range without success extend the
	range to even lower ports.

	* sysdeps/unix/clock_gettime.c (clock_gettime): Revert last patch.

2005-05-22  Andreas Schwab  <schwab@suse.de>

	* elf/rtld.c: Include <dl-osinfo.h>.

2005-05-17  Alan Modra  <amodra@bigpond.net.au>

	* sysdeps/powerpc/powerpc32/sysdep.h (PSEUDO_RET): Don't use
	JUMPTARGET.  Instead append @local to __syscall_error.
	* sysdeps/powerpc/powerpc32/bsd-_setjmp.S: Delete all occurrences
	of JUMPTARGET.  Instead append @local to labels.
	* sysdeps/powerpc/powerpc32/bsd-setjmp.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/setjmp-common.S: Likewise.
	* sysdeps/powerpc/powerpc32/ppc-mcount.S: Likewise.
	* sysdeps/powerpc/powerpc32/setjmp-common.S: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/brk.S: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/clone.S: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/getcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/makecontext.S: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/setcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/swapcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/powerpc/powerpc32/vfork.S: Likewise.

	* sysdeps/powerpc/powerpc32/fpu/s_ceil.S: Use float constants.
	* sysdeps/powerpc/powerpc32/fpu/s_floor.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_rint.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_trunc.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_lround.S: Likewise.  Use one GOT
	slot to access both constants.
	* sysdeps/powerpc/powerpc32/fpu/s_round.S: Likewise.
	* sysdeps/powerpc/powerpc32/fpu/s_roundf.S: Likewise.

	* sysdeps/powerpc/powerpc32/fpu/s_ceil.S (TWO52.0): Delete.
	* sysdeps/powerpc/powerpc32/fpu/s_ceilf.S (TWO23.0): Delete.
	* sysdeps/powerpc/powerpc32/fpu/s_floor.S (TWO52.0): Delete.
	* sysdeps/powerpc/powerpc32/fpu/s_floorf.S (TWO23.0): Delete.
	* sysdeps/powerpc/powerpc32/fpu/s_lround.S: Comment typo.
	(NEGZERO.0, POINTFIVE.0): Delete.
	* sysdeps/powerpc/powerpc32/fpu/s_rint.S (TWO52.0): Delete.
	* sysdeps/powerpc/powerpc32/fpu/s_rintf.S (TWO23.0): Delete.
	* sysdeps/powerpc/powerpc32/fpu/s_round.S (__round): Code in .text.
	(TWO52.0, POINTFIVE.0): Delete.
	* sysdeps/powerpc/powerpc32/fpu/s_roundf.S (__roundf): Code in .text.
	(TWO23.0, POINTFIVE.0): Delete.
	* sysdeps/powerpc/powerpc32/fpu/s_trunc.S (__trunc): Code in .text.
	(TWO52.0): Delete.
	* sysdeps/powerpc/powerpc32/fpu/s_truncf.S (__truncf): Code in .text.
	(TWO23.0): Delete.
	* sysdeps/powerpc/powerpc32/memset.S (memset): Formatting.

2005-05-19  Richard Henderson  <rth@redhat.com>

	* sysdeps/unix/clock_gettime.c (clock_gettime): Fix typo around
	CLOCK_REALTIME.

	* sysdeps/ia64/bits/atomic.h (__arch_compare_and_exchange_bool_32_acq,
	__arch_compare_and_exchange_bool_64_acq,
	__arch_compare_and_exchange_val_32_acq,
	__arch_compare_and_exchange_val_64_acq, atomic_exchange_and_add):
	Use __sync builtin without _si or _di suffix.

2005-05-19  Jakub Jelinek  <jakub@redhat.com>

	[BZ #955]
	* iconvdata/ibm939.c (BODY): Avoid segfaults with input characters
	<UFFFF> and above.

2005-05-17  Andreas Schwab  <schwab@suse.de>

	* sysdeps/unix/sysv/linux/clock_getcpuclockid.c
	(clock_getcpuclockid): Always return a defined value.

2005-05-17  Neal H. Walfield  <neal@gnu.org>

	[BZ #1350]
	* sysdeps/posix/getaddrinfo.c (gaih_local): Check [_HAVE_SA_LEN]
	instead of [SALEN].
	(gaih_inet): Likewise.

2005-05-11  Ulrich Drepper  <drepper@redhat.com>

	* elf/elf.h (Elf32_auxv_t): Make cross-compile safe.
	(Elf64_auxv_t): Likewise.
	* sysdeps/generic/dl-sysdep.c (_dl_sysdep_start): Adjust for
	removal of a_ptr element in ElfXX_auxv_t.
	* elf/dl-support.c (_dl_aux_init): Likewise.

2005-05-09  Daniel Jacobowitz  <dan@codesourcery.com>

	* sysdeps/unix/sysv/linux/clock_getres.c: Include <time.h>.
	* sysdeps/unix/sysv/linux/clock_gettime.c: Likewise.

2005-05-09  Alan Modra  <amodra@bigpond.net.au>

	* sysdeps/powerpc/powerpc64/dl-machine.h (RTLD_START): Use
	.pushsection/.popsection in place of .section/.previous.

2005-05-08  Ulrich Drepper  <drepper@redhat.com>

	* MakeTAGS: Make xgettext not look into test cases.

	* MakeTAGS: Make sure translations in error calls are marked with
	c-format by xgettext.

2005-05-07  Ulrich Drepper  <drepper@redhat.com>

	* intl/libintl.h: Always use __attribute_format_arg__ for gettext
	functions since gcc sometimes forgets the attribute for the
	standard functions.

2005-05-06  Jakub Jelinek  <jakub@redhat.com>

	[BZ #934]
	* posix/regex_internal.h: Include bits/libc-lock.h or define dummy
	__libc_lock_* macros if not _LIBC.
	(struct re_dfa_t): Add lock.
	* posix/regcomp.c (re_compile_internal): Add __libc_lock_init.
	* posix/regexec.c (regexec, re_search_stub): Add locking.

2005-05-04  Jakub Jelinek  <jakub@redhat.com>

	* intl/Makefile (tst-gettext[45].out): Pass also $(run-program-prefix)
	as argument to the scripts.
	* intl/tst-gettext2.sh: Use mkdir -p instead of test -d + mkdir.
	* intl/tst-gettext4.sh: Likewise.  Use run_program_prefix argument.
	* intl/tst-gettext5.sh: Likewise.

	* intl/tst-translit.sh: Add mkdir -p.

	* sysdeps/unix/sysv/linux/i386/sysdep.h (SETUP_PIC_REG): Use
	.ifndef/.endif to allow use of this macro more than once per .S
	file.
	(LOAD_PIC_REG): New macro.
	* sysdeps/unix/sysv/linux/i386/makecontext.S: Add call frame
	information.
	* sysdeps/unix/sysv/linux/i386/getcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/vfork.S: Likewise.
	* sysdeps/i386/fpu/s_asinh.S: Use LOAD_PIC_REG macro.  Add call frame
	information.
	* sysdeps/i386/fpu/e_log10f.S: Likewise.
	* sysdeps/i386/fpu/s_expm1.S: Likewise.
	* sysdeps/i386/fpu/e_acoshf.S: Likewise.
	* sysdeps/i386/fpu/e_log2l.S: Likewise.
	* sysdeps/i386/fpu/s_log1pf.S: Likewise.
	* sysdeps/i386/fpu/s_lrint.S: Likewise.
	* sysdeps/i386/fpu/s_llrint.S: Likewise.
	* sysdeps/i386/fpu/s_ilogbf.S: Likewise.
	* sysdeps/i386/fpu/s_cbrtl.S: Likewise.
	* sysdeps/i386/fpu/s_asinhf.S: Likewise.
	* sysdeps/i386/fpu/e_log.S: Likewise.
	* sysdeps/i386/fpu/e_atanhf.S: Likewise.
	* sysdeps/i386/fpu/s_lrintl.S: Likewise.
	* sysdeps/i386/fpu/e_atanhl.S: Likewise.
	* sysdeps/i386/fpu/e_scalb.S: Likewise.
	* sysdeps/i386/fpu/s_log1p.S: Likewise.
	* sysdeps/i386/fpu/s_nearbyintl.S: Likewise.
	* sysdeps/i386/fpu/s_frexpl.S: Likewise.
	* sysdeps/i386/fpu/s_log1pl.S: Likewise.
	* sysdeps/i386/fpu/s_nearbyintf.S: Likewise.
	* sysdeps/i386/fpu/s_cbrt.S: Likewise.
	* sysdeps/i386/fpu/s_expm1l.S: Likewise.
	* sysdeps/i386/fpu/s_lrintf.S: Likewise.
	* sysdeps/i386/fpu/e_acosh.S: Likewise.
	* sysdeps/i386/fpu/s_cexp.S: Likewise.
	* sysdeps/i386/fpu/s_ilogbl.S: Likewise.
	* sysdeps/i386/fpu/s_expm1f.S: Likewise.
	* sysdeps/i386/fpu/e_powl.S: Likewise.
	* sysdeps/i386/fpu/e_powf.S: Likewise.
	* sysdeps/i386/fpu/e_scalbf.S: Likewise.
	* sysdeps/i386/fpu/e_logl.S: Likewise.
	* sysdeps/i386/fpu/e_acoshl.S: Likewise.
	* sysdeps/i386/fpu/s_frexp.S: Likewise.
	* sysdeps/i386/fpu/e_pow.S: Likewise.
	* sysdeps/i386/fpu/e_logf.S: Likewise.
	* sysdeps/i386/fpu/e_log2.S: Likewise.
	* sysdeps/i386/fpu/s_frexpf.S: Likewise.
	* sysdeps/i386/fpu/s_cexpl.S: Likewise.
	* sysdeps/i386/fpu/s_llrintf.S: Likewise.
	* sysdeps/i386/fpu/s_ilogb.S: Likewise.
	* sysdeps/i386/fpu/e_scalbl.S: Likewise.
	* sysdeps/i386/fpu/e_atanh.S: Likewise.
	* sysdeps/i386/fpu/e_log10.S: Likewise.
	* sysdeps/i386/fpu/s_cbrtf.S: Likewise.
	* sysdeps/i386/fpu/s_cexpf.S: Likewise.
	* sysdeps/i386/fpu/s_llrintl.S: Likewise.
	* sysdeps/i386/fpu/e_log10l.S: Likewise.
	* sysdeps/i386/fpu/s_nearbyint.S: Likewise.
	* sysdeps/i386/fpu/s_asinhl.S: Likewise.
	* sysdeps/i386/fpu/e_log2f.S: Likewise.
	* sysdeps/i386/addmul_1.S: Various fixes to cfi handling.
	* sysdeps/i386/mul_1.S: Likewise.
	* sysdeps/i386/strtok.S: Likewise.
	* sysdeps/i386/sub_n.S: Likewise.
	* sysdeps/i386/submul_1.S: Likewise.
	* sysdeps/i386/i586/addmul_1.S: Likewise.
	* sysdeps/i386/i586/memcpy.S: Likewise.
	* sysdeps/i386/i586/mul_1.S: Likewise.
	* sysdeps/i386/i586/rshift.S: Likewise.
	* sysdeps/i386/i586/sub_n.S: Likewise.
	* sysdeps/i386/i586/submul_1.S: Likewise.
	* sysdeps/i386/i686/memcmp.S: Likewise.
	* sysdeps/i386/i686/memmove.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/clone.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/mmap.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/mmap64.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/setcontext.S: Likewise.

2005-05-03  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/i386/add_n.S: Add call frame information.
	* sysdeps/i386/addmul_1.S: Likewise.
	* sysdeps/i386/bsd-setjmp.S: Likewise.
	* sysdeps/i386/lshift.S: Likewise.
	* sysdeps/i386/memchr.S: Likewise.
	* sysdeps/i386/memcmp.S: Likewise.
	* sysdeps/i386/mul_1.S: Likewise.
	* sysdeps/i386/rawmemchr.S: Likewise.
	* sysdeps/i386/rshift.S: Likewise.
	* sysdeps/i386/stpncpy.S: Likewise.
	* sysdeps/i386/strchr.S: Likewise.
	* sysdeps/i386/strchrnul.S: Likewise.
	* sysdeps/i386/strcspn.S: Likewise.
	* sysdeps/i386/strpbrk.S: Likewise.
	* sysdeps/i386/strrchr.S: Likewise.
	* sysdeps/i386/strspn.S: Likewise.
	* sysdeps/i386/strtok.S: Likewise.
	* sysdeps/i386/sub_n.S: Likewise.
	* sysdeps/i386/submul_1.S: Likewise.
	* sysdeps/i386/elf/bsd-setjmp.S: Likewise.
	* sysdeps/i386/i486/strcat.S: Likewise.
	* sysdeps/i386/i586/add_n.S: Likewise.
	* sysdeps/i386/i586/addmul_1.S: Likewise.
	* sysdeps/i386/i586/lshift.S: Likewise.
	* sysdeps/i386/i586/memcpy.S: Likewise.
	* sysdeps/i386/i586/memset.S: Likewise.
	* sysdeps/i386/i586/mul_1.S: Likewise.
	* sysdeps/i386/i586/rshift.S: Likewise.
	* sysdeps/i386/i586/strchr.S: Likewise.
	* sysdeps/i386/i586/strcpy.S: Likewise.
	* sysdeps/i386/i586/sub_n.S: Likewise.
	* sysdeps/i386/i586/submul_1.S: Likewise.
	* sysdeps/i386/i686/add_n.S: Likewise.
	* sysdeps/i386/i686/memcmp.S: Likewise.
	* sysdeps/i386/i686/memmove.S: Likewise.
	* sysdeps/i386/i686/mempcpy.S: Likewise.
	* sysdeps/i386/i686/memset.S: Likewise.
	* sysdeps/i386/i686/strtok.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/clone.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/mmap.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/mmap64.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/posix_fadvise64.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/semtimedop.S: Likewise.
	* sysdeps/unix/sysv/linux/i386/setcontext.S: Likewise.

	* sysdeps/i386/fpu/libm-test-ulps: Adjust for gcc 4.

	* sysdeps/unix/sysv/linux/kernel-features.h: waitid is available
	on ppc in 2.6.12.

2005-04-29  Jakub Jelinek  <jakub@redhat.com>

	[BZ #1083]
	* sysdeps/posix/posix_fallocate.c (posix_fallocate): If len == 0,
	call ftruncate if offset is bigger than current size.  Make sure
	the file is offset + len bytes long if that is more than current size.
	Don't overwrite previous content of the file.
	* sysdeps/posix/posix_fallocate64.c (__posix_fallocate64_l64):
	Likewise.

2005-05-02  Roland McGrath  <roland@redhat.com>

	[BZ #924]
	* crypt/md5.c [! HAVE_MEMCPY] (memcpy): Yield proper expression value.

2005-04-29  Roland McGrath  <roland@redhat.com>

	* timezone/africa: Update from tzdata2005i.
	* timezone/asia: Likewise.
	* timezone/northamerica: Likewise.
	* timezone/yearistype: Likewise.

	* sysdeps/i386/sysdep.h (CALL_MCOUNT): Fix typo in last change.

2005-04-29  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1093]
	* nis/nis_table.c: Fix realloc handling.
	* nis/nis_removemember.c: Likewise.

2005-04-28  Ulrich Drepper  <drepper@redhat.com>

	[BZ #798]
	* nscd/Makefile: Help losers who use --with-headers.

2005-04-28  Roland McGrath  <roland@redhat.com>

	[BZ #796]
	* sysdeps/unix/sysv/linux/dl-sysdep.h: New file.
	Define NEED_DL_SYSINFO_DSO for all platforms.

	* sysdeps/generic/dl-sysdep.h: Remove multiple inclusion protection.
	* sysdeps/alpha/dl-sysdep.h: Likewise.
	Use #include_next instead of duplicating generic file's contents.
	* sysdeps/ia64/dl-sysdep.h: Likewise.
	* sysdeps/sparc/dl-sysdep.h: Likewise.

2005-03-22  Steven Munroe  <sjmunroe@us.ibm.com>

	* sysdeps/powerpc/powerpc64/memset.S (memset): Make ___memset local.

2005-03-07  Steven Munroe  <sjmunroe@us.ibm.com>

	[BZ #781]
	* sysdeps/unix/sysv/linux/kernel-features.h
	(__ASSUME_TGKILL): Define for powerpc32/64 starting with 2.6.1.
	(__ASSUME_UTIMES): Define for powerpc32/64 starting with 2.6.1.
	(__ASSUME_FADVISE64_64_SYSCALL): Define for powerpc32 only starting
	with 2.6.1.
	(__ASSUME_WAITID_SYSCALL): Don't define for powerpc32/64.

2005-04-28  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/i386/sysdep.h: Add cfi instrumentation to asm fragments.
	* sysdeps/unix/sysv/linux/i386/sysdep.h: Likewise.
	* sysdeps/unix/sysv/linux/i386/socket.S: Remove now duplicate
	cfi_startproc and cfi_endproc.

	* configure.in: Remove ultrasparc names.

	* sysdeps/i386/i686/memcmp.S: Move misplaced END.

2005-03-27  Bruno Haible  <bruno@clisp.org>

	Make it possible for multiple threads to use gettext() in different
	locales.
	* intl/dcigettext.c (HAVE_PER_THREAD_LOCALE): New macro.
	(struct known_translation_t): If HAVE_PER_THREAD_LOCALE, add localename
	field.
	(transcmp): If HAVE_PER_THREAD_LOCALE, compare localename fields.
	(DCIGETTEXT): If HAVE_PER_THREAD_LOCALE, fill the localename field in
	search and newp.

	* intl/tst-gettext4.c: New file.
	* intl/tst-gettext4.sh: New file.
	* intl/tst-gettext4-de.po: New file.
	* intl/tst-gettext4-fr.po: New file.
	* intl/tst-gettext5.c: New file.
	* intl/tst-gettext5.sh: New file.
	* intl/Makefile (distribute): Add tst-gettext4.sh, tst-gettext4-de.po,
	tst-gettext4-fr.po, tst-gettext5.sh.
	(multithread-test-srcs): New variable.
	(test-srcs): Add its contents.
	(tests): Depend on tst-gettext4.out, tst-gettext5.out.
	(tst-gettext4.out, tst-gettext5.out): New rules.
	(CFLAGS-tst-gettext4.c, CFLAGS-tst-gettext5.c): New variables.
	Add rule for linking the multithread-test-srcs with the appropriate
	thread-library.

2005-04-28  Ulrich Drepper  <drepper@redhat.com>

	* po/rw.po: New file.  From translation team.

	* scripts/config.guess: Update from upstream.
	* scripts/config.sub: Likewise.

2005-04-27  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1094]
	* nscd/connections.c (nscd_run): Use time() value in prune_cache
	call, not timeout value, since the latter might be from another clock.

2005-04-27  Roland McGrath  <roland@redhat.com>

	[BZ #877]
	* posix/unistd.h: Remove __nonnull from acct decl.

	* rt/tst-cpuclock1.c: New file.
	* rt/tst-cpuclock2.c: New file.
	* rt/tst-cputimer1.c: New file.
	* rt/tst-cputimer2.c: New file.
	* rt/tst-cputimer3.c: New file.
	* rt/Makefile (tests): Add them.

	* sysdeps/unix/sysv/linux/kernel-posix-cpu-timers.h: New file.
	* sysdeps/unix/sysv/linux/clock_getcpuclockid.c: New file.
	* sysdeps/unix/sysv/linux/ia64/clock_getcpuclockid.c
	(HAS_CPUCLOCK): New macro.
	(clock_getcpuclockid): Function removed.
	#include the new linux file to define it instead.
	* sysdeps/unix/clock_gettime.c [HP_TIMING_AVAIL] (hp_timing_gettime):
	New function, broken out of ...
	(clock_gettime) [HP_TIMING_AVAIL]: ... here.  Call it.
	(realtime_gettime): New function, broken out of ...
	(clock_gettime) [! HANDLED_REALTIME]: ... here.  Call it.
	(clock_gettime) [SYSDEP_GETTIME_CPU]: Use new macro in default case.
	* sysdeps/unix/sysv/linux/clock_gettime.c (SYSCALL_GETTIME): New macro.
	(SYSDEP_GETTIME_CPUTIME): New macro.
	(SYSDEP_GETTIME): Use both.
	[! __ASSUME_POSIX_TIMERS] (maybe_syscall_gettime): New function, broken
	out of ...
	(SYSDEP_GETTIME): ... here.  Use it.
	[__NR_clock_gettime] (HANDLED_CPUTIME): Define it.
	(SYSDEP_GETTIME_CPUTIME): New macro.  Handle CPU timers by trying
	kernel support and falling back to hp-timing code.
	* sysdeps/posix/clock_getres.c
	[HP_TIMING_AVAIL] (hp_timing_getres): New function, broken out of ...
	(clock_getres) [HP_TIMING_AVAIL]: ... here.  Call it.
	(realtime_getres): New function, broken out of ...
	(clock_getres) [! HANDLED_REALTIME]: ... here.  Call it.
	(clock_getres) [SYSDEP_GETRES_CPU]: Use new macro in default case.
	* sysdeps/unix/sysv/linux/clock_getres.c (SYSCALL_GETRES): New macro.
	(SYSDEP_GETRES_CPUTIME): New macro.
	(SYSDEP_GETRES): Use both.
	[! __ASSUME_POSIX_TIMERS] (maybe_syscall_getres): New function, broken
	out of ...
	(SYSDEP_GETRES): ... here.  Use it.
	[__NR_clock_getres] (HANDLED_CPUTIME): Define it.
	(SYSDEP_GETRES_CPUTIME): New macro.  Handle CPU timers by trying
	kernel support and falling back to hp-timing code.
	* sysdeps/unix/sysv/linux/clock_nanosleep.c: Handle
	CLOCK_PROCESS_CPUTIME_ID and CLOCK_PROCESS_THREAD_ID specially,
	translating to the kernel clockid_t for our own process/thread clock.

2005-04-27  Ulrich Drepper  <drepper@redhat.com>

	* stdlib/test-canon.c: Make doesExist a directory and add more tests
	for the new error case.

2004-06-02  Dmitry V. Levin  <ldv@altlinux.org>
	    Ranjani Murthy <ranmur@gmail.com>

	* stdlib/canonicalize.c (__realpath): Change realpath(3) to
	return NULL and set errno to ENOTDIR for such pathnames like
	"/path/to/existing-non-directory/".

2005-04-26  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1105]
	* time/strptime_l.c (__strptime_internal): Handle 'z' to set
	tm_gmtoff.
	* time/Makefile (tests): Add tst-strptime2.
	* time/tst-strptime2.c: New file.

2005-04-26  Jakub Jelinek  <jakub@redhat.com>

	[BZ #1081]
	* elf/dl-close.c: Include stddef.h.
	(_dl_close): If called recursively, just remember GC needs to be rerun
	and decrease l_direct_opencount.  Avoid GC if l_direct_opencount
	decreased to 1.  Rerun GC at the end if any destructor unloaded some
	additional libraries.
	* elf/Makefile: Add rules to build and run unload6 test.
	* elf/unload6.c: New test.
	* elf/unload6mod1.c: New file.
	* elf/unload6mod2.c: New file.
	* elf/unload6mod3.c: New file.

	* malloc/hooks.c (mem2chunk_check): Add magic_p argument, set *magic_p
	if magic_p is not NULL.
	(top_check): Invoke MALLOC_FAILURE_ACTION if MORECORE failed.
	(malloc_check): Fail if sz == -1.
	(free_check): Adjust mem2chunk_check caller.
	(realloc_check): Likewise.  Fail if bytes == -1.  If bytes == 0 and
	oldmem != NULL, call free_check and return NULL.  If reallocating
	and returning NULL, invert magic byte again to make oldmem valid
	region for further checking.
	(memalign_check): Fail if bytes == -1.
	* malloc/Makefile: Add rules to build and run tst-mcheck.
	* malloc/tst-mcheck.c: New test.

2005-04-26  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1110]
	* stdio-common/vfscanf.c: Correctly account for characters of
	decimal points right after +-.

2005-04-26  Roland McGrath  <roland@redhat.com>

	* elf/rtld-Rules (rtld-all): Test ifndef rtld-modules instead of
	ifeq ($(subdir),elf) to distinguish main driver from subdir runs.

2005-04-25  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/sysv/linux/powerpc/powerpc64/sysdep.h
	(INTERNAL_SYSCALL_ERROR_P): Fix typo in last change.

	* sunrpc/xdr.c (xdr_u_int): Use `long' for L and cast where needed.

	* elf/dl-load.c: Revert last change.

2005-04-24  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1110]
	* stdio-common/vfscanf.c: Fix parsing of decimal point after +-.
	Patch by Hamed Malek <hamed@bamdad.org>.

2005-04-21  Roland McGrath  <roland@redhat.com>

	* elf/dl-load.c (_dl_map_object_from_fd): Don't use MAP_DENYWRITE,
	since Linux ignores it in user mmap calls.

2005-04-17  David S. Miller  <davem@davemloft.net>

	* sysdeps/sparc/sparc32/elf/start.S: Define __data_start.
	* sysdeps/sparc/sparc64/elf/start.S: Likewise.

2005-04-15  Roland McGrath  <roland@redhat.com>

	* timezone/Makefile (zic-deps): New variable.
	($(testdata)/America/New_York): Use it instead of explicit deps.
	($(testdata)/Etc/UTC, $(testdata)/Australia/Melbourne): Likewise.
	($(testdata)/America/Sao_Paulo, $(testdata)/Asia/Tokyo): Likewise.
	(%/UTC %/Universal): New pattern rule, replaces ...
	($(testdata)/UTC, $(testdata)/Universal): ... these removed targets.
	($(testdata)/%/Berlin $(testdata)/%/London): New pattern rule.
	($(testdata)/Europe/London, $(testdata)/Europe/Berlin): Removed.

2005-04-14  Roland McGrath  <roland@redhat.com>

	* MakeTAGS ($P/$(domain).pot): Depend on distinfo file as well.
	(extract): Filter-out distinfo file name.

	[BZ #253]
	* MakeTAGS (text-srcs): Match %.bash.in files too.

	[BZ #253]
	* nscd/Makefile (all-nscd-modules): New variable, include selinux
	module regardless of configuration.
	(distribute): Use that instead of $(nscd-modules).

2005-04-13  David S. Miller  <davem@davemloft.net>

	Add sparc64 TLS and NPTL support.
	* elf/tls-macros.h: Add Sparc64 defines.
	* sysdeps/sparc/sparc64/dl-machine.h (sparc64_fixup_plt): Mark as
	always_inline.
	(elf_machine_fixup_plt): Likewise.
	(elf_machine_rela): Handle TLS relocations.
	(elf_machine_type_cleaa): Likewise.
	* sysdeps/unix/sysv/linux/sparc/sparc64/sysdep.h
	(SYSCALL_ERROR_HANDLER_ENTRY): Use sethi/or for GOT reloc.
	It does not always fit in R_SPARC_GOT13 when building -fPIC.
	Also, add TLS handling.
	* sysdeps/unix/sysv/linux/configure.in (arch_minimum_kernel):
	Increase it to 2.4.21 for sparc64.
	* sysdeps/unix/sysv/linux/sparc/sparc32/clone.S: NULL terminate
	backtrace by zero'ing out %fp.  Store away flags, func_ptr,
	and func_arg in global registers not local registers.
	* sysdeps/unix/sysv/linux/sparc/sparc64/clone.S: Handle PTID, TLS,
	and CTID arguments properly.  Add RESET_PID handling.
	* sysdeps/unix/sysv/linux/sparc/sparc64/pause.c: Rework so that we
	do not invoke __sigprocmask().  We can always assume rt signals
	are present on sparc64, so just do an inline syscall.

2005-04-13  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/sparc/sparc64/dl-machine.h: Add dl_machine_h multiple
	inclusion guard for the first half of the header.
	(elf_machine_type_class, ELF_MACHINE_JMP_SLOT, ELF_MACHINE_NO_REL,
	ELF_MACHINE_PLTREL_OVERLAP, elf_machine_runtime_setup,
	elf_machine_relplt, DL_STACK_END, RTLD_START): Move into the
	#ifndef dl_machine_h guarded part of the header.

2005-04-14  Ulrich Drepper  <drepper@redhat.com>

	[BZ #851]
	* posix/execvp.c (execvp): Use file name including path when
	trying to run it with shell.
	* posix/Makefile: Add rules to build and run tst-execvp3.
	* posix/tst-execvp3.c: New file.

2005-04-12  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1090]
	* stdlib/random_r.c (__initstate_r): Don't use non-existing state.
	* string/tst-strfry.c: New file.
	* string/Makefile (tests): Add tst-strfry.

2005-04-11  James A. Morrison  <ja2morri@uwaterloo.ca>

	* manual/string.texi: Fix typo in wmemcpy decl.

2005-04-10  David S. Miller  <davem@davemloft.net>

	* sysdeps/sparc/sparc32/dl-trampoline.S: Use std not stx.

2005-04-08  Carlos O'Donell <carlos@baldric.uwo.ca>

	* FAQ.in: Explain why `make' might fail running rpcgen.
	* FAQ: Regenerated.

2005-04-07  Roland McGrath  <roland@redhat.com>

	* po/libc.pot: Regenerated.

2005-04-07  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/sysv/linux/dl-osinfo.h (_dl_discover_osversion)
	[(NEED_DL_SYSINFO || NEED_DL_SYSINFO_DSO) && SHARED]: Scan
	GLRO(dl_sysinfo_map) for PT_NOTE giving Linux kernel version,
	we can skip the uname call if it's there.
	* sysdeps/generic/dl-sysdep.c (_dl_sysdep_start): Don't use
	DL_SYSDEP_OSCHECK here.
	* elf/rtld.c (dl_main) [DL_SYSDEP_OSCHECK]: Do it here instead.

	* sysdeps/generic/ldsodefs.h (struct rtld_global_ro):
	Add _dl_sysinfo_map.
	* elf/rtld.c (dl_main): Don't call _dl_init_paths early in the
	rtld_is_main case.  Call it unconditionally later.
	Move GLRO(dl_sysinfo_dso) handling earlier, before _dl_init_paths call.
	Initialize GLRO(dl_sysinfo_map).
	* elf/dl-load.c (open_path): Bail out if _dl_init_paths wasn't called.
	* sysdeps/generic/dl-sysdep.c (_DL_FIRST_EXTRA): New macro.
	(_dl_important_hwcaps)
	[(NEED_DL_SYSINFO || NEED_DL_SYSINFO_DSO) && SHARED]: Scan
	GLRO(dl_sysinfo_map) for PT_NOTE giving synthetic hwcap names
	and bit values.
	* elf/ldconfig.c (_DL_FIRST_EXTRA): New macro.
	(hwcap_extra): New static variable.
	(is_hwcap_platform): Check hwcap_extra for a matching name.
	Remove tls special case.
	(path_hwcap): Likewise.
	(parse_conf): Parse "hwcap" directive to define synthetic hwcap bits
	and their names, stored in hwcap_extra.
	(main) [USE_TLS]: Initialize final synthetic hwcap bit as "tls".

	* sysdeps/generic/ldsodefs.h (struct rtld_global_ro): Use uint64_t for
	_dl_hwcap and _dl_hwcap_mask.
	* sysdeps/generic/dl-sysdep.c (_dl_sysdep_start): Cast a_val for
	AT_HWCAP to unsigned long int.
	* elf/dl-support.c (_dl_aux_init): Likewise.
	(_dl_hwcap): Update defn.

	* elf/cache.c (print_entry): Pad hwcap value with 0s in diagnostic.
	* elf/ldconfig.c (search_dir): Likewise.

2005-04-05  Roland McGrath  <roland@redhat.com>

	* NEWS: Copy 2.3.5 section from 2.3 branch.

	* intl/tst-codeset.sh: Use mkdir -p.  Put msgfmt output in temporary
	file and mv it into place.
	* intl/tst-gettext3.sh: Likewise.

	* Makefile (glibc-%.tar rule): Use make -q to ensure configure scripts
	are up to date in srcdir.  Touch all configure scripts after export.

	* iconv/gconv_int.h: Include <ctype.h> and <string.h>.

2005-04-05  H.J. Lu  <hongjiu.lu@intel.com>

	[BZ #592]
	* sysdeps/ia64/fpu/e_acosh.S: Update from Intel libm 2005-04-05
	(comment changes only).
	* sysdeps/ia64/fpu/e_acoshl.S: Likewise.
	* sysdeps/ia64/fpu/e_atanh.S: Likewise.
	* sysdeps/ia64/fpu/e_cosh.S: Likewise.
	* sysdeps/ia64/fpu/e_coshf.S: Likewise.
	* sysdeps/ia64/fpu/e_exp.S: Likewise.
	* sysdeps/ia64/fpu/e_exp10.S: Likewise.
	* sysdeps/ia64/fpu/e_exp10f.S: Likewise.
	* sysdeps/ia64/fpu/e_exp2.S: Likewise.
	* sysdeps/ia64/fpu/e_exp2f.S: Likewise.
	* sysdeps/ia64/fpu/e_expf.S: Likewise.
	* sysdeps/ia64/fpu/e_log.S: Likewise.
	* sysdeps/ia64/fpu/e_logf.S: Likewise.
	* sysdeps/ia64/fpu/e_pow.S: Likewise.
	* sysdeps/ia64/fpu/e_powf.S: Likewise.
	* sysdeps/ia64/fpu/e_sinh.S: Likewise.
	* sysdeps/ia64/fpu/e_sinhf.S: Likewise.
	* sysdeps/ia64/fpu/libm_error.c: Likewise.
	* sysdeps/ia64/fpu/libm_lgamma.S: Likewise.
	* sysdeps/ia64/fpu/libm_lgammaf.S: Likewise.
	* sysdeps/ia64/fpu/libm_lgammal.S: Likewise.
	* sysdeps/ia64/fpu/libm_sincos.S: Likewise.
	* sysdeps/ia64/fpu/libm_sincosf.S: Likewise.
	* sysdeps/ia64/fpu/s_asinh.S: Likewise.
	* sysdeps/ia64/fpu/s_atanl.S: Likewise.
	* sysdeps/ia64/fpu/s_cos.S: Likewise.
	* sysdeps/ia64/fpu/s_cosf.S: Likewise.
	* sysdeps/ia64/fpu/s_erf.S: Likewise.
	* sysdeps/ia64/fpu/s_erfc.S: Likewise.
	* sysdeps/ia64/fpu/s_erfcf.S: Likewise.
	* sysdeps/ia64/fpu/s_erfcl.S: Likewise.
	* sysdeps/ia64/fpu/s_erff.S: Likewise.
	* sysdeps/ia64/fpu/s_expm1.S: Likewise.
	* sysdeps/ia64/fpu/s_expm1f.S: Likewise.
	* sysdeps/ia64/fpu/s_log1p.S: Likewise.
	* sysdeps/ia64/fpu/s_tanf.S: Likewise.
	* sysdeps/ia64/fpu/s_tanh.S: Likewise.
	* sysdeps/ia64/fpu/s_tanhf.S: Likewise.
	* sysdeps/ia64/fpu/w_tgamma.S: Likewise.
	* sysdeps/ia64/fpu/w_tgammaf.S: Likewise.
	* sysdeps/ia64/fpu/w_tgammal.S: Likewise.

2005-04-05  Roland McGrath  <roland@redhat.com>

	* scripts/config.guess: Update from master, timestamp='2005-03-24'.
	* scripts/config.sub: Update from master, timestamp='2005-02-10'.

2005-04-04  David S. Miller  <davem@davemloft.net>

	* sysdeps/sparc/sparc32/dl-trampoline.S: New file.
	* sysdeps/sparc/sparc32/dl-machine.h: Move PLT trampolines there.
	Use RESOLVE_MAP instead of RESOLVE to protect relocation code.
	(elf_machine_runtime_setup): Test for dl_profile non-null.
	* sysdeps/sparc/sparc64/dl-trampoline.S: New file.
	(ARCH_LA_PLTENTER, ARCH_LA_PLTEXIT): New.
	* sysdeps/sparc/sparc64/dl-machine.h: Move PLT trampolines there.
	Use RESOLVE_MAP instead of RESOLVE to protect relocation code.
	(elf_machine_runtime_setup): Test for dl_profile non-null.
	* sysdeps/sparc/bits/link.h: New file.
	* sysdeps/generic/ldsodefs.h (La_sparc32_regs, La_sparc32_retval,
	La_sparc64_regs, La_sparc64_retval): New.
	(struct audit_ifaces): Add sparc entries.
	* elf/tst-auditmod1.c: Add sparc entries.

2005-03-27  Bruno Haible  <bruno@clisp.org>

	* intl/tst-gettext3.c: New file.
	* intl/tst-gettext3.sh: New file.
	* intl/Makefile (distribute): Add tst-gettext3.sh.
	(test-srcs): Add tst-gettext3.
	(tests): Depend on tst-gettext3.out.
	(tst-gettext3.out): New rule.
	(CFLAGS-tst-gettext3.c): New variable.

	Fix bug exposed by tst-gettext3.
	* intl/gettextP.h (struct converted_domain): New type.
	(struct loaded_domain): Remove the conv, conv_tab fields. Add
	conversions, nconversions fields.
	(_nl_init_domain_conv): Remove declaration.
	(_nl_free_domain_conv): Remove declaration.
	(_nl_find_msg): Add convert argument.
	* intl/dcigettext.c (DCIGETTEXT): Call _nl_find_msg with convert=1.
	(_nl_find_msg): Add convert argument. When a conversion to a different
	charset is needed, create a new converted_domain element, instead of
	throwing away the old converted translations.
	(get_output_charset): New function.
	* intl/loadmsgcat.c (_nl_init_domain_conv): Remove function.
	(_nl_free_domain_conv): Remove function.
	(_nl_load_domain): Initialize the conversions array to empty. Use
	_nl_find_msg instead of _nl_init_domain_conv to retrieve the header
	entry.
	(_nl_unload_domain): Free the conversions array and its contents.

	* intl/gettextP.h (struct loaded_domain): Remove codeset_cntr field.
	(struct binding): Likewise.
	* intl/bindtextdom.c (set_binding_values): Drop codeset_cntr
	modifications.

2005-04-04  Jakub Jelinek  <jakub@redhat.com>

	[BZ #1082]
	* sunrpc/pmap_rmt.c (xdr_rmtcall_args): Use a dummy arglen instead
	of trying to encode uninitialized arglen.

2005-04-04  Ulrich Drepper  <drepper@redhat.com>

	[BZ #825]
	* timezone/scheck.c: Update from tzcode2005h.
	* timezone/tzfile.h: Likewise.
	* timezone/zdump.c: Likewise.
	* timezone/zic.c: Likewise.

	[BZ #825]
	* timezone/antarctica: Update from tzdata2005h.
	* timezone/asia: Likewise.
	* timezone/australasia: Likewise.
	* timezone/etcetera: Likewise.
	* timezone/europe: Likewise.
	* timezone/northamerica: Likewise.
	* timezone/southamerica: Likewise.
	* timezone/leapseconds: Likewise.
	* timezone/iso3166.tab: Likewise.

2005-03-31  H.J. Lu  <hongjiu.lu@intel.com>

	[BZ #592]
	* sysdeps/ia64/fpu/libm_cpu_defs.h: Update copyright.

2005-04-01  Ulrich Drepper  <drepper@redhat.com>

	* wcsmbs/btowc.c (__btowc): Optimize parameters in ASCII range.
	* wcsmbs/wctob.c (wctob): Likewise.
	* wcsmbs/wchar.h (btowc): Add optimized inline function.
	(wctob): Likewise.

2005-03-31  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/x86_64/getcontext.S: Use functionally
	equivalent, but shorter instructions.
	* sysdeps/unix/sysv/linux/x86_64/sysdep.h: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/setcontext.S: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/clone.S: Likewise.
	* sysdeps/unix/sysv/linux/x86_64/swapcontext.S: Likewise.
	* sysdeps/unix/x86_64/sysdep.S: Likewise.
	* sysdeps/x86_64/strchr.S: Likewise.
	* sysdeps/x86_64/memset.S: Likewise.
	* sysdeps/x86_64/strcspn.S: Likewise.
	* sysdeps/x86_64/strcmp.S: Likewise.
	* sysdeps/x86_64/elf/start.S: Likewise.
	* sysdeps/x86_64/strspn.S: Likewise.
	* sysdeps/x86_64/dl-machine.h: Likewise.
	* sysdeps/x86_64/bsd-_setjmp.S: Likewise.
	* sysdeps/x86_64/bsd-setjmp.S: Likewise.
	* sysdeps/x86_64/strtok.S: Likewise.

2005-03-30  H.J. Lu  <hongjiu.lu@intel.com>

	[BZ #592]
	* sysdeps/ia64/fpu/e_acosf.S: Update from Intel libm 2005-03-21.
	* sysdeps/ia64/fpu/e_acoshf.S: Likewise.
	* sysdeps/ia64/fpu/e_acoshl.S: Likewise.
	* sysdeps/ia64/fpu/e_acosh.S: Likewise.
	* sysdeps/ia64/fpu/e_acosl.S: Likewise.
	* sysdeps/ia64/fpu/e_acos.S: Likewise.
	* sysdeps/ia64/fpu/e_asinf.S: Likewise.
	* sysdeps/ia64/fpu/e_asinl.S: Likewise.
	* sysdeps/ia64/fpu/e_asin.S: Likewise.
	* sysdeps/ia64/fpu/e_atan2f.S: Likewise.
	* sysdeps/ia64/fpu/e_atan2.S: Likewise.
	* sysdeps/ia64/fpu/e_atanhf.S: Likewise.
	* sysdeps/ia64/fpu/e_atanhl.S: Likewise.
	* sysdeps/ia64/fpu/e_atanh.S: Likewise.
	* sysdeps/ia64/fpu/e_coshf.S: Likewise.
	* sysdeps/ia64/fpu/e_coshl.S: Likewise.
	* sysdeps/ia64/fpu/e_cosh.S: Likewise.
	* sysdeps/ia64/fpu/e_exp10f.S: Likewise.
	* sysdeps/ia64/fpu/e_exp10l.S: Likewise.
	* sysdeps/ia64/fpu/e_exp10.S: Likewise.
	* sysdeps/ia64/fpu/e_exp2f.S: Likewise.
	* sysdeps/ia64/fpu/e_exp2l.S: Likewise.
	* sysdeps/ia64/fpu/e_exp2.S: Likewise.
	* sysdeps/ia64/fpu/e_expf.S: Likewise.
	* sysdeps/ia64/fpu/e_exp.S: Likewise.
	* sysdeps/ia64/fpu/e_fmodf.S: Likewise.
	* sysdeps/ia64/fpu/e_fmodl.S: Likewise.
	* sysdeps/ia64/fpu/e_fmod.S: Likewise.
	* sysdeps/ia64/fpu/e_hypotf.S: Likewise.
	* sysdeps/ia64/fpu/e_hypotl.S: Likewise.
	* sysdeps/ia64/fpu/e_hypot.S: Likewise.
	* sysdeps/ia64/fpu/e_lgammaf_r.c: Likewise.
	* sysdeps/ia64/fpu/e_lgammal_r.c: Likewise.
	* sysdeps/ia64/fpu/e_lgamma_r.c: Likewise.
	* sysdeps/ia64/fpu/e_log2f.S: Likewise.
	* sysdeps/ia64/fpu/e_log2l.S: Likewise.
	* sysdeps/ia64/fpu/e_log2.S: Likewise.
	* sysdeps/ia64/fpu/e_logf.S: Likewise.
	* sysdeps/ia64/fpu/e_logl.S: Likewise.
	* sysdeps/ia64/fpu/e_log.S: Likewise.
	* sysdeps/ia64/fpu/e_powf.S: Likewise.
	* sysdeps/ia64/fpu/e_powl.S: Likewise.
	* sysdeps/ia64/fpu/e_pow.S: Likewise.
	* sysdeps/ia64/fpu/e_remainderf.S: Likewise.
	* sysdeps/ia64/fpu/e_remainderl.S: Likewise.
	* sysdeps/ia64/fpu/e_remainder.S: Likewise.
	* sysdeps/ia64/fpu/e_scalbf.S: Likewise.
	* sysdeps/ia64/fpu/e_scalbl.S: Likewise.
	* sysdeps/ia64/fpu/e_scalb.S: Likewise.
	* sysdeps/ia64/fpu/e_sinhf.S: Likewise.
	* sysdeps/ia64/fpu/e_sinhl.S: Likewise.
	* sysdeps/ia64/fpu/e_sinh.S: Likewise.
	* sysdeps/ia64/fpu/e_sqrtf.S: Likewise.
	* sysdeps/ia64/fpu/e_sqrtl.S: Likewise.
	* sysdeps/ia64/fpu/e_sqrt.S: Likewise.
	* sysdeps/ia64/fpu/libm_error.c: Likewise.
	* sysdeps/ia64/fpu/libm_lgammaf.S: Likewise.
	* sysdeps/ia64/fpu/libm_lgammal.S: Likewise.
	* sysdeps/ia64/fpu/libm_lgamma.S: Likewise.
	* sysdeps/ia64/fpu/libm_scalblnf.S: Likewise.
	* sysdeps/ia64/fpu/libm_sincosf.S: Likewise.
	* sysdeps/ia64/fpu/libm_sincos_large.S: Likewise.
	* sysdeps/ia64/fpu/libm_sincosl.S: Likewise.
	* sysdeps/ia64/fpu/libm_sincos.S: Likewise.
	* sysdeps/ia64/fpu/libm_support.h: Likewise.
	* sysdeps/ia64/fpu/s_asinhl.S: Likewise.
	* sysdeps/ia64/fpu/s_asinh.S: Likewise.
	* sysdeps/ia64/fpu/s_atanf.S: Likewise.
	* sysdeps/ia64/fpu/s_atanl.S: Likewise.
	* sysdeps/ia64/fpu/s_cbrtf.S: Likewise.
	* sysdeps/ia64/fpu/s_cbrtl.S: Likewise.
	* sysdeps/ia64/fpu/s_cosf.S: Likewise.
	* sysdeps/ia64/fpu/s_cosl.S: Likewise.
	* sysdeps/ia64/fpu/s_cos.S: Likewise.
	* sysdeps/ia64/fpu/s_erfcf.S: Likewise.
	* sysdeps/ia64/fpu/s_erfcl.S: Likewise.
	* sysdeps/ia64/fpu/s_erfc.S: Likewise.
	* sysdeps/ia64/fpu/s_erfl.S: Likewise.
	* sysdeps/ia64/fpu/s_erf.S: Likewise.
	* sysdeps/ia64/fpu/s_expm1f.S: Likewise.
	* sysdeps/ia64/fpu/s_expm1l.S: Likewise.
	* sysdeps/ia64/fpu/s_expm1.S: Likewise.
	* sysdeps/ia64/fpu/s_fdimf.S: Likewise.
	* sysdeps/ia64/fpu/s_fdiml.S: Likewise.
	* sysdeps/ia64/fpu/s_fdim.S: Likewise.
	* sysdeps/ia64/fpu/s_frexp.c: Likewise.
	* sysdeps/ia64/fpu/s_frexpf.c: Likewise.
	* sysdeps/ia64/fpu/s_frexpl.c: Likewise.
	* sysdeps/ia64/fpu/s_ilogbf.S: Likewise.
	* sysdeps/ia64/fpu/s_ilogbl.S: Likewise.
	* sysdeps/ia64/fpu/s_ilogb.S: Likewise.
	* sysdeps/ia64/fpu/s_ldexp.c: Likewise.
	* sysdeps/ia64/fpu/s_ldexpf.c: Likewise.
	* sysdeps/ia64/fpu/s_ldexpl.c: Likewise.
	* sysdeps/ia64/fpu/s_libm_ldexpf.S: Likewise.
	* sysdeps/ia64/fpu/s_libm_ldexpl.S: Likewise.
	* sysdeps/ia64/fpu/s_libm_ldexp.S: Likewise.
	* sysdeps/ia64/fpu/s_libm_scalbnf.S: Likewise.
	* sysdeps/ia64/fpu/s_libm_scalbnl.S: Likewise.
	* sysdeps/ia64/fpu/s_libm_scalbn.S: Likewise.
	* sysdeps/ia64/fpu/s_log1pf.S: Likewise.
	* sysdeps/ia64/fpu/s_log1pl.S: Likewise.
	* sysdeps/ia64/fpu/s_log1p.S: Likewise.
	* sysdeps/ia64/fpu/s_logbf.S: Likewise.
	* sysdeps/ia64/fpu/s_logbl.S: Likewise.
	* sysdeps/ia64/fpu/s_logb.S: Likewise.
	* sysdeps/ia64/fpu/s_nearbyintf.S: Likewise.
	* sysdeps/ia64/fpu/s_nearbyintl.S: Likewise.
	* sysdeps/ia64/fpu/s_nearbyint.S: Likewise.
	* sysdeps/ia64/fpu/s_nextafterf.S: Likewise.
	* sysdeps/ia64/fpu/s_nextafterl.S: Likewise.
	* sysdeps/ia64/fpu/s_nextafter.S: Likewise.
	* sysdeps/ia64/fpu/s_nexttowardf.S: Likewise.
	* sysdeps/ia64/fpu/s_nexttowardl.S: Likewise.
	* sysdeps/ia64/fpu/s_nexttoward.S: Likewise.
	* sysdeps/ia64/fpu/s_roundf.S: Likewise.
	* sysdeps/ia64/fpu/s_roundl.S: Likewise.
	* sysdeps/ia64/fpu/s_round.S: Likewise.
	* sysdeps/ia64/fpu/s_scalblnf.c: Likewise.
	* sysdeps/ia64/fpu/s_scalbn.c: Likewise.
	* sysdeps/ia64/fpu/s_scalbnf.c: Likewise.
	* sysdeps/ia64/fpu/s_scalbnl.c: Likewise.
	* sysdeps/ia64/fpu/s_tanf.S: Likewise.
	* sysdeps/ia64/fpu/s_tanhl.S: Likewise.
	* sysdeps/ia64/fpu/s_tanh.S: Likewise.
	* sysdeps/ia64/fpu/s_tanl.S: Likewise.
	* sysdeps/ia64/fpu/s_tan.S: Likewise.
	* sysdeps/ia64/fpu/w_lgamma.c: Likewise.
	* sysdeps/ia64/fpu/w_lgammaf.c: Likewise.
	* sysdeps/ia64/fpu/w_lgammal.c: Likewise.
	* sysdeps/ia64/fpu/w_tgammaf.S: Likewise.
	* sysdeps/ia64/fpu/w_tgammal.S: Likewise.
	* sysdeps/ia64/fpu/w_tgamma.S: Likewise.

	[BZ #592]
	* sysdeps/ia64/fpu/libm_cpu_defs.h: New file.
	* sysdeps/ia64/fpu/libm_error_codes.h: New file.

	[BZ #592]
	* sysdeps/ia64/fpu/gen_import_file_list: Updated for Intel libm
	2005-03-21.
	* sysdeps/ia64/fpu/import_file.awk: Likewise.
	* sysdeps/ia64/fpu/import_intel_libm: Likewise.
	* sysdeps/ia64/fpu/Makefile: Likewise.

2005-03-29  Jakub Jelinek  <jakub@redhat.com>

	[BZ #1087]
	* posix/fnmatch.c (fnmatch): For short patterns or strings attempt to
	avoid calling mbsrtowcs twice.

2005-03-29  Roland McGrath  <roland@redhat.com>

	* sysdeps/unix/sysv/linux/dl-osinfo.h (_dl_discover_osversion): New
	function, inline broken out of ...
	(DL_SYSDEP_OSCHECK): ... here.  Use that.
	Do the discovery and set GLRO(dl_osversion) if successful,
	if __LINUX_KERNEL_VERSION <= 0.
	* elf/dl-load.c: Don't include dl-osinfo.h here.

2005-03-29  Alfred M. Szmidt  <ams@gnu.org>

	* manual/install.texi (Tools for Compilation): GNU binutils 2.15
	is now needed.

2005-03-19  Bruno Haible  <bruno@clisp.org>

	* intl/dcigettext.c (struct known_translation_t): Change type of
	domainname field to 'const char *'.
	(DCIGETTEXT): Remove const-cast.

2005-03-29  Thorsten Kukuk  <kukuk@suse.de>

	[BZ #661]
	* grp/initgroups.c (internal_getgrouplist): Check if we have
	enough space before adding the primary group to the list.

	* posix/tst-execle1.c (do_test): Fix execle arguments.
	* posix/tst-execle2.c (do_test): Likewise.

2005-03-28  Roland McGrath  <roland@redhat.com>

	* sysdeps/generic/w_exp2.c [NO_LONG_DOUBLE]: Fix typos in alias names.
	Reported by Mark Mitchell <mark@codesourcery.com>.
	* Versions.def (libm): Define GLIBC_2.4 set.
	* math/Versions (libm: GLIBC_2.4): Add this set, with exp2l.
	* sysdeps/i386/Versions (libm: GLIBC_2.1): Add this set, with exp2l.
	* sysdeps/ia64/Versions: Likewise.
	* sysdeps/m68k/Versions: Likewise.
	* sysdeps/sparc/sparc64/Versions: Likewise.
	* sysdeps/x86_64/Versions: New file.
	* sysdeps/mips/mips64/Versions: New file.

	* locale/langinfo.h (_NL_LOCALE_NAME): New macro.
	[__USE_GNU] (NL_LOCALE_NAME): New macro.
	* locale/nl_langinfo.c: Grok special item value for _NL_LOCALE_NAME,
	return locale name string for the category.

2005-03-25  Jakub Jelinek  <jakub@redhat.com>

	[BZ #721]
	* sysdeps/generic/wcstoul_l.c: Include "wcstol_l.c" rather than
	<wcstol_l.c>.

2005-03-28  Daniel Jacobowitz  <dan@codesourcery.com>

	* sysdeps/mips/atomicity.h: Remove unused file.
	* sysdeps/mips/dl-machine.h (elf_machine_rel): Add TLS relocations.
	* sysdeps/mips/dl-tls.h: New file.
	* sysdeps/mips/libc-tls.c: New file.
	* sysdeps/mips/tls-macros.h: New file.
	* sysdeps/mips/bits/atomic.h: New file.
	* sysdeps/mips/bits/setjmp.h: Protect against multiple inclusion.
	* sysdeps/mips/elf/configure.in: New file.
	* sysdeps/mips/elf/configure: Generated.
	* sysdeps/mips/sys/asm.h: New file.
	* sysdeps/unix/sysv/linux/mips/vfork.S: New file.
	* sysdeps/unix/sysv/linux/mips/clone.S: Add NPTL and five-argument
	clone support.
	* sysdeps/unix/sysv/linux/mips/mips32/sysdep.h
	(INTERNAL_SYSCALL_NCS): New.
	(INTERNAL_SYSCALL): Update for non-constant support.
	(internal_syscall0): Likewise.
	(internal_syscall1): Likewise.
	(internal_syscall2): Likewise.
	(internal_syscall3): Likewise.
	(internal_syscall4): Likewise.
	(internal_syscall5): Likewise.
	(internal_syscall6): Likewise.
	(internal_syscall7): Likewise.
	* sysdeps/unix/sysv/linux/mips/bits/siginfo.h (SIGEV_THREAD):
	Update to match the kernel.
	(SIGEV_CALLBACK): Likewise.
	(SIGEV_THREAD_ID): Likewise.

2005-03-28  Daniel Jacobowitz  <dan@codesourcery.com>

	[BZ #783]
	* elf/tst-auditmod1.c: Add MIPS support.
	* sysdeps/generic/ldsodefs.h (La_mips_32_regs): New.
	(La_mips_32_retval): New.
	(La_mips_64_regs): New.
	(La_mips_64_retval): New.
	(struct audit_ifaces): Add MIPS entries.
	* sysdeps/mips/dl-machine.h: Check RESOLVE_MAP instead of RESOLVE.
	(elf_machine_runtime_link_map, ELF_DL_FRAME_SIZE,
	ELF_DL_SAVE_ARG_REGS, ELF_DL_RESTORE_ARG_REGS,
	ELF_MACHINE_RUNTIME_TRAMPOLINE): Move to dl-trampoline.c.
	(RTLD_START): Align the stack before calling _dl_init_internal.
	Use .ent for _dl_start_user.
	(ARCH_LA_PLTENTER, ARCH_LA_PLTEXIT): Define.
	(elf_machine_rel, elf_machine_rel_relative, elf_machine_lazy_rel)
	(elf_machine_runtime_setup): Use "auto inline".
	(elf_machine_rela, elf_machine_rela_relative): Provide empty versions.
	(elf_machine_got_rel): Likewise.  Use RESOLVE_MAP.
	* sysdeps/mips/dl-trampoline.c: New file.
	* sysdeps/mips/bits/link.h: New file.
	* sysdeps/unix/sysv/linux/mips/mips32/sysdep.h
	(internal_syscall5): Use register operands instead of non-lvalue
	memory operands.
	(internal_syscall6): Likewise.
	(internal_syscall7): Likewise.

2005-03-27  Andreas Jaeger  <aj@suse.de>

	* debug/warning-nop.c (__builtin___memcpy_chk): Define away to
	avoid warnings with older compiler.
	(__builtin___memcpy_chk): Likewise.
	(__builtin___memmove_chk: Likewise.
	(__builtin___mempcpy_chk): Likewise.
	(__builtin___memset_chk): Likewise.
	(__builtin___stpcpy_chk): Likewise.
	(__builtin___strcat_chk): Likewise.
	(__builtin___strcpy_chk): Likewise.
	(__builtin___strncat_chk): Likewise.
	(__builtin___strncpy_chk): Likewise.
	(__builtin_object_size): Likewise.

2005-03-27  Daniel Jacobowitz  <dan@codesourcery.com>

	* elf/tls-macros.h: Correct typo.

2005-03-23  Jakub Jelinek  <jakub@redhat.com>

	[BZ #822]
	* nis/ypclnt.c (yp_2_yperr): Revert 2004-11-30 patch.
	(ypprot_err): Use yp_2_yperr table also for YP_NODOM .. YP_NOMORE.

2005-03-22  Roland McGrath  <roland@redhat.com>

	* locale/setlocale.c: Comment typo.

	* scripts/versions.awk: No errors for GLIBC_PRIVATE.

	* Versions.def (libdl, librt): Add GLIBC_2.3.4 version.

	* scripts/versions.awk: Print all errors and die at the end.
	Use library name in versions array keys.

2005-03-22  Daniel Jacobowitz  <dan@codesourcery.com>

	* elf/elf.h (PT_ARM_EXIDX): New macro.

2005-03-21  Thorsten Kukuk  <kukuk@suse.de>

	[BZ #1098]
	* sunrpc/xdr_stdio.c (xdrstdio_getlong, xdrstdio_putlong):
	Convert correctly between long/int on 64bit big-endian.

2005-03-21  David Mosberger  <davidm@hpl.hp.com>

	* sysdeps/ia64/_mcount.S: Newer kernels don't like register-frames
	with more than 8 output registers.  Fix this by passing original
	ar.pfs to _mcount_ret_helper via r3.

2005-03-15  Jakub Jelinek  <jakub@redhat.com>

	[BZ #786]
	* sysdeps/generic/dl-tls.c (_dl_next_tls_modid): Handle
	GL(dl_tls_static_nelem) == GL(dl_tls_max_dtv_idx).
	* elf/Makefile: Add rules to build and run tst-tls15.
	* elf/tst-tls15.c: New test.
	* elf/tst-tlsmod15a.c: New file.
	* elf/tst-tlsmod15b.c: New file.

2005-03-20  Ulrich Drepper  <drepper@redhat.com>

	* elf/rtld.c (dl_main): Always call init_tls if we have audit modules.

2005-03-20  Alfred M. Szmidt  <ams@gnu.org>

	* elf/dl-open.c (dl_open_worker): Fix typo.

2005-03-20  Ulrich Drepper  <drepper@redhat.com>

	* malloc/malloc.c (public_cALLOc): We cannot skip the memory
	clearing if perturb_byte != 0.

2005-03-20  Jakub Jelinek  <jakub@redhat.com>

	* posix/bits/unistd.h (pread) [__USE_FILE_OFFSET64]: Use __off64_t
	instead of __off_t for last argument.
	* debug/Makefile (tests): Add tst-lfschk{1,2,3}.
	* debug/tst-lfschk1.c: New test.
	* debug/tst-lfschk2.c: New test.
	* debug/tst-lfschk3.c: New test.

2005-02-09  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/bits/termios.h (CMSPAR): Define.
	* sysdeps/unix/sysv/linux/sparc/bits/termios.h: Add __USE_MISC
	and __USE_XOPEN guards to match linux/bits/termios.h.
	* sysdeps/unix/sysv/linux/alpha/bits/termios.h: Likewise.
	(CMSPAR): Define.
	* sysdeps/unix/sysv/linux/powerpc/bits/termios.h: Likewise.

2005-02-10  H.J. Lu  <hongjiu.lu@intel.com>

	[BZ #1076]
	* sysdeps/ia64/elf/initfini.c: Add local _init and _fini labels.

2005-02-27  Denis Barbier  <barbier@debian.org>

	[BZ #549]
	* locale/iso-4217.def: Add CSD currency.

2005-03-19  Ulrich Drepper  <drepper@redhat.com>

	* inet/test-ifaddrs.c: Use test-skeleton.
	* inet/test_ifindex.c: Likewise.

	[BZ #821]
	* elf/dl-lookup.c (add_dependency): Always search l_initfini if
	the list exists.

	[BZ #821]
	* elf/Makefile: Add rules to build and run order2.
	* elf/order2.c: New file.
	* elf/order2mod1.c: New file.
	* elf/order2mod2.c: New file.
	* elf/order2mod3.c: New file.
	* elf/order2mod4.c: New file.

2005-03-19  Jakub Jelinek  <jakub@redhat.com>

	[BZ #821]
	* elf/dl-open.c (dl_open_worker): Print exact l_direct_opencount value,
	it has been incremented before.

2005-03-18  Ulrich Drepper  <drepper@redhat.com>

	[BZ #821]
	* elf/dl-fini.c (_dl_fini): Split sorting of the maps in separate
	function _dl_sort_fini.
	(_dl_sort_fini): New function.
	* sysdeps/generic/ldsodefs.h: Declare _dl_sort_fini.
	* elf/dl-close.c (_dl_close): Call _dl_sort_fini before running
	destructors to call them in the right order.

2005-02-07  Steven Munroe  <sjmunroe@us.ibm.com>

	* sysdeps/powerpc/bits/link.h (La_ppc64_regs): Add lr_vrsave.
	(La_ppc64_retval): Correct size of lrc_fp.
	* sysdeps/powerpc/powerpc64/dl-trampoline.S (_dl_profile_resolve):
	Fix up ABI problems and complete function.

2005-03-10  Jakub Jelinek  <jakub@redhat.com>

	* math/test-misc.c (main): Add some more tests.

2005-03-17  Jakub Jelinek  <jakub@redhat.com>

	* posix/regcomp.c (re_compile_fastmap_iter): Fix check for failed
	__wcrtomb.  Check return values of other __wcrtomb calls.
	* posix/regex_internal.c (build_wcs_buffer, re_string_skip_chars):
	Change mbclen type to size_t.
	(build_wcs_upper_buffer): Change mbclen and mbcdlen type to size_t.
	Handle mb chars whose upper case doesn't have multibyte representation
	in locale's charset.

2005-03-15  Jakub Jelinek  <jakub@redhat.com>

	* malloc/malloc.c (_int_icalloc, _int_icomalloc, iALLOc,
	public_iCALLOc, public_iCALLOc, public_iCOMALLOc): Protect with
	#ifndef _LIBC.

	[BZ #779]
	* malloc/malloc.c (public_mTRIm): Initialize malloc if not yet
	initialized.

2005-03-10  Jakub Jelinek  <jakub@redhat.com>

	* misc/sys/cdefs.h (__always_inline): Define.
	* posix/bits/unistd.h (read, pread, pread64, readlink, getcwd, getwd):
	Use __always_inline instead of __inline.
	* socket/bits/socket2.h (recv, recvfrom): Likewise.
	* libio/bits/stdio2.h (gets, fgets, fgets_unlocked): Likewise.
	* string/bits/string3.h (__memcpy_ichk, __memmove_ichk, __mempcpy_ichk,
	__memset_ichk, __strcpy_ichk, __stpcpy_ichk, __strncpy_ichk,
	__strcat_ichk, __strncat_ichk): Use __always_inline instead of
	__inline__ __attribute__ ((__always_inline__)).

2005-03-09  Jakub Jelinek  <jakub@redhat.com>

	* debug/tst-chk1.c: Include sys/socket.h and sys/un.h.
	(do_test): Add new tests for recv, recvfrom, getcwd, getwd and
	readlink.  Add some more tests for read, pread, pread64, fgets and
	fgets_unlocked.

	* posix/bits/unistd.h (read, pread, pread64, readlink,
	getcwd, getwd): Change macros into extern inline functions.
	(__read_alias, __pread_alias, __pread64_alias, __readlink_alias,
	__getcwd_alias, __getwd_alias): New prototypes.
	* socket/bits/socket2.h (recv, recvfrom): Change macros into
	extern inline functions.
	(__recv_alias, __recvfrom_alias): New prototypes.
	* libio/bits/stdio2.h (gets, fgets, fgets_unlocked): Change macros
	into extern inline functions.
	(__gets_alias, __fgets_alias, __fgets_unlocked_alias): New prototypes.

	* debug/pread_chk.c (__pread_chk): Fix order of arguments passed
	to __pread.
	* debug/pread64_chk.c (__pread64_chk): Fix order of arguments passed
	to __pread64.

2005-03-18  Daniel Jacobowitz  <dan@codesourcery.com>

	* configure.in: Use %function instead of @function.

2005-03-18  Ulrich Drepper  <drepper@redhat.com>

	[BZ #821]
	* include/link.h (struct link_map): Remove l_opencount.  Add l_removed.
	Change type of l_idx to int.
	* elf/dl-close.c: Basically rewrite.  Do not use l_opencount to
	determine whether a DSO has to be unloaded.  Instead compute this
	in this function.
	* elf/dl-deps.c: No need to manipulate l_opencount anymore.
	* elf/dl-lookup.c: Likewise.
	* elf/rtld.c: Likewise
	* elf/dl-open.c: Likewise.  Use l_init_called to determine whether
	object was just loaded.
	* elf/dl-fini.c: Bump l_direct_opencount instead of l_opencount.
	* elf/dl-load.c (_dl_map_object_from_fd): Do not recognize DSO which
	is about to be unloaded as a match.
	(_dl_map_object): Likewise.
	* elf/do-lookup.h (do_lookup_x): Do not look into DSO which is about
	to be unloaded.
	* elf/circleload1.c: Don't use l_opencount anymore.
	* elf/neededtest.c: Likewise.
	* elf/neededtest2.c: Likewise.
	* elf/neededtest3.c: Likewise.
	* elf/neededtest4.c: Likewise.
	* elf/unload.c: Likewise.
	* elf/unload2.c: Likewise.
	* elf/loadtest.c: Likewise.

	[BZ #821]
	* elf/rtld.c: Preloading errors are now never fatal.

2005-03-08  Jakub Jelinek  <jakub@redhat.com>

	[BZ #821]
	* elf/Makefile: Add rules to build and run unload5 test.
	* elf/unload5.c: New file.

	[BZ #821]
	* elf/Makefile: Add rules to build and run unload4 test.
	* elf/unload4.c: New file.
	* elf/unload4mod1.c: New file.
	* elf/unload4mod2.c: New file.
	* elf/unload4mod3.c: New file.
	* elf/unload4mod4.c: New file.

2005-03-17  Roland McGrath  <roland@redhat.com>

	* nscd/aicache.c (addhstaiX): Tweak type to avoid warning.

2005-03-16  Richard Henderson  <rth@redhat.com>

	[BZ #721]
	* include/libc-symbols.h (__hidden_proto): Remove bogus declaration
	of internal.
	(__hidden_def1, __hidden_dot_def1): Remove.
	(__hidden_def2, __hidden_def3): Remove.
	(__hidden_ver1): New.
	(hidden_ver, hidden_def, hidden_weak): Use it.
	(hidden_data_ver, hidden_data_ver, hidden_data_weak): Use non-data
	version of the macro.

	[BZ #721]
	* include/wchar.h (__wcscoll): Remove.
	* wcsmbs/wcscoll.c: Define wcscoll directly instead of via __wcscoll.
	* string/strcoll.c: Don't issue libc_hidden_def STRCOLL redefined.

2005-03-16  Daniel Jacobowitz  <dan@codesourcery.com>

	* elf/elf.h: Define MIPS TLS relocations.

2005-03-16  Ulrich Drepper  <drepper@redhat.com>

	* elf/circleload1.c (main): Pretty printing.

2005-03-15  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/generic/wordexp.c (exec_comm_child): Add inline keyword.
	Patch by Dan Kegel <dank@kegel.com>.

	[BZ #721]
	* elf/dynamic-link.h (elf_machine_rel, elf_machine_rel_relative,
	elf_machine_rela, elf_machine_rela_relative, elf_machine_lazy_rel):
	Add inline keyword.
	* sysdeps/alpha/dl-machine.h (elf_machine_rela,
	elf_machine_rela_relative, elf_machine_lazy_rel): Add always_inline
	attribute.
	* sysdeps/sparc/sparc32/dl-machine.h (elf_machine_rela,
	elf_machine_rela_relative, elf_machine_lazy_rel): Likewise.  Change
	static inline into auto inline.
	* sysdeps/sparc/sparc64/dl-machine.h (elf_machine_rela,
	elf_machine_rela_relative, elf_machine_lazy_rel): Likewise.
	* sysdeps/generic/dl-machine.h (elf_machine_rel, elf_machine_rela):
	Likewise.
	* sysdeps/arm/dl-machine.h (elf_machine_rel, elf_machine_rel_relative,
	elf_machine_rela, elf_machine_rela_relative, elf_machine_lazy_rel):
	Likewise.

2005-03-15  Jakub Jelinek  <jakub@redhat.com>

	[BZ #789]
	* sysdeps/i386/i686/hp-timing.h (HP_TIMING_ACCUM): Fix asm constraints.
	Remove memory clobber.

	* sysdeps/x86_64/hp-timing.h (HP_TIMING_ACCUM): Make the addition
	thread-safe.  Subtract GLRO(dl_hp_timing_overhead) from Diff.

2005-03-14  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/powerpc/sys/ucontext.h: Don't include
	asm/types.h.

2005-03-10  GOTO Masanori  <gotom@debian.or.jp>

	* sysdeps/unix/sysv/linux/sh/bits/mman.h: Define MAP_POPULATE and
	MAP_NONBLOCK.
	* sysdeps/unix/sysv/linux/sparc/bits/mman.h: Likewise.
	Correct MAP_GROWSDOWN value.

2005-03-13  Roland McGrath  <roland@redhat.com>

	* elf/tls-macros.h: #include_next <tls-macros.h> to get a sysdeps
	version if there is one.  Only #error if macros are then undefined.
	* sysdeps/generic/tls-macros.h: New file.

2005-03-10  GOTO Masanori  <gotom@debian.or.jp>

	* sysdeps/hppa/configure.in: Remove old Makefile leftovers.
	* sysdeps/hppa/configure: Regenerated.

2005-03-08  Roland McGrath  <roland@redhat.com>

	* sysdeps/gnu/errlist-compat.awk: Use NERR in all array decls, so
	array types match exactly in C alias decls.

2005-03-07  Ulrich Drepper  <drepper@redhat.com>

	* malloc/arena.c (ptmalloc_init): Recognize MALLOC_PERTURB_ and call
	mallopt appropriately.
	* malloc/malloc.h: Define M_PERTURB.
	* malloc/malloc.c (perturb_byte): New variable.
	(alloc_perturb, free_perturb): New macros.
	(_int_malloc): Before returning, overwrite the memory if this is
	requested.
	(_int_free): Overwrite freed memory if requested.
	(mALLOPt): Handle M_PERTURB.
	* test-skeleton.c: Add call to mallopt with M_PERTURB command.

	* elf/dl-close.c (_dl_close): Decrement l_opencount before
	printing debug message.
	* elf/dl-open.c (dl_open_worker): Always print the new opencount
	in debug messages.

2005-03-06  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-close.c (_dl_close): Unify debug message format.

	* elf/dl-close.c (_dl_close): Print debug message just before
	destroying a link map.

	* elf/do-lookup.h (do_lookup_x): Add namespace info to debug output.
	* elf/dl-version.c (match_symbol): Likewise.

	* posix/bits/unistd.h (pread): Fix typo in __USE_FILE_OFFSET64 code.

	* debug/recv_chk.c (__recv_chk): Always fail if request could
	overflow the buffer.
	* debug/recvfrom_chk.c (__recvfrom_chk): Likewise.
	* socket/bits/socket2.h (recv): Avoid calls to the _chk variant if
	we know the call succeeds.
	(recvfrom): Likewise.

2005-03-05  Ulrich Drepper  <drepper@redhat.com>

	* posix/regexec.c (check_node_accept_bytes): Correct cast to avoid
	warning.
	* posix/regex_internal.c (re_string_reconstruct): Add cast to
	avoid warning.
	(build_wcs_upper_buffer): Change type of bug to plain char.
	* locale/weightwc.h (findidx): Add casts to avoid warnings.
	* time/mktime.c (ranged_convert): Initialize tm to make the
	compiler happy.
	* wcsmbs/mbsrtowcs_l.c (__mbsrtowcs_l): Add casts to avoid warnings.
	* wcsmbs/wcsnrtombs.c (__wcsnrtombs): Add casts to avoid warnings.
	* wcsmbs/mbsnrtowcs.c: Add casts to avoid warnings.
	* wcsmbs/wcsrtombs.c (__wcsrtombs): Add casts to avoid warnings.
	* wcsmbs/wcrtomb.c (__wcrtomb): Add casts to avoid warnings.
	* wcsmbs/mbrtowc.c (__mbrtowc): Use unsigned char for outbuf.
	* wcsmbs/wctob.c (wctob): Make buf array of unsigned char.
	* sysdeps/generic/strchrnul.c: Add cast to avoid warning.
	* libio/iofwide.c: Add casts to avoid warnings.
	* stdio-common/printf-prs.c (parse_printf_format): Introduce new
	variable f to avoid warnings.
	* sysdeps/unix/sysv/linux/x86_64/makecontext.c (__makecontext):
	Fix a few casts to avoid warnings.
	* iconv/gconv_simple.c (internal_utf8_loop): Make start unsigned
	to avoid warning.

	[BZ #1101]
	* posix/regex_internal.c [_LIBC] (build_wcs_buffer): Avoid using
	dynamically sized array.
	(build_wcs_upper_buffer): Likewise.

2005-03-05  Jakub Jelinek  <jakub@redhat.com>

	* include/bits/unistd.h: New file.
	* include/bits/socket2.h: New file.

2005-03-05  Ulrich Drepper  <drepper@redhat.com>

	* sunrpc/key_call.c: Remove doors support.
	* sunrpc/Makefile: Remove CPPFLAGS-key_call.c definition.
	* configure.in: Remove test for doors support which never existed.
	* config.make.in: Remove have_doors entry.

	* configure.in: Make sure at least gcc 3.4 is used.  Undo last change.
	* config.make.in: Undo last change.

	* sysdeps/i386/Makefile (CFLAGS-initfini.s): Unconditionally use
	-mtune.

2005-03-05  Roland McGrath  <roland@redhat.com>

	* sysdeps/generic/ldsodefs.h (_dl_out_of_memory_internal): Remove decl.
	(_dl_out_of_memory): Use rtld_hidden_proto.
	* elf/dl-error.c (_dl_out_of_memory): Use rtld_hidden_data_def.
	(_dl_signal_error): Don't use INTUSE on _dl_out_of_memory.
	* elf/dl-open.c (_dl_open): Likewise.
	* elf/dl-deps.c (_dl_map_object_deps): Likewise.

	* sunrpc/des_impl.c (des_set_key): Make first argument unsigned char *.

	* elf/dl-addr.c (_dl_addr): Add a cast.

	[BZ #821]
	* elf/unload3mod4.c: Declare foo.
	* elf/testobj2.c: Include <stdio.h>.

	* sysdeps/gnu/errlist.awk: Emit NERR macro for _sys_nerr_internal
	value constant, and use it in the defn.
	* sysdeps/gnu/errlist-compat.awk: Use NERR in array decl.
	Use actual size for compat array decls.

	* config.make.in (cc-mtune): New substituted variable.
	* configure.in (libc_cv_cc_mtune): New test for -mtune= switch,
	done only if libc_mtune_example is defined.
	* sysdeps/i386/configure.in (libc_mtune_example): Set it.
	* sysdeps/i386/Makefile (CFLAGS-initfini.s): Use $(cc-mtune).

2005-03-05  Jakub Jelinek  <jakub@redhat.com>

	[BZ #721]
	* sysdeps/i386/dl-machine.h (ELF_MACHINE_NO_RELA): Define
	unconditionally to (defined RTLD_BOOTSTRAP).
	* sysdeps/arm/dl-machine.h (ELF_MACHINE_NO_RELA): Likewise.

2005-03-05  Jakub Jelinek  <jakub@redhat.com>

	* Makerules ($(inst_libdir)/libc.so): Use $(slibdir) instead of
	$(inst_slibdir) in AS_NEEDED directive.

2005-03-03  Jakub Jelinek  <jakub@redhat.com>

	* posix/bits/unistd.h (pread, pread64): Don't swap function arguments.

2005-03-01  H.J. Lu  <hongjiu.lu@intel.com>

	[BZ #776]
	* iconv/iconvconfig.c: Fix comment for the output file.
	(write_output): Clear padding in header.

2005-03-03  Ulrich Drepper  <drepper@redhat.com>

	[BZ #821]
	* elf/dl-close.c (_dl_close): Don't try to set up new searchpath if the
	loader is closed.  Fixes unload3.
	* elf/tst-global1.c: New file.
	* elf/Makefile (tests): Add tst-global1.
	* elf/testobj2.c (p): New function.

2005-03-03  Jakub Jelinek  <jakub@redhat.com>

	[BZ #821]
	* elf/Makefile: Add rules to build and run unload3 test.
	* elf/unload3.c: New test.
	* elf/unload3mod1.c: New file.
	* elf/unload3mod2.c: New file.
	* elf/unload3mod3.c: New file.
	* elf/unload3mod4.c: New file.

2005-02-21  Alan Modra <amodra@bigpond.net.au>

	[BZ #1394]
	* sysdeps/unix/sysv/linux/powerpc/sys/procfs.h (elf_vrreg_t): Don't
	use __uint128_t.

2005-03-01  Jakub Jelinek  <jakub@redhat.com>

	* posix/bits/unistd.h (read, pread, pread64): Use __bos0 instead
	of __bos.
	* socket/bits/socket2.h (recv, recvfrom): Likewise.

2005-03-01  Roland McGrath  <roland@redhat.com>

	[BZ #721]
	* sysdeps/arm/dl-machine.h (ELF_MACHINE_NO_RELA): Define this outside
	of [RESOLVE_MAP].

2005-03-01  Alfred M. Szmidt  <ams@gnu.org>

	[BZ #777]
	* elf/dl-load.c (__stack_prot) [!PROT_GROWSUP && !PROT_GROWSDOWN]:
	Add missing initializer.

	[BZ #777]
	* malloc/arena.c: #include <stdbool.h> outside of [SHARED &&
	USE_TLS && !USE___THREAD].

2005-02-26  GOTO Masanori  <gotom@debian.or.jp>

	* csu/Makefile: Use printf instead of echo for some shells.

2005-02-28  Roland McGrath  <roland@redhat.com>

	* debug/warning-nop.c (__nop): Rename to nop, make it static.
	(__warndecl): Use alias attribute directly, instead of strong_alias
	macro.  Add attribute_hidden.

2005-02-28  Ulrich Drepper  <drepper@redhat.com>

	* posix/bits/unistd.h: Avoid calling __*_chk variants if we can
	determine the call will never trigger a failure.
	* debug/read_chk.c (__read_chk): Always fail if the buffer is too
	small.
	* debug/readlink_chk.c (__readlink_chk): Likewise.
	* debug/pread64_chk.c (__pread64_chk): Likewise.
	* debug/pread_chk.c (__pread_chk): Likewise.

	* sysdeps/i386/i686/memset_chk.S: Remove alias and warning.
	* sysdeps/x86_64/memset_chk.S: Likewise.

2005-02-24  Roland McGrath  <roland@redhat.com>

	* debug/Versions (libc: GLIBC_2.4): Remove
	__memset_zero_constant_len_parameter.
	* sysdeps/generic/memset_chk.c: Remove alias and warning.
	* misc/sys/cdefs.h (__warndecl): New macro.
	* debug/warning-nop.c: New file.
	* string/bits/string3.h (memset): Call __warn_memset_zero_len with no
	arguments, instead of calling __memset_zero_constant_len_parameter.
	Use __warndecl for __warn_memset_zero_len.
	* debug/Makefile (routines): Add $(static-only-routines).
	(static-only-routines): New variable.

2005-02-27  Ulrich Drepper  <drepper@redhat.com>

	* po/tr.po: Update from translation team.

2005-02-26  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-addr.c: Cleanups.  Move declaration next to first use.

	* dlfcn/dlerror.c (check_free): New function.  Extract common code
	from fini and free_key_mem.  Check whether this is libdl in the
	base namespace.

2005-02-25  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-lookup.c (_dl_debug_bindings): Add namespace information
	to debug output.

2004-11-11  Richard Sandiford  <rsandifo@redhat.com>

	[BZ #758]
	* sysdeps/unix/sysv/linux/mips/configure.in (asm-unistd.h): Only
	preprocess <asm/unistd.h> if it defines ABI-prefixed syscall names
	like __NR_N32_open.  Just include <asm/unistd.h> otherwise.
	* sysdeps/unix/sysv/linux/mips/configure: Regenerate.
	* sysdeps/unix/sysv/linux/mips/mips32/kern64/sysdep.h: Delete
	* sysdeps/unix/sysv/linux/mips/mips64/n32/sysdep.h (SYS_ify): Use the
	standard __NR prefix.
	* sysdeps/unix/sysv/linux/mips/mips64/n64/sysdep.h (SYS_ify): Likewise.
	* sysdeps/unix/sysv/linux/mips/Makefile (syscall-%.h): Rework so that
	the output file is compatible with both pre-2.6 and 2.6 kernel headers.
	Extract separate syscall lists for each ABI.

2005-02-23  Ulrich Drepper  <drepper@redhat.com>

	* Makerules (libc.so): Add AS_NEEDED line for dynamic linker.

	[BZ #719]
	* elf/Makefile: Run tst-tls9-static again.

2005-02-22  Ulrich Drepper  <drepper@redhat.com>

	[BZ #719]
	* sysdeps/generic/libc-tls.c (static_dtv): Size the same as the
	slotinfo array.
	(__libc_setup_tls): Initialize length of DTV based on array length.
	* elf/dl-load.c: Revert last change.
	* sysdeps/generic/dl-tls.c: Revert last change.

	* posix/Makefile (tests): Add tst-execvp1, tst-execvp2, tst-execlp1,
	tst-execlp2, tst-execv1, tst-execv2, tst-execl1, tst-execl2,
	tst-execve1, tst-execve2, tst-execle1, and tst-execle2.
	* posix/tst-execl1.c: New file.
	* posix/tst-execl2.c: New file.
	* posix/tst-execle1.c: New file.
	* posix/tst-execle2.c: New file.
	* posix/tst-execlp1.c: New file.
	* posix/tst-execlp2.c: New file.
	* posix/tst-execv1.c: New file.
	* posix/tst-execv2.c: New file.
	* posix/tst-execve1.c: New file.
	* posix/tst-execve2.c: New file.
	* posix/tst-execvp1.c: New file.
	* posix/tst-execvp2.c: New file.

2005-02-22  Roland McGrath  <roland@redhat.com>

	* include/signal.h: Revert last change.
	(__sigemptyset): Use __builtin_memset instead of memset.

2005-02-22  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/libc_fatal.c (__libc_message): Use
	non-cancelable I/O functions.

2005-02-22  Jakub Jelinek  <jakub@redhat.com>

	[BZ #769]
	* nscd/nscd-client.h: Include sys/uio.h.
	(__readall, __readvall, writeall): New prototypes.
	* nscd/connections.c (writeall): New function.
	(handle_request): Use it.
	* nscd/aicache.c (addhstaiX): Likewise.
	* nscd/initgrcache.c (addinitgroupsX): Likewise.
	* nscd/hstcache.c (cache_addhst): Likewise.
	* nscd/grpcache.c (cache_addgr): Likewise.
	* nscd/pwdcache.c (cache_addpw): Likewise.
	* nscd/nscd_helper.c (__readall, __readvall): New functions.
	* nscd/nscd_getai.c (__nscd_getai): Use them.
	* nscd/nscd_getpw_r.c (__nscd_getpw_r): Likewise.
	* nscd/nscd_getgr_r.c (__nscd_getgr_r): Likewise.
	* nscd/nscd_gethst_r.c (__nscd_gethst_r): Likewise.
	* nscd/nscd_initgroups.c (__nscd_getgrouplist): Likewise.

2005-02-22  Roland McGrath  <roland@redhat.com>

	* include/sys/socket.h: Declare __recv.
	* sysdeps/generic/recv.c (recv): Rename to __recv, and add weak alias.
	* sysdeps/mach/hurd/recv.c: Likewise.

	* sysdeps/unix/sysv/linux/libc_fatal.c: Include <execinfo.h> for
	__backtrace_* decls.

	* sysdeps/unix/sysv/linux/powerpc/powerpc32/sysdep.h
	(INTERNAL_SYSCALL_ERROR_P): Evalute VAL.  Parenthesize ERR.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/sysdep.h: Likewise.

	* include/signal.h: Include <string.h> for memset decl.

2005-02-22  Andreas Schwab  <schwab@suse.de>

	* posix/execvp.c (execvp): Fix invalid free.

2005-02-22  Jakub Jelinek  <jakub@redhat.com>

	[BZ #1095]
	* malloc/Makefile (CFLAGS-mcheck-init.c): Add.
	* sunrpc/Makefile: Add $(PIC-ccflag) to CFLAGS-x* for
	librpcsvc.a objects.

2005-02-21  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1107]
	* iconvdata/ibm930.h: Correct Yen mapping.
	* iconvdata/ibm939.h: Likewise.
	* iconvdata/testdata/IBM930..UTF8: Adjust test data.
	* iconvdata/testdata/IBM939..UTF8: Likewise.
	Patch by Jiro Sekiba <SEKIBA@jp.ibm.com>.

	* iconvdata/Makefile (modules): Add IBM1025, IBM1122, IBM1137, IBM1153,
	IBM1154, IBM1155, IBM1156, IBM1157, and IBM1158.
	(distribute): Add ibm1025.c, ibm1025.h, ibm1122.c, ibm1122.h,
	ibm1137.c, ibm1137.h, ibm1153.c, ibm1153.h, ibm1154.c, ibm1154.h,
	ibm1155.c, ibm1155.h, ibm1156.c, ibm1156.h, ibm1157.c, ibm1157.h,
	ibm1158.c, and ibm1158.h.
	* iconvdata/TESTS: Add IBM1025, IBM1122, IBM1137, IBM1153,
	IBM1154, IBM1155, IBM1156, IBM1157, and IBM1158.
	* iconvdata/gconv-modules: Likewise.
	* iconvdata/ibm1025.c: New file.
	* iconvdata/ibm1025.h: New file.
	* iconvdata/ibm1122.c: New file.
	* iconvdata/ibm1122.h: New file.
	* iconvdata/ibm1137.c: New file.
	* iconvdata/ibm1137.h: New file.
	* iconvdata/ibm1153.c: New file.
	* iconvdata/ibm1153.h: New file.
	* iconvdata/ibm1154.c: New file.
	* iconvdata/ibm1154.h: New file.
	* iconvdata/ibm1155.c: New file.
	* iconvdata/ibm1155.h: New file.
	* iconvdata/ibm1156.c: New file.
	* iconvdata/ibm1156.h: New file.
	* iconvdata/ibm1157.c: New file.
	* iconvdata/ibm1157.h: New file.
	* iconvdata/ibm1158.c: New file.
	* iconvdata/ibm1158.h: New file.
	* iconvdata/testdata/IBM1025: New file.
	* iconvdata/testdata/IBM1025..UTF8: New file.
	* iconvdata/testdata/IBM1122: New file.
	* iconvdata/testdata/IBM1122..UTF8: New file.
	* iconvdata/testdata/IBM1137: New file.
	* iconvdata/testdata/IBM1137..UTF8: New file.
	* iconvdata/testdata/IBM1153: New file.
	* iconvdata/testdata/IBM1153..UTF8: New file.
	* iconvdata/testdata/IBM1154: New file.
	* iconvdata/testdata/IBM1154..UTF8: New file.
	* iconvdata/testdata/IBM1155: New file.
	* iconvdata/testdata/IBM1155..UTF8: New file.
	* iconvdata/testdata/IBM1156: New file.
	* iconvdata/testdata/IBM1156..UTF8: New file.
	* iconvdata/testdata/IBM1157: New file.
	* iconvdata/testdata/IBM1157..UTF8: New file.
	* iconvdata/testdata/IBM1158: New file.
	* iconvdata/testdata/IBM1158..UTF8: New file.
	Contributed by Jiro Sekiba <SEKIBA@jp.ibm.com>.

2005-02-10  Paolo Bonzini  <bonzini@gnu.org>

	* posix/regcomp.c (lower_subexp): Do not optimize empty
	subexpressions even with REG_NOSUB.
	* posix/rxspencer/tests: Add a previously failing testcase.

2005-02-21  Alan Modra <amodra@bigpond.net.au>

	[BZ #719]
	* elf/dl-reloc.c (_dl_nothread_init_static_tls): Assert that dtv
	array index is within bounds.

2005-02-21  Ulrich Drepper  <drepper@redhat.com>

	[BZ #719]
	* elf/dl-load.c: Do not allow PT_TLS in modules loaded in statically
	linked code.
	* sysdeps/generic/dl-tls.c [!SHARED]: Don't build _dl_next_tls_modid.
	* elf/Makefile: Remove rules to build and run tst-tls9-static.

	[BZ #719]
	* elf/dl-reloc.c (_dl_nothread_init_static_tls): Avoid using
	THREAD_DTV multiple times, this minimally reduces code size on
	some archs.

2005-02-21  Jakub Jelinek  <jakub@redhat.com>

	[BZ #768]
	* nscd/nscd_gethst_r.c (nscd_gethst_r): Set *h_errnop to
	NETDB_INTERNAL if buffer is too small.

	[BZ #768]
	* nscd/hstcache.c (INCR): Remove.
	(addhstbyX): Double buflen in each iteration rather than add INCR.
	* nscd/grpcache.c: Likewise.
	* nscd/pwdcache.c: Likewise.

2005-02-21  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/libc_fatal.c: Print backtrace and memory
	map if requested.
	* debug/chk_fail.c: Request backtrace and memory map dump.

	* Versions.def: Add GLIBC_2.4 for libc.
	* debug/fgets_chk.c: New file.
	* debug/fgets_u_chk.c: New file.
	* debug/getcwd_chk.c: New file.
	* debug/getwd_chk.c: New file.
	* debug/readlink_chk.c: New file.
	* debug/read_chk.c: New file.
	* debug/pread_chk.c: New file.
	* debug/pread64_chk.c: New file.
	* debug/recv_chk.c: New file.
	* debug/recvfrom_chk.c: New file.
	* debug/Versions: Add all new functions with version GLIBC_2.4.
	* debug/Makefile (routines): Add fgets_chk, fgets_u_chk, read_chk,
	pread_chk, pread64_chk, recv_chk, recvfrom_chk, readlink_chk,
	getwd_chk, and getcwd_chk.  Plus appropriate CFLAGS definitions.
	* debug/tst-chk1.c: Add more tests.
	* libio/bits/stdio2.h: Add macros for fgets and fgets_unlocked.
	* include/stdio.h: Declare __fgets_chk and __fgets_unlocked_chk.
	* posix/unistd.h: Include <bits/unistd.h> for fortification.
	* posix/bits/unistd.h: New file.
	* posix/Makefile (headers): Add bits/unistd.h.
	* socket/sys/socket.h: Include <bits/socket2.h> for fortification.
	* socket/bits/socket2.h: New file.
	* socket/Makefile (headers): Add bits/socket2.h.

	* string/bits/string3.h: Extend memset macro to check for zero 3rd
	parameter and use __memset_zero_constant_len_parameter in that case.
	* sysdeps/generic/memset_chk.c: Add
	__memset_zero_constant_len_parameter alias and linker warning.
	* debug/Versions: Add __memset_zero_constant_len_parameter to libc
	with version GLIBC_2.4.

	* sysdeps/generic/bits/types.h: Don't unnecessarily use __extension__
	in __STD_TYPE definition.

2005-02-21  Jakub Jelinek  <jakub@redhat.com>

	* malloc/malloc.c (malloc_printerr): If MALLOC_CHECK_={5,7}, print
	the error message rather than program name.

2005-02-21  Ulrich Drepper  <drepper@redhat.com>

	[BZ #767]
	* posix/unistd.h: symlink and readlink are unconditionally
	available in the 2001 spec.

2005-02-16  Roland McGrath  <roland@redhat.com>

	* intl/dcigettext.c (_nl_find_msg): Add a cast.

	* nis/nis_clone_dir.c (nis_clone_directory): Use char * for ADDR.
	* nis/nis_clone_obj.c (nis_clone_object): Likewise.
	* nis/nis_clone_res.c (nis_clone_result): Likewise.

	* resolv/nss_dns/dns-network.c (getanswer_r): Use const unsigned char *
	for END_OF_MESSAGE and CP.

	* resolv/res_send.c (send_dg): Add else branch for case impossible
	unless `poll' is buggy.

	* crypt/crypt_util.c (__setkey_r): Add a cast.

	* locale/programs/linereader.c (get_toplvl_escape): Use size_t for
	NBYTES, and unsigned char * for BYTES.

	* locale/programs/charmap.c (charmap_new_char): Use size_t and
	unsighed char * for NBYTES, BYTES parameters.

	* sysdeps/generic/dl-hash.h (_dl_elf_hash): Take const char * argument
	and cast it.
	* sysdeps/i386/i686/dl-hash.h (_dl_elf_hash): Likewise.

	* sunrpc/create_xid.c (_create_xid): Don't use unsigned long for RES.

	* sunrpc/svcauth_des.c (_svcauth_des): Fix cast type.

	* sunrpc/auth_des.c (authdes_create): Don't use u_char for PKEY_DATA.
	(authdes_marshal): Don't use unsigned int for LEN.
	* sunrpc/xdr.c (xdr_hyper): Don't use unsigned long for T2.
	(xdr_u_hyper): Likewise.
	(xdr_u_short): Don't use u_long for L.
	* sunrpc/xdr_intXX_t.c (xdr_int64_t): Don't use uint32_t for T2.

	* inet/rexec.c (rexec_af): Use socklen_t.
	* sunrpc/key_call.c (getkeyserv_handle): Likewise.
	* sunrpc/rtime.c (rtime): Likewise.
	* resolv/res_send.c (send_vc, send_dg): Likewise.
	* nis/nis_callback.c (__nis_create_callback): Likewise.

	* sysdeps/generic/libc-start.c: Use unsigned int for nthreads ptr.

	* sysdeps/posix/getaddrinfo.c (gaih_inet): Fix type of ADDR local.

	* libio/libio.h (_IO_BE): Add parenthesis around EXPR.

	* intl/dcigettext.c (INTVARDEF, INTUSE): Macros removed.
	(_nl_default_dirname): Use libc_hidden_data_def instead of INTVARDEF.
	(libc_freeres_fn, DCIGETTEXT): Don't use INTUSE.
	* intl/bindtextdom.c (INTUSE): Macro removed.
	(_nl_default_dirname): Use libc_hidden_proto.
	(set_binding_values): Don't use INTUSE.
	* include/libintl.h (_libc_intl_domainname_internal): Decl removed.
	(_libc_intl_domainname): Use libc_hidden_proto.
	* posix/regex_internal.h (gettext): Remove INTUSE on it.
	* locale/SYS_libc.c (_libc_intl_domainname): Use libc_hidden_data_def
	rather than INTDEF.
	* include/libintl.h (_): Don't use *_internal name.

	* ctype/ctype-extn.c (__ctype_tolower, __ctype_toupper): Use int32_t,
	not uint32_t.
	* locale/lc-ctype.c (_nl_postload_ctype): Likewise for assignments.

	* iconv/gconv_open.c (__gconv_open): Remove useless cast.

	[BZ #721]
	* sysdeps/i386/dl-machine.h (ELF_MACHINE_NO_RELA): Define this outside
	of [RESOLVE_MAP].
	* sysdeps/sh/dl-machine.h (ELF_MACHINE_NO_REL): Likewise.
	* sysdeps/powerpc/powerpc32/dl-machine.h
	(elf_machine_rel, elf_machine_rel_relative): Removed.
	* sysdeps/powerpc/powerpc64/dl-machine.h
	(elf_machine_rel, elf_machine_rel_relative): Removed.

2005-02-03  Alexandre Oliva  <aoliva@redhat.com>

	[BZ #721]
	* elf/dynamic-link.h: Don't declare nested auto functions that are
	not going to be defined.

2004-07-23  Jakub Jelinek  <jakub@redhat.com>

	[BZ #284]
	* include/features.h (_POSIX_SOURCE, _POSIX_C_SOURCE): Define
	if _XOPEN_SOURCE >= 500 even if __STRICT_ANSI__ is defined.

2005-02-16  Roland McGrath  <roland@redhat.com>

	* sysdeps/generic/libc-start.c (LIBC_START_MAIN): Move UBP_EV defn
	inside [! SHARED] where it's used.

2005-02-15  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/generic/bits/byteswap.h: Make sure result of all the
	functions and macros is unsigned.

2005-02-11  Barry deFreese  <bddebian@comcast.net>

	[BZ #722]
	* sysdeps/mach/hurd/setresgid.c: Use weak_alias.
	* sysdeps/mach/hurd/setresuid.c: Likewise.

2005-02-14  GOTO Masanori  <gotom@debian.or.jp>

	* misc/sys/syslog.h: Fix typo in comment.

2005-02-14  Roland McGrath  <roland@redhat.com>

	[BZ #720]
	* sysdeps/unix/sysv/linux/sys/kd.h: Don't leave _LINUX_TYPES_H defined
	if it wasn't originally.

2005-02-14  GOTO Masanori  <gotom@debian.or.jp>

	* sysdeps/unix/sysv/linux/alpha/syscalls.list: Remove the duplicated
	getpeername entry.
	* sysdeps/unix/sysv/linux/ia64/syscalls.list: Likewise.
	* sysdeps/unix/sysv/linux/s390/s390-64/syscalls.list: Likewise.

2005-02-11  Jakub Jelinek  <jakub@redhat.com>

	* scripts/soversions.awk: Only record first WORDSIZE{32,64}
	matching line.

2005-02-14  Alan Modra  <amodra@bigpond.net.au>

	[BZ #721]
	* sysdeps/powerpc/powerpc32/dl-machine.h (elf_machine_rela): Define
	with auto inline, and attribute always_inline.
	(elf_machine_rela_relative, elf_machine_lazy_rel): Likewise.
	(elf_machine_rel, elf_machine_rel_relative): Likewise.
	* sysdeps/powerpc/powerpc64/dl-machine.h (elf_machine_rela): Likewise.
	(elf_machine_rela_relative, elf_machine_lazy_rel): Likewise.
	(elf_machine_rel, elf_machine_rel_relative): Likewise.
	(elf_machine_tprel): Likewise.

2005-02-14  Andreas Schwab  <schwab@suse.de>

	* manual/filesys.texi (Random Access Directory): Fix type of file
	position value for telldir and seekdir.
	(Attribute Meanings): Fix typo.

2005-02-14  H.J. Lu  <hongjiu.lu@intel.com>

	* csu/elf-init.c (__libc_csu_fini): Enable if LIBC_NONSHARED
	isn't defined.
	* sysdeps/generic/libc-start.c (LIBC_START_MAIN): Call fini
	if SHARED isn't defined.
	* elf/Makefile (tests-static): Add tst-array1-static.
	($(objpfx)tst-array1-static.out): New target.
	* elf/tst-array1-static.c: New file.

2005-02-11  Jakub Jelinek  <jakub@redhat.com>

	[BZ #1100]
	* debug/chk_fail.c (__chk_fail): Add a while (1) loop around
	__libc_message to kill GCC warning about noreturn function returning.

	* elf/rtld.c (dlmain): If LD_TRACE_PRELINKING, clear l_relocated flag
	before relocating ld.so again.

	* elf/rtld.c (_dl_start): Set bootstrap_map.l_relocated even
	for already prelinked ld.so.

2005-02-11  Roland McGrath  <roland@redhat.com>

	[BZ #715]
	* Makefile (installed-stubs): New variable.
	Set to $(inst_includedir)/gnu/stubs.h if $(biarch) is no,
	or to $(inst_includedir)/gnu/stubs-$(biarch).h if otherwise.
	[$(biarch) != no] (install-others-nosubdir): Add $(installed-stubs).
	($(inst_includedir)/gnu/stubs.h): Use $(installed-stubs) for this
	rule's target.
	($(inst_includedir)/gnu/stubs.h): New target, install from ...
	* include/stubs-biarch.h: New file.

	* shlib-versions (i.86-.*-.*): Add WORDSIZE64 line mapping to x86_64.

	* Makeconfig ($(common-objpfx)soversions.mk): Depend on Makeconfig.
	Emit defn for variable `biarch'.

	* include/stub-tag.h: Update comment.

	* scripts/soversions.awk: Fix default version set handling.

2005-02-10  Roland McGrath  <roland@redhat.com>

	[BZ #157]
	* include/libc-symbols.h (stub_warning): Emit a marker section called
	.gnu.glibc-stub.NAME.
	* Makerules ($(objpfx)stubs): Depend on object files, not dep files.
	Use objdump to collect those marker section names.
	($(common-objpfx)shlib.lds): Discard .gnu.glibc-stub.* sections.

	* Rules (subdir_objs, subdir_stubs): New phony targets.
	* Makefile (+subdir_targets): Add them.

	* Makerules ($(common-objpfx)Versions.all): Grok new leading column in
	soversions.i.

	* scripts/lib-names.awk: Consider [0-9].* a "number", not just [0-9]+.
	Reported by H.J. Lu <hongjiu.lu@intel.com>.

	* scripts/lib-names.awk: Always print WORDSIZE32 section first when
	doing two.

2005-02-10  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/powerpc/powerpc32/bits/link.h: Removed.
	* sysdeps/powerpc/powerpc64/bits/link.h: Moved to...
	* sysdeps/powerpc/bits/link.h: ... here.  New file.

2005-02-09  Jakub Jelinek  <jakub@redhat.com>

	[BZ #710]
	* stdlib/random_r.c (__initstate_r): Save old state.
	* stdlib/Makefile (tests): Add tst-random2.
	* stdlib/tst-random2.c: New test.
	Reported by Peter Bergner <bergner@vnet.ibm.com>.

2005-01-25  H.J. Lu  <hongjiu.lu@intel.com>

	* dlfcn/dlfcn.c (init): Put it in .init_array section.

2005-02-10  Roland McGrath  <roland@redhat.com>

	[BZ #632]
	* scripts/soversions.awk: Expect cpu, vendor, os as separate variables
	from command line.
	Grok shlib-versions lines with WORDSIZE* in second column.
	Add new leading column to output, DEFAULT for existing output lines.
	Also emit lines with WORDSIZE* for alternate configurations.
	* Makeconfig ($(common-objpfx)soversions.i): Pass those variables.
	($(common-objpfx)soversions.mk): Grok new column, use only DEFAULT.
	($(common-objpfx)gnu/lib-names.stmp): Depend on soversions.i instead
	of soversions.mk; replace inline shell script with use of ...
	* scripts/lib-names.awk: New file.  If input has non-DEFAULT lines,
	emit multiple sets of macros under #if.
	* shlib-versions (x86_64-.*-.*): Add WORDSIZE32 line mapping to i686.
	(s390x-.*-.*): Likewise for s390.
	(powerpc64-.*-.*): Likewise for powerpc.
	(sparc64-.*-.*): Likewise for sparc.
	(s390-.*-.*, powerpc.*-.*-.*, sparc.*-.*-.*): Add WORDSIZE64 entries
	for these mapping back to the above.

2005-02-08  Jakub Jelinek  <jakub@redhat.com>

	* elf/dl-load.c (_dl_map_object_from_fd): Fix a typo.

2005-02-08  Andreas Schwab  <schwab@suse.de>

	* sysdeps/m68k/dl-machine.h (elf_machine_rela): Remove use of
	RESOLVE.

2005-02-07  Richard Henderson  <rth@redhat.com>

	[BZ #721]
	* iconvdata/jis0208.h (struct jisx0208_ucs_idx): Move before use.

2005-02-08  Kaz Kojima  <kkojima@rr.iij4u.or.jp>

	* sysdeps/sh/dl-machine.h (elf_machine_rela): Remove code using
	RESOLVE.

2005-02-07  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-load.c (_dl_map_object_from_fd): Make sure registers are
	set correctly.

2005-01-07  Richard Henderson  <rth@redhat.com>

	[BZ #721]
	* math/math_private.h (__copysign): Define as builtin for gcc 4.
	(__copysignf, __copysignl): Likewise.
	* sysdeps/alpha/fpu/bits/mathinline.h (copysign): Don't define
	for gcc 4.0.
	(copysignf, copysignl, fabsf, fabs): Likewise.
	(__copysign, __copysignf, __copysignl): Remove.
	(__fabs, __fabsf): Remove.

2005-01-07  Jakub Jelinek  <jakub@redhat.com>

	[BZ #738]
	* elf/dl-load.c (open_path): If rtld_search_dirs is in RELRO segment,
	avoid writing to it if none of the standard search directories exist.

2005-02-07  Steven Munroe  <sjmunroe@us.ibm.com>

	[BZ #700]
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/setcontext.S
	(__novec_setcontext, __setcontext): Fix typo so CCR is restored.
	Load MSR as a doubleword.
	* sysdeps/unix/sysv/linux/powerpc/powerpc64/swapcontext.S
	(__novec_swapcontext, __swapcontext): Likewise.

2005-02-07  Ulrich Drepper  <drepper@redhat.com>

	* iconv/iconv_prog.c (main): Provide more help in case on an error.

	* sysdeps/unix/sysv/linux/i386/sysdep.h (check_consistency): Define.

2005-02-07  Jakub Jelinek  <jakub@redhat.com>

	[BZ #741]
	* nscd/nscd.c (termination_handler): Avoid segfault if some database
	is not enabled.

	[BZ #741]
	* nscd/nscd_getai.c (__nscd_getai): If ai_resp->found == -1, set
	__nss_not_use_nscd_hosts and return -1.
	* nscd/nscd_initgroups.c (__nscd_getgrouplist): If
	initgr_resp->found == -1, set __nss_not_use_nscd_group and return -1.
	Avoid leaking sockets.

2005-01-28  Andreas Schwab  <schwab@suse.de>
	    H.J. Lu  <hongjiu.lu@intel.com>

	[BZ #677]
	* elf/dl-runtime.c (fixup): Change return type to
	DL_FIXUP_VALUE_TYPE. Use DL_FIXUP_VALUE_TYPE,
	DL_FIXUP_MAKE_VALUE and DL_FIXUP_VALUE_CODE_ADDR for relocation
	values. Use DL_FIXUP_VALUE_ADDR and DL_FIXUP_ADDR_VALUE to
	store and retrieve relocation values.
	(profile_fixup): Likewise.
	* include/link.h (link_map): Use DL_FIXUP_VALUE_TYPE for
	l_reloc_result.
	* sysdeps/generic/dl-fptr.h (link_map): Forward declaration.
	* sysdeps/generic/dl-lookupcfg.h (DL_FIXUP_VALUE_TYPE): New.
	(DL_FIXUP_MAKE_VALUE): Likewise.
	(DL_FIXUP_VALUE_CODE_ADDR): Likewise.
	(DL_FIXUP_VALUE_ADDR): Likewise.
	(DL_FIXUP_ADDR_VALUE): Likewise.
	* sysdeps/ia64/dl-lookupcfg.h: Include <dl-fptr.h> for "struct fdesc".
	(DL_FIXUP_VALUE_TYPE): New.
	(DL_FIXUP_MAKE_VALUE): Likewise.
	(DL_FIXUP_VALUE_CODE_ADDR): Likewise.
	(DL_FIXUP_VALUE_ADDR): Likewise.
	(DL_FIXUP_ADDR_VALUE): Likewise.
	* sysdeps/ia64/dl-machine.h (elf_machine_profile_fixup_plt): Removed.
	(elf_machine_profile_plt): Removed.
	(elf_machine_fixup_plt): Change return type and type of value
	parameter to struct fdesc.
	(elf_machine_plt_value): Likewise.
	(elf_machine_rela): Use DL_FIXUP_MAKE_VALUE to construct
	argument for elf_machine_fixup_plt.

2005-02-07  Jakub Jelinek  <jakub@redhat.com>

	[BZ #742]
	* nscd/nscd.init (reload): Print Reloading nscd: before and a newline
	after the status string printed by killproc.

2004-11-18  Alexandre Oliva  <aoliva@redhat.com>

	* manual/.cvsignore: Add dir-add.texi.

2005-02-06  Richard Henderson  <rth@redhat.com>

	* sysdeps/alpha/dl-machine.h (elf_machine_rela): Use RESOLVE_MAP
	all the time.

2004-11-03  Marcus Brinkmann  <marcus@gnu.org>

	* configure.in (sysnames): Append sysdeps/generic for each add-on.
	* configure: Regenerated.

2005-02-02  Alfred M. Szmidt  <ams@gnu.org>

	* sysdeps/mach/hurd/tls.h: Include <stdbool.h>
	(dtv_t): Change pointer type to be a struct which also contains
	information whether the memory pointed to is static TLS or not.

	* sysdeps/generic/syslog.c (send_flags) [!send_flags]: Define it.

	* shadow/sgetspent_r.c (FALSE): Macro renamed to ...
	(FALSEP): ... this.  Updated all references.

	[BZ #765]
	* libio/fmemopen.c: Include <stdint.h>.

2005-01-30  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1103]
	* nscd/nscd_helper.c (get_mapping): Use MSG_NOSIGNAL if available.
	* nscd/connections.c (send_ro_fd): Likewise.

2005-01-28  H.J. Lu  <hongjiu.lu@intel.com>

	* elf/tst-auditmod1.c: Add ia64 entries.
	* sysdeps/generic/ldsodefs.h (La_ia64_regs): New.
	(La_ia64_retval): New.
	(audit_ifaces): Add ia64 entries.
	* sysdeps/ia64/bits/link.h: New file.
	* sysdeps/ia64/dl-machine.h (elf_machine_runtime_setup): Test
	for dl_profile non-null.
	(ARCH_LA_PLTENTER): New.
	(ARCH_LA_PLTEXIT): New.
	* sysdeps/ia64/dl-trampoline.S (_dl_runtime_resolve): Allocate
	only 2 output registers. Allocate stack to save/restore
	8 incoming fp registers. Call _dl_fixup instead of fixup.
	(_dl_runtime_profile): Rewrite.

2005-01-28  Martin Schwidefsky  <schwidefsky@de.ibm.com>

	* sysdeps/s390/bits/link.h: New file.
	* sysdeps/s390/s390-32/dl-trampoline.S: New file.
	* sysdeps/s390/s390-64/dl-trampoline.S: New file.
	* sysdeps/s390/s390-32/dl-machine.h: Move PLT trampolines to
	dl-trampoline.S. Use RESOLVE_MAP instead of RESOLVE to protect
	relocation code.
	(elf_machine_runtime_setup): Test for dl_profile non-null.
	(elf_machine_rela): Remove code using RESOLVE.
	(ARCH_LA_PLTENTER, ARCH_LA_PLTEXIT): New.
	* sysdeps/s390/s390-64/dl-machine.h: Likewise.
	* sysdeps/generic/ldsodefs.h (La_s390_32_regs, La_s390_32_retval,
	La_s390_64_regs, La_s390_64_retval): New.
	* elf/tst-auditmod1.c: Add s390 entries.

	[BZ #743]
	* sysdeps/s390/bits/string.h (strlen, strncpy, strcat, strncat,
	strncat, memchr, strcmp): Add missing memory clobber.

2005-01-27  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/alpha/oldglob.c (__old_globfree): Also
	copy gl_offs.  Patch by Sergey Tikhonov <tsv@solvo.ru>.

2005-01-27  Paolo Bonzini  <bonzini@gnu.org>

	[BZ #558]
	* posix/regcomp.c (calc_inveclosure): Return reg_errcode_t.
	Initialize the node sets in dfa->inveclosures.
	(analyze): Initialize inveclosures only if it is needed.
	Check errors from calc_inveclosure.
	* posix/regex_internal.c (re_dfa_add_node): Do not initialize
	the inveclosure node set.
	* posix/regexec.c (re_search_internal): If nmatch includes unused
	subexpressions, reset them to { rm_so: -1, rm_eo: -1 } here.

	* posix/regcomp.c (parse_bracket_exp) [!RE_ENABLE_I18N]:
	Do build a SIMPLE_BRACKET token.

	* posix/regexec.c (transit_state_mb): Do not examine nodes
	where ACCEPT_MB is not set.

2005-01-27  Jakub Jelinek  <jakub@redhat.com>

	* stdlib/tst-fmtmsg.c: Include stdlib.h.
	* stdio-common/tst-fmemopen2.c: Include string.h.
	* posix/execvp.c: Include stdbool.h.

2004-12-13  Paolo Bonzini  <bonzini@gnu.org>

	Separate parsing and creation of the NFA.  Avoided recursion on
	the (very unbalanced) parse tree.
	[BZ #611]
	* posix/regcomp.c (struct subexp_optimize, analyze_tree, calc_epsdest,
	re_dfa_add_tree_node, mark_opt_subexp_iter): Removed.
	(optimize_subexps, duplicate_tree, calc_first, calc_next,
	mark_opt_subexp): Rewritten.
	(preorder, postorder, lower_subexps, lower_subexp, link_nfa_nodes,
	create_token_tree, free_tree, free_token): New.
	(analyze): Accept a regex_t *.  Invoke the passes via the preorder and
	postorder generic visitors.  Do not initialize the fields in the
	re_dfa_t that represent the transitions.
	(free_dfa_content): Use free_token.
	(re_compile_internal): Analyze before UTF-8 optimizations.  Do not
	include optimization of subexpressions.
	(create_initial_state): Fetch the DFA node index from the first node's
	bin_tree_t *.
	(optimize_utf8): Abort on unexpected nodes, including OP_DUP_QUESTION.
	Return on COMPLEX_BRACKET.
	(duplicate_node_closure): Fix comment.
	(duplicate_node): Do not initialize the fields in the
	re_dfa_t that represent the transitions.
	(calc_eclosure, calc_inveclosure): Do not handle OP_DELETED_SUBEXP.
	(create_tree): Remove final argument.  All callers adjusted.  Rewritten
	to use create_token_tree.
	(parse_reg_exp, parse_branch, parse_expression, parse_bracket_exp,
	build_charclass_op): Use create_tree or create_token_tree instead
	of re_dfa_add_tree_node.
	(parse_dup_op): Likewise.  Also free the tree using free_tree for
	"<re>{0}", and lower OP_DUP_QUESTION to OP_ALT: "a?" is equivalent
	to "a|".  Adjust invocation of mark_opt_subexp.
	(parse_sub_exp): Create a single SUBEXP node.
	* posix/regex_internal.c (re_dfa_add_node): Remove last parameter,
	always perform as if it was 1.  Do not initialize OPT_SUBEXP and
	DUPLICATED, and initialize the DFA fields representing the transitions.
	* posix/regex_internal.h (re_dfa_add_node): Adjust prototype.
	(re_token_type_t): Move OP_DUP_PLUS and OP_DUP_QUESTION to the tokens
	section.  Add a tree-only code SUBEXP.  Remove OP_DELETED_SUBEXP.
	(bin_tree_t): Include a full re_token_t for TOKEN.  Turn FIRST and
	NEXT into pointers to trees.  Remove ECLOSURE.

2004-12-28  Paolo Bonzini  <bonzini@gnu.org >

	[BZ #605]
	* posix/regcomp.c (parse_bracket_exp): Do not modify DFA nodes
	that were already created.
	* posix/regex_internal.c (re_dfa_add_node): Set accept_mb field
	in the token if needed.
	(create_ci_newstate, create_cd_newstate): Set accept_mb field
	from the tokens' field.
	* posix/regex_internal.h (re_token_t): Add accept_mb field.
	(ACCEPT_MB_NODE): Removed.
	* posix/regexec.c (proceed_next_node, transit_states_mb,
	build_sifted_states, check_arrival_add_next_nodes): Use
	accept_mb instead of ACCEPT_MB_NODE.

2005-01-26  Ulrich Drepper  <drepper@redhat.com>

	[BZ #1100]
	* debug/chk_fail.c (__chk_fail): Print program name in final message.

	* sysdeps/unix/sysv/linux/kernel-features.h: Found reference to
	MSG_NOSIGNAL being in 2.2 kernels.

2005-01-26  Jakub Jelinek  <jakub@redhat.com>

	* sysdeps/unix/sysv/linux/i386/sysdep.h
	(SYSCALL_ERROR_HANDLER_TLS_STORE): Remove unnecessary 0 imm.

	[BZ #693]
	* posix/regex_internal.h (DUMMY_CONSTRAINT): Rename to...
	(WORD_DELIM_CONSTRAINT): ...this.
	(NOT_WORD_DELIM_CONSTRAINT): Define.
	(re_context_type): Add INSIDE_NOTWORD and NOT_WORD_DELIM,
	change WORD_DELIM to use WORD_DELIM_CONSTRAINT.
	* posix/regcomp.c (peek_token): For \B create NOT_WORD_DELIM
	anchor instead of INSIDE_WORD.
	(parse_expression): Handle NOT_WORD_DELIM constraint.
	* posix/bug-regex19.c (tests): Adjust tests that relied on \B
	being inside word instead of not word delim.
	* posix/tst-rxspencer.c (mb_frob_pattern): Don't frob escaped
	characters.
	* posix/rxspencer/tests: Add some new tests.

2005-01-14  GOTO Masanori  <gotom@debian.or.jp>

	[BZ #1108]
	* sunrpc/rpc_main.c (s_output): Generate #include <rpc/pmap_clnt.h>
	irrespective of Cflag.

	* manual/memory.texi (sbrk): Fix definition.
	* manual/string.texi (strcasestr): Fix example typo.

2005-01-25  Roland McGrath  <roland@redhat.com>

	* sysdeps/generic/syslog.c [NO_SIGPIPE]: Protect sigpipe_handler decl.

2005-01-23  Roland McGrath  <roland@redhat.com>

	[BZ #737]
	* sysdeps/i386/Makefile (defines): If -mno-tls-direct-seg-refs appears
	in $(CFLAGS), add -DNO_TLS_DIRECT_SEG_REFS.
	* sysdeps/unix/sysv/linux/i386/sysdep.h [USE___THREAD]
	(SYSCALL_ERROR_HANDLER) [NO_TLS_DIRECT_SEG_REFS]: Load thread pointer
	from %gs:0 and add to that value, rather that direct %gs:OFFSET access.
	* sysdeps/unix/i386/sysdep.S [NO_TLS_DIRECT_SEG_REFS]: Likewise.

2005-01-25  Jakub Jelinek  <jakub@redhat.com>

	[BZ #731]
	* stdlib/fmtmsg.c (addseverity): Remove new_string variable.
	(free_mem): Don't free string.
	* stdlib/tst-fmtmsg.c: Include string.h.
	(main): Add some more tests.

2005-01-25  Andreas Schwab  <schwab@suse.de>

	[BZ #736]
	* timezone/asia: Update from tzdata2005c.
	* timezone/backward: Likewise.
	* timezone/europe: Likewise.
	* timezone/leapseconds: Likewise.
	* timezone/northamerica: Likewise.
	* timezone/southamerica: Likewise.

	[BZ #736]
	* timezone/private.h: Update from tzcode2005c.
	* timezone/tzfile.h: Likewise.
	* timezone/zdump.c: Likewise.
	* timezone/zic.c: Likewise.

2005-01-25  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/i386/dl-machine.h (elf_machine_rel): Remove code using
	RESOLVE.
	* sysdeps/x86_64/dl-machine.h (elf_machine_rela): Remove code
	using RESOLVE.
	* elf/rtld.c (_dl_start): Remove RESOLVE definition.

2005-01-25  Alan Modra  <amodra@bigpond.net.au>

	* sysdeps/powerpc/powerpc32/dl-machine.h (elf_machine_rela): Test
	sym_map, not sym, against zero.

2005-01-24  Ulrich Drepper  <drepper@redhat.com>

	[BZ #671]
	* misc/syslog.c: Moved to...
	* sysdeps/generic/syslog.c: ...here.
	[NO_SIGIPE]: Don't install SIGPIPE handler.
	* sysdeps/unix/sysv/linux/syslog.c: New file.
	* sysdeps/unix/sysv/linux/kernel-features.h: Define
	__ASSUME_MSG_NOSIGNAL.

2005-01-22  Richard Henderson  <rth@redhat.com>

	* sysdeps/alpha/dl-trampoline.S: New file.
	* sysdeps/alpha/dl-machine.h: Move PLT trampolines there.
	Use RESOLVE_MAP instead of RESOLVE to protect relocation code.
	(elf_machine_runtime_setup): Test for dl_profile non-null.
	(ARCH_LA_PLTENTER, ARCH_LA_PLTEXIT): New.
	* sysdeps/alpha/bits/link.h: New file.
	* sysdeps/generic/ldsodefs.h (La_alpha_regs, La_alpha_retval): New.
	(struct audit_ifaces): Add alpha entries.
	* elf/tst-auditmod1.c: Add alpha entries.

2005-01-22  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/ia64/dl-machine.h: Remove PLT trampolines here.
	* sysdeps/ia64/dl-trampoline.S: New file.

	* sysdeps/x86_64/bits/link.h: Use namespace-safe identifiers in
	La_x86_64_xmm definition.

	* posix/Makefile: Use CFLAGS-*.os instead of CFLAGS-*.c for frame
	pointer option.
	* stdlib/Makefile (CFLAGS-system.os): Use this instead of
	CFLAGS-system.c for frame pointer option.

2005-01-21  Roland McGrath  <roland@redhat.com>

	* elf/dl-runtime.c (_dl_profile_fixup): Remove const from REGS.
	* sysdeps/i386/dl-machine.h: Update decl.

2005-01-21  Jakub Jelinek  <jakub@redhat.com>

	[BZ #735]
	* elf/Makefile: Add rules to build and run tst-align2.
	* elf/tst-align2.c: New test.
	* elf/tst-alignmod2.c: New file.
	* sysdeps/powerpc/tst-stack-align.h: New file.
	* sysdeps/i386/dl-machine.h (RTLD_START): Align stack and clear frame
	pointer before calling _dl_init.
	* sysdeps/x86_64/dl-machine.h (RTLD_START): Likewise.

2005-01-20  Ulrich Drepper  <drepper@redhat.com>

	* posix/execl.c: Do not allocate potentially large buffers on the
	stack.
	* posix/execle.c: Likewise.
	* posix/execlp.c: Likewise.
	* posix/execvp.c: Likewise.
	(script_execute): Removed.
	(allocate_scripts_argv): New function.  Called at most once to
	allocate memory, not every time a script is run.  Adjust caller.

	* sysdeps/generic/wordexp.c (exec_comm): Add a few
	TEMP_FAILURE_RETRY.  Reorganize code to avoid multiple calls to
	exec_comm_child.
	(exec_comm_child): Can now be inlined.

	* posix/Makefile: Add -fomit-frame-pointer for a few more files.
	* stdlib/Makefile: Likewise.

2005-01-19  Roland McGrath  <roland@redhat.com>

	[BZ #681]
	* sunrpc/openchild.c (_openchild): Use NULL instead of 0 for trailing
	argument to execlp.
	Reported by Marcus Meissner <meissner@suse.de>.

2005-01-19  Jakub Jelinek  <jakub@redhat.com>

	* hurd/sigunwind.c (_hurdsig_longjmp_from_handler): Fix a typo
	in assert.
	* iconv/strtab.c (strtabfinalize): Likewise.

	* libio/iofopncook.c (_IO_cookie_seekoff): Add prototype.

2005-01-17  Roland McGrath  <roland@redhat.com>

	[BZ #745]
	* nscd/Makefile (LDLIBS-nscd): New variable.
	($(objpfx)nscd): Use that instead of selinux-LIBS.

	* Makeconfig (link-extra-libs): Define just as $(LDLIBS-$(@F)).
	(link-extra-libs-static): Define to $(link-extra-libs).
	(link-extra-libs-bounded): Likewise.

2005-01-17  Ulrich Drepper  <drepper@redhat.com>

	* include/link.h: Remove stray definition of pltenter.

2005-01-16  GOTO Masanori  <gotom@debian.or.jp>

	[BZ #734]
	* sysdeps/unix/rewinddir.c: Reset filepos.
	* dirent/tst-seekdir.c: Check telldir value after calling rewinddir.

2005-01-15  Ulrich Drepper  <drepper@redhat.com>

	* elf/tst-auditmod1.c: Reduce duplication.

2005-01-16  Andreas Schwab  <schwab@suse.de>

	* sysdeps/m68k/dl-machine.h: Remove trampoline code.  Define
	ARCH_LA_PLTENTER and ARCH_LA_PLTEXIT.
	(elf_machine_runtime_setup): If profile != 0 does not anymore mean
	GLRO(dl_profile) != NULL.
	* sysdeps/m68k/dl-trampoline.S: New file.
	* sysdeps/m68k/bits/link.h: New file.
	* sysdeps/generic/ldsodefs.h (struct audit_ifaces): Add m68k
	variants.
	* elf/tst-auditmod1.c: Add m68k support.

2005-01-14  Ulrich Drepper  <drepper@redhat.com>

	* posix/regcomp.c [!_LIBC] (init_dfa): Fix determining of relevant
	LC_* variable.  Patch by Aharon Robbins <arnold@skeeve.com>.

	[BZ #731]
	* stdlib/fmtmsg.c (internal_addseverity): Remove incorrect free call.
	* stdlib/tst-fmtmsg.c (main): Add another addseverity test.

2005-01-12  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-load.c (_dl_map_object_from_fd): We don't have to allow
	callers from libc anymore.

	* elf/dl-open.c (dl_open_worker): Pass __RTLD_AUDIT flag from caller
	to _dl_map_object_deps.
	* elf/dl-load.c (_dl_map_object_from_fd): Don't change memory
	protections when loading auditing modules.

	* dlfcn/dlopen.c (dlopen_doit): Catch invalid mode arguments and fail.

	* posix/getconf.c: Update copyright year.
	* nss/getent.c: Likewise.
	* nscd/nscd_nischeck.c: Likewise.
	* iconv/iconvconfig.c: Likewise.
	* iconv/iconv_prog.c: Likewise.
	* elf/ldconfig.c: Likewise.
	* catgets/gencat.c: Likewise.
	* csu/version.c: Likewise.
	* elf/ldd.bash.in: Likewise.
	* elf/sprof.c (print_version): Likewise.
	* locale/programs/locale.c: Likewise.
	* locale/programs/localedef.c: Likewise.
	* nscd/nscd.c (print_version): Likewise.
	* debug/xtrace.sh: Likewise.
	* malloc/memusage.sh: Likewise.
	* malloc/mtrace.pl: Likewise.
	* debug/catchsegv.sh: Likewise.

2005-01-11  Thorsten Kukuk  <kukuk@suse.de>

	[BZ #733]
	* sunrpc/svc_tcp.c (svctcp_create): Call listen with SOMAXCONN
	as backlog.
	* sunrpc/svc_unix.c (svcunix_create): Likewise.

	[BZ #1099]
	* grp/putgrent.c (putgrent): Don't write 0 as group
	ID if groupname starts with + or -.
	* pwd/putpwent.c (putpwent): Don't write 0 as user or
	group ID if user name starts with + or -.

2005-01-09  Kaz Kojima  <kkojima@rr.iij4u.or.jp>

	* sysdeps/generic/ldsodefs.h (struct audit_ifaces): Add sh variants.
	* sysdeps/elf/tst-auditmod1.c: Add sh support.
	* sysdeps/sh/bits/link.h: New.
	* sysdeps/sh/dl-machine.h: Remove trampoline code here.  Define
	ARCH_LA_PLTENTER and ARCH_LA_PLTEXIT.  Remove obsolete comments.
	(RTLD_START): Define __fpscr_values.
	* sysdeps/sh/dl-trampoline.S: New file.
	* sysdeps/sh/sh4/dl-trampoline.S: New file.
	* sysdeps/sh/sh4/Versions [ld]: Add __fpscr_values.
	* sysdeps/sh/sh4/dl-machine.h: Remove.

2005-01-10  Jakub Jelinek  <jakub@redhat.com>

	[BZ #732]
	* time/tst-strptime.c (day_tests): Add 2 new tests.
	(test_tm, main): Issue an error instead of segfaulting if
	strptime returns NULL.

2005-01-10  H.J. Lu  <hongjiu.lu@intel.com>

	* sysdeps/alpha/libc-tls.c (__tls_get_addr): Updated for dtv_t union.
	* sysdeps/ia64/libc-tls.c (__tls_get_addr): Likewise.

2005-01-11  Ulrich Drepper  <drepper@redhat.com>

	* malloc/malloc.h: Remove no-glibc support.

2005-01-12  GOTO Masanori  <gotom@debian.or.jp>

	[BZ #650]
	* malloc/malloc.h: Always include features.h.

2005-01-10  Roland McGrath  <roland@redhat.com>

	* sysdeps/ia64/fpu/e_logl.c: File removed.

	* dlfcn/dlfcn.c (init): Fix typo in attribute decl.

2005-01-10  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/generic/dl-tls.c (_dl_next_tls_modid): Fix assertion and
	recognition of last entry.

2005-01-09  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-runtime.c: Include <sys/param.h>.

	* elf/Makefile (headers): Add bits/link.h.

2005-01-09  Andreas Schwab  <schwab@suse.de>

	* elf/rtld.c (dl_main): Create main_map with __RTLD_OPENEXEC.

2005-01-09  Andreas Jaeger  <aj@suse.de>

	[BZ #732]
	* time/strptime_l.c (__strptime_internal): Add braces to avoid
	warning.

	* sysdeps/x86_64/bits/link.h: Use vector_size for GCC 4.0.

	* elf/rtld.c (dl_main): Call _dl_add_to_slotinfo only if USE_TLS.

2005-01-08  Jakub Jelinek  <jakub@redhat.com>

	* elf/Makefile (generated): Add tst-pie1{,.out,.o}.

2005-01-09  Ulrich Drepper  <drepper@redhat.com>

	* elf/dl-fini.c (_dl_fini): Call destructors of audit DSOs after
	those of all the regular objects.

	* elf/dl-debug.c (_dl_debug_initialize): Take extra parameter and
	use it to select the r_debug structure for that namespace.
	* elf/dl-close.c (_dl_close): Adjust call to _dl_debug_initialize.
	* elf/dl-load.c (_dl_map_object_from_fd): Likewise.
	* elf/dl-open.c (_dl_open): Likewise.
	* elf/rtld.c (dl_main): Likewise.
	* sysdeps/generic/ldsodefs.h (struct link_namespaces): Add _ns_debug
	member.
	(_dl_debug_initialize): Add new parameter in declaration.

	* elf/dl-close.c (_dl_close): Make sure auditing callbacks are not
	called for the auditing objects themselves.
	* elf/dl-load.c (_dl_map_object_from_fd): Likewise.

2005-01-07  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/powerpc/powerpc64/dl-machine.h
	(elf_machine_runtime_setup): If profile != 0 does not anymore mean
	GLRO(dl_profile) != NULL.
	* sysdeps/powerpc/powerpc64/bits/link.h (struct la_ppc64_regs): Add
	padding.
	* sysdeps/powerpc/powerpc64/dl-trampoline.S: (_dl_profile_resolve):
	Extend _dl_prof_resolve to add pass extra parameters to
	_dl_profile_fixup and set up structure with register content.

	* sysdeps/powerpc/powerpc32/dl-machine.c (__elf_machine_runtime_setup):
	If profile != 0 does not anymore mean GLRO(dl_profile) != NULL.
	* sysdeps/powerpc/powerpc32/dl-trampoline.S (_dl_prof_resolve):
	Extend _dl_prof_resolve to add pass extra parameters to
	_dl_profile_fixup and set up structure with register content.
	* sysdeps/powerpc/powerpc32/bits/link.h: Fix types of some fields in
	the register and result structures.
	* sysdeps/powerpc/powerpc64/bits/link.h: Fix types of some fields
	in the 32-bit register and result structures.

	* sysdeps/powerpc/powerpc64/dl-trampoline.S: Use register names.

	* sysdeps/powerpc/powerpc32/dl-trampoline.S: New file.
	* sysdeps/powerpc/powerpc32/dl-machine.h: Remove trampoline code here.
	Define ARCH_LA_PLTENTER and ARCH_LA_PLTEXIT.
	* sysdeps/generic/ldsodefs.h (struct audit_ifaces): Add ppc32 variants.
	* elf/tst-auditmod1.c: Add ppc32 support.
	* sysdeps/powerpc/powerpc32/bits/link.h: New file.
	* sysdeps/powerpc/powerpc64/bits/link.h: Add ppc32 definitions.

	* malloc/malloc.c (malloc_printerr): Print program name as part of
	error message.

	* misc/sys/cdefs.h (__attribute_warn_unused_result__): Define.
	* stdlib/stdlib.h: Make realloc with
	__attribute_warn_unused_result__ instead of __wur.
	* malloc/malloc.h: Add __wur and __attribute_warn_unused_result__
	markers as in <stdlib.h>.

	* libio/stdio.h: Remove __wur from rename and remove.
	* posix/unistd.h: Remove __wur from dup2.

2005-01-03  Andreas Jaeger  <aj@suse.de>

	* elf/Makefile (tests): Revert patch from 2005-01-03.

2005-01-07  Ulrich Drepper  <drepper@redhat.com>

	* sysdeps/unix/sysv/linux/init-first.c (__libc_init_first): Don't
	make __libc_init_first hidden.

	* elf/rtld.c [!DONT_USE_BOOTSTRAP_MAP] (_dl_start_final): Initialize
	l_relocated of rtld map.
	* sysdeps/powerpc/powerpc64/dl-trampoline.S: New file.
	* sysdeps/powerpc/powerpc64/dl-machine.h: Remove trampoline code here.
	Define ARCH_LA_PLTENTER and ARCH_LA_PLTEXIT.
	* sysdeps/generic/ldsodefs.h (struct audit_ifaces): Add ppc64 variants.
	* elf/tst-auditmod1.c: Add ppc64 support.
	* sysdeps/powerpc/powerpc64/bits/link.h: New file.

2005-01-06  Roland McGrath  <roland@redhat.com>

	[BZ #633]
	* sysdeps/unix/sysv/linux/futimes.c (__futimes): Catch errno values
	indicating file-name lookup errors, and return ENOSYS or EBADF instead.

2005-01-06  Ulrich Drepper  <drepper@redhat.com>

	* csu/elf-init.c (__libc_csu_fini): Don't do anything here.
	* sysdeps/generic/libc-start.c: Don't register program destructor here.

	* dlfcn/Makefile: Add rules to build dlfcn.c.
	(LDFLAGS-dl.so): Removed.
	* dlfcn/dlclose.c: _dl_close is now in ld.so, use function pointer
	table.
	* dlfcn/dlmopen.c: Likewise for _dl_open.
	* dlfcn/dlopen.c: Likewise.
	* dlfcn/dlopenold.c: Likewise.
	* elf/dl-libc.c: Likewise for _dl_open and _dl_close.
	* elf/Makefile (routines): Remove dl-open and dl-close.
	(dl-routines): Add dl-open, dl-close, and dl-trampoline.
	Add rules to build and run tst-audit1.
	* elf/tst-audit1.c: New file.
	* elf/tst-auditmod1.c: New file.
	* elf/Versions [libc]: Remove _dl_open and _dl_close.
	* elf/dl-close.c: Change for use inside ld.so instead of libc.so.
	* elf/dl-open.c: Likewise.
	* elf/dl-debug.c (_dl_debug_initialize): Allow reinitialization,
	signaled by nonzero parameter.
	* elf/dl-init.c: Fix use of r_state.
	* elf/dl-load.c: Likewise.

	* elf/dl-close.c: Add auditing checkpoints.
	* elf/dl-open.c: Likewise.
	* elf/dl-fini.c: Likewise.
	* elf/dl-load.c: Likewise.
	* elf/dl-sym.c: Likewise.
	* sysdeps/generic/libc-start.c: Likewise.
	* elf/dl-object.c: Allocate memory for auditing information.
	* elf/dl-reloc.c: Remove RESOLV.  We now always need the map.
	Correctly initialize slotinfo.
	* elf/dynamic-link.h: Adjust after removal of RESOLV.
	* sysdeps/hppa/dl-lookupcfg.h: Likewise.
	* sysdeps/ia64/dl-lookupcfg.h: Likewise.
	* sysdeps/powerpc/powerpc64/dl-lookupcfg.h: Removed.
	* elf/dl-runtime.c (_dl_fixup): Little cleanup.
	(_dl_profile_fixup): New parameters to point to register struct and
	variable for frame size.
	Add auditing checkpoints.
	(_dl_call_pltexit): New function.
	Don't define trampoline code here.
	* elf/rtld.c: Recognize LD_AUDIT.  Load modules on startup.
	Remove all the functions from _rtld_global_ro which only _dl_open
	and _dl_close needed.
	Add auditing checkpoints.
	* elf/link.h: Define symbols for auditing interfaces.
	* include/link.h: Likewise.
	* include/dlfcn.h: Define __RTLD_AUDIT.
	Remove prototypes for _dl_open and _dl_close.
	Adjust access to argc and argv in libdl.
	* dlfcn/dlfcn.c: New file.
	* sysdeps/generic/dl-lookupcfg.h: Remove all content now that RESOLVE
	is gone.
	* sysdeps/generic/ldsodefs.h: Add definitions for auditing interfaces.
	* sysdeps/generic/unsecvars.h: Add LD_AUDIT.
	* sysdeps/i386/dl-machine.h: Remove trampoline code here.
	Adjust for removal of RESOLVE.
	* sysdeps/x86_64/dl-machine.h: Likewise.
	* sysdeps/generic/dl-trampoline.c: New file.
	* sysdeps/i386/dl-trampoline.c: New file.
	* sysdeps/x86_64/dl-trampoline.c: New file.

	* sysdeps/generic/dl-tls.c: Cleanups.  Fixup for dtv_t change.
	Fix updating of DTV.
	* sysdeps/generic/libc-tls.c: Likewise.

	* sysdeps/arm/bits/link.h: Renamed to ...
	* sysdeps/arm/bits/linkmap.h: ...this.
	* sysdeps/generic/bits/link.h: Renamed to...
	* sysdeps/generic/bits/linkmap.h: ...this.
	* sysdeps/hppa/bits/link.h: Renamed to...
	* sysdeps/hppa/bits/linkmap.h: ...this.
	* sysdeps/i386/bits/link.h: Renamed to...
	* sysdeps/i386/bits/linkmap.h: ...this.
	* sysdeps/ia64/bits/link.h: Renamed to...
	* sysdeps/ia64/bits/linkmap.h: ...this.
	* sysdeps/s390/bits/link.h: Renamed to...
	* sysdeps/s390/bits/linkmap.h: ...this.
	* sysdeps/sh/bits/link.h: Renamed to...
	* sysdeps/sh/bits/linkmap.h: ...this.
	* sysdeps/x86_64/bits/link.h: Renamed to...
	* sysdeps/x86_64/bits/linkmap.h: ...this.

	* posix/unistd.h: Declare ftruncate for POSIX 2003.  [BZ #640]

2004-12-22  Steven Munroe  <sjmunroe@us.ibm.com>

	[BZ #602]
	* math/libm-test.inc (rint_test_tonearest): New test.
	(rint_test_towardzero): New test.
	(rint_test_downward): New test.
	(rint_test_upward): New test.
	* sysdeps/powerpc/powerpc32/fpu/s_ceil.S: Fix -0.0 case.
	Remove redundant const values.
	* sysdeps/powerpc/powerpc32/fpu/s_ceilf.S: Fix -0.0 case.
	Remove redundant const values.  Use float const.
	* sysdeps/powerpc/powerpc32/fpu/s_floor.S: Fix -0.0 case.
	* sysdeps/powerpc/powerpc32/fpu/s_floorf.S: Fix -0.0 case.
	Use float const.
	* sysdeps/powerpc/powerpc32/fpu/s_rint.S: Fix -0.0 case.
	* sysdeps/powerpc/powerpc32/fpu/s_rintf.S: Fix -0.0 case.
	Use float const.
	* sysdeps/powerpc/powerpc32/fpu/s_round.S: Fix -0.0 case.
	Remove redundant const values.
	* sysdeps/powerpc/powerpc32/fpu/s_roundf.S: Fix -0.0 case.
	Remove redundant const values.  Use float const.
	* sysdeps/powerpc/powerpc32/fpu/s_trunc.S: Fix -0.0 case.
	Remove redundant const values.
	* sysdeps/powerpc/powerpc32/fpu/s_truncf.S: Fix -0.0 case.
	Remove redundant const values.  Use float const.
	* sysdeps/powerpc/powerpc64/fpu/s_ceil.S: Use EALIGN for Quadword
	alignment.  Fix -0.0 case.  Remove redundant const values.
	* sysdeps/powerpc/powerpc64/fpu/s_ceilf.S: Use EALIGN for Quadword
	alignment.  Fix -0.0 case.  Remove redundant const values.
	Use float const.
	* sysdeps/powerpc/powerpc64/fpu/s_floor.S: Use EALIGN for Quadword
	alignment.  Fix -0.0 case.
	* sysdeps/powerpc/powerpc64/fpu/s_floorf.S: Use EALIGN for Quadword
	alignment.  Fix -0.0 case.  Use float const.
	* sysdeps/powerpc/powerpc64/fpu/s_rint.S: Use EALIGN for Quadword
	alignment.  Fix -0.0 case.
	* sysdeps/powerpc/powerpc64/fpu/s_rintf.S: Use EALIGN for Quadword
	alignment.  Fix -0.0 case.  Use float const.
	* sysdeps/powerpc/powerpc64/fpu/s_round.S: Use EALIGN for Quadword
	alignment.  Fix -0.0 case.  Remove redundant const values.
	* sysdeps/powerpc/powerpc64/fpu/s_roundf.S: Use EALIGN for Quadword
	alignment.  Fix -0.0 case.  Remove redundant const values.
	Use float const.
	* sysdeps/powerpc/powerpc64/fpu/s_trunc.S: Use EALIGN for Quadword
	alignment.  Fix -0.0 case.
	* sysdeps/powerpc/powerpc64/fpu/s_truncf.S: Use EALIGN for Quadword
	alignment.  Fix -0.0 case.  Remove redundant const values.
	Use float const.

2005-01-06  Ulrich Drepper  <drepper@redhat.com>

	* misc/sys/cdefs.h: Define __wur.
	* libio/stdio.h: Use __wur for a number of interfaces.
	* posix/unistd.h: Likewise.
	* stdlib/stdlib.h: Likewise.

2004-12-29  Jakub Jelinek  <jakub@redhat.com>

	[BZ #592]
	* sysdeps/ia64/fpu/libm_support.h (__libm_error_support): Use
	libc_hidden_proto instead of HIDDEN_PROTO.
	* sysdeps/ia64/fpu/libm-symbols.h (HIDDEN_PROTO): Remove.
	(__libm_error_support): If ASSEMBLER and in libc, define to
	HIDDEN_JUMPTARGET(__libm_error_support).

2004-12-28  David Mosberger  <davidm@hpl.hp.com>

	[BZ #592]
	* sysdeps/ia64/fpu/Makefile (duplicated-routines): New macro.
	(sysdep_routines): Replace libm_ldexp{,f,l} and libm_scalbn{,f,l}
	with $(duplicated-routines).
	(libm-sysdep_routines): Likewise, but substitute "s_" prefix for
	"m_" prefix.

2004-12-27  David Mosberger  <davidm@hpl.hp.com>

	[BZ #592]
	* sysdeps/ia64/fpu/libm-symbols.h: Add include of <sysdep.h> and
	undefine "ret" macro.  Add __libm_error_support hidden definitions.

	[BZ #592]
	* sysdeps/ia64/fpu/e_lgamma_r.c: Remove CVS-id comment.  Add
	missing portion of copyright statement.
	* sysdeps/ia64/fpu/e_lgammaf_r.c: Likewise.
	* sysdeps/ia64/fpu/e_lgammal_r.c: Likewise.

	[BZ #592]
	* sysdeps/ia64/fpu/w_lgamma.c: Remove CVS-id comment.  Add
	missing portion of copyright statement.
	(__ieee754_lgamma): Rename from lgamma().  Make lgamma() a weak alias.
	(__ieee754_gamma): Likewise.
	* sysdeps/ia64/fpu/w_lgammaf.c: Likewise.
	* sysdeps/ia64/fpu/w_lgammal.c: Likewise.

2004-12-09  H.J. Lu <hjl@lucon.org>

	[BZ #592]
	* sysdeps/ia64/fpu/s_nextafterl.c: Remove.
	* sysdeps/ia64/fpu/s_nexttoward.c: Likewise.
	* sysdeps/ia64/fpu/s_nexttowardf.c: Likewise.
	* sysdeps/ia64/fpu/e_atan2l.S: Remove (duplicate of e_atan2l.c).
	* sysdeps/ia64/fpu/e_expl.S: Likewise.
	* sysdeps/ia64/fpu/e_logl.c: Remove (conflicts with e_logl.S).

2004-11-18  David Mosberger  <davidm@hpl.hp.com>

	[BZ #592]
	* sysdeps/ia64/fpu/README: New file.
	* sysdeps/ia64/fpu/gen_import_file_list: New file.
	* sysdeps/ia64/fpu/import_check: Likewise.
	* sysdeps/ia64/fpu/import_diffs: Likewise.
	* sysdeps/ia64/fpu/import_file.awk: Likewise.
	* sysdeps/ia64/fpu/import_intel_libm: Likewise.
	* sysdeps/ia64/fpu/libm-symbols.h: Likewise.

	[BZ #592]
	* sysdeps/ia64/fpu/e_acos.S: Update from Intel libm v2.1+.
	* sysdeps/ia64/fpu/e_acosf.S: Likewise.
	* sysdeps/ia64/fpu/e_acosl.S: Likewise.
	* sysdeps/ia64/fpu/e_asin.S: Likewise.
	* sysdeps/ia64/fpu/e_asinf.S: Likewise.
	* sysdeps/ia64/fpu/e_asinl.S: Likewise.
	* sysdeps/ia64/fpu/e_atan2.S: Likewise.
	* sysdeps/ia64/fpu/e_atan2f.S: Likewise.
	* sysdeps/ia64/fpu/e_cosh.S: Likewise.
	* sysdeps/ia64/fpu/e_coshf.S: Likewise.
	* sysdeps/ia64/fpu/e_coshl.S: Likewise.
	* sysdeps/ia64/fpu/e_exp.S: Likewise.
	* sysdeps/ia64/fpu/e_expf.S: Likewise.
	* sysdeps/ia64/fpu/e_fmod.S: Likewise.
	* sysdeps/ia64/fpu/e_fmodf.S: Likewise.
	* sysdeps/ia64/fpu/e_fmodl.S: Likewise.
	* sysdeps/ia64/fpu/e_hypot.S: Likewise.
	* sysdeps/ia64/fpu/e_hypotf.S: Likewise.
	* sysdeps/ia64/fpu/e_hypotl.S: Likewise.
	* sysdeps/ia64/fpu/e_log.S: Likewise.
	* sysdeps/ia64/fpu/e_log2.S: Likewise.
	* sysdeps/ia64/fpu/e_log2f.S: Likewise.
	* sysdeps/ia64/fpu/e_log2l.S: Likewise.
	* sysdeps/ia64/fpu/e_logf.S: Likewise.
	* sysdeps/ia64/fpu/e_pow.S: Likewise.
	* sysdeps/ia64/fpu/e_powf.S: Likewise.
	* sysdeps/ia64/fpu/e_powl.S: Likewise.
	* sysdeps/ia64/fpu/e_remainder.S: Likewise.
	* sysdeps/ia64/fpu/e_remainderf.S: Likewise.
	* sysdeps/ia64/fpu/e_remainderl.S: Likewise.
	* sysdeps/ia64/fpu/e_scalb.S: Likewise.
	* sysdeps/ia64/fpu/e_scalbf.S: Likewise.
	* sysdeps/ia64/fpu/e_scalbl.S: Likewise.
	* sysdeps/ia64/fpu/e_sinh.S: Likewise.
	* sysdeps/ia64/fpu/e_sinhf.S: Likewise.
	* sysdeps/ia64/fpu/e_sinhl.S: Likewise.
	* sysdeps/ia64/fpu/e_sqrt.S: Likewise.
	* sysdeps/ia64/fpu/e_sqrtf.S: Likewise.
	* sysdeps/ia64/fpu/e_sqrtl.S: Likewise.
	* sysdeps/ia64/fpu/libm_error.c: Likewise.
	* sysdeps/ia64/fpu/libm_reduce.c: Likewise.
	* sysdeps/ia64/fpu/libm_support.h: Likewise.
	* sysdeps/ia64/fpu/s_atan.S: Likewise.
	* sysdeps/ia64/fpu/s_atanf.S: Likewise.
	* sysdeps/ia64/fpu/s_atanl.S: Likewise.
	* sysdeps/ia64/fpu/s_cbrt.S: Likewise.
	* sysdeps/ia64/fpu/s_cbrtf.S: Likewise.
	* sysdeps/ia64/fpu/s_cbrtl.S: Likewise.
	* sysdeps/ia64/fpu/s_ceil.S: Likewise.
	* sysdeps/ia64/fpu/s_ceilf.S: Likewise.
	* sysdeps/ia64/fpu/s_ceill.S: Likewise.
	* sysdeps/ia64/fpu/s_cos.S: Likewise.
	* sysdeps/ia64/fpu/s_cosf.S: Likewise.
	* sysdeps/ia64/fpu/s_cosl.S: Likewise.
	* sysdeps/ia64/fpu/s_expm1.S: Likewise.
	* sysdeps/ia64/fpu/s_expm1f.S: Likewise.
	* sysdeps/ia64/fpu/s_expm1l.S: Likewise.
	* sysdeps/ia64/fpu/s_fabs.S: Likewise.
	* sysdeps/ia64/fpu/s_fabsf.S: Likewise.
	* sysdeps/ia64/fpu/s_fabsl.S: Likewise.
	* sysdeps/ia64/fpu/s_floor.S: Likewise.
	* sysdeps/ia64/fpu/s_floorf.S: Likewise.
	* sysdeps/ia64/fpu/s_floorl.S: Likewise.
	* sysdeps/ia64/fpu/s_frexp.c: Likewise.
	* sysdeps/ia64/fpu/s_frexpf.c: Likewise.
	* sysdeps/ia64/fpu/s_frexpl.c: Likewise.
	* sysdeps/ia64/fpu/s_ilogb.S: Likewise.
	* sysdeps/ia64/fpu/s_ilogbf.S: Likewise.
	* sysdeps/ia64/fpu/s_ilogbl.S: Likewise.
	* sysdeps/ia64/fpu/s_log1p.S: Likewise.
	* sysdeps/ia64/fpu/s_log1pf.S: Likewise.
	* sysdeps/ia64/fpu/s_log1pl.S: Likewise.
	* sysdeps/ia64/fpu/s_logb.S: Likewise.
	* sysdeps/ia64/fpu/s_logbf.S: Likewise.
	* sysdeps/ia64/fpu/s_logbl.S: Likewise.
	* sysdeps/ia64/fpu/s_modf.S: Likewise.
	* sysdeps/ia64/fpu/s_modff.S: Likewise.
	* sysdeps/ia64/fpu/s_modfl.S: Likewise.
	* sysdeps/ia64/fpu/s_nearbyint.S: Likewise.
	* sysdeps/ia64/fpu/s_nearbyintf.S: Likewise.
	* sysdeps/ia64/fpu/s_nearbyintl.S: Likewise.
	* sysdeps/ia64/fpu/s_rint.S: Likewise.
	* sysdeps/ia64/fpu/s_rintf.S: Likewise.
	* sysdeps/ia64/fpu/s_rintl.S: Likewise.
	* sysdeps/ia64/fpu/s_round.S: Likewise.
	* sysdeps/ia64/fpu/s_roundf.S: Likewise.
	* sysdeps/ia64/fpu/s_roundl.S: Likewise.
	* sysdeps/ia64/fpu/s_significand.S: Likewise.
	* sysdeps/ia64/fpu/s_significandf.S: Likewise.
	* sysdeps/ia64/fpu/s_significandl.S: Likewise.
	* sysdeps/ia64/fpu/s_tan.S: Likewise.
	* sysdeps/ia64/fpu/s_tanf.S: Likewise.
	* sysdeps/ia64/fpu/s_tanl.S: Likewise.
	* sysdeps/ia64/fpu/s_trunc.S: Likewise.
	* sysdeps/ia64/fpu/s_truncf.S: Likewise.
	* sysdeps/ia64/fpu/s_truncl.S: Likewise.

	[BZ #592]
	* sysdeps/ia64/fpu/e_acosh.S: New file from Intel libm v2.1+.
	* sysdeps/ia64/fpu/e_acoshf.S: Likewise.
	* sysdeps/ia64/fpu/e_acoshl.S: Likewise.
	* sysdeps/ia64/fpu/e_atanh.S: Likewise.
	* sysdeps/ia64/fpu/e_atanhf.S: Likewise.
	* sysdeps/ia64/fpu/e_atanhl.S: Likewise.
	* sysdeps/ia64/fpu/e_exp10.S: Likewise.
	* sysdeps/ia64/fpu/e_exp10f.S: Likewise.
	* sysdeps/ia64/fpu/e_exp10l.S: Likewise.
	* sysdeps/ia64/fpu/e_exp2.S: Likewise.
	* sysdeps/ia64/fpu/e_exp2f.S: Likewise.
	* sysdeps/ia64/fpu/e_exp2l.S: Likewise.
	* sysdeps/ia64/fpu/e_lgamma_r.S: Likewise.
	* sysdeps/ia64/fpu/e_lgammaf_r.S: Likewise.
	* sysdeps/ia64/fpu/e_lgammal_r.S: Likewise.
	* sysdeps/ia64/fpu/e_logl.S: Likewise.
	* sysdeps/ia64/fpu/libm_frexp.S: Likewise.
	* sysdeps/ia64/fpu/libm_frexpf.S: Likewise.
	* sysdeps/ia64/fpu/libm_frexpl.S: Likewise.
	* sysdeps/ia64/fpu/s_libm_ldexp.S: Likewise.
	* sysdeps/ia64/fpu/s_libm_ldexpf.S: Likewise.
	* sysdeps/ia64/fpu/s_libm_ldexpl.S: Likewise.
	* sysdeps/ia64/fpu/s_libm_scalbn.S: Likewise.
	* sysdeps/ia64/fpu/s_libm_scalbnf.S: Likewise.
	* sysdeps/ia64/fpu/s_libm_scalbnl.S: Likewise.
	* sysdeps/ia64/fpu/libm_lgamma.S: Likewise.
	* sysdeps/ia64/fpu/libm_lgammaf.S: Likewise.
	* sysdeps/ia64/fpu/libm_lgammal.S: Likewise.
	* sysdeps/ia64/fpu/libm_sincos.S: Likewise.
	* sysdeps/ia64/fpu/libm_sincos_large.S: Likewise.
	* sysdeps/ia64/fpu/libm_sincosf.S: Likewise.
	* sysdeps/ia64/fpu/libm_sincosl.S: Likewise.
	* sysdeps/ia64/fpu/libm_scalblnf.S: Likewise.
	* sysdeps/ia64/fpu/s_asinh.S: Likewise.
	* sysdeps/ia64/fpu/s_asinhf.S: Likewise.
	* sysdeps/ia64/fpu/s_asinhl.S: Likewise.
	* sysdeps/ia64/fpu/s_erf.S: Likewise.
	* sysdeps/ia64/fpu/s_erfc.S: Likewise.
	* sysdeps/ia64/fpu/s_erfcf.S: Likewise.
	* sysdeps/ia64/fpu/s_erfcl.S: Likewise.
	* sysdeps/ia64/fpu/s_erff.S: Likewise.
	* sysdeps/ia64/fpu/s_erfl.S: Likewise.
	* sysdeps/ia64/fpu/s_fdim.S: Likewise.
	* sysdeps/ia64/fpu/s_fdimf.S: Likewise.
	* sysdeps/ia64/fpu/s_fdiml.S: Likewise.
	* sysdeps/ia64/fpu/s_fma.S: Likewise.
	* sysdeps/ia64/fpu/s_fmaf.S: Likewise.
	* sysdeps/ia64/fpu/s_fmal.S: Likewise.
	* sysdeps/ia64/fpu/s_fmax.S: Likewise.
	* sysdeps/ia64/fpu/s_fmaxf.S: Likewise.
	* sysdeps/ia64/fpu/s_fmaxl.S: Likewise.
	* sysdeps/ia64/fpu/s_ldexp.c: Likewise.
	* sysdeps/ia64/fpu/s_ldexpf.c: Likewise.
	* sysdeps/ia64/fpu/s_ldexpl.c: Likewise.
	* sysdeps/ia64/fpu/s_nextafter.S: Likewise.
	* sysdeps/ia64/fpu/s_nextafterf.S: Likewise.
	* sysdeps/ia64/fpu/s_nextafterl.S: Likewise.
	* sysdeps/ia64/fpu/s_nexttoward.S: Likewise.
	* sysdeps/ia64/fpu/s_nexttowardf.S: Likewise.
	* sysdeps/ia64/fpu/s_nexttowardl.S: Likewise.
	* sysdeps/ia64/fpu/s_tanh.S: Likewise.
	* sysdeps/ia64/fpu/s_tanhf.S: Likewise.
	* sysdeps/ia64/fpu/s_tanhl.S: Likewise.
	* sysdeps/ia64/fpu/s_scalblnf.c: Likewise.
	* sysdeps/ia64/fpu/w_lgamma.c: Likewise.
	* sysdeps/ia64/fpu/w_lgammaf.c: Likewise.
	* sysdeps/ia64/fpu/w_lgammal.c: Likewise.
	* sysdeps/ia64/fpu/w_tgamma.S: Likewise.
	* sysdeps/ia64/fpu/w_tgammaf.S: Likewise.
	* sysdeps/ia64/fpu/w_tgammal.S: Likewise.

	[BZ #592]
	* sysdeps/ia64/fpu/e_gamma_r.c: New empty dummy-file.
	* sysdeps/ia64/fpu/e_gammaf_r.c: Likewise.
	* sysdeps/ia64/fpu/e_gammal_r.c: Likewise.
	* sysdeps/ia64/fpu/w_acosh.c: Likewise.
	* sysdeps/ia64/fpu/w_acoshf.c: Likewise.
	* sysdeps/ia64/fpu/w_acoshl.c: Likewise.
	* sysdeps/ia64/fpu/w_atanh.c: Likewise.
	* sysdeps/ia64/fpu/w_atanhf.c: Likewise.
	* sysdeps/ia64/fpu/w_atanhl.c: Likewise.
	* sysdeps/ia64/fpu/w_exp10.c: Likewise.
	* sysdeps/ia64/fpu/w_exp10f.c: Likewise.
	* sysdeps/ia64/fpu/w_exp10l.c: Likewise.
	* sysdeps/ia64/fpu/w_exp2.c: Likewise.
	* sysdeps/ia64/fpu/w_exp2f.c: Likewise.
	* sysdeps/ia64/fpu/w_exp2l.c: Likewise.
	* sysdeps/ia64/fpu/w_expl.c: Likewise.
	* sysdeps/ia64/fpu/e_expl.S: Likewise.
	* sysdeps/ia64/fpu/w_lgamma_r.c: Likewise.
	* sysdeps/ia64/fpu/w_lgammaf_r.c: Likewise.
	* sysdeps/ia64/fpu/w_lgammal_r.c: Likewise.
	* sysdeps/ia64/fpu/w_log2.c: Likewise.
	* sysdeps/ia64/fpu/w_log2f.c: Likewise.
	* sysdeps/ia64/fpu/w_log2l.c: Likewise.
	* sysdeps/ia64/fpu/w_sinh.c: Likewise.
	* sysdeps/ia64/fpu/w_sinhf.c: Likewise.
	* sysdeps/ia64/fpu/w_sinhl.c: Likewise.

	[BZ #592]
	* sysdeps/ia64/fpu/libm_atan2_reg.S: Remove.
	* sysdeps/ia64/fpu/s_ldexp.S: Likewise.
	* sysdeps/ia64/fpu/s_ldexpf.S: Likewise.
	* sysdeps/ia64/fpu/s_ldexpl.S: Likewise.
	* sysdeps/ia64/fpu/s_scalbn.S: Likewise.
	* sysdeps/ia64/fpu/s_scalbnf.S: Likewise.
	* sysdeps/ia64/fpu/s_scalbnl.S: Likewise.

	[BZ #592]
	* sysdeps/ia64/fpu/s_sincos.c: Make it an empty dummy-file.
	* sysdeps/ia64/fpu/s_sincosf.c: Likewise.
	* sysdeps/ia64/fpu/s_sincosl.c: Likewise.

	[BZ #592]
	* sysdeps/ia64/fpu/e_atan2l.S: Add "Not needed" comment.

	[BZ #592]
	* sysdeps/ia64/fpu/s_copysign.S: Add __libm_copysign{,f,l}
	alias for use by libm_error.c

	[BZ #592]
	* sysdeps/ia64/fpu/Makefile (libm-sysdep_routines): Remove
	libm_atan2_reg, libm_tan, libm_frexp4{f,l}.
	Mention s_erfc{,f,l}, libm_frexp{,f,l}, libm_ldexp{,f,l},
	libm_sincos{,f,l}, libm_sincos_large, libm_lgamma{,f,l},
	libm_scalbn{,f,l}, libm_scalblnf.
	(sysdep_routines): Remove libm_frexp4{,f,l}.
	Mention libm_frexp{,f,l}, libm_ldexp{,f,l}, and libm_scalbn{,f,l}.
	(sysdep-CPPFLAGS): Add -include libm-symbols.h, -D__POSIX__,
	_D_LIB_VERSIONIMF=_LIB_VERSION, -DSIZE_LONG_INT_64, and
	-DSIZE_LONG_LONG_INT_64.

2005-01-05  Steven Munroe  <sjmunroe@us.ibm.com>

	[BZ #729]
	* elf/rtld.c (dl_main) [NEED_DL_SYSINFO_DSO]: Insure l_map_end and
	l_text_end are set for a VDSO with a single PT_LOAD entry.

2005-01-05  Ulrich Drepper  <drepper@redhat.com>

	[BZ #730]
	* libio/iofopncook.c (_IO_cookie_seekoff): Define.  Mark offset as
	invalid to disable optimizations in fileops which won't work here.
	(_IO_cookie_jumps): Use it.
	(_IO_old_cookie_jumps): Likewise.
	* libio/fmemopen.c (fmemopen_seek): Result must be returned in *P,
	not the return value.
	* stdio-common/Makefile (tests): Add tst-fmemopen2.
	* stdio-common/tst-fmemopen2.c: New file.

	* sysdeps/unix/sysv/linux/bits/waitflags.h: Define __WNOTHREAD.

2005-01-05  Roland McGrath  <roland@redhat.com>

	* configure.in (libc_cv_cpp_asm_debuginfo): Checked moved ...
	* sysdeps/i386/configure.in: ... here.  New file.

2005-01-03  Ulrich Drepper  <drepper@redhat.com>

	[BZ #727]
	* sysdeps/generic/libc-start.c [SHARED] (__libc_start_main): Don't
	initialize __environ again.
	* stdlib/Makefile: Add rules to build and run tst-putenv.
	* stdlib/tst-putenv.c: New file.
	* stdlib/tst-putenvmod.c: New file.

	* sysdeps/unix/sysv/linux/init-first.c: Clean file up.  Don't
	define unnecessary wrappers or aliases of static functions.

2005-01-03  Andreas Jaeger  <aj@suse.de>

	* csu/Makefile (generated): Add start.os and start.ob.

	* elf/Makefile (tests): Change rule for tst-pie1 so that make
	clean works.

2004-12-29  Roland McGrath  <roland@redhat.com>

	[BZ #626]
	* sysdeps/unix/alarm.c (alarm): Round return value to nearest rather
	than always up; when nearest is zero, round up to one.

2004-12-28  Ulrich Drepper  <drepper@redhat.com>

	* po/es.po: Update from translation team.

	[BZ #726]
	* sysdeps/generic/dl-tls.c (__tls_get_addr): Fix typo.

2004-12-27  Ulrich Drepper  <drepper@redhat.com>

	[BZ #744]
	* include/signal.h: Define __sigemptyset.

2004-04-27  Paolo Bonzini  <bonzini@gnu.org>

	* posix/regex_internal.h (struct re_dfastate_t): Make
	word_trtable a pointer to the 512-item transition table.
	* posix/regexec.c (build_trtable): Fill in either state->trtable
	or state->word_trtable.  Return a boolean indicating success.
	(transit_state): Expect state->trtable to be a 256-item
	transition table.  Reorganize code to have less tests in
	the common case, and to save an indentation level.
	* posix/regex_internal.c (free_state): Free word_trtable.

2004-12-21  Jakub Jelinek  <jakub@redhat.com>

	[BZ #723]
	* sysdeps/unix/sysv/linux/i386/clone.S (__clone): Make sure %esp when
	calling fn is 16 byte aligned.
	* sysdeps/i386/tst-stack-align.h: New file.

	[BZ #725]
	* misc/efgcvt_r.c (FLOAT_MIN_10_EXP, FLOAT_MIN_10_NORM): Define.
	(ecvt_r): Special case denormals.
	* misc/qefgcvt_r.c (FLOAT_MIN_10_EXP, FLOAT_MIN_10_NORM): Define.
	* misc/tst-efgcvt.c: Include float.h.
	(ecvt_tests): Add 2 new tests.

2004-12-20  Roland McGrath  <roland@frob.com>

	* version.h (RELEASE, VERSION): development, 2.3.90
	* include/features.h (__GLIBC_MINOR__): Now 4.


See ChangeLog.15 for earlier changes.
