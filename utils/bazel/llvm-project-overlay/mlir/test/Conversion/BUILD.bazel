load("//llvm:lit_test.bzl", "lit_test")
load("//llvm:targets.bzl", "llvm_targets")

licenses(["notice"])

package(default_visibility = ["//visibility:public"])

[
    lit_test(
        name = "%s.test" % src,
        srcs = [src],
        data = [
            "//mlir:mlir-opt",
            "//mlir/test:lit_data",
        ],
    )
    for src in glob(
        include = ["**/*.mlir"],
        exclude = ["GPUToROCm/lower-rocdl-kernel-to-hsaco.mlir"] + (
            # MathToXeVM needs SPIRV; see MathToXeVM/lit.local.cfg
            ["MathToXeVM/**"] if "SPIRV" not in llvm_targets else []
        ),
    )
]
