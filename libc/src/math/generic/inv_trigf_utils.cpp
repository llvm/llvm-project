//===-- Single-precision general exp/log functions ------------------------===//
//
// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.
// See https://llvm.org/LICENSE.txt for license information.
// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception
//
//===----------------------------------------------------------------------===//

#include "inv_trigf_utils.h"

namespace LIBC_NAMESPACE {

// Polynomial approximation for 0 <= x <= 1:
//   atan(x) ~ atan((i/16) + (x - (i/16)) * Q(x - i/16)
//           = P(x - i/16)
// Generated by Sollya with:
// > for i from 1 to 16 do {
//     mid_point = i/16;
//     P = fpminimax(atan(mid_point + x), 7, [|D...|], [-1/32, 1/32]);
//     print("{", coeff(P, 0), ",", coeff(P, 1), ",", coeff(P, 2), ",",
//           coeff(P, 3), ",", coeff(P, 4), ",", coeff(P, 5), ",", coeff(P, 6),
//           ",", coeff(P, 7), "},");
//   };
// For i = 0, ATAN_COEFFS[0][j] = (-1)^j * (1/(2*j + 1)) is the odd coefficients
// of the Taylor polynomial of atan(x).
double ATAN_COEFFS[17][8] = {
    {0x1.0000000000000p+0, -0x1.5555555555555p-2, 0x1.999999999999ap-3,
     -0x1.2492492492492p-3, 0x1.c71c71c71c71cp-4, -0x1.745d1745d1746p-4,
     0x1.3b13b13b13b14p-4, -0x1.1111111111111p-4},
    {0x1.ff55bb72cfdb1p-5, 0x1.fe01fe01fe1bp-1, -0x1.fc05f80821d1ap-5,
     -0x1.4d6930419fc5fp-2, 0x1.f61b9f6d69313p-5, 0x1.8208a32f4346cp-3,
     -0x1.ecb8fc53d04efp-5, -0x1.060710cb59cbcp-3},
    {0x1.fd5ba9aac2f3cp-4, 0x1.f81f81f81f96ap-1, -0x1.f05e09cf4c1b2p-4,
     -0x1.368c3aac7543ep-2, 0x1.d9b14bddfac55p-4, 0x1.4048e55ec725ep-3,
     -0x1.b98ca3c1594b5p-4, -0x1.664eabaabbc16p-4},
    {0x1.7b97b4bce5ae7p-3, 0x1.ee9c7f8458f06p-1, -0x1.665c226c8dc69p-3,
     -0x1.1344bb77961b7p-2, 0x1.42ac97745d3ccp-3, 0x1.c32e142047ec1p-4,
     -0x1.137ae41ab96cbp-3, -0x1.1a6ae8c09a4b6p-5},
    {0x1.f5b75f92c80c6p-3, 0x1.e1e1e1e1e1ed4p-1, -0x1.c5894d101ad4p-3,
     -0x1.ce6de02b38c38p-3, 0x1.78a3920c336b9p-3, 0x1.dd5ff94a9d499p-5,
     -0x1.1ac2d3f9d072ep-3, 0x1.0af9735dff373p-6},
    {0x1.362773707ebc5p-2, 0x1.d272ca3fc5b8bp-1, -0x1.0997e8ae90cb6p-2,
     -0x1.6cf6667146798p-3, 0x1.8dd1dff17f3d3p-3, 0x1.24860eced656fp-7,
     -0x1.f4220e8f18ed5p-4, 0x1.b700aed7cdc34p-5},
    {0x1.6f61941e4deeep-2, 0x1.c0e070381c115p-1, -0x1.2726dd1347c7ep-2,
     -0x1.09f37b3ad010dp-3, 0x1.85eaca5196f5cp-3, -0x1.04d640117852ap-5,
     -0x1.802c2956871c7p-4, 0x1.2992b45df0ee7p-4},
    {0x1.a64eec3cc23fep-2, 0x1.adbe87f94906bp-1, -0x1.3b9d8eab5eae5p-2,
     -0x1.57c09646faabbp-4, 0x1.6795330e73aep-3, -0x1.f2d89a702a652p-5,
     -0x1.f3afd90a9d4d7p-5, 0x1.3261723d3f153p-4},
    {0x1.dac670561bb53p-2, 0x1.999999999998fp-1, -0x1.47ae147afd8cap-2,
     -0x1.5d867c3dfd72ap-5, 0x1.3a92a76cba833p-3, -0x1.3ec460286928ap-4,
     -0x1.ed02ff86892acp-6, 0x1.0a674c8f05727p-4},
    {0x1.0657e94db30d2p-1, 0x1.84f00c27805ffp-1, -0x1.4c62cb564f677p-2,
     -0x1.e6495b262dfe7p-8, 0x1.063c34eca262bp-3, -0x1.58b78dc79b5aep-4,
     -0x1.4623815233be1p-8, 0x1.93afe94328089p-5},
    {0x1.1e00babdefeb6p-1, 0x1.702e05c0b8159p-1, -0x1.4af2b78236bd6p-2,
     0x1.5d0b7ea46ed08p-6, 0x1.a124870236935p-4, -0x1.519e1ec133a88p-4,
     0x1.a54632a3f48c7p-7, 0x1.099ca0945096dp-5},
    {0x1.345f01cce37bdp-1, 0x1.5babcc647fa7ep-1, -0x1.449db09443a67p-2,
     0x1.655caac78a0fcp-5, 0x1.3bbbdb0d09efap-4, -0x1.34a306c27e021p-4,
     0x1.83fe749c7966p-6, 0x1.2057cc96d9edcp-6},
    {0x1.4978fa3269ee2p-1, 0x1.47ae147ae146bp-1, -0x1.3a92a305652e1p-2,
     0x1.ec21b5172657fp-5, 0x1.c2f8c45d2f4eep-5, -0x1.0ba99c4aeb8acp-4,
     0x1.d716a4af4d1d6p-6, 0x1.97fba0a9696dep-8},
    {0x1.5d58987169b19p-1, 0x1.34679ace0133cp-1, -0x1.2ddfb03920e2fp-2,
     0x1.2491307c0fa0bp-4, 0x1.29c7eca0136fp-5, -0x1.bca792caa6f1cp-5,
     0x1.e5d92545576bcp-6, -0x1.8ca76fcf5ccd2p-10},
    {0x1.700a7c5784634p-1, 0x1.21fb78121fb71p-1, -0x1.1f6a8499ea541p-2,
     0x1.41b15e5e77bcfp-4, 0x1.59bc9bf54fb02p-6, -0x1.63b54ff058e0fp-5,
     0x1.c8da01221306fp-6, -0x1.906b2c274c39cp-8},
    {0x1.819d0b7158a4dp-1, 0x1.107fbbe01107cp-1, -0x1.0feeb40897d4ep-2,
     0x1.50e5afb95f5d6p-4, 0x1.2a7c2f0c7495dp-7, -0x1.12bd2bb5062cdp-5,
     0x1.93e8ceb89afebp-6, -0x1.10da9b8c6b731p-7},
    {0x1.921fb54442d18p-1, 0x1.fffffffffffebp-2, -0x1.fffffffffcbbcp-3,
     0x1.555555564e2fep-4, -0x1.20b17d5dd89dcp-30, -0x1.9999c5ad71711p-6,
     0x1.5558b76e7aaf9p-6, -0x1.236e803c6c1f6p-7},
};

} // namespace LIBC_NAMESPACE
