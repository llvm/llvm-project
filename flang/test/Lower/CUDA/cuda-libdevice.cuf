! RUN: bbc -emit-hlfir -fcuda %s -o - | FileCheck %s

! Test CUDA Fortran procedures available in cudadevice module

attributes(global) subroutine test_sad()
  integer :: res
  integer :: i, j, k
  res = __sad(i, j, k)
end subroutine

! CHECK-LABEL: _QPtest_sad
! CHECK: %{{.*}} = fir.call @__nv_sad(%{{.*}}, %{{.*}}, %{{.*}}) proc_attrs<bind_c> fastmath<contract> : (i32, i32, i32) -> i32

attributes(global) subroutine test_usad()
  integer :: res
  integer :: i, j, k
  res = __usad(i, j, k)
end subroutine

! CHECK-LABEL: _QPtest_usad
! CHECK: %{{.*}} = fir.call @__nv_usad(%{{.*}}, %{{.*}}, %{{.*}}) proc_attrs<bind_c> fastmath<contract> : (i32, i32, i32) -> i32

attributes(global) subroutine test_log()
  real :: res
  real :: r
  res = __logf(r)
  res = __log2f(r)
  res = __log10f(r)
end subroutine

! CHECK-LABEL: _QPtest_log
! CHECK: %{{.*}} = fir.call @__nv_logf(%{{.*}}) proc_attrs<bind_c> fastmath<contract> : (f32) -> f32
! CHECK: %{{.*}} = fir.call @__nv_log2f(%{{.*}}) proc_attrs<bind_c> fastmath<contract> : (f32) -> f32
! CHECK: %{{.*}} = fir.call @__nv_log10f(%{{.*}}) proc_attrs<bind_c> fastmath<contract> : (f32) -> f32

attributes(global) subroutine test_sinf()
  real :: res
  real :: r
  res = __sinf(r)
end subroutine

! CHECK-LABEL: _QPtest_sinf
! CHECK: %{{.*}} = fir.call @__nv_sinf(%{{.*}}) proc_attrs<bind_c> fastmath<contract> : (f32) -> f32

attributes(global) subroutine test_tanf()
  real :: res
  real :: r
  res = __tanf(r)
end subroutine

! CHECK-LABEL: _QPtest_tanf
! CHECK: %{{.*}} = fir.call @__nv_tanf(%{{.*}}) proc_attrs<bind_c> fastmath<contract> : (f32) -> f32

