//===-- sanitizer_hash_test.cpp -------------------------------------------===//
//
// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.
// See https://llvm.org/LICENSE.txt for license information.
// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception
//
//===----------------------------------------------------------------------===//
//
// This file is a part of Sanitizers.
//
//===----------------------------------------------------------------------===//
#include "sanitizer_common/sanitizer_hash.h"

#include "gtest/gtest.h"

namespace __sanitizer {

// Tests matche a few hashes generated by https://github.com/aappleby/smhasher.

TEST(SanitizerCommon, Hash32Seed) {
  EXPECT_EQ(MurMur2HashBuilder(0).get(), 275646681u);
  EXPECT_EQ(MurMur2HashBuilder(1).get(), 3030210376u);
  EXPECT_EQ(MurMur2HashBuilder(3).get(), 1816185114u);
}

TEST(SanitizerCommon, Hash32Add) {
  MurMur2HashBuilder h(123 * sizeof(u32));
  for (u32 i = 0; i < 123; ++i) h.add(i);
  EXPECT_EQ(h.get(), 351963665u);
  for (u32 i = 0; i < 123; ++i) h.add(-i);
  EXPECT_EQ(h.get(), 2640061027u);
}

}  // namespace __sanitizer
