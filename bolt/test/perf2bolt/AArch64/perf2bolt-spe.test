## Check that Arm SPE mode is available on AArch64.

REQUIRES: system-linux,perf,target=aarch64{{.*}}

RUN: perf record -e cycles -q -o %t.perf.data -- %t.exe 2> /dev/null

RUN: (perf2bolt -p %t.perf.data -o %t.perf.boltdata --spe --nl %t.exe 2> /dev/null; exit 0) | FileCheck %s --check-prefix=CHECK-SPE-NO-LBR

RUN: (perf2bolt -p %t.perf.data -o %t.perf.boltdata --spe %t.exe 2> /dev/null; exit 0) | FileCheck %s --check-prefix=CHECK-SPE-LBR

CHECK-SPE-NO-LBR: PERF2BOLT: spawning perf job to read SPE branch events (non-lbr)
CHECK-SPE-LBR: PERF2BOLT: spawning perf job to read SPE brstack events

