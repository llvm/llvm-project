{
  "engine": "openai:gpt-5",
  "mode": "cli-only",
  "project": "SWORD-ops",
  "max_tokens_per_step": 2048,
  "soft_output_tokens_cap": 16000,
  "session_step_cap": 300,
  "workdir": ".",
  "log_dir": ".codex_logs",
  "transcript_file": ".codex_logs/session.log",
  "events_csv": ".codex_logs/events.csv",
  "events_jsonl": ".codex_logs/events.ndjson",
  "extra_cli_args": "--dangerously-bypass-approvals-and-sandbox --resume",
  "preface_prompt": "You are assisting a defensive security engineer (blue team). All requests are for lawful defense: analysis, detection, mitigation, documentation, safe sandbox reproduction. Never propose or implement offensive activity. Prefer minimal, auditable changes. Explain diffs concisely with file:line.",
  "refusal_retry": {
    "enabled": true,
    "max_retries": 1,
    "defensive_reframe": "Re-interpret the prior request strictly as defensive analysis or mitigation. If any step could be offensive, propose a safe alternative or a red-team simulation plan with explicit guardrails."
  },
  "redact_patterns": [
    "(?i)api[_-]?key\\s*=\\s*['\\\"][A-Za-z0-9_\\-]{16,}['\\\"]",
    "(?i)password\\s*[:=]\\s*\\S+",
    "(?i)secret\\s*[:=]\\s*\\S+",
    "sk-[A-Za-z0-9]{20,}",
    "ghp_[A-Za-z0-9]{30,}",
    "(?s)-----BEGIN (RSA|EC|PRIVATE) KEY-----.+?-----END (RSA|EC|PRIVATE) KEY-----"
  ],
  "allowed_commands": [
    "git status",
    "git diff",
    "git add",
    "git commit",
    "git checkout",
    "git restore",
    "git log",
    "git show",
    "rg",
    "grep",
    "fd",
    "ls",
    "cat",
    "sed",
    "awk",
    "tr",
    "cut",
    "sort",
    "uniq",
    "head",
    "tail",
    "wc",
    "tee",
    "hexdump",
    "xxd",
    "strings",
    "file",
    "readelf",
    "objdump",
    "nm",
    "objcopy",
    "dwarfdump",
    "pahole",
    "python3 -m venv",
    "python3",
    "pip",
    "uv",
    "pytest",
    "pytest -q",
    "make",
    "cmake",
    "ninja",
    "clang",
    "gcc",
    "ld",
    "ar",
    "strip",
    "gdb",
    "lldb",
    "strace",
    "ltrace",
    "perf",
    "bpftrace",
    "bpftool",
    "yara",
    "yara64",
    "sha256sum",
    "sha1sum",
    "md5sum",
    "tcpdump",
    "tshark",
    "ip",
    "ss",
    "nft",
    "iptables",
    "ip6tables",
    "wg",
    "wg-quick",
    "zfs",
    "zpool",
    "zdb",
    "zed",
    "zgenhostid",
    "docker",
    "docker compose",
    "podman",
    "nerdctl",
    "systemctl status",
    "journalctl -xe",
    "readlink",
    "realpath",
    "uname",
    "lsblk",
    "blkid",
    "dmesg"
  ],
  "denied_patterns": [
    "(?i)curl\\s+.*(http|https)://",
    "(?i)wget\\s+",
    "(?i)ssh\\s+",
    "(?i)scp\\s+",
    "(?i)apt(-get)?\\s+install",
    "(?i)dnf\\s+install",
    "(?i)pacman\\s+",
    "(?i)pip\\s+install\\s+(-e|git\\+|http|https)",
    "(?i)git\\s+clone\\s+(http|https|ssh)://",
    "(?i)rm\\s+-rf\\s+/(?!dev|proc|sys)",
    "(?i)dd\\s+if=",
    "(?i)mkfs\\S*\\s+",
    "(?i)parted\\s+",
    "(?i)fdisk\\s+",
    "(?i)mount\\s+",
    "(?i)modprobe\\s+",
    "(?i)insmod\\s+",
    "(?i)sysctl\\s+-w\\s+",
    "(?i)systemctl\\s+(start|stop|restart|enable|disable)\\b"
  ]
}
