if(LIBOMP_OMPD_SUPPORT)

if(NOT OPENMP_TEST_COMPILER_ID STREQUAL "Clang")
  message(STATUS "LIBOMPD: Can only test with Clang compiler")
  message(WARNING "LIBOMPD: The check-libompd target will not be available!")
  return()
endif()

set(PYTHON_PLUGIN ${ompd_BINARY_DIR}/gdb-plugin/python-module)

# Configure the lit.site.cfg.in file
set(AUTO_GEN_COMMENT "## Autogenerated by libomp configuration.\n# Do not edit!")
configure_file(lit.site.cfg.in lit.site.cfg @ONLY)

add_openmp_testsuite(check-ompd "Running OMPD tests"
  ${CMAKE_CURRENT_BINARY_DIR}
  DEPENDS omp ompd ompd_gdb_plugin)
endif()
