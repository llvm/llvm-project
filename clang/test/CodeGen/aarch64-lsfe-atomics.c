// NOTE: Assertions have been autogenerated by utils/update_cc_test_checks.py UTC_ARGS: --version 6
// RUN: %clang_cc1 %s -emit-llvm -o - -triple=aarch64-linux-gnu | FileCheck %s --check-prefix=CHECK-LLVM

_Atomic(float) f;
_Atomic(double) d;

// CHECK-LLVM-LABEL: define dso_local void @test_float_add(
// CHECK-LLVM-SAME: float noundef [[VAL:%.*]]) #[[ATTR0:[0-9]+]] {
// CHECK-LLVM-NEXT:  [[ENTRY:.*:]]
// CHECK-LLVM-NEXT:    [[VAL_ADDR:%.*]] = alloca float, align 4
// CHECK-LLVM-NEXT:    store float [[VAL]], ptr [[VAL_ADDR]], align 4
// CHECK-LLVM-NEXT:    [[TMP0:%.*]] = load float, ptr [[VAL_ADDR]], align 4
// CHECK-LLVM-NEXT:    [[TMP1:%.*]] = atomicrmw fadd ptr @f, float [[TMP0]] seq_cst, align 4
// CHECK-LLVM-NEXT:    [[TMP2:%.*]] = fadd float [[TMP1]], [[TMP0]]
// CHECK-LLVM-NEXT:    ret void
//
void test_float_add(float val) {
  f += val;
}

// CHECK-LLVM-LABEL: define dso_local void @test_double_add(
// CHECK-LLVM-SAME: double noundef [[VAL:%.*]]) #[[ATTR0]] {
// CHECK-LLVM-NEXT:  [[ENTRY:.*:]]
// CHECK-LLVM-NEXT:    [[VAL_ADDR:%.*]] = alloca double, align 8
// CHECK-LLVM-NEXT:    store double [[VAL]], ptr [[VAL_ADDR]], align 8
// CHECK-LLVM-NEXT:    [[TMP0:%.*]] = load double, ptr [[VAL_ADDR]], align 8
// CHECK-LLVM-NEXT:    [[TMP1:%.*]] = atomicrmw fadd ptr @d, double [[TMP0]] seq_cst, align 8
// CHECK-LLVM-NEXT:    [[TMP2:%.*]] = fadd double [[TMP1]], [[TMP0]]
// CHECK-LLVM-NEXT:    ret void
//
void test_double_add(double val) {
  d += val;
}

// CHECK-LLVM-LABEL: define dso_local void @test_float_sub(
// CHECK-LLVM-SAME: float noundef [[VAL:%.*]]) #[[ATTR0]] {
// CHECK-LLVM-NEXT:  [[ENTRY:.*:]]
// CHECK-LLVM-NEXT:    [[VAL_ADDR:%.*]] = alloca float, align 4
// CHECK-LLVM-NEXT:    store float [[VAL]], ptr [[VAL_ADDR]], align 4
// CHECK-LLVM-NEXT:    [[TMP0:%.*]] = load float, ptr [[VAL_ADDR]], align 4
// CHECK-LLVM-NEXT:    [[TMP1:%.*]] = atomicrmw fsub ptr @f, float [[TMP0]] seq_cst, align 4
// CHECK-LLVM-NEXT:    [[TMP2:%.*]] = fsub float [[TMP1]], [[TMP0]]
// CHECK-LLVM-NEXT:    ret void
//
void test_float_sub(float val) {
  f -= val;
}

// CHECK-LLVM-LABEL: define dso_local void @test_double_sub(
// CHECK-LLVM-SAME: double noundef [[VAL:%.*]]) #[[ATTR0]] {
// CHECK-LLVM-NEXT:  [[ENTRY:.*:]]
// CHECK-LLVM-NEXT:    [[VAL_ADDR:%.*]] = alloca double, align 8
// CHECK-LLVM-NEXT:    store double [[VAL]], ptr [[VAL_ADDR]], align 8
// CHECK-LLVM-NEXT:    [[TMP0:%.*]] = load double, ptr [[VAL_ADDR]], align 8
// CHECK-LLVM-NEXT:    [[TMP1:%.*]] = atomicrmw fsub ptr @d, double [[TMP0]] seq_cst, align 8
// CHECK-LLVM-NEXT:    [[TMP2:%.*]] = fsub double [[TMP1]], [[TMP0]]
// CHECK-LLVM-NEXT:    ret void
//
void test_double_sub(double val){
    d -= val;
}
