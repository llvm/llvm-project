// NOTE: Assertions have been autogenerated by utils/update_cc_test_checks.py UTC_ARGS: --version 5

// RUN: %clang_cc1 -fbounds-safety -Oz -disable-llvm-passes -triple arm64-apple-ios -emit-llvm %s -o - | FileCheck %s
// RUN: %clang_cc1 -fbounds-safety -Oz -disable-llvm-passes -triple arm64-apple-ios -x objective-c -fexperimental-bounds-safety-objc -emit-llvm %s -o - | FileCheck %s
// RUN: %clang_cc1 -Oz -disable-llvm-passes -triple arm64-apple-ios -emit-llvm %s -o - | FileCheck %s

#include <ptrcheck.h>

struct pf_addr {
 union {
  short _addr16[8];
  int _addr32[4];
 } pfa;
};

void foo(struct pf_addr *up) {
  up->pfa._addr32[0] = 5;
  *up->pfa._addr32 = 4;
}

// CHECK: store i32 5, ptr [[TMP1:%.*]], align 4, !tbaa ![[TBAA_9:[0-9]+]]
// CHECK: store i32 4, ptr [[WIDE_PTR_PTR:%.*]], align 4, !tbaa ![[TBAA_10:[0-9]+]]
// CHECK-DAG: ![[TBAA_4:[0-9]+]] = !{!"omnipotent char", !{{[0-9]+}}, i64 0}
// CHECK-DAG: ![[TBAA_9]] = !{![[TBAA_4]], ![[TBAA_4]], i64 0}
// CHECK-DAG: ![[TBAA_10]] = !{![[TBAA_11:[0-9]+]], ![[TBAA_11]], i64 0}
// CHECK-DAG: ![[TBAA_11]] = !{!"int", !{{[0-9]+}}, i64 0}
