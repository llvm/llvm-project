// NOTE: Assertions have been autogenerated by utils/update_cc_test_checks.py
// REQUIRES: amdgpu-registered-target
// RUN: %clang_cc1 -triple amdgcn-unknown-unknown -target-cpu gfx1300 -target-feature +wavefrontsize32 -emit-llvm -o - %s | FileCheck %s --check-prefix=CHECK-GFX1300

typedef float  v8f   __attribute__((ext_vector_type(8)));
typedef int    v8i   __attribute__((ext_vector_type(8)));

#define A_FORMAT_F6_E2M3 (2 << 6)
#define B_FORMAT_F6_E2M3 (2 << 9)

// CHECK-GFX1300-LABEL: @test_amdgcn_wmma_f32_16x16x64_f8f6f4_gfx13(
// CHECK-GFX1300-NEXT:  entry:
// CHECK-GFX1300-NEXT:    [[TMP0:%.*]] = tail call <8 x float> @llvm.amdgcn.wmma.f32.16x16x64.f8f6f4.clamp(<8 x i32> [[A:%.*]], <8 x i32> [[B:%.*]], <8 x float> [[C:%.*]], i32 [[SCALE_A:%.*]], i32 [[SCALE_B:%.*]], i32 1152, i1 true)
// CHECK-GFX1300-NEXT:    store <8 x float> [[TMP0]], ptr addrspace(1) [[OUT:%.*]], align 32, !tbaa [[TBAA4:![0-9]+]]
// CHECK-GFX1300-NEXT:    ret void
//
void test_amdgcn_wmma_f32_16x16x64_f8f6f4_gfx13(global v8f* out, v8i a, v8i b, v8f c, int scale_a, int scale_b)
{
   *out = __builtin_amdgcn_wmma_f32_16x16x64_f8f6f4_clamp(a, b, c, scale_a, scale_b, A_FORMAT_F6_E2M3 | B_FORMAT_F6_E2M3, 1);
}
