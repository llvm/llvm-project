name: PR sccache save
inputs:
  artifact-name-suffix:
    desciption: The suffix to append to the artifict name (sccache-pr#)
    required: true

runs:
  using: "composite"
  steps:
    - name: Package sccache Directory
      shell: bash
      run: |
        # Dereference symlinks so that this works on Windows.
        tar -h -c .sccache | zstd -T0 -c > sccache.tar.zst

    - uses: actions/upload-artifact@26f96dfa697d77e81fd5907df203aa23a56210a8 #v4.3.0
      with:
        name: 'sccache-pr${{ github.event.number }}-${{ inputs.artifact-name-suffix }}'
        path: sccache.tar.zst
        retention-days: 7
        overwrite: true

    - shell: bash
      run: |
        rm sccache.tar.zst
        sccache --show-stats

