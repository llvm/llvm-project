name: PR ccache save
inputs:
  artifact-name-suffix:
    desciption: The suffix to append to the artifict name (ccache-pr#)
    required: true

runs:
  using: "composite"
  steps:
    - name: Package ccache Directory
      shell: bash
      run: |
        # Dereference symlinks so that this works on Windows.
        tar -h -c .ccache | zstd -T0 -c > ccache.tar.zst
    - uses: actions/upload-artifact@26f96dfa697d77e81fd5907df203aa23a56210a8 #v4.3.0
      with:
        name: 'ccache-pr${{ github.event.number }}-${{ inputs.artifact-name-suffix }}'
        path: ccache.tar.zst
        retention-days: 7
        overwrite: true

    - shell: bash
      run: |
        rm ccache.tar.zst
        ccache --show-stats
